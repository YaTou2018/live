!function(e){function t(t){for(var n,r,o=t[0],a=t[1],s=0,c=[];s<o.length;s++)r=o[s],i[r]&&c.push(i[r][0]),i[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(l&&l(t);c.length;)c.shift()()}var n={},i={2:0};function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise(function(t,r){n=i[e]=[t,r]});t.push(n[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+""+({1:"vendors~pdfjsWorker"}[e]||e)+".js"}(e);var l=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(c);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",l.type=r,l.request=o,n[1](l)}i[e]=void 0}};var c=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp=window.webpackJsonp||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var l=a;r(r.s=216)}([function(e,t,n){var i=n(105),r=n(114);function o(e){return(o="function"==typeof r&&"symbol"==typeof i?function(e){return typeof e}:function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":typeof e})(e)}function a(t){return"function"==typeof r&&"symbol"===o(i)?e.exports=a=function(e){return o(e)}:e.exports=a=function(e){return e&&"function"==typeof r&&e.constructor===r&&e!==r.prototype?"symbol":o(e)},a(t)}e.exports=a},function(e,t,n){e.exports=n(122)},function(e,t,n){e.exports=n(130)},function(e,t,n){var i=n(121),r=n(124),o=n(127);e.exports=function(e,t){return i(e)||r(e,t)||o()}},function(e,t,n){e.exports=n(128)},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var i=n(35);function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),i(e,r.key,r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,n){e.exports=n(125)},function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},function(e,t,n){e.exports=n(165)},function(e,t,n){var i=n(15),r=n(8),o=n(23),a=n(25),s=n(29),l=function(e,t,n){var c,d,u,h=e&l.F,p=e&l.G,f=e&l.S,m=e&l.P,g=e&l.B,v=e&l.W,y=p?r:r[t]||(r[t]={}),b=y.prototype,w=p?i:f?i[t]:(i[t]||{}).prototype;for(c in p&&(n=t),n)(d=!h&&w&&void 0!==w[c])&&s(y,c)||(u=d?w[c]:n[c],y[c]=p&&"function"!=typeof w[c]?n[c]:g&&d?o(u,i):v&&w[c]==u?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(u):m&&"function"==typeof u?o(Function.call,u):u,m&&((y.virtual||(y.virtual={}))[c]=u,e&l.R&&b&&!b[c]&&a(b,c,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){e.exports=n(120)},function(e,t,n){var i=n(0),r=n(194);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?r(e):t}},function(e,t,n){var i=n(195),r=n(101);function o(t){return e.exports=o=r?i:function(e){return e.__proto__||i(e)},o(t)}e.exports=o},function(e,t,n){var i=n(201),r=n(204);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=i(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){var i=n(137),r=n(138),o=n(145);e.exports=function(e){return i(e)||r(e)||o()}},function(e,t,n){var i=n(62)("wks"),r=n(49),o=n(15).Symbol,a="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:r)("Symbol."+e))}).store=i},function(e,t,n){e.exports=!n(26)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){var i=n(22),r=n(81),o=n(57),a=Object.defineProperty;t.f=n(18)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){e.exports=n(135)},function(e,t,n){var i=n(20);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var i=n(38);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){e.exports=n(132)},function(e,t,n){var i=n(19),r=n(39);e.exports=n(18)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var i=n(60),r=n(46);e.exports=function(e){return i(r(e))}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var i=n(46);e.exports=function(e){return Object(i(e))}},function(e,t,n){e.exports=n(146)},function(e,t,n){"use strict";var i=n(107)(!0);n(59)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t){e.exports={}},function(e,t,n){var i=n(83),r=n(63);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){e.exports=n(103)},function(e,t,n){var i=n(160),r=n(95),o=n(2),a=n(164);e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},s=o(n);"function"==typeof r&&(s=s.concat(r(n).filter(function(e){return i(n,e).enumerable}))),s.forEach(function(t){a(e,t,n[t])})}return e}},function(e,t,n){e.exports=n(169)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){e.exports=!0},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var i=n(19).f,r=n(29),o=n(17)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){n(112);for(var i=n(15),r=n(25),o=n(33),a=n(17)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<s.length;l++){var c=s[l],d=i[c],u=d&&d.prototype;u&&!u[a]&&r(u,a,c),o[c]=o.Array}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var i=n(23),r=n(90),o=n(91),a=n(22),s=n(48),l=n(71),c={},d={};(t=e.exports=function(e,t,n,u,h){var p,f,m,g,v=h?function(){return e}:l(e),y=i(n,u,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(p=s(e.length);p>b;b++)if((g=t?y(a(f=e[b])[0],f[1]):y(e[b]))===c||g===d)return g}else for(m=v.call(e);!(f=m.next()).done;)if((g=r(m,y,f.value,t))===c||g===d)return g}).BREAK=c,t.RETURN=d},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){var i=n(22),r=n(109),o=n(63),a=n(61)("IE_PROTO"),s=function(){},l=function(){var e,t=n(56)("iframe"),i=o.length;for(t.style.display="none",n(84).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[o[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:r(n,t)}},function(e,t,n){var i=n(58),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t){var n=0,i=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+i).toString(36))}},function(e,t,n){var i=n(41),r=n(17)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){e.exports=n(139)},function(e,t,n){var i=n(95),r=n(193);e.exports=function(e,t){if(null==e)return{};var n,o,a=r(e,t);if(i){var s=i(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}},function(e,t,n){(function(t,i,r){var o;o=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var i=n(1),r=n(147),o=n(162),a=n(163),s=n(151),l=n(164),c=n(156),d=n(153);if(n(4)()){var u=n(165).PDFNodeStream;r.setPDFNetworkStreamFactory(function(e){return new u(e)})}else{var h,p=n(168).PDFNetworkStream;s.isFetchSupported()&&(h=n(169).PDFFetchStream),r.setPDFNetworkStreamFactory(function(e){return h&&s.isValidFetchUrl(e.url)?new h(e):new p(e)})}t.build=r.build,t.version=r.version,t.getDocument=r.getDocument,t.LoopbackPort=r.LoopbackPort,t.PDFDataRangeTransport=r.PDFDataRangeTransport,t.PDFWorker=r.PDFWorker,t.renderTextLayer=o.renderTextLayer,t.AnnotationLayer=a.AnnotationLayer,t.createPromiseCapability=i.createPromiseCapability,t.PasswordResponses=i.PasswordResponses,t.InvalidPDFException=i.InvalidPDFException,t.MissingPDFException=i.MissingPDFException,t.SVGGraphics=l.SVGGraphics,t.NativeImageDecoding=i.NativeImageDecoding,t.CMapCompressionType=i.CMapCompressionType,t.PermissionFlag=i.PermissionFlag,t.UnexpectedResponseException=i.UnexpectedResponseException,t.OPS=i.OPS,t.VerbosityLevel=i.VerbosityLevel,t.UNSUPPORTED_FEATURES=i.UNSUPPORTED_FEATURES,t.createValidAbsoluteUrl=i.createValidAbsoluteUrl,t.createObjectURL=i.createObjectURL,t.removeNullCharacters=i.removeNullCharacters,t.shadow=i.shadow,t.Util=i.Util,t.ReadableStream=i.ReadableStream,t.URL=i.URL,t.RenderingCancelledException=s.RenderingCancelledException,t.getFilenameFromUrl=s.getFilenameFromUrl,t.LinkTarget=s.LinkTarget,t.addLinkAttributes=s.addLinkAttributes,t.loadScript=s.loadScript,t.PDFDateString=s.PDFDateString,t.GlobalWorkerOptions=c.GlobalWorkerOptions,t.apiCompatibilityParams=d.apiCompatibilityParams},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayByteLength=w,t.arraysToBytes=function(e){if(1===e.length&&e[0]instanceof Uint8Array)return e[0];var t,n,i,r=0,o=e.length;for(t=0;t<o;t++)n=e[t],i=w(n),r+=i;var a=0,s=new Uint8Array(r);for(t=0;t<o;t++)(n=e[t])instanceof Uint8Array||(n="string"==typeof n?b(n):new Uint8Array(n)),i=n.byteLength,s.set(n,a),a+=i;return s},t.assert=d,t.bytesToString=function(e){d(null!==e&&"object"===o(e)&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length;if(t<8192)return String.fromCharCode.apply(null,e);for(var n=[],i=0;i<t;i+=8192){var r=Math.min(i+8192,t),a=e.subarray(i,r);n.push(String.fromCharCode.apply(null,a))}return n.join("")},t.createPromiseCapability=function(){var e=Object.create(null),t=!1;return Object.defineProperty(e,"settled",{get:function(){return t}}),e.promise=new Promise(function(n,i){e.resolve=function(e){t=!0,n(e)},e.reject=function(e){t=!0,i(e)}}),e},t.getVerbosityLevel=function(){return s},t.info=function(e){s>=a.INFOS&&console.log("Info: "+e)},t.isArrayBuffer=function(e){return"object"===o(e)&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){if(e.length!==t.length)return!1;return e.every(function(e,n){return e===t[n]})},t.isBool=function(e){return"boolean"==typeof e},t.isEmptyObj=function(e){for(var t in e)return!1;return!0},t.isNum=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSpace=function(e){return 32===e||9===e||13===e||10===e},t.isSameOrigin=function(e,t){try{var n=new r.URL(e);if(!n.origin||"null"===n.origin)return!1}catch(e){return!1}var i=new r.URL(t,n);return n.origin===i.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{var n=t?new r.URL(e,t):new r.URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(e){}return null},t.isLittleEndian=function(){var e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]},t.isEvalSupported=function(){try{return new Function(""),!0}catch(e){return!1}},t.log2=function(e){if(e<=0)return 0;return Math.ceil(Math.log2(e))},t.readInt8=function(e,t){return e[t]<<24>>24},t.readUint16=function(e,t){return e[t]<<8|e[t+1]},t.readUint32=function(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0},t.removeNullCharacters=function(e){if("string"!=typeof e)return l("The argument for removeNullCharacters must be a string."),e;return e.replace(y,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(s=e)},t.shadow=function(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n},t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=b,t.stringToPDFString=function(e){var t,n=e.length,i=[];if("þ"===e[0]&&"ÿ"===e[1])for(t=2;t<n;t+=2)i.push(String.fromCharCode(e.charCodeAt(t)<<8|e.charCodeAt(t+1)));else for(t=0;t<n;++t){var r=S[e.charCodeAt(t)];i.push(r?String.fromCharCode(r):e.charAt(t))}return i.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=l,t.unreachable=c,Object.defineProperty(t,"ReadableStream",{enumerable:!0,get:function(){return i.ReadableStream}}),Object.defineProperty(t,"URL",{enumerable:!0,get:function(){return r.URL}}),t.createObjectURL=t.FormatError=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.NativeImageDecoding=t.MissingPDFException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=void 0,n(2);var i=n(143),r=n(145);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.IDENTITY_MATRIX=[1,0,0,1,0,0];t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0];t.NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"};t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.StreamType={UNKNOWN:0,FLATE:1,LZW:2,DCT:3,JPX:4,JBIG:5,A85:6,AHX:7,CCF:8,RL:9};t.FontType={UNKNOWN:0,TYPE1:1,TYPE1C:2,CIDFONTTYPE0:3,CIDFONTTYPE0C:4,TRUETYPE:5,CIDFONTTYPE2:6,TYPE3:7,OPENTYPE:8,TYPE0:9,MMTYPE1:10};var a={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=a;t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2};t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"};t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var s=a.WARNINGS;function l(e){s>=a.WARNINGS&&console.log("Warning: "+e)}function c(e){throw new Error(e)}function d(e,t){e||c(t)}var u=function(){function e(e,t){this.name="PasswordException",this.message=e,this.code=t}return e.prototype=new Error,e.constructor=e,e}();t.PasswordException=u;var h=function(){function e(e,t){this.name="UnknownErrorException",this.message=e,this.details=t}return e.prototype=new Error,e.constructor=e,e}();t.UnknownErrorException=h;var p=function(){function e(e){this.name="InvalidPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.InvalidPDFException=p;var f=function(){function e(e){this.name="MissingPDFException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.MissingPDFException=f;var m=function(){function e(e,t){this.name="UnexpectedResponseException",this.message=e,this.status=t}return e.prototype=new Error,e.constructor=e,e}();t.UnexpectedResponseException=m;var g=function(){function e(e){this.message=e}return e.prototype=new Error,e.prototype.name="FormatError",e.constructor=e,e}();t.FormatError=g;var v=function(){function e(e){this.name="AbortException",this.message=e}return e.prototype=new Error,e.constructor=e,e}();t.AbortException=v;var y=/\x00/g;function b(e){d("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,n=new Uint8Array(t),i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}function w(e){return void 0!==e.length?e.length:(d(void 0!==e.byteLength),e.byteLength)}var _=function(){function e(){}var t=["rgb(",0,",",0,",",0,")"];return e.makeCssRgb=function(e,n,i){return t[1]=e,t[3]=n,t[5]=i,t.join("")},e.transform=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},e.applyTransform=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},e.applyInverseTransform=function(e,t){var n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]},e.getAxialAlignedBoundingBox=function(t,n){var i=e.applyTransform(t,n),r=e.applyTransform(t.slice(2,4),n),o=e.applyTransform([t[0],t[3]],n),a=e.applyTransform([t[2],t[1]],n);return[Math.min(i[0],r[0],o[0],a[0]),Math.min(i[1],r[1],o[1],a[1]),Math.max(i[0],r[0],o[0],a[0]),Math.max(i[1],r[1],o[1],a[1])]},e.inverseTransform=function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]},e.apply3dTransform=function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]},e.singularValueDecompose2dScale=function(e){var t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(n+o)/2,s=Math.sqrt((n+o)*(n+o)-4*(n*o-r*i))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]},e.normalizeRect=function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t},e.intersect=function(t,n){function i(e,t){return e-t}var r=[t[0],t[2],n[0],n[2]].sort(i),o=[t[1],t[3],n[1],n[3]].sort(i),a=[];return t=e.normalizeRect(t),n=e.normalizeRect(n),(r[0]===t[0]&&r[1]===n[0]||r[0]===n[0]&&r[1]===t[0])&&(a[0]=r[1],a[2]=r[2],(o[0]===t[1]&&o[1]===n[1]||o[0]===n[1]&&o[1]===t[1])&&(a[1]=o[1],a[3]=o[2],a))},e}();t.Util=_;var S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];var k,P=(k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&r.URL.createObjectURL){var n=new Blob([e],{type:t});return r.URL.createObjectURL(n)}for(var i="data:"+t+";base64,",o=0,a=e.length;o<a;o+=3){var s=255&e[o],l=255&e[o+1],c=255&e[o+2];i+=k[s>>2]+k[(3&s)<<4|l>>4]+k[o+1<a?(15&l)<<2|c>>6:64]+k[o+2<a?63&c:64]}return i});t.createObjectURL=P},function(e,n,i){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=i(3);if(!o._pdfjsCompatibilityChecked){o._pdfjsCompatibilityChecked=!0;var a=i(4),s="object"===("undefined"==typeof window?"undefined":r(window))&&"object"===("undefined"==typeof document?"undefined":r(document));!o.btoa&&a()&&(o.btoa=function(e){return t.from(e,"binary").toString("base64")}),!o.atob&&a()&&(o.atob=function(e){return t.from(e,"base64").toString("binary")}),s&&void 0===Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){if(s&&!a()){var e=document.createElement("div");if(e.classList.add("testOne","testTwo"),!0!==e.classList.contains("testOne")||!0!==e.classList.contains("testTwo")){var t=DOMTokenList.prototype.add,n=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(var r=0,o=n;r<o.length;r++){var a=o[r];t.call(this,a)}},DOMTokenList.prototype.remove=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var r=0,o=t;r<o.length;r++){var a=o[r];n.call(this,a)}}}}}(),s&&!a()&&!1!==document.createElement("div").classList.toggle("test",0)&&(DOMTokenList.prototype.toggle=function(e){var t=arguments.length>1?!!arguments[1]:!this.contains(e);return this[t?"add":"remove"](e),t}),String.prototype.startsWith||i(5),String.prototype.endsWith||i(36),String.prototype.includes||i(38),Array.prototype.includes||i(40),Array.from||i(47),Object.assign||i(70),Math.log2||(Math.log2=i(75)),Number.isNaN||(Number.isNaN=i(77)),Number.isInteger||(Number.isInteger=i(79)),o.Promise&&o.Promise.prototype&&o.Promise.prototype.finally||(o.Promise=i(82)),o.WeakMap||(o.WeakMap=i(102)),o.WeakSet||(o.WeakSet=i(119)),String.codePointAt||(String.codePointAt=i(123)),String.fromCodePoint||(String.fromCodePoint=i(125)),o.Symbol||i(127),String.prototype.padStart||i(134),String.prototype.padEnd||i(138),Object.values||(Object.values=i(140))}},function(e,t,n){"use strict";e.exports="undefined"!=typeof window&&window.Math===Math?window:void 0!==i&&i.Math===Math?i:"undefined"!=typeof self&&self.Math===Math?self:{}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(){return"object"===(void 0===r?"undefined":i(r))&&r+""=="[object process]"&&!r.versions.nw&&!r.versions.electron}},function(e,t,n){"use strict";n(6),e.exports=n(9).String.startsWith},function(e,t,n){"use strict";var i=n(7),r=n(28),o=n(30),a="".startsWith;i(i.P+i.F*n(35)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=r(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),i=String(e);return a?a.call(t,i,n):t.slice(n,n+i.length)===i}})},function(e,t,n){"use strict";var i=n(8),r=n(9),o=n(10),a=n(20),s=n(26),l=function e(t,n,l){var c,d,u,h,p=t&e.F,f=t&e.G,m=t&e.P,g=t&e.B,v=f?i:t&e.S?i[n]||(i[n]={}):(i[n]||{}).prototype,y=f?r:r[n]||(r[n]={}),b=y.prototype||(y.prototype={});for(c in f&&(l=n),l)u=((d=!p&&v&&void 0!==v[c])?v:l)[c],h=g&&d?s(u,i):m&&"function"==typeof u?s(Function.call,u):u,v&&a(v,c,u,t&e.U),y[c]!=u&&o(y,c,h),m&&b[c]!=u&&(b[c]=u)};i.core=r,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){"use strict";var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(e,t,n){"use strict";var i=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=i)},function(e,t,n){"use strict";var i=n(11),r=n(19);e.exports=n(15)?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";var i=n(12),r=n(14),o=n(18),a=Object.defineProperty;t.f=n(15)?Object.defineProperty:function(e,t,n){if(i(e),t=o(t,!0),i(n),r)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===i(e)?null!==e:"function"==typeof e}},function(e,t,n){"use strict";e.exports=!n(15)&&!n(16)(function(){return 7!=Object.defineProperty(n(17)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";e.exports=!n(16)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t,n){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";var i=n(13),r=n(8).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){"use strict";var i=n(8),r=n(10),o=n(21),a=n(22)("src"),s=n(23),l=(""+s).split("toString");n(9).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(o(n,"name")||r(n,"name",t)),e[t]!==n&&(c&&(o(n,a)||r(n,a,e[t]?""+e[t]:l.join(String(t)))),e===i?e[t]=n:s?e[t]?e[t]=n:r(e,t,n):(delete e[t],r(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(e,t,n){"use strict";var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,n){"use strict";var i=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+r).toString(36))}},function(e,t,n){"use strict";e.exports=n(24)("native-function-to-string",Function.toString)},function(e,t,n){"use strict";var i=n(9),r=n(8),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(25)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){"use strict";e.exports=!1},function(e,t,n){"use strict";var i=n(27);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){"use strict";var i=n(29),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},function(e,t,n){"use strict";var i=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:i)(e)}},function(e,t,n){"use strict";var i=n(31),r=n(34);e.exports=function(e,t,n){if(i(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(r(e))}},function(e,t,n){"use strict";var i=n(13),r=n(32),o=n(33)("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==r(e))}},function(e,t,n){"use strict";var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,n){"use strict";var i=n(24)("wks"),r=n(22),o=n(8).Symbol,a="function"==typeof o;(e.exports=function(e){return i[e]||(i[e]=a&&o[e]||(a?o:r)("Symbol."+e))}).store=i},function(e,t,n){"use strict";e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";var i=n(33)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){"use strict";n(37),e.exports=n(9).String.endsWith},function(e,t,n){"use strict";var i=n(7),r=n(28),o=n(30),a="".endsWith;i(i.P+i.F*n(35)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,i=r(t.length),s=void 0===n?i:Math.min(r(n),i),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,n){"use strict";n(39),e.exports=n(9).String.includes},function(e,t,n){"use strict";var i=n(7),r=n(30);i(i.P+i.F*n(35)("includes"),"String",{includes:function(e){return!!~r(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){"use strict";n(41),e.exports=n(9).Array.includes},function(e,t,n){"use strict";var i=n(7),r=n(42)(!0);i(i.P,"Array",{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),n(46)("includes")},function(e,t,n){"use strict";var i=n(43),r=n(28),o=n(45);e.exports=function(e){return function(t,n,a){var s,l=i(t),c=r(l.length),d=o(a,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){"use strict";var i=n(44),r=n(34);e.exports=function(e){return i(r(e))}},function(e,t,n){"use strict";var i=n(32);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){"use strict";var i=n(29),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):o(e,t)}},function(e,t,n){"use strict";var i=n(33)("unscopables"),r=Array.prototype;null==r[i]&&n(10)(r,i,{}),e.exports=function(e){r[i][e]=!0}},function(e,t,n){"use strict";n(48),n(63),e.exports=n(9).Array.from},function(e,t,n){"use strict";var i=n(49)(!0);n(50)(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=i(t,n),this._i+=e.length,{value:e,done:!1})})},function(e,t,n){"use strict";var i=n(29),r=n(34);e.exports=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var i=n(25),r=n(7),o=n(20),a=n(10),s=n(51),l=n(52),c=n(60),d=n(61),u=n(33)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,f,m,g,v){l(n,t,f);var y,b,w,_=function(e){if(!h&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",k="values"==m,P=!1,C=e.prototype,T=C[u]||C["@@iterator"]||m&&C[m],A=T||_(m),I=m?k?_("entries"):A:void 0,E="Array"==t&&C.entries||T;if(E&&(w=d(E.call(new e)))!==Object.prototype&&w.next&&(c(w,S,!0),i||"function"==typeof w[u]||a(w,u,p)),k&&T&&"values"!==T.name&&(P=!0,A=function(){return T.call(this)}),i&&!v||!h&&!P&&C[u]||a(C,u,A),s[t]=A,s[S]=p,m)if(y={values:k?A:_("values"),keys:g?A:_("keys"),entries:I},v)for(b in y)b in C||o(C,b,y[b]);else r(r.P+r.F*(h||P),t,y);return y}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var i=n(53),r=n(19),o=n(60),a={};n(10)(a,n(33)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){"use strict";var i=n(12),r=n(54),o=n(58),a=n(57)("IE_PROTO"),s=function(){},l=function(){var e,t=n(17)("iframe"),i=o.length;for(t.style.display="none",n(59).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;i--;)delete l.prototype[o[i]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=i(e),n=new s,s.prototype=null,n[a]=e):n=l(),void 0===t?n:r(n,t)}},function(e,t,n){"use strict";var i=n(11),r=n(12),o=n(55);e.exports=n(15)?Object.defineProperties:function(e,t){r(e);for(var n,a=o(t),s=a.length,l=0;s>l;)i.f(e,n=a[l++],t[n]);return e}},function(e,t,n){"use strict";var i=n(56),r=n(58);e.exports=Object.keys||function(e){return i(e,r)}},function(e,t,n){"use strict";var i=n(21),r=n(43),o=n(42)(!1),a=n(57)("IE_PROTO");e.exports=function(e,t){var n,s=r(e),l=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){"use strict";var i=n(24)("keys"),r=n(22);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){"use strict";e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){"use strict";var i=n(8).document;e.exports=i&&i.documentElement},function(e,t,n){"use strict";var i=n(11).f,r=n(21),o=n(33)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},function(e,t,n){"use strict";var i=n(21),r=n(62),o=n(57)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){"use strict";var i=n(34);e.exports=function(e){return Object(i(e))}},function(e,t,n){"use strict";var i=n(26),r=n(7),o=n(62),a=n(64),s=n(65),l=n(28),c=n(66),d=n(67);r(r.S+r.F*!n(69)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,u,h=o(e),p="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=0,y=d(h);if(g&&(m=i(m,f>2?arguments[2]:void 0,2)),null==y||p==Array&&s(y))for(n=new p(t=l(h.length));t>v;v++)c(n,v,g?m(h[v],v):h[v]);else for(u=y.call(h),n=new p;!(r=u.next()).done;v++)c(n,v,g?a(u,m,[r.value,v],!0):r.value);return n.length=v,n}})},function(e,t,n){"use strict";var i=n(12);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},function(e,t,n){"use strict";var i=n(51),r=n(33)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){"use strict";var i=n(11),r=n(19);e.exports=function(e,t,n){t in e?i.f(e,t,r(0,n)):e[t]=n}},function(e,t,n){"use strict";var i=n(68),r=n(33)("iterator"),o=n(51);e.exports=n(9).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||o[i(e)]}},function(e,t,n){"use strict";var i=n(32),r=n(33)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){"use strict";var i=n(33)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";n(71),e.exports=n(9).Object.assign},function(e,t,n){"use strict";var i=n(7);i(i.S+i.F,"Object",{assign:n(72)})},function(e,t,n){"use strict";var i=n(15),r=n(55),o=n(73),a=n(74),s=n(62),l=n(44),c=Object.assign;e.exports=!c||n(16)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=i})?function(e,t){for(var n=s(e),c=arguments.length,d=1,u=o.f,h=a.f;c>d;)for(var p,f=l(arguments[d++]),m=u?r(f).concat(u(f)):r(f),g=m.length,v=0;g>v;)p=m[v++],i&&!h.call(f,p)||(n[p]=f[p]);return n}:c},function(e,t,n){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";t.f={}.propertyIsEnumerable},function(e,t,n){"use strict";n(76),e.exports=n(9).Math.log2},function(e,t,n){"use strict";var i=n(7);i(i.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){"use strict";n(78),e.exports=n(9).Number.isNaN},function(e,t,n){"use strict";var i=n(7);i(i.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){"use strict";n(80),e.exports=n(9).Number.isInteger},function(e,t,n){"use strict";var i=n(7);i(i.S,"Number",{isInteger:n(81)})},function(e,t,n){"use strict";var i=n(13),r=Math.floor;e.exports=function(e){return!i(e)&&isFinite(e)&&r(e)===e}},function(e,t,n){"use strict";n(83),n(48),n(84),n(87),n(100),n(101),e.exports=n(9).Promise},function(e,t,n){"use strict";var i=n(68),r={};r[n(33)("toStringTag")]="z",r+""!="[object z]"&&n(20)(Object.prototype,"toString",function(){return"[object "+i(this)+"]"},!0)},function(e,t,n){"use strict";for(var i=n(85),r=n(55),o=n(20),a=n(8),s=n(10),l=n(51),c=n(33),d=c("iterator"),u=c("toStringTag"),h=l.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=r(p),m=0;m<f.length;m++){var g,v=f[m],y=p[v],b=a[v],w=b&&b.prototype;if(w&&(w[d]||s(w,d,h),w[u]||s(w,u,v),l[v]=h,y))for(g in i)w[g]||o(w,g,i[g],!0)}},function(e,t,n){"use strict";var i=n(46),r=n(86),o=n(51),a=n(43);e.exports=n(50)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){"use strict";e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i,r,o,a,s=n(25),l=n(8),c=n(26),d=n(68),u=n(7),h=n(13),p=n(27),f=n(88),m=n(89),g=n(90),v=n(91).set,y=n(93)(),b=n(94),w=n(95),_=n(96),S=n(97),k=l.TypeError,P=l.process,C=P&&P.versions,T=C&&C.v8||"",A=l.Promise,I="process"==d(P),E=function(){},x=r=b.f,R=!!function(){try{var e=A.resolve(1),t=(e.constructor={})[n(33)("species")]=function(e){e(E,E)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(E)instanceof t&&0!==T.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),D=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},L=function(e,t){if(!e._n){e._n=!0;var n=e._c;y(function(){for(var i=e._v,r=1==e._s,o=0,a=function(t){var n,o,a,s=r?t.ok:t.fail,l=t.resolve,c=t.reject,d=t.domain;try{s?(r||(2==e._h&&N(e),e._h=1),!0===s?n=i:(d&&d.enter(),n=s(i),d&&(d.exit(),a=!0)),n===t.promise?c(k("Promise-chain cycle")):(o=D(n))?o.call(n,l,c):l(n)):c(i)}catch(e){d&&!a&&d.exit(),c(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&M(e)})}},M=function(e){v.call(l,function(){var t,n,i,r=e._v,o=W(e);if(o&&(t=w(function(){I?P.emit("unhandledRejection",r,e):(n=l.onunhandledrejection)?n({promise:e,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),e._h=I||W(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},W=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){v.call(l,function(){var t;I?P.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},O=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),L(t,!0))},F=function e(t){var n,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw k("Promise can't be resolved itself");(n=D(t))?y(function(){var r={_w:i,_d:!1};try{n.call(t,c(e,r,1),c(O,r,1))}catch(e){O.call(r,e)}}):(i._v=t,i._s=1,L(i,!1))}catch(e){O.call({_w:i,_d:!1},e)}}};R||(A=function(e){f(this,A,"Promise","_h"),p(e),i.call(this);try{e(c(F,this,1),c(O,this,1))}catch(e){O.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(98)(A.prototype,{then:function(e,t){var n=x(g(this,A));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=I?P.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new i;this.promise=e,this.resolve=c(F,e,1),this.reject=c(O,e,1)},b.f=x=function(e){return e===A||e===a?new o(e):r(e)}),u(u.G+u.W+u.F*!R,{Promise:A}),n(60)(A,"Promise"),n(99)("Promise"),a=n(9).Promise,u(u.S+u.F*!R,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(s||!R),"Promise",{resolve:function(e){return S(s&&this===a?A:this,e)}}),u(u.S+u.F*!(R&&n(69)(function(e){A.all(e).catch(E)})),"Promise",{all:function(e){var t=this,n=x(t),i=n.resolve,r=n.reject,o=w(function(){var n=[],o=0,a=1;m(e,!1,function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--a||i(n))},r)}),--a||i(n)});return o.e&&r(o.v),n.promise},race:function(e){var t=this,n=x(t),i=n.reject,r=w(function(){m(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(e,t,n){"use strict";e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var i=n(26),r=n(64),o=n(65),a=n(12),s=n(28),l=n(67),c={},d={},u=e.exports=function(e,t,n,u,h){var p,f,m,g,v=h?function(){return e}:l(e),y=i(n,u,t?2:1),b=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(o(v)){for(p=s(e.length);p>b;b++)if((g=t?y(a(f=e[b])[0],f[1]):y(e[b]))===c||g===d)return g}else for(m=v.call(e);!(f=m.next()).done;)if((g=r(m,y,f.value,t))===c||g===d)return g};u.BREAK=c,u.RETURN=d},function(e,t,n){"use strict";var i=n(12),r=n(27),o=n(33)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},function(e,t,n){"use strict";var i,r,o,a=n(26),s=n(92),l=n(59),c=n(17),d=n(8),u=d.process,h=d.setImmediate,p=d.clearImmediate,f=d.MessageChannel,m=d.Dispatch,g=0,v={},y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){y.call(e.data)};h&&p||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},p=function(e){delete v[e]},"process"==n(32)(u)?i=function(e){u.nextTick(a(y,e,1))}:m&&m.now?i=function(e){m.now(a(y,e,1))}:f?(o=(r=new f).port2,r.port1.onmessage=b,i=a(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(i=function(e){d.postMessage(e+"","*")},d.addEventListener("message",b,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:h,clear:p}},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){"use strict";var i=n(8),r=n(91).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(32)(a);e.exports=function(){var e,t,n,c=function(){var i,r;for(l&&(i=a.domain)&&i.exit();e;){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(c)};else if(!o||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var d=s.resolve(void 0);n=function(){d.then(c)}}else n=function(){r.call(i,c)};else{var u=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=u=!u}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},function(e,t,n){"use strict";var i=n(27);function r(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new r(e)}},function(e,t,n){"use strict";e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var i=n(8).navigator;e.exports=i&&i.userAgent||""},function(e,t,n){"use strict";var i=n(12),r=n(13),o=n(94);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var i=n(20);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},function(e,t,n){"use strict";var i=n(8),r=n(11),o=n(15),a=n(33)("species");e.exports=function(e){var t=i[e];o&&t&&!t[a]&&r.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";var i=n(7),r=n(9),o=n(8),a=n(90),s=n(97);i(i.P+i.R,"Promise",{finally:function(e){var t=a(this,r.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var i=n(7),r=n(94),o=n(95);i(i.S,"Promise",{try:function(e){var t=r.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t,n){"use strict";n(83),n(84),n(103),n(115),n(117),e.exports=n(9).WeakMap},function(e,t,n){"use strict";var i,r=n(8),o=n(104)(0),a=n(20),s=n(108),l=n(72),c=n(109),d=n(13),u=n(110),h=n(110),p=!r.ActiveXObject&&"ActiveXObject"in r,f=s.getWeak,m=Object.isExtensible,g=c.ufstore,v=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(d(e)){var t=f(e);return!0===t?g(u(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(u(this,"WeakMap"),e,t)}},b=e.exports=n(111)("WeakMap",v,y,c,!0,!0);h&&p&&(l((i=c.getConstructor(v,"WeakMap")).prototype,y),s.NEED=!0,o(["delete","has","get","set"],function(e){var t=b.prototype,n=t[e];a(t,e,function(t,r){if(d(t)&&!m(t)){this._f||(this._f=new i);var o=this._f[e](t,r);return"set"==e?this:o}return n.call(this,t,r)})}))},function(e,t,n){"use strict";var i=n(26),r=n(44),o=n(62),a=n(28),s=n(105);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,d=4==e,u=6==e,h=5==e||u,p=t||s;return function(t,s,f){for(var m,g,v=o(t),y=r(v),b=i(s,f,3),w=a(y.length),_=0,S=n?p(t,w):l?p(t,0):void 0;w>_;_++)if((h||_ in y)&&(g=b(m=y[_],_,v),e))if(n)S[_]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return _;case 2:S.push(m)}else if(d)return!1;return u?-1:c||d?d:S}}},function(e,t,n){"use strict";var i=n(106);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){"use strict";var i=n(13),r=n(107),o=n(33)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var i=n(32);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=n(22)("meta"),o=n(13),a=n(21),s=n(11).f,l=0,c=Object.isExtensible||function(){return!0},d=!n(16)(function(){return c(Object.preventExtensions({}))}),u=function(e){s(e,r,{value:{i:"O"+ ++l,w:{}}})},h=e.exports={KEY:r,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==i(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,r)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[r].i},getWeak:function(e,t){if(!a(e,r)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[r].w},onFreeze:function(e){return d&&h.NEED&&c(e)&&!a(e,r)&&u(e),e}}},function(e,t,n){"use strict";var i=n(98),r=n(108).getWeak,o=n(12),a=n(13),s=n(88),l=n(89),c=n(104),d=n(21),u=n(110),h=c(5),p=c(6),f=0,m=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},v=function(e,t){return h(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=v(this,e);if(t)return t[1]},has:function(e){return!!v(this,e)},set:function(e,t){var n=v(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=p(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var c=e(function(e,i){s(e,c,t,"_i"),e._t=t,e._i=f++,e._l=void 0,null!=i&&l(i,n,e[o],e)});return i(c.prototype,{delete:function(e){if(!a(e))return!1;var n=r(e);return!0===n?m(u(this,t)).delete(e):n&&d(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=r(e);return!0===n?m(u(this,t)).has(e):n&&d(n,this._i)}}),c},def:function(e,t,n){var i=r(o(t),!0);return!0===i?m(e).set(t,n):i[e._i]=n,e},ufstore:m}},function(e,t,n){"use strict";var i=n(13);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){"use strict";var i=n(8),r=n(7),o=n(20),a=n(98),s=n(108),l=n(89),c=n(88),d=n(13),u=n(16),h=n(69),p=n(60),f=n(112);e.exports=function(e,t,n,m,g,v){var y=i[e],b=y,w=g?"set":"add",_=b&&b.prototype,S={},k=function(e){var t=_[e];o(_,e,"delete"==e?function(e){return!(v&&!d(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!d(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!d(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof b&&(v||_.forEach&&!u(function(){(new b).entries().next()}))){var P=new b,C=P[w](v?{}:-0,1)!=P,T=u(function(){P.has(1)}),A=h(function(e){new b(e)}),I=!v&&u(function(){for(var e=new b,t=5;t--;)e[w](t,t);return!e.has(-0)});A||((b=t(function(t,n){c(t,b,e);var i=f(new y,t,b);return null!=n&&l(n,g,i[w],i),i})).prototype=_,_.constructor=b),(T||I)&&(k("delete"),k("has"),g&&k("get")),(I||C)&&k(w),v&&_.clear&&delete _.clear}else b=m.getConstructor(t,e,g,w),a(b.prototype,n),s.NEED=!0;return p(b,e),S[e]=b,r(r.G+r.W+r.F*(b!=y),S),v||m.setStrong(b,e,g),b}},function(e,t,n){"use strict";var i=n(13),r=n(113).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&i(o)&&r&&r(e,o),e}},function(e,t,n){"use strict";var i=n(13),r=n(12),o=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n(26)(Function.call,n(114).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){"use strict";var i=n(74),r=n(19),o=n(43),a=n(18),s=n(21),l=n(14),c=Object.getOwnPropertyDescriptor;t.f=n(15)?c:function(e,t){if(e=o(e),t=a(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},function(e,t,n){"use strict";n(116)("WeakMap")},function(e,t,n){"use strict";var i=n(7);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){"use strict";n(118)("WeakMap")},function(e,t,n){"use strict";var i=n(7),r=n(27),o=n(26),a=n(89);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,l=arguments[1];return r(this),(t=void 0!==l)&&r(l),null==e?new this:(n=[],t?(i=0,s=o(l,arguments[2],2),a(e,!1,function(e){n.push(s(e,i++))})):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){"use strict";n(83),n(84),n(120),n(121),n(122),e.exports=n(9).WeakSet},function(e,t,n){"use strict";var i=n(109),r=n(110);n(111)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return i.def(r(this,"WeakSet"),e,!0)}},i,!1,!0)},function(e,t,n){"use strict";n(116)("WeakSet")},function(e,t,n){"use strict";n(118)("WeakSet")},function(e,t,n){"use strict";n(124),e.exports=n(9).String.codePointAt},function(e,t,n){"use strict";var i=n(7),r=n(49)(!1);i(i.P,"String",{codePointAt:function(e){return r(this,e)}})},function(e,t,n){"use strict";n(126),e.exports=n(9).String.fromCodePoint},function(e,t,n){"use strict";var i=n(7),r=n(45),o=String.fromCharCode,a=String.fromCodePoint;i(i.S+i.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],i=arguments.length,a=0;i>a;){if(t=+arguments[a++],r(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){"use strict";n(128),n(83),e.exports=n(9).Symbol},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=n(8),o=n(21),a=n(15),s=n(7),l=n(20),c=n(108).KEY,d=n(16),u=n(24),h=n(60),p=n(22),f=n(33),m=n(129),g=n(130),v=n(131),y=n(107),b=n(12),w=n(13),_=n(62),S=n(43),k=n(18),P=n(19),C=n(53),T=n(132),A=n(114),I=n(73),E=n(11),x=n(55),R=A.f,D=E.f,L=T.f,M=r.Symbol,W=r.JSON,N=W&&W.stringify,O=f("_hidden"),F=f("toPrimitive"),B={}.propertyIsEnumerable,j=u("symbol-registry"),V=u("symbols"),U=u("op-symbols"),z=Object.prototype,q="function"==typeof M&&!!I.f,H=r.QObject,G=!H||!H.prototype||!H.prototype.findChild,Y=a&&d(function(){return 7!=C(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=R(z,t);i&&delete z[t],D(e,t,n),i&&e!==z&&D(z,t,i)}:D,J=function(e){var t=V[e]=C(M.prototype);return t._k=e,t},X=q&&"symbol"==i(M.iterator)?function(e){return"symbol"==i(e)}:function(e){return e instanceof M},K=function(e,t,n){return e===z&&K(U,t,n),b(e),t=k(t,!0),b(n),o(V,t)?(n.enumerable?(o(e,O)&&e[O][t]&&(e[O][t]=!1),n=C(n,{enumerable:P(0,!1)})):(o(e,O)||D(e,O,P(1,{})),e[O][t]=!0),Y(e,t,n)):D(e,t,n)},Q=function(e,t){b(e);for(var n,i=v(t=S(t)),r=0,o=i.length;o>r;)K(e,n=i[r++],t[n]);return e},Z=function(e){var t=B.call(this,e=k(e,!0));return!(this===z&&o(V,e)&&!o(U,e))&&(!(t||!o(this,e)||!o(V,e)||o(this,O)&&this[O][e])||t)},$=function(e,t){if(e=S(e),t=k(t,!0),e!==z||!o(V,t)||o(U,t)){var n=R(e,t);return!n||!o(V,t)||o(e,O)&&e[O][t]||(n.enumerable=!0),n}},ee=function(e){for(var t,n=L(S(e)),i=[],r=0;n.length>r;)o(V,t=n[r++])||t==O||t==c||i.push(t);return i},te=function(e){for(var t,n=e===z,i=L(n?U:S(e)),r=[],a=0;i.length>a;)!o(V,t=i[a++])||n&&!o(z,t)||r.push(V[t]);return r};q||(l((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=p(arguments.length>0?arguments[0]:void 0);return a&&G&&Y(z,e,{configurable:!0,set:function t(n){this===z&&t.call(U,n),o(this,O)&&o(this[O],e)&&(this[O][e]=!1),Y(this,e,P(1,n))}}),J(e)}).prototype,"toString",function(){return this._k}),A.f=$,E.f=K,n(133).f=T.f=ee,n(74).f=Z,I.f=te,a&&!n(25)&&l(z,"propertyIsEnumerable",Z,!0),m.f=function(e){return J(f(e))}),s(s.G+s.W+s.F*!q,{Symbol:M});for(var ne="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;ne.length>ie;)f(ne[ie++]);for(var re=x(f.store),oe=0;re.length>oe;)g(re[oe++]);s(s.S+s.F*!q,"Symbol",{for:function(e){return o(j,e+="")?j[e]:j[e]=M(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){G=!0},useSimple:function(){G=!1}}),s(s.S+s.F*!q,"Object",{create:function(e,t){return void 0===t?C(e):Q(C(e),t)},defineProperty:K,defineProperties:Q,getOwnPropertyDescriptor:$,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var ae=d(function(){I.f(1)});s(s.S+s.F*ae,"Object",{getOwnPropertySymbols:function(e){return I.f(_(e))}}),W&&s(s.S+s.F*(!q||d(function(){var e=M();return"[null]"!=N([e])||"{}"!=N({a:e})||"{}"!=N(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=t=i[1],(w(t)||void 0!==e)&&!X(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!X(t))return t}),i[1]=t,N.apply(W,i)}}),M.prototype[F]||n(10)(M.prototype,F,M.prototype.valueOf),h(M,"Symbol"),h(Math,"Math",!0),h(r.JSON,"JSON",!0)},function(e,t,n){"use strict";t.f=n(33)},function(e,t,n){"use strict";var i=n(8),r=n(9),o=n(25),a=n(129),s=n(11).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){"use strict";var i=n(55),r=n(73),o=n(74);e.exports=function(e){var t=i(e),n=r.f;if(n)for(var a,s=n(e),l=o.f,c=0;s.length>c;)l.call(e,a=s[c++])&&t.push(a);return t}},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=n(43),o=n(133).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":i(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return s.slice()}}(e):o(r(e))}},function(e,t,n){"use strict";var i=n(56),r=n(58).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t,n){"use strict";n(135),e.exports=n(9).String.padStart},function(e,t,n){"use strict";var i=n(7),r=n(136),o=n(96),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*a,"String",{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){"use strict";var i=n(28),r=n(137),o=n(34);e.exports=function(e,t,n,a){var s=String(o(e)),l=s.length,c=void 0===n?" ":String(n),d=i(t);if(d<=l||""==c)return s;var u=d-l,h=r.call(c,Math.ceil(u/c.length));return h.length>u&&(h=h.slice(0,u)),a?h+s:s+h}},function(e,t,n){"use strict";var i=n(29),r=n(34);e.exports=function(e){var t=String(r(this)),n="",o=i(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t,n){"use strict";n(139),e.exports=n(9).String.padEnd},function(e,t,n){"use strict";var i=n(7),r=n(136),o=n(96),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);i(i.P+i.F*a,"String",{padEnd:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){"use strict";n(141),e.exports=n(9).Object.values},function(e,t,n){"use strict";var i=n(7),r=n(142)(!1);i(i.S,"Object",{values:function(e){return r(e)}})},function(e,t,n){"use strict";var i=n(15),r=n(55),o=n(43),a=n(74).f;e.exports=function(e){return function(t){for(var n,s=o(t),l=r(s),c=l.length,d=0,u=[];c>d;)n=l[d++],i&&!a.call(s,n)||u.push(e?[n,s[n]]:s[n]);return u}}},function(e,t,n){"use strict";var i=!1;if("undefined"!=typeof ReadableStream)try{new ReadableStream({start:function(e){e.close()}}),i=!0}catch(e){}t.ReadableStream=i?ReadableStream:n(144).ReadableStream},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){for(var n in t)e[n]=t[n]}(t,function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){var r="function"==typeof Symbol&&"symbol"===i(Symbol.iterator)?function(e){return i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":i(e)},o=n(1).assert;function a(e){return"string"==typeof e||"symbol"===(void 0===e?"undefined":r(e))}function s(e,t,n){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}t.typeIsObject=function(e){return"object"===(void 0===e?"undefined":r(e))&&null!==e||"function"==typeof e},t.createDataProperty=function(e,n,i){o(t.typeIsObject(e)),Object.defineProperty(e,n,{value:i,writable:!0,enumerable:!0,configurable:!0})},t.createArrayFromList=function(e){return e.slice()},t.ArrayBufferCopy=function(e,t,n,i,r){new Uint8Array(e).set(new Uint8Array(n,i,r),t)},t.CreateIterResultObject=function(e,t){o("boolean"==typeof t);var n={};return Object.defineProperty(n,"value",{value:e,enumerable:!0,writable:!0,configurable:!0}),Object.defineProperty(n,"done",{value:t,enumerable:!0,writable:!0,configurable:!0}),n},t.IsFiniteNonNegativeNumber=function(e){return!Number.isNaN(e)&&(e!==1/0&&!(e<0))},t.InvokeOrNoop=function(e,t,n){o(void 0!==e),o(a(t)),o(Array.isArray(n));var i=e[t];if(void 0!==i)return s(i,e,n)},t.PromiseInvokeOrNoop=function(e,n,i){o(void 0!==e),o(a(n)),o(Array.isArray(i));try{return Promise.resolve(t.InvokeOrNoop(e,n,i))}catch(e){return Promise.reject(e)}},t.PromiseInvokeOrPerformFallback=function(e,t,n,i,r){o(void 0!==e),o(a(t)),o(Array.isArray(n)),o(Array.isArray(r));var l=void 0;try{l=e[t]}catch(e){return Promise.reject(e)}if(void 0===l)return i.apply(null,r);try{return Promise.resolve(s(l,e,n))}catch(e){return Promise.reject(e)}},t.TransferArrayBuffer=function(e){return e.slice()},t.ValidateAndNormalizeHighWaterMark=function(e){if(e=Number(e),Number.isNaN(e)||e<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return e},t.ValidateAndNormalizeQueuingStrategy=function(e,n){if(void 0!==e&&"function"!=typeof e)throw new TypeError("size property of a queuing strategy must be a function");return{size:e,highWaterMark:n=t.ValidateAndNormalizeHighWaterMark(n)}}},function(e,t,n){function i(e){this.name="AssertionError",this.message=e||"",this.stack=(new Error).stack}i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,e.exports={rethrowAssertionErrorRejection:function(e){e&&e.constructor===i&&setTimeout(function(){throw e},0)},AssertionError:i,assert:function(e,t){if(!e)throw new i(t)}}},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(0),a=o.InvokeOrNoop,s=o.PromiseInvokeOrNoop,l=o.ValidateAndNormalizeQueuingStrategy,c=o.typeIsObject,d=n(1),u=d.assert,h=d.rethrowAssertionErrorRejection,p=n(3),f=p.DequeueValue,m=p.EnqueueValueWithSize,g=p.PeekQueueValue,v=p.ResetQueue,y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size,o=n.highWaterMark,a=void 0===o?1:o;if(r(this,e),this._state="writable",this._storedError=void 0,this._writer=void 0,this._writableStreamController=void 0,this._writeRequests=[],this._inFlightWriteRequest=void 0,this._closeRequest=void 0,this._inFlightCloseRequest=void 0,this._pendingAbortRequest=void 0,this._backpressure=!1,void 0!==t.type)throw new RangeError("Invalid type is specified");this._writableStreamController=new F(this,t,i,a),this._writableStreamController.__startSteps()}return i(e,[{key:"abort",value:function(e){return!1===w(this)?Promise.reject(q("abort")):!0===_(this)?Promise.reject(new TypeError("Cannot abort a stream that already has a writer")):S(this,e)}},{key:"getWriter",value:function(){if(!1===w(this))throw q("getWriter");return b(this)}},{key:"locked",get:function(){if(!1===w(this))throw q("locked");return _(this)}}]),e}();function b(e){return new R(e)}function w(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function _(e){return u(!0===w(e),"IsWritableStreamLocked should only be used on known writable streams"),void 0!==e._writer}function S(e,t){var n=e._state;if("closed"===n)return Promise.resolve(void 0);if("errored"===n)return Promise.reject(e._storedError);var i=new TypeError("Requested to abort");if(void 0!==e._pendingAbortRequest)return Promise.reject(i);u("writable"===n||"erroring"===n,"state must be writable or erroring");var r=!1;"erroring"===n&&(r=!0,t=void 0);var o=new Promise(function(n,i){e._pendingAbortRequest={_resolve:n,_reject:i,_reason:t,_wasAlreadyErroring:r}});return!1===r&&P(e,i),o}function k(e,t){var n=e._state;"writable"!==n?(u("erroring"===n),C(e)):P(e,t)}function P(e,t){u(void 0===e._storedError,"stream._storedError === undefined"),u("writable"===e._state,"state must be writable");var n=e._writableStreamController;u(void 0!==n,"controller must not be undefined"),e._state="erroring",e._storedError=t;var i=e._writer;void 0!==i&&W(i,t),!1===I(e)&&!0===n._started&&C(e)}function C(e){u("erroring"===e._state,"stream._state === erroring"),u(!1===I(e),"WritableStreamHasOperationMarkedInFlight(stream) === false"),e._state="errored",e._writableStreamController.__errorSteps();for(var t=e._storedError,n=0;n<e._writeRequests.length;n++){e._writeRequests[n]._reject(t)}if(e._writeRequests=[],void 0!==e._pendingAbortRequest){var i=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,!0===i._wasAlreadyErroring)return i._reject(t),void E(e);e._writableStreamController.__abortSteps(i._reason).then(function(){i._resolve(),E(e)},function(t){i._reject(t),E(e)})}else E(e)}function T(e){u(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0;var t=e._state;u("writable"===t||"erroring"===t),"erroring"===t&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var n=e._writer;void 0!==n&&function(e){u(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(n),u(void 0===e._pendingAbortRequest,"stream._pendingAbortRequest === undefined"),u(void 0===e._storedError,"stream._storedError === undefined")}function A(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function I(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function E(e){u("errored"===e._state,'_stream_.[[state]] is `"errored"`'),void 0!==e._closeRequest&&(u(void 0===e._inFlightCloseRequest),e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var t=e._writer;void 0!==t&&(J(t,e._storedError),t._closedPromise.catch(function(){}))}function x(e,t){u("writable"===e._state),u(!1===A(e));var n=e._writer;void 0!==n&&t!==e._backpressure&&(!0===t?function(e){u(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=new Promise(function(t,n){e._readyPromise_resolve=t,e._readyPromise_reject=n}),e._readyPromiseState="pending"}(n):(u(!1===t),Q(n))),e._backpressure=t}e.exports={AcquireWritableStreamDefaultWriter:b,IsWritableStream:w,IsWritableStreamLocked:_,WritableStream:y,WritableStreamAbort:S,WritableStreamDefaultControllerError:z,WritableStreamDefaultWriterCloseWithErrorPropagation:function(e){var t=e._ownerWritableStream;u(void 0!==t);var n=t._state;if(!0===A(t)||"closed"===n)return Promise.resolve();if("errored"===n)return Promise.reject(t._storedError);return u("writable"===n||"erroring"===n),L(e)},WritableStreamDefaultWriterRelease:N,WritableStreamDefaultWriterWrite:O,WritableStreamCloseQueuedOrInFlight:A};var R=function(){function e(t){if(r(this,e),!1===w(t))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===_(t))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=t,t._writer=this;var n,i=t._state;if("writable"===i)!1===A(t)&&!0===t._backpressure?((n=this)._readyPromise=new Promise(function(e,t){n._readyPromise_resolve=e,n._readyPromise_reject=t}),n._readyPromiseState="pending"):K(this),Y(this);else if("erroring"===i)X(this,t._storedError),this._readyPromise.catch(function(){}),Y(this);else if("closed"===i)K(this),function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}(this);else{u("errored"===i,"state must be errored");var o=t._storedError;X(this,o),this._readyPromise.catch(function(){}),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}(this,o),this._closedPromise.catch(function(){})}}return i(e,[{key:"abort",value:function(e){return!1===D(this)?Promise.reject(H("abort")):void 0===this._ownerWritableStream?Promise.reject(G("abort")):function(e,t){var n=e._ownerWritableStream;return u(void 0!==n),S(n,t)}(this,e)}},{key:"close",value:function(){if(!1===D(this))return Promise.reject(H("close"));var e=this._ownerWritableStream;return void 0===e?Promise.reject(G("close")):!0===A(e)?Promise.reject(new TypeError("cannot close an already-closing stream")):L(this)}},{key:"releaseLock",value:function(){if(!1===D(this))throw H("releaseLock");var e=this._ownerWritableStream;void 0!==e&&(u(void 0!==e._writer),N(this))}},{key:"write",value:function(e){return!1===D(this)?Promise.reject(H("write")):void 0===this._ownerWritableStream?Promise.reject(G("write to")):O(this,e)}},{key:"closed",get:function(){return!1===D(this)?Promise.reject(H("closed")):this._closedPromise}},{key:"desiredSize",get:function(){if(!1===D(this))throw H("desiredSize");if(void 0===this._ownerWritableStream)throw G("desiredSize");return function(e){var t=e._ownerWritableStream,n=t._state;if("errored"===n||"erroring"===n)return null;if("closed"===n)return 0;return B(t._writableStreamController)}(this)}},{key:"ready",get:function(){return!1===D(this)?Promise.reject(H("ready")):this._readyPromise}}]),e}();function D(e){return!!c(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function L(e){var t=e._ownerWritableStream;u(void 0!==t);var n=t._state;if("closed"===n||"errored"===n)return Promise.reject(new TypeError("The stream (in "+n+" state) is not in the writable state and cannot be closed"));u("writable"===n||"erroring"===n),u(!1===A(t));var i,r=new Promise(function(e,n){var i={_resolve:e,_reject:n};t._closeRequest=i});return!0===t._backpressure&&"writable"===n&&Q(e),i=t._writableStreamController,m(i,"close",0),j(i),r}function M(e,t){"pending"===e._closedPromiseState?J(e,t):function(e,t){u(void 0===e._closedPromise_resolve,"writer._closedPromise_resolve === undefined"),u(void 0===e._closedPromise_reject,"writer._closedPromise_reject === undefined"),u("pending"!==e._closedPromiseState,"writer._closedPromiseState is not pending"),e._closedPromise=Promise.reject(t),e._closedPromiseState="rejected"}(e,t),e._closedPromise.catch(function(){})}function W(e,t){"pending"===e._readyPromiseState?function(e,t){u(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}(e,t):function(e,t){u(void 0===e._readyPromise_resolve,"writer._readyPromise_resolve === undefined"),u(void 0===e._readyPromise_reject,"writer._readyPromise_reject === undefined"),e._readyPromise=Promise.reject(t),e._readyPromiseState="rejected"}(e,t),e._readyPromise.catch(function(){})}function N(e){var t=e._ownerWritableStream;u(void 0!==t),u(t._writer===e);var n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");W(e,n),M(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function O(e,t){var n=e._ownerWritableStream;u(void 0!==n);var i=n._writableStreamController,r=function(e,t){var n=e._strategySize;if(void 0===n)return 1;try{return n(t)}catch(t){return V(e,t),1}}(i,t);if(n!==e._ownerWritableStream)return Promise.reject(G("write to"));var o=n._state;if("errored"===o)return Promise.reject(n._storedError);if(!0===A(n)||"closed"===o)return Promise.reject(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return Promise.reject(n._storedError);u("writable"===o);var a=function(e){return u(!0===_(e)),u("writable"===e._state),new Promise(function(t,n){var i={_resolve:t,_reject:n};e._writeRequests.push(i)})}(n);return function(e,t,n){var i={chunk:t};try{m(e,i,n)}catch(t){return void V(e,t)}var r=e._controlledWritableStream;if(!1===A(r)&&"writable"===r._state){var o=U(e);x(r,o)}j(e)}(i,t,r),a}var F=function(){function e(t,n,i,o){if(r(this,e),!1===w(t))throw new TypeError("WritableStreamDefaultController can only be constructed with a WritableStream instance");if(void 0!==t._writableStreamController)throw new TypeError("WritableStreamDefaultController instances can only be created by the WritableStream constructor");this._controlledWritableStream=t,this._underlyingSink=n,this._queue=void 0,this._queueTotalSize=void 0,v(this),this._started=!1;var a=l(i,o);this._strategySize=a.size,this._strategyHWM=a.highWaterMark,x(t,U(this))}return i(e,[{key:"error",value:function(e){if(!1===function(e){if(!c(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_underlyingSink"))return!1;return!0}(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");"writable"===this._controlledWritableStream._state&&z(this,e)}},{key:"__abortSteps",value:function(e){return s(this._underlyingSink,"abort",[e])}},{key:"__errorSteps",value:function(){v(this)}},{key:"__startSteps",value:function(){var e=this,t=a(this._underlyingSink,"start",[this]),n=this._controlledWritableStream;Promise.resolve(t).then(function(){u("writable"===n._state||"erroring"===n._state),e._started=!0,j(e)},function(t){u("writable"===n._state||"erroring"===n._state),e._started=!0,k(n,t)}).catch(h)}}]),e}();function B(e){return e._strategyHWM-e._queueTotalSize}function j(e){var t=e._controlledWritableStream;if(!1!==e._started&&void 0===t._inFlightWriteRequest){var n=t._state;if("closed"!==n&&"errored"!==n)if("erroring"!==n){if(0!==e._queue.length){var i=g(e);"close"===i?function(e){var t=e._controlledWritableStream;(function(e){u(void 0===e._inFlightCloseRequest),u(void 0!==e._closeRequest),e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),f(e),u(0===e._queue.length,"queue must be empty once the final write record is dequeued"),s(e._underlyingSink,"close",[]).then(function(){T(t)},function(e){!function(e,t){u(void 0!==e._inFlightCloseRequest),e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,u("writable"===e._state||"erroring"===e._state),void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),k(e,t)}(t,e)}).catch(h)}(e):function(e,t){var n=e._controlledWritableStream;(function(e){u(void 0===e._inFlightWriteRequest,"there must be no pending write request"),u(0!==e._writeRequests.length,"writeRequests must not be empty"),e._inFlightWriteRequest=e._writeRequests.shift()})(n),s(e._underlyingSink,"write",[t,e]).then(function(){!function(e){u(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(n);var t=n._state;if(u("writable"===t||"erroring"===t),f(e),!1===A(n)&&"writable"===t){var i=U(e);x(n,i)}j(e)},function(e){!function(e,t){u(void 0!==e._inFlightWriteRequest),e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,u("writable"===e._state||"erroring"===e._state),k(e,t)}(n,e)}).catch(h)}(e,i.chunk)}}else C(t)}}function V(e,t){"writable"===e._controlledWritableStream._state&&z(e,t)}function U(e){return B(e)<=0}function z(e,t){var n=e._controlledWritableStream;u("writable"===n._state),P(n,t)}function q(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function H(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function G(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Y(e){e._closedPromise=new Promise(function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"})}function J(e,t){u(void 0!==e._closedPromise_resolve,"writer._closedPromise_resolve !== undefined"),u(void 0!==e._closedPromise_reject,"writer._closedPromise_reject !== undefined"),u("pending"===e._closedPromiseState,"writer._closedPromiseState is pending"),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function X(e,t){e._readyPromise=Promise.reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function K(e){e._readyPromise=Promise.resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function Q(e){u(void 0!==e._readyPromise_resolve,"writer._readyPromise_resolve !== undefined"),u(void 0!==e._readyPromise_reject,"writer._readyPromise_reject !== undefined"),e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}},function(e,t,n){var i=n(0).IsFiniteNonNegativeNumber,r=n(1).assert;t.DequeueValue=function(e){r("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: DequeueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),r(e._queue.length>0,"Spec-level failure: should never dequeue from an empty queue.");var t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value},t.EnqueueValueWithSize=function(e,t,n){if(r("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: EnqueueValueWithSize should only be used on containers with [[queue]] and [[queueTotalSize]]."),n=Number(n),!i(n))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n},t.PeekQueueValue=function(e){return r("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: PeekQueueValue should only be used on containers with [[queue]] and [[queueTotalSize]]."),r(e._queue.length>0,"Spec-level failure: should never peek at an empty queue."),e._queue[0].value},t.ResetQueue=function(e){r("_queue"in e&&"_queueTotalSize"in e,"Spec-level failure: ResetQueue should only be used on containers with [[queue]] and [[queueTotalSize]]."),e._queue=[],e._queueTotalSize=0}},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(0),a=o.ArrayBufferCopy,s=o.CreateIterResultObject,l=o.IsFiniteNonNegativeNumber,c=o.InvokeOrNoop,d=o.PromiseInvokeOrNoop,u=o.TransferArrayBuffer,h=o.ValidateAndNormalizeQueuingStrategy,p=o.ValidateAndNormalizeHighWaterMark,f=n(0),m=f.createArrayFromList,g=f.createDataProperty,v=f.typeIsObject,y=n(1),b=y.assert,w=y.rethrowAssertionErrorRejection,_=n(3),S=_.DequeueValue,k=_.EnqueueValueWithSize,P=_.ResetQueue,C=n(2),T=C.AcquireWritableStreamDefaultWriter,A=C.IsWritableStream,I=C.IsWritableStreamLocked,E=C.WritableStreamAbort,x=C.WritableStreamDefaultWriterCloseWithErrorPropagation,R=C.WritableStreamDefaultWriterRelease,D=C.WritableStreamDefaultWriterWrite,L=C.WritableStreamCloseQueuedOrInFlight,M=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.size,o=n.highWaterMark;r(this,e),this._state="readable",this._reader=void 0,this._storedError=void 0,this._disturbed=!1,this._readableStreamController=void 0;var a=t.type;if("bytes"===String(a))void 0===o&&(o=0),this._readableStreamController=new he(this,t,o);else{if(void 0!==a)throw new RangeError("Invalid type is specified");void 0===o&&(o=1),this._readableStreamController=new ie(this,t,i,o)}}return i(e,[{key:"cancel",value:function(e){return!1===N(this)?Promise.reject(Ee("cancel")):!0===O(this)?Promise.reject(new TypeError("Cannot cancel a stream that already has a reader")):V(this,e)}},{key:"getReader",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).mode;if(!1===N(this))throw Ee("getReader");if(void 0===e)return W(this);if("byob"===(e=String(e)))return new K(this);throw new RangeError("Invalid mode is specified")}},{key:"pipeThrough",value:function(e,t){var n=e.writable,i=e.readable;return function(e){try{Promise.prototype.then.call(e,void 0,function(){})}catch(e){}}(this.pipeTo(n,t)),i}},{key:"pipeTo",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.preventClose,r=n.preventAbort,o=n.preventCancel;if(!1===N(this))return Promise.reject(Ee("pipeTo"));if(!1===A(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));if(i=Boolean(i),r=Boolean(r),o=Boolean(o),!0===O(this))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream"));if(!0===I(e))return Promise.reject(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream"));var a=W(this),s=T(e),l=!1,c=Promise.resolve();return new Promise(function(n,d){var u,h,p;if(g(t,a._closedPromise,function(t){!1===r?v(function(){return E(e,t)},!0,t):y(!0,t)}),g(e,s._closedPromise,function(e){!1===o?v(function(){return V(t,e)},!0,e):y(!0,e)}),u=t,h=a._closedPromise,p=function(){!1===i?v(function(){return x(s)}):y()},"closed"===u._state?p():h.then(p).catch(w),!0===L(e)||"closed"===e._state){var f=new TypeError("the destination writable stream closed before all data could be piped to it");!1===o?v(function(){return V(t,f)},!0,f):y(!0,f)}function m(){var e=c;return c.then(function(){return e!==c?m():void 0})}function g(e,t,n){"errored"===e._state?n(e._storedError):t.catch(n).catch(w)}function v(t,n,i){function r(){t().then(function(){return b(n,i)},function(e){return b(!0,e)}).catch(w)}!0!==l&&(l=!0,"writable"===e._state&&!1===L(e)?m().then(r):r())}function y(t,n){!0!==l&&(l=!0,"writable"===e._state&&!1===L(e)?m().then(function(){return b(t,n)}).catch(w):b(t,n))}function b(e,t){R(s),te(a),e?d(t):n(void 0)}(function e(){return c=Promise.resolve(),!0===l?Promise.resolve():s._readyPromise.then(function(){return ne(a).then(function(e){var t=e.value;!0!==e.done&&(c=D(s,t).catch(function(){}))})}).then(e)})().catch(function(e){c=Promise.resolve(),w(e)})})}},{key:"tee",value:function(){if(!1===N(this))throw Ee("tee");var e=F(this,!1);return m(e)}},{key:"locked",get:function(){if(!1===N(this))throw Ee("locked");return O(this)}}]),e}();function W(e){return new X(e)}function N(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function O(e){return b(!0===N(e),"IsReadableStreamLocked should only be used on known readable streams"),void 0!==e._reader}function F(e,t){b(!0===N(e)),b("boolean"==typeof t);var n=W(e),i={closedOrErrored:!1,canceled1:!1,canceled2:!1,reason1:void 0,reason2:void 0};i.promise=new Promise(function(e){i._resolve=e});var r=function(){return function e(){var t=e._reader,n=e._branch1,i=e._branch2,r=e._teeState;return ne(t).then(function(e){b(v(e));var t=e.value,o=e.done;if(b("boolean"==typeof o),!0===o&&!1===r.closedOrErrored&&(!1===r.canceled1&&ae(n),!1===r.canceled2&&ae(i),r.closedOrErrored=!0),!0!==r.closedOrErrored){var a=t,s=t;!1===r.canceled1&&se(n,a),!1===r.canceled2&&se(i,s)}})}}();r._reader=n,r._teeState=i,r._cloneForBranch2=t;var o=function(){return function e(t){var n=e._stream,i=e._teeState;i.canceled1=!0;i.reason1=t;if(!0===i.canceled2){var r=m([i.reason1,i.reason2]),o=V(n,r);i._resolve(o)}return i.promise}}();o._stream=e,o._teeState=i;var a=function(){return function e(t){var n=e._stream,i=e._teeState;i.canceled2=!0;i.reason2=t;if(!0===i.canceled1){var r=m([i.reason1,i.reason2]),o=V(n,r);i._resolve(o)}return i.promise}}();a._stream=e,a._teeState=i;var s=Object.create(Object.prototype);g(s,"pull",r),g(s,"cancel",o);var l=new M(s),c=Object.create(Object.prototype);g(c,"pull",r),g(c,"cancel",a);var d=new M(c);return r._branch1=l._readableStreamController,r._branch2=d._readableStreamController,n._closedPromise.catch(function(e){!0!==i.closedOrErrored&&(le(r._branch1,e),le(r._branch2,e),i.closedOrErrored=!0)}),[l,d]}function B(e){return b(!0===Q(e._reader)),b("readable"===e._state||"closed"===e._state),new Promise(function(t,n){var i={_resolve:t,_reject:n};e._reader._readIntoRequests.push(i)})}function j(e){return b(!0===Z(e._reader)),b("readable"===e._state),new Promise(function(t,n){var i={_resolve:t,_reject:n};e._reader._readRequests.push(i)})}function V(e,t){return e._disturbed=!0,"closed"===e._state?Promise.resolve(void 0):"errored"===e._state?Promise.reject(e._storedError):(U(e),e._readableStreamController.__cancelSteps(t).then(function(){}))}function U(e){b("readable"===e._state),e._state="closed";var t=e._reader;if(void 0!==t){if(!0===Z(t)){for(var n=0;n<t._readRequests.length;n++){(0,t._readRequests[n]._resolve)(s(void 0,!0))}t._readRequests=[]}!function(e){b(void 0!==e._closedPromise_resolve),b(void 0!==e._closedPromise_reject),e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(t)}}function z(e,t){b(!0===N(e),"stream must be ReadableStream"),b("readable"===e._state,"state must be readable"),e._state="errored",e._storedError=t;var n=e._reader;if(void 0!==n){if(!0===Z(n)){for(var i=0;i<n._readRequests.length;i++){n._readRequests[i]._reject(t)}n._readRequests=[]}else{b(Q(n),"reader must be ReadableStreamBYOBReader");for(var r=0;r<n._readIntoRequests.length;r++){n._readIntoRequests[r]._reject(t)}n._readIntoRequests=[]}De(n,t),n._closedPromise.catch(function(){})}}function q(e,t,n){var i=e._reader;b(i._readRequests.length>0),i._readRequests.shift()._resolve(s(t,n))}function H(e){return e._reader._readIntoRequests.length}function G(e){return e._reader._readRequests.length}function Y(e){var t=e._reader;return void 0!==t&&!1!==Q(t)}function J(e){var t=e._reader;return void 0!==t&&!1!==Z(t)}e.exports={ReadableStream:M,IsReadableStreamDisturbed:function(e){return b(!0===N(e),"IsReadableStreamDisturbed should only be used on known readable streams"),e._disturbed},ReadableStreamDefaultControllerClose:ae,ReadableStreamDefaultControllerEnqueue:se,ReadableStreamDefaultControllerError:le,ReadableStreamDefaultControllerGetDesiredSize:de};var X=function(){function e(t){if(r(this,e),!1===N(t))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===O(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");$(this,t),this._readRequests=[]}return i(e,[{key:"cancel",value:function(e){return!1===Z(this)?Promise.reject(Re("cancel")):void 0===this._ownerReadableStream?Promise.reject(xe("cancel")):ee(this,e)}},{key:"read",value:function(){return!1===Z(this)?Promise.reject(Re("read")):void 0===this._ownerReadableStream?Promise.reject(xe("read from")):ne(this)}},{key:"releaseLock",value:function(){if(!1===Z(this))throw Re("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");te(this)}}},{key:"closed",get:function(){return!1===Z(this)?Promise.reject(Re("closed")):this._closedPromise}}]),e}(),K=function(){function e(t){if(r(this,e),!N(t))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===pe(t._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(O(t))throw new TypeError("This stream has already been locked for exclusive reading by another reader");$(this,t),this._readIntoRequests=[]}return i(e,[{key:"cancel",value:function(e){return Q(this)?void 0===this._ownerReadableStream?Promise.reject(xe("cancel")):ee(this,e):Promise.reject(Le("cancel"))}},{key:"read",value:function(e){return Q(this)?void 0===this._ownerReadableStream?Promise.reject(xe("read from")):ArrayBuffer.isView(e)?0===e.byteLength?Promise.reject(new TypeError("view must have non-zero byteLength")):function(e,t){var n=e._ownerReadableStream;if(b(void 0!==n),n._disturbed=!0,"errored"===n._state)return Promise.reject(n._storedError);return function(e,t){var n=e._controlledReadableStream,i=1;t.constructor!==DataView&&(i=t.constructor.BYTES_PER_ELEMENT);var r=t.constructor,o={buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:i,ctor:r,readerType:"byob"};if(e._pendingPullIntos.length>0)return o.buffer=u(o.buffer),e._pendingPullIntos.push(o),B(n);if("closed"===n._state){var a=new t.constructor(o.buffer,o.byteOffset,0);return Promise.resolve(s(a,!0))}if(e._queueTotalSize>0){if(!0===we(e,o)){var l=ye(o);return Se(e),Promise.resolve(s(l,!1))}if(!0===e._closeRequested){var c=new TypeError("Insufficient bytes to fill elements in the given buffer");return Ae(e,c),Promise.reject(c)}}o.buffer=u(o.buffer),e._pendingPullIntos.push(o);var d=B(n);return me(e),d}(n._readableStreamController,t)}(this,e):Promise.reject(new TypeError("view must be an array buffer view")):Promise.reject(Le("read"))}},{key:"releaseLock",value:function(){if(!Q(this))throw Le("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");te(this)}}},{key:"closed",get:function(){return Q(this)?this._closedPromise:Promise.reject(Le("closed"))}}]),e}();function Q(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function Z(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function $(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?function(e){e._closedPromise=new Promise(function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n})}(e):"closed"===t._state?function(e){e._closedPromise=Promise.resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e):(b("errored"===t._state,"state must be errored"),function(e,t){e._closedPromise=Promise.reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}(e,t._storedError),e._closedPromise.catch(function(){}))}function ee(e,t){var n=e._ownerReadableStream;return b(void 0!==n),V(n,t)}function te(e){b(void 0!==e._ownerReadableStream),b(e._ownerReadableStream._reader===e),"readable"===e._ownerReadableStream._state?De(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){b(void 0===e._closedPromise_resolve),b(void 0===e._closedPromise_reject),e._closedPromise=Promise.reject(t)}(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._closedPromise.catch(function(){}),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function ne(e){var t=e._ownerReadableStream;return b(void 0!==t),t._disturbed=!0,"closed"===t._state?Promise.resolve(s(void 0,!0)):"errored"===t._state?Promise.reject(t._storedError):(b("readable"===t._state),t._readableStreamController.__pullSteps())}var ie=function(){function e(t,n,i,o){if(r(this,e),!1===N(t))throw new TypeError("ReadableStreamDefaultController can only be constructed with a ReadableStream instance");if(void 0!==t._readableStreamController)throw new TypeError("ReadableStreamDefaultController instances can only be created by the ReadableStream constructor");this._controlledReadableStream=t,this._underlyingSource=n,this._queue=void 0,this._queueTotalSize=void 0,P(this),this._started=!1,this._closeRequested=!1,this._pullAgain=!1,this._pulling=!1;var a=h(i,o);this._strategySize=a.size,this._strategyHWM=a.highWaterMark;var s=this,l=c(n,"start",[this]);Promise.resolve(l).then(function(){s._started=!0,b(!1===s._pulling),b(!1===s._pullAgain),oe(s)},function(e){ce(s,e)}).catch(w)}return i(e,[{key:"close",value:function(){if(!1===re(this))throw Me("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");ae(this)}},{key:"enqueue",value:function(e){if(!1===re(this))throw Me("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");return se(this,e)}},{key:"error",value:function(e){if(!1===re(this))throw Me("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");le(this,e)}},{key:"__cancelSteps",value:function(e){return P(this),d(this._underlyingSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(this._queue.length>0){var t=S(this);return!0===this._closeRequested&&0===this._queue.length?U(e):oe(this),Promise.resolve(s(t,!1))}var n=j(e);return oe(this),n}},{key:"desiredSize",get:function(){if(!1===re(this))throw Me("desiredSize");return de(this)}}]),e}();function re(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingSource")}function oe(e){!1!==function(e){var t=e._controlledReadableStream;if("closed"===t._state||"errored"===t._state)return!1;if(!0===e._closeRequested)return!1;if(!1===e._started)return!1;if(!0===O(t)&&G(t)>0)return!0;if(de(e)>0)return!0;return!1}(e)&&(!0!==e._pulling?(b(!1===e._pullAgain),e._pulling=!0,d(e._underlyingSource,"pull",[e]).then(function(){if(e._pulling=!1,!0===e._pullAgain)return e._pullAgain=!1,oe(e)},function(t){ce(e,t)}).catch(w)):e._pullAgain=!0)}function ae(e){var t=e._controlledReadableStream;b(!1===e._closeRequested),b("readable"===t._state),e._closeRequested=!0,0===e._queue.length&&U(t)}function se(e,t){var n=e._controlledReadableStream;if(b(!1===e._closeRequested),b("readable"===n._state),!0===O(n)&&G(n)>0)q(n,t,!1);else{var i=1;if(void 0!==e._strategySize){var r=e._strategySize;try{i=r(t)}catch(t){throw ce(e,t),t}}try{k(e,t,i)}catch(t){throw ce(e,t),t}}oe(e)}function le(e,t){var n=e._controlledReadableStream;b("readable"===n._state),P(e),z(n,t)}function ce(e,t){"readable"===e._controlledReadableStream._state&&le(e,t)}function de(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}var ue=function(){function e(t,n){r(this,e),this._associatedReadableByteStreamController=t,this._view=n}return i(e,[{key:"respond",value:function(e){if(!1===fe(this))throw We("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");!function(e,t){if(t=Number(t),!1===l(t))throw new RangeError("bytesWritten must be a finite");b(e._pendingPullIntos.length>0),Ce(e,t)}(this._associatedReadableByteStreamController,e)}},{key:"respondWithNewView",value:function(e){if(!1===fe(this))throw We("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");!function(e,t){b(e._pendingPullIntos.length>0);var n=e._pendingPullIntos[0];if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=t.buffer,Ce(e,t.byteLength)}(this._associatedReadableByteStreamController,e)}},{key:"view",get:function(){return this._view}}]),e}(),he=function(){function e(t,n,i){if(r(this,e),!1===N(t))throw new TypeError("ReadableByteStreamController can only be constructed with a ReadableStream instance given a byte source");if(void 0!==t._readableStreamController)throw new TypeError("ReadableByteStreamController instances can only be created by the ReadableStream constructor given a byte source");this._controlledReadableStream=t,this._underlyingByteSource=n,this._pullAgain=!1,this._pulling=!1,ge(this),this._queue=this._queueTotalSize=void 0,P(this),this._closeRequested=!1,this._started=!1,this._strategyHWM=p(i);var o=n.autoAllocateChunkSize;if(void 0!==o&&(!1===Number.isInteger(o)||o<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");this._autoAllocateChunkSize=o,this._pendingPullIntos=[];var a=this,s=c(n,"start",[this]);Promise.resolve(s).then(function(){a._started=!0,b(!1===a._pulling),b(!1===a._pullAgain),me(a)},function(e){"readable"===t._state&&Ae(a,e)}).catch(w)}return i(e,[{key:"close",value:function(){if(!1===pe(this))throw Ne("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");!function(e){var t=e._controlledReadableStream;if(b(!1===e._closeRequested),b("readable"===t._state),e._queueTotalSize>0)return void(e._closeRequested=!0);if(e._pendingPullIntos.length>0){var n=e._pendingPullIntos[0];if(n.bytesFilled>0){var i=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Ae(e,i),i}}U(t)}(this)}},{key:"enqueue",value:function(e){if(!1===pe(this))throw Ne("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(e))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");!function(e,t){var n=e._controlledReadableStream;b(!1===e._closeRequested),b("readable"===n._state);var i=t.buffer,r=t.byteOffset,o=t.byteLength,a=u(i);if(!0===J(n))if(0===G(n))be(e,a,r,o);else{b(0===e._queue.length);var s=new Uint8Array(a,r,o);q(n,s,!1)}else!0===Y(n)?(be(e,a,r,o),Pe(e)):(b(!1===O(n),"stream must not be locked"),be(e,a,r,o))}(this,e)}},{key:"error",value:function(e){if(!1===pe(this))throw Ne("error");var t=this._controlledReadableStream;if("readable"!==t._state)throw new TypeError("The stream is "+t._state+" and so cannot be errored");Ae(this,e)}},{key:"__cancelSteps",value:function(e){this._pendingPullIntos.length>0&&(this._pendingPullIntos[0].bytesFilled=0);return P(this),d(this._underlyingByteSource,"cancel",[e])}},{key:"__pullSteps",value:function(){var e=this._controlledReadableStream;if(b(!0===J(e)),this._queueTotalSize>0){b(0===G(e));var t=this._queue.shift();this._queueTotalSize-=t.byteLength,Se(this);var n=void 0;try{n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}catch(e){return Promise.reject(e)}return Promise.resolve(s(n,!1))}var i=this._autoAllocateChunkSize;if(void 0!==i){var r=void 0;try{r=new ArrayBuffer(i)}catch(e){return Promise.reject(e)}var o={buffer:r,byteOffset:0,byteLength:i,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}var a=j(e);return me(this),a}},{key:"byobRequest",get:function(){if(!1===pe(this))throw Ne("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){var e=this._pendingPullIntos[0],t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled);this._byobRequest=new ue(this,t)}return this._byobRequest}},{key:"desiredSize",get:function(){if(!1===pe(this))throw Ne("desiredSize");return Ie(this)}}]),e}();function pe(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_underlyingByteSource")}function fe(e){return!!v(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function me(e){!1!==function(e){var t=e._controlledReadableStream;if("readable"!==t._state)return!1;if(!0===e._closeRequested)return!1;if(!1===e._started)return!1;if(!0===J(t)&&G(t)>0)return!0;if(!0===Y(t)&&H(t)>0)return!0;if(Ie(e)>0)return!0;return!1}(e)&&(!0!==e._pulling?(b(!1===e._pullAgain),e._pulling=!0,d(e._underlyingByteSource,"pull",[e]).then(function(){e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,me(e))},function(t){"readable"===e._controlledReadableStream._state&&Ae(e,t)}).catch(w)):e._pullAgain=!0)}function ge(e){ke(e),e._pendingPullIntos=[]}function ve(e,t){b("errored"!==e._state,"state must not be errored");var n=!1;"closed"===e._state&&(b(0===t.bytesFilled),n=!0);var i=ye(t);"default"===t.readerType?q(e,i,n):(b("byob"===t.readerType),function(e,t,n){var i=e._reader;b(i._readIntoRequests.length>0),i._readIntoRequests.shift()._resolve(s(t,n))}(e,i,n))}function ye(e){var t=e.bytesFilled,n=e.elementSize;return b(t<=e.byteLength),b(t%n==0),new e.ctor(e.buffer,e.byteOffset,t/n)}function be(e,t,n,i){e._queue.push({buffer:t,byteOffset:n,byteLength:i}),e._queueTotalSize+=i}function we(e,t){var n=t.elementSize,i=t.bytesFilled-t.bytesFilled%n,r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),o=t.bytesFilled+r,s=o-o%n,l=r,c=!1;s>i&&(l=s-t.bytesFilled,c=!0);for(var d=e._queue;l>0;){var u=d[0],h=Math.min(l,u.byteLength),p=t.byteOffset+t.bytesFilled;a(t.buffer,p,u.buffer,u.byteOffset,h),u.byteLength===h?d.shift():(u.byteOffset+=h,u.byteLength-=h),e._queueTotalSize-=h,_e(e,h,t),l-=h}return!1===c&&(b(0===e._queueTotalSize,"queue must be empty"),b(t.bytesFilled>0),b(t.bytesFilled<t.elementSize)),c}function _e(e,t,n){b(0===e._pendingPullIntos.length||e._pendingPullIntos[0]===n),ke(e),n.bytesFilled+=t}function Se(e){b("readable"===e._controlledReadableStream._state),0===e._queueTotalSize&&!0===e._closeRequested?U(e._controlledReadableStream):me(e)}function ke(e){void 0!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function Pe(e){for(b(!1===e._closeRequested);e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;var t=e._pendingPullIntos[0];!0===we(e,t)&&(Te(e),ve(e._controlledReadableStream,t))}}function Ce(e,t){var n=e._pendingPullIntos[0],i=e._controlledReadableStream;if("closed"===i._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(e,t){t.buffer=u(t.buffer),b(0===t.bytesFilled,"bytesFilled must be 0");var n=e._controlledReadableStream;if(!0===Y(n))for(;H(n)>0;)ve(n,Te(e))}(e,n)}else b("readable"===i._state),function(e,t,n){if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range");if(_e(e,t,n),!(n.bytesFilled<n.elementSize)){Te(e);var i=n.bytesFilled%n.elementSize;if(i>0){var r=n.byteOffset+n.bytesFilled,o=n.buffer.slice(r-i,r);be(e,o,0,o.byteLength)}n.buffer=u(n.buffer),n.bytesFilled-=i,ve(e._controlledReadableStream,n),Pe(e)}}(e,t,n)}function Te(e){var t=e._pendingPullIntos.shift();return ke(e),t}function Ae(e,t){var n=e._controlledReadableStream;b("readable"===n._state),ge(e),P(e),z(n,t)}function Ie(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Ee(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}function xe(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Re(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}function De(e,t){b(void 0!==e._closedPromise_resolve),b(void 0!==e._closedPromise_reject),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function Le(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}function Me(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function We(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function Ne(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}},function(e,t,n){var i=n(6),r=n(4),o=n(2);t.TransformStream=i.TransformStream,t.ReadableStream=r.ReadableStream,t.IsReadableStreamDisturbed=r.IsReadableStreamDisturbed,t.ReadableStreamDefaultControllerClose=r.ReadableStreamDefaultControllerClose,t.ReadableStreamDefaultControllerEnqueue=r.ReadableStreamDefaultControllerEnqueue,t.ReadableStreamDefaultControllerError=r.ReadableStreamDefaultControllerError,t.ReadableStreamDefaultControllerGetDesiredSize=r.ReadableStreamDefaultControllerGetDesiredSize,t.AcquireWritableStreamDefaultWriter=o.AcquireWritableStreamDefaultWriter,t.IsWritableStream=o.IsWritableStream,t.IsWritableStreamLocked=o.IsWritableStreamLocked,t.WritableStream=o.WritableStream,t.WritableStreamAbort=o.WritableStreamAbort,t.WritableStreamDefaultControllerError=o.WritableStreamDefaultControllerError,t.WritableStreamDefaultWriterCloseWithErrorPropagation=o.WritableStreamDefaultWriterCloseWithErrorPropagation,t.WritableStreamDefaultWriterRelease=o.WritableStreamDefaultWriterRelease,t.WritableStreamDefaultWriterWrite=o.WritableStreamDefaultWriterWrite},function(e,t,n){var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(1).assert,a=n(0),s=a.InvokeOrNoop,l=a.PromiseInvokeOrPerformFallback,c=a.PromiseInvokeOrNoop,d=a.typeIsObject,u=n(4),h=u.ReadableStream,p=u.ReadableStreamDefaultControllerClose,f=u.ReadableStreamDefaultControllerEnqueue,m=u.ReadableStreamDefaultControllerError,g=u.ReadableStreamDefaultControllerGetDesiredSize,v=n(2),y=v.WritableStream,b=v.WritableStreamDefaultControllerError;function w(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");var n=e._readableController;try{f(n,t)}catch(t){throw e._readableClosed=!0,S(e,t),e._storedError}!0===g(n)<=0&&!1===e._backpressure&&C(e,!0)}function _(e){o(!1===e._errored),o(!1===e._readableClosed);try{p(e._readableController)}catch(e){o(!1)}e._readableClosed=!0}function S(e,t){!1===e._errored&&k(e,t)}function k(e,t){o(!1===e._errored),e._errored=!0,e._storedError=t,!1===e._writableDone&&b(e._writableController,t),!1===e._readableClosed&&m(e._readableController,t)}function P(e){return o(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!1===e._backpressure?Promise.resolve():(o(!0===e._backpressure,"_backpressure should have been initialized"),e._backpressureChangePromise)}function C(e,t){o(e._backpressure!==t,"TransformStreamSetBackpressure() should be called only when backpressure is changed"),void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(t),e._backpressureChangePromise=new Promise(function(t){e._backpressureChangePromise_resolve=t}),e._backpressureChangePromise.then(function(e){o(e!==t,"_backpressureChangePromise should be fulfilled only when backpressure is changed")}),e._backpressure=t}function T(e,t){return w(t._controlledTransformStream,e),Promise.resolve()}function A(e){return!!d(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function I(e){return!!d(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}var E=function(){function e(t,n){r(this,e),this._transformStream=t,this._startPromise=n}return i(e,[{key:"start",value:function(e){var t=this._transformStream;return t._writableController=e,this._startPromise.then(function(){return P(t)})}},{key:"write",value:function(e){return function(e,t){o(!1===e._errored),o(!1===e._transforming),o(!1===e._backpressure),e._transforming=!0;var n=e._transformer,i=e._transformStreamController;return l(n,"transform",[t,i],T,[t,i]).then(function(){return e._transforming=!1,P(e)},function(t){return S(e,t),Promise.reject(t)})}(this._transformStream,e)}},{key:"abort",value:function(){var e=this._transformStream;e._writableDone=!0,k(e,new TypeError("Writable side aborted"))}},{key:"close",value:function(){var e=this._transformStream;return o(!1===e._transforming),e._writableDone=!0,c(e._transformer,"flush",[e._transformStreamController]).then(function(){return!0===e._errored?Promise.reject(e._storedError):(!1===e._readableClosed&&_(e),Promise.resolve())}).catch(function(t){return S(e,t),Promise.reject(e._storedError)})}}]),e}(),x=function(){function e(t,n){r(this,e),this._transformStream=t,this._startPromise=n}return i(e,[{key:"start",value:function(e){var t=this._transformStream;return t._readableController=e,this._startPromise.then(function(){return o(void 0!==t._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),!0===t._backpressure?Promise.resolve():(o(!1===t._backpressure,"_backpressure should have been initialized"),t._backpressureChangePromise)})}},{key:"pull",value:function(){var e=this._transformStream;return o(!0===e._backpressure,"pull() should be never called while _backpressure is false"),o(void 0!==e._backpressureChangePromise,"_backpressureChangePromise should have been initialized"),C(e,!1),e._backpressureChangePromise}},{key:"cancel",value:function(){var e=this._transformStream;e._readableClosed=!0,k(e,new TypeError("Readable side canceled"))}}]),e}(),R=function(){function e(t){if(r(this,e),!1===I(t))throw new TypeError("TransformStreamDefaultController can only be constructed with a TransformStream instance");if(void 0!==t._transformStreamController)throw new TypeError("TransformStreamDefaultController instances can only be created by the TransformStream constructor");this._controlledTransformStream=t}return i(e,[{key:"enqueue",value:function(e){if(!1===A(this))throw L("enqueue");w(this._controlledTransformStream,e)}},{key:"close",value:function(){if(!1===A(this))throw L("close");!function(e){if(!0===e._errored)throw new TypeError("TransformStream is already errored");if(!0===e._readableClosed)throw new TypeError("Readable side is already closed");_(e)}(this._controlledTransformStream)}},{key:"error",value:function(e){if(!1===A(this))throw L("error");!function(e,t){if(!0===e._errored)throw new TypeError("TransformStream is already errored");k(e,t)}(this._controlledTransformStream,e)}},{key:"desiredSize",get:function(){if(!1===A(this))throw L("desiredSize");var e=this._controlledTransformStream._readableController;return g(e)}}]),e}(),D=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this._transformer=t;var n=t.readableStrategy,i=t.writableStrategy;this._transforming=!1,this._errored=!1,this._storedError=void 0,this._writableController=void 0,this._readableController=void 0,this._transformStreamController=void 0,this._writableDone=!1,this._readableClosed=!1,this._backpressure=void 0,this._backpressureChangePromise=void 0,this._backpressureChangePromise_resolve=void 0,this._transformStreamController=new R(this);var a=void 0,l=new Promise(function(e){a=e}),c=new x(this,l);this._readable=new h(c,n);var d=new E(this,l);this._writable=new y(d,i),o(void 0!==this._writableController),o(void 0!==this._readableController),C(this,g(this._readableController)<=0);var u=this,p=s(t,"start",[u._transformStreamController]);a(p),l.catch(function(e){!1===u._errored&&(u._errored=!0,u._storedError=e)})}return i(e,[{key:"readable",get:function(){if(!1===I(this))throw M("readable");return this._readable}},{key:"writable",get:function(){if(!1===I(this))throw M("writable");return this._writable}}]),e}();function L(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function M(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}e.exports={TransformStream:D}},function(e,t,n){e.exports=n(5)}]))},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=!1;try{if("function"==typeof URL&&"object"===i(URL.prototype)&&"origin"in URL.prototype){var o=new URL("b","http://a");o.pathname="c%20d",r="http://a/c%20d"===o.href}}catch(e){}if(r)t.URL=URL;else{var a=n(146).URL,s=n(3).URL;s&&(a.createObjectURL=function(e){return s.createObjectURL.apply(s,arguments)},a.revokeObjectURL=function(e){s.revokeObjectURL(e)}),t.URL=a}},function(e,t,n){"use strict";!function(){var e=Object.create(null);e.ftp=21,e.file=0,e.gopher=70,e.http=80,e.https=443,e.ws=80,e.wss=443;var n=Object.create(null);function i(t){return void 0!==e[t]}function r(){h.call(this),this._isInvalid=!0}function o(e){return""===e&&r.call(this),e.toLowerCase()}function a(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function s(e){var t=e.charCodeAt(0);return t>32&&t<127&&-1===[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}n["%2e"]=".",n[".%2e"]="..",n["%2e."]="..",n["%2e%2e"]="..";var l,c=/[a-zA-Z]/,d=/[a-zA-Z0-9\+\-\.]/;function u(t,u,h){function p(e){b.push(e)}var f=u||"scheme start",m=0,g="",v=!1,y=!1,b=[];e:for(;(t[m-1]!==l||0===m)&&!this._isInvalid;){var w=t[m];switch(f){case"scheme start":if(!w||!c.test(w)){if(u){p("Invalid scheme.");break e}g="",f="no scheme";continue}g+=w.toLowerCase(),f="scheme";break;case"scheme":if(w&&d.test(w))g+=w.toLowerCase();else{if(":"!==w){if(u){if(w===l)break e;p("Code point not allowed in scheme: "+w);break e}g="",m=0,f="no scheme";continue}if(this._scheme=g,g="",u)break e;i(this._scheme)&&(this._isRelative=!0),f="file"===this._scheme?"relative":this._isRelative&&h&&h._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"===w?(this._query="?",f="query"):"#"===w?(this._fragment="#",f="fragment"):w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._schemeData+=a(w));break;case"no scheme":if(h&&i(h._scheme)){f="relative";continue}p("Missing scheme."),r.call(this);break;case"relative or authority":if("/"!==w||"/"!==t[m+1]){p("Expected /, got: "+w),f="relative";continue}f="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!==this._scheme&&(this._scheme=h._scheme),w===l){this._host=h._host,this._port=h._port,this._path=h._path.slice(),this._query=h._query,this._username=h._username,this._password=h._password;break e}if("/"===w||"\\"===w)"\\"===w&&p("\\ is an invalid code point."),f="relative slash";else if("?"===w)this._host=h._host,this._port=h._port,this._path=h._path.slice(),this._query="?",this._username=h._username,this._password=h._password,f="query";else{if("#"!==w){var _=t[m+1],S=t[m+2];("file"!==this._scheme||!c.test(w)||":"!==_&&"|"!==_||S!==l&&"/"!==S&&"\\"!==S&&"?"!==S&&"#"!==S)&&(this._host=h._host,this._port=h._port,this._username=h._username,this._password=h._password,this._path=h._path.slice(),this._path.pop()),f="relative path";continue}this._host=h._host,this._port=h._port,this._path=h._path.slice(),this._query=h._query,this._fragment="#",this._username=h._username,this._password=h._password,f="fragment"}break;case"relative slash":if("/"!==w&&"\\"!==w){"file"!==this._scheme&&(this._host=h._host,this._port=h._port,this._username=h._username,this._password=h._password),f="relative path";continue}"\\"===w&&p("\\ is an invalid code point."),f="file"===this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!==w){p("Expected '/', got: "+w),f="authority ignore slashes";continue}f="authority second slash";break;case"authority second slash":if(f="authority ignore slashes","/"!==w){p("Expected '/', got: "+w);continue}break;case"authority ignore slashes":if("/"!==w&&"\\"!==w){f="authority";continue}p("Expected authority, got: "+w);break;case"authority":if("@"===w){v&&(p("@ already seen."),g+="%40"),v=!0;for(var k=0;k<g.length;k++){var P=g[k];if("\t"!==P&&"\n"!==P&&"\r"!==P)if(":"!==P||null!==this._password){var C=a(P);null!==this._password?this._password+=C:this._username+=C}else this._password="";else p("Invalid whitespace in authority.")}g=""}else{if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){m-=g.length,g="",f="host";continue}g+=w}break;case"file host":if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){2!==g.length||!c.test(g[0])||":"!==g[1]&&"|"!==g[1]?0===g.length?f="relative path start":(this._host=o.call(this,g),g="",f="relative path start"):f="relative path";continue}"\t"===w||"\n"===w||"\r"===w?p("Invalid whitespace in file host."):g+=w;break;case"host":case"hostname":if(":"!==w||y){if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w){if(this._host=o.call(this,g),g="",f="relative path start",u)break e;continue}"\t"!==w&&"\n"!==w&&"\r"!==w?("["===w?y=!0:"]"===w&&(y=!1),g+=w):p("Invalid code point in host/hostname: "+w)}else if(this._host=o.call(this,g),g="",f="port","hostname"===u)break e;break;case"port":if(/[0-9]/.test(w))g+=w;else{if(w===l||"/"===w||"\\"===w||"?"===w||"#"===w||u){if(""!==g){var T=parseInt(g,10);T!==e[this._scheme]&&(this._port=T+""),g=""}if(u)break e;f="relative path start";continue}"\t"===w||"\n"===w||"\r"===w?p("Invalid code point in port: "+w):r.call(this)}break;case"relative path start":if("\\"===w&&p("'\\' not allowed in path."),f="relative path","/"!==w&&"\\"!==w)continue;break;case"relative path":var A;if(w!==l&&"/"!==w&&"\\"!==w&&(u||"?"!==w&&"#"!==w))"\t"!==w&&"\n"!==w&&"\r"!==w&&(g+=a(w));else"\\"===w&&p("\\ not allowed in relative path."),(A=n[g.toLowerCase()])&&(g=A),".."===g?(this._path.pop(),"/"!==w&&"\\"!==w&&this._path.push("")):"."===g&&"/"!==w&&"\\"!==w?this._path.push(""):"."!==g&&("file"===this._scheme&&0===this._path.length&&2===g.length&&c.test(g[0])&&"|"===g[1]&&(g=g[0]+":"),this._path.push(g)),g="","?"===w?(this._query="?",f="query"):"#"===w&&(this._fragment="#",f="fragment");break;case"query":u||"#"!==w?w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._query+=s(w)):(this._fragment="#",f="fragment");break;case"fragment":w!==l&&"\t"!==w&&"\n"!==w&&"\r"!==w&&(this._fragment+=w)}m++}}function h(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function p(e,t){void 0===t||t instanceof p||(t=new p(String(t))),this._url=e,h.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");u.call(this,n,null,t)}p.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return""===this._username&&null===this._password||(e=this._username+(null!==this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){h.call(this),u.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||u.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&u.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],u.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"===this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"===e[0]&&(e=e.slice(1)),u.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"===this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"===e[0]&&(e=e.slice(1)),u.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null";case"blob":try{return new p(this._schemeData).origin||"null"}catch(e){}return"null"}return(e=this.host)?this._scheme+"://"+e:""}},t.URL=p}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocument=function(e){var t,n=new L;if("string"==typeof e)t={url:e};else if((0,o.isArrayBuffer)(e))t={data:e};else if(e instanceof M)t={range:e};else{if("object"!==k(e))throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=e}var i=Object.create(null),r=null,s=null;for(var c in t)if("url"!==c||"undefined"==typeof window)if("range"!==c)if("worker"!==c)if("data"!==c||t[c]instanceof Uint8Array)i[c]=t[c];else{var d=t[c];if("string"==typeof d)i[c]=(0,o.stringToBytes)(d);else if("object"!==k(d)||null===d||isNaN(d.length)){if(!(0,o.isArrayBuffer)(d))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");i[c]=new Uint8Array(d)}else i[c]=new Uint8Array(d)}else s=t[c];else r=t[c];else i[c]=new o.URL(t[c],window.location).href;i.rangeChunkSize=i.rangeChunkSize||C,i.CMapReaderFactory=i.CMapReaderFactory||a.DOMCMapReaderFactory,i.ignoreErrors=!0!==i.stopAtErrors,i.pdfBug=!0===i.pdfBug;var p=Object.values(o.NativeImageDecoding);void 0!==i.nativeImageDecoderSupport&&p.includes(i.nativeImageDecoderSupport)||(i.nativeImageDecoderSupport=l.apiCompatibilityParams.nativeImageDecoderSupport||o.NativeImageDecoding.DECODE);Number.isInteger(i.maxImageSize)||(i.maxImageSize=-1);"boolean"!=typeof i.isEvalSupported&&(i.isEvalSupported=!0);"boolean"!=typeof i.disableFontFace&&(i.disableFontFace=l.apiCompatibilityParams.disableFontFace||!1);"boolean"!=typeof i.disableRange&&(i.disableRange=!1);"boolean"!=typeof i.disableStream&&(i.disableStream=!1);"boolean"!=typeof i.disableAutoFetch&&(i.disableAutoFetch=!1);"boolean"!=typeof i.disableCreateObjectURL&&(i.disableCreateObjectURL=l.apiCompatibilityParams.disableCreateObjectURL||!1);if((0,o.setVerbosityLevel)(i.verbosity),!s){var m={postMessageTransfers:i.postMessageTransfers,verbosity:i.verbosity,port:u.GlobalWorkerOptions.workerPort};s=m.port?F.fromPort(m):new F(m),n._worker=s}var g=n.docId;return s.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");return function(e,t,n,i){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(n&&(t.length=n.length,t.initialData=n.initialData,t.progressiveDone=n.progressiveDone),e.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"2.2.228",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,disableCreateObjectURL:t.disableCreateObjectURL,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,nativeImageDecoderSupport:t.nativeImageDecoderSupport,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported}).then(function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t}))}(s,i,r,g).then(function(e){if(n.destroyed)throw new Error("Loading aborted");var t;r?t=new f.PDFDataTransportStream({length:i.length,initialData:i.initialData,progressiveDone:i.progressiveDone,disableRange:i.disableRange,disableStream:i.disableStream},r):i.data||(t=E({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream}));var o=new h.MessageHandler(g,e,s.port);o.postMessageTransfers=s.postMessageTransfers;var a=new j(o,n,t,i);n._transport=a,o.send("Ready",null)})}).catch(n._capability.reject),n},t.setPDFNetworkStreamFactory=function(e){E=e},t.build=t.version=t.PDFPageProxy=t.PDFDocumentProxy=t.PDFWorker=t.PDFDataRangeTransport=t.LoopbackPort=void 0;var r=g(i(148)),o=i(1),a=i(151),s=i(152),l=i(153),c=i(154),d=g(i(3)),u=i(156),h=i(157),p=i(158),f=i(160),m=i(161);function g(e){return e&&e.__esModule?e:{default:e}}function v(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),e}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var P,C=65536,T=!1,A=null,I=!1;"undefined"==typeof window?(T=!0,I=!0):I=!0,"undefined"!=typeof requirejs&&requirejs.toUrl&&(P=requirejs.toUrl("pdfjs-dist/build/pdf.worker.js"));var E,x="undefined"!=typeof requirejs&&requirejs.load;if(A=I?function(){return new Promise(function(e,t){n.e(1).then(function(){try{var i;i=n(80),e(i.WorkerMessageHandler)}catch(e){t(e)}}.bind(null,n)).catch(t)})}:x?function(){return new Promise(function(e,t){requirejs(["pdfjs-dist/build/pdf.worker"],function(n){try{e(n.WorkerMessageHandler)}catch(e){t(e)}},t)})}:null,!P&&"object"===("undefined"==typeof document?"undefined":k(document))&&"currentScript"in document){var R=document.currentScript&&document.currentScript.src;R&&(P=R.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}var D,L=(D=0,function(){function e(){w(this,e),this._capability=(0,o.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+D++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return S(e,[{key:"destroy",value:function(){var e=this;return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(function(){e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)})}},{key:"then",value:function(e,t){return(0,a.deprecated)("PDFDocumentLoadingTask.then method, use the `promise` getter instead."),this.promise.then.apply(this.promise,arguments)}},{key:"promise",get:function(){return this._capability.promise}}]),e}()),M=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];w(this,e),this.length=t,this.initialData=n,this.progressiveDone=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,o.createPromiseCapability)()}return S(e,[{key:"addRangeListener",value:function(e){this._rangeListeners.push(e)}},{key:"addProgressListener",value:function(e){this._progressListeners.push(e)}},{key:"addProgressiveReadListener",value:function(e){this._progressiveReadListeners.push(e)}},{key:"addProgressiveDoneListener",value:function(e){this._progressiveDoneListeners.push(e)}},{key:"onDataRange",value:function(e,t){var n=!0,i=!1,r=void 0;try{for(var o,a=this._rangeListeners[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){(0,o.value)(e,t)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}},{key:"onDataProgress",value:function(e,t){var n=this;this._readyCapability.promise.then(function(){var i=!0,r=!1,o=void 0;try{for(var a,s=n._progressListeners[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){(0,a.value)(e,t)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}})}},{key:"onDataProgressiveRead",value:function(e){var t=this;this._readyCapability.promise.then(function(){var n=!0,i=!1,r=void 0;try{for(var o,a=t._progressiveReadListeners[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){(0,o.value)(e)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}})}},{key:"onDataProgressiveDone",value:function(){var e=this;this._readyCapability.promise.then(function(){var t=!0,n=!1,i=void 0;try{for(var r,o=e._progressiveDoneListeners[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){(0,r.value)()}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}})}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(e,t){(0,o.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),e}();t.PDFDataRangeTransport=M;var W=function(){function e(t,n){w(this,e),this._pdfInfo=t,this._transport=n}return S(e,[{key:"getPage",value:function(e){return this._transport.getPage(e)}},{key:"getPageIndex",value:function(e){return this._transport.getPageIndex(e)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(e){return this._transport.getDestination(e)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageLayout",value:function(){return this._transport.getPageLayout()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getViewerPreferences",value:function(){return this._transport.getViewerPreferences()}},{key:"getOpenActionDestination",value:function(){return this._transport.getOpenActionDestination()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"getStats",value:function(){return this._transport.getStats()}},{key:"cleanup",value:function(){this._transport.startCleanup()}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprint",get:function(){return this._pdfInfo.fingerprint}},{key:"loadingParams",get:function(){return this._transport.loadingParams}},{key:"loadingTask",get:function(){return this._transport.loadingTask}}]),e}();t.PDFDocumentProxy=W;var N=function(){function e(t,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];w(this,e),this.pageIndex=t,this._pageInfo=n,this._transport=i,this._stats=r?new a.StatTimer:a.DummyStatTimer,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new V,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return S(e,[{key:"getViewport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scale,n=e.rotation,i=void 0===n?this.rotate:n,r=e.dontFlip,o=void 0!==r&&r;return(arguments.length>1||"number"==typeof arguments[0])&&((0,a.deprecated)("getViewport is called with obsolete arguments."),t=arguments[0],i="number"==typeof arguments[1]?arguments[1]:this.rotate,o="boolean"==typeof arguments[2]&&arguments[2]),new a.PageViewport({viewBox:this.view,scale:t,rotation:i,dontFlip:o})}},{key:"getAnnotations",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).intent,t=void 0===e?null:e;return this.annotationsPromise&&this.annotationsIntent===t||(this.annotationsPromise=this._transport.getAnnotations(this.pageIndex,t),this.annotationsIntent=t),this.annotationsPromise}},{key:"render",value:function(e){var t=this,n=e.canvasContext,i=e.viewport,r=e.intent,s=void 0===r?"display":r,l=e.enableWebGL,c=void 0!==l&&l,d=e.renderInteractiveForms,u=void 0!==d&&d,h=e.transform,p=void 0===h?null:h,f=e.imageLayer,g=void 0===f?null:f,v=e.canvasFactory,y=void 0===v?null:v,b=e.background,w=void 0===b?null:b,_=this._stats;_.time("Overall"),this.pendingCleanup=!1;var S="print"===s?"print":"display",k=y||new a.DOMCanvasFactory,P=new m.WebGLContext({enable:c});this.intentStates[S]||(this.intentStates[S]=Object.create(null));var C=this.intentStates[S];C.displayReadyCapability||(C.receivingOperatorList=!0,C.displayReadyCapability=(0,o.createPromiseCapability)(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1},_.time("Page Request"),this._transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageNumber-1,intent:S,renderInteractiveForms:!0===u}));var T=function(e){var n=C.renderTasks.indexOf(A);n>=0&&C.renderTasks.splice(n,1),(t.cleanupAfterRender||"print"===S)&&(t.pendingCleanup=!0),t._tryCleanup(),e?A.capability.reject(e):A.capability.resolve(),_.timeEnd("Rendering"),_.timeEnd("Overall")},A=new z({callback:T,params:{canvasContext:n,viewport:i,transform:p,imageLayer:g,background:w},objs:this.objs,commonObjs:this.commonObjs,operatorList:C.operatorList,pageNumber:this.pageNumber,canvasFactory:k,webGLContext:P,useRequestAnimationFrame:"print"!==S,pdfBug:this._pdfBug});C.renderTasks||(C.renderTasks=[]),C.renderTasks.push(A);var I=A.task;return C.displayReadyCapability.promise.then(function(e){t.pendingCleanup?T():(_.time("Rendering"),A.initializeGraphics(e),A.operatorListChanged())}).catch(T),I}},{key:"getOperatorList",value:function(){this.intentStates.oplist||(this.intentStates.oplist=Object.create(null));var e,t=this.intentStates.oplist;return t.opListReadCapability||((e={}).operatorListChanged=function(){if(t.operatorList.lastChunk){t.opListReadCapability.resolve(t.operatorList);var n=t.renderTasks.indexOf(e);n>=0&&t.renderTasks.splice(n,1)}},t.receivingOperatorList=!0,t.opListReadCapability=(0,o.createPromiseCapability)(),t.renderTasks=[],t.renderTasks.push(e),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats.time("Page Request"),this._transport.messageHandler.send("RenderPageRequest",{pageIndex:this.pageIndex,intent:"oplist"})),t.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.normalizeWhitespace,n=void 0!==t&&t,i=e.disableCombineTextItems,r=void 0!==i&&i;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this.pageNumber-1,normalizeWhitespace:!0===n,combineTextItems:!0!==r},{highWaterMark:100,size:function(e){return e.items.length}})}},{key:"getTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.streamTextContent(e);return new Promise(function(e,n){var i=t.getReader(),r={items:[],styles:Object.create(null)};!function t(){i.read().then(function(n){var i,o=n.value;n.done?e(r):(Object.assign(r.styles,o.styles),(i=r.items).push.apply(i,b(o.items)),t())},n)}()})}},{key:"_destroy",value:function(){this.destroyed=!0,this._transport.pageCache[this.pageIndex]=null;var e=[];return Object.keys(this.intentStates).forEach(function(t){"oplist"!==t&&this.intentStates[t].renderTasks.forEach(function(t){var n=t.capability.promise.catch(function(){});e.push(n),t.cancel()})},this),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)}},{key:"cleanup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup=!0,this._tryCleanup(e)}},{key:"_tryCleanup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.pendingCleanup&&!Object.keys(this.intentStates).some(function(e){var t=this.intentStates[e];return 0!==t.renderTasks.length||t.receivingOperatorList},this)&&(Object.keys(this.intentStates).forEach(function(e){delete this.intentStates[e]},this),this.objs.clear(),this.annotationsPromise=null,e&&this._stats instanceof a.StatTimer&&(this._stats=new a.StatTimer),this.pendingCleanup=!1)}},{key:"_startRenderPage",value:function(e,t){var n=this.intentStates[t];n.displayReadyCapability&&n.displayReadyCapability.resolve(e)}},{key:"_renderPageChunk",value:function(e,t){for(var n=this.intentStates[t],i=0,r=e.length;i<r;i++)n.operatorList.fnArray.push(e.fnArray[i]),n.operatorList.argsArray.push(e.argsArray[i]);n.operatorList.lastChunk=e.lastChunk;for(var o=0;o<n.renderTasks.length;o++)n.renderTasks[o].operatorListChanged();e.lastChunk&&(n.receivingOperatorList=!1,this._tryCleanup())}},{key:"pageNumber",get:function(){return this.pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"stats",get:function(){return this._stats instanceof a.StatTimer?this._stats:null}}]),e}();t.PDFPageProxy=N;var O=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];w(this,e),this._listeners=[],this._defer=t,this._deferred=Promise.resolve(void 0)}return S(e,[{key:"postMessage",value:function(e,t){var n=this;if(this._defer){var i=new WeakMap,r={data:function e(n){if("object"!==k(n)||null===n)return n;if(i.has(n))return i.get(n);var r,a;if((r=n.buffer)&&(0,o.isArrayBuffer)(r)){var s=t&&t.includes(r);return a=n===r?n:s?new n.constructor(r,n.byteOffset,n.byteLength):new n.constructor(n),i.set(n,a),a}for(var l in a=Array.isArray(n)?[]:{},i.set(n,a),n){for(var c=void 0,d=n;!(c=Object.getOwnPropertyDescriptor(d,l));)d=Object.getPrototypeOf(d);void 0!==c.value&&"function"!=typeof c.value&&(a[l]=e(c.value))}return a}(e)};this._deferred.then(function(){n._listeners.forEach(function(e){e.call(this,r)},n)})}else this._listeners.forEach(function(t){t.call(this,{data:e})},this)}},{key:"addEventListener",value:function(e,t){this._listeners.push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)}},{key:"terminate",value:function(){this._listeners.length=0}}]),e}();t.LoopbackPort=O;var F=function(){var e,t=new WeakMap,n=0;function i(){if(u.GlobalWorkerOptions.workerSrc)return u.GlobalWorkerOptions.workerSrc;if(void 0!==P)return P;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function r(){try{if("undefined"!=typeof window)return window.pdfjsWorker&&window.pdfjsWorker.WorkerMessageHandler}catch(e){}return null}return function(){function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.name,i=void 0===n?null:n,r=e.port,a=void 0===r?null:r,l=e.postMessageTransfers,c=void 0===l||l,d=e.verbosity,u=void 0===d?(0,o.getVerbosityLevel)():d;if(w(this,s),a&&t.has(a))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=i,this.destroyed=!1,this.postMessageTransfers=!1!==c,this.verbosity=u,this._readyCapability=(0,o.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,a)return t.set(a,this),void this._initializeFromPort(a);this._initialize()}return S(s,[{key:"_initializeFromPort",value:function(e){this._port=e,this._messageHandler=new h.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}},{key:"_initialize",value:function(){var e,t,n=this;if("undefined"!=typeof Worker&&!T&&!r()){var a=i();try{(0,o.isSameOrigin)(window.location.href,a)||(e=new o.URL(a,window.location).href,t="importScripts('"+e+"');",a=o.URL.createObjectURL(new Blob([t])));var s=new Worker(a),l=new h.MessageHandler("main","worker",s),c=function(){s.removeEventListener("error",d),l.destroy(),s.terminate(),n.destroyed?n._readyCapability.reject(new Error("Worker was destroyed")):n._setupFakeWorker()},d=function(){n._webWorker||c()};s.addEventListener("error",d),l.on("test",function(e){s.removeEventListener("error",d),n.destroyed?c():e&&e.supportTypedArray?(n._messageHandler=l,n._port=s,n._webWorker=s,e.supportTransfers||(n.postMessageTransfers=!1),n._readyCapability.resolve(),l.send("configure",{verbosity:n.verbosity})):(n._setupFakeWorker(),l.destroy(),s.terminate())}),l.on("ready",function(e){if(s.removeEventListener("error",d),n.destroyed)c();else try{u()}catch(e){n._setupFakeWorker()}});var u=function(){var e=new Uint8Array([n.postMessageTransfers?255:0]);try{l.send("test",e,[e.buffer])}catch(t){(0,o.info)("Cannot use postMessage transfers"),e[0]=0,l.send("test",e)}};return void u()}catch(e){(0,o.info)("The worker has been disabled.")}}this._setupFakeWorker()}},{key:"_setupFakeWorker",value:function(){var t=this;T||((0,o.warn)("Setting up fake worker."),T=!0),function(){if(e)return e.promise;e=(0,o.createPromiseCapability)();var t=r();return t?(e.resolve(t),e.promise):((A||function(){return(0,a.loadScript)(i()).then(function(){return window.pdfjsWorker.WorkerMessageHandler})})().then(e.resolve,e.reject),e.promise)}().then(function(e){if(t.destroyed)t._readyCapability.reject(new Error("Worker was destroyed"));else{var i=new O;t._port=i;var r="fake"+n++,o=new h.MessageHandler(r+"_worker",r,i);e.setup(o,i);var a=new h.MessageHandler(r,r+"_worker",i);t._messageHandler=a,t._readyCapability.resolve()}}).catch(function(e){t._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(e.message,'".')))})}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}},{key:"promise",get:function(){return this._readyCapability.promise}},{key:"port",get:function(){return this._port}},{key:"messageHandler",get:function(){return this._messageHandler}}],[{key:"fromPort",value:function(e){if(!e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return t.has(e.port)?t.get(e.port):new s(e)}},{key:"getWorkerSrc",value:function(){return i()}}]),s}()}();t.PDFWorker=F;var B,j=function(){function e(t,n,i,r){w(this,e),this.messageHandler=t,this.loadingTask=n,this.commonObjs=new V,this.fontLoader=new s.FontLoader({docId:n.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this)}),this._params=r,this.CMapReaderFactory=new r.CMapReaderFactory({baseUrl:r.cMapUrl,isCompressed:r.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,o.createPromiseCapability)(),this.setupMessageHandler()}return S(e,[{key:"destroy",value:function(){var e=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,o.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach(function(e){e&&t.push(e._destroy())}),this.pageCache.length=0,this.pagePromises.length=0;var n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then(function(){e.fontLoader.clear(),e._networkStream&&e._networkStream.cancelAllRequests(),e.messageHandler&&(e.messageHandler.destroy(),e.messageHandler=null),e.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var e=this.messageHandler,t=this.loadingTask;e.on("GetReader",function(e,t){var n=this;(0,o.assert)(this._networkStream),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=function(e){n._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=function(){n._fullReader.read().then(function(e){var n=e.value;e.done?t.close():((0,o.assert)((0,o.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))}).catch(function(e){t.error(e)})},t.onCancel=function(e){n._fullReader.cancel(e)}},this),e.on("ReaderHeadersReady",function(e){var n=this,i=(0,o.createPromiseCapability)(),r=this._fullReader;return r.headersReady.then(function(){r.isStreamingSupported&&r.isRangeSupported||(n._lastProgress&&t.onProgress&&t.onProgress(n._lastProgress),r.onProgress=function(e){t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),i.resolve({isStreamingSupported:r.isStreamingSupported,isRangeSupported:r.isRangeSupported,contentLength:r.contentLength})},i.reject),i.promise},this),e.on("GetRangeReader",function(e,t){(0,o.assert)(this._networkStream);var n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=function(){n.read().then(function(e){var n=e.value;e.done?t.close():((0,o.assert)((0,o.isArrayBuffer)(n)),t.enqueue(new Uint8Array(n),1,[n]))}).catch(function(e){t.error(e)})},t.onCancel=function(e){n.cancel(e)}):t.close()},this),e.on("GetDoc",function(e){var n=e.pdfInfo;this._numPages=n.numPages,t._capability.resolve(new W(n,this))},this),e.on("PasswordRequest",function(e){var n=this;if(this._passwordCapability=(0,o.createPromiseCapability)(),t.onPassword){try{t.onPassword(function(e){n._passwordCapability.resolve({password:e})},e.code)}catch(e){this._passwordCapability.reject(e)}}else this._passwordCapability.reject(new o.PasswordException(e.message,e.code));return this._passwordCapability.promise},this),e.on("PasswordException",function(e){t._capability.reject(new o.PasswordException(e.message,e.code))},this),e.on("InvalidPDF",function(e){t._capability.reject(new o.InvalidPDFException(e.message))},this),e.on("MissingPDF",function(e){t._capability.reject(new o.MissingPDFException(e.message))},this),e.on("UnexpectedResponse",function(e){t._capability.reject(new o.UnexpectedResponseException(e.message,e.status))},this),e.on("UnknownError",function(e){t._capability.reject(new o.UnknownErrorException(e.message,e.details))},this),e.on("DataLoaded",function(e){t.onProgress&&t.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)},this),e.on("StartRenderPage",function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex];t._stats.timeEnd("Page Request"),t._startRenderPage(e.transparency,e.intent)}},this),e.on("RenderPageChunk",function(e){this.destroyed||this.pageCache[e.pageIndex]._renderPageChunk(e.operatorList,e.intent)},this),e.on("commonobj",function(t){var n=this;if(!this.destroyed){var i=y(t,3),r=i[0],a=i[1],l=i[2];if(!this.commonObjs.has(r))switch(a){case"Font":var c=this._params;if("error"in l){var u=l.error;(0,o.warn)("Error during font loading: ".concat(u)),this.commonObjs.resolve(r,u);break}var h=null;c.pdfBug&&d.default.FontInspector&&d.default.FontInspector.enabled&&(h={registerFont:function(e,t){d.default.FontInspector.fontAdded(e,t)}});var p=new s.FontFaceObject(l,{isEvalSupported:c.isEvalSupported,disableFontFace:c.disableFontFace,ignoreErrors:c.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:h});this.fontLoader.bind(p).then(function(){n.commonObjs.resolve(r,p)},function(t){e.sendWithPromise("FontFallback",{id:r}).finally(function(){n.commonObjs.resolve(r,p)})});break;case"FontPath":case"FontType3Res":this.commonObjs.resolve(r,l);break;default:throw new Error("Got unknown common object type ".concat(a))}}},this),e.on("obj",function(e){if(!this.destroyed){var t=y(e,4),n=t[0],i=t[1],r=t[2],o=t[3],s=this.pageCache[i];if(!s.objs.has(n))switch(r){case"JpegStream":return new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t(new Error("Error during JPEG image loading")),(0,a.releaseImageResources)(n)},n.src=o}).then(function(e){s.objs.resolve(n,e)});case"Image":s.objs.resolve(n,o);o&&"data"in o&&o.data.length>8e6&&(s.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type ".concat(r))}}},this),e.on("DocProgress",function(e){this.destroyed||t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})},this),e.on("PageError",function(e){if(!this.destroyed){var t=this.pageCache[e.pageIndex].intentStates[e.intent];if(!t.displayReadyCapability)throw new Error(e.error);if(t.displayReadyCapability.reject(new Error(e.error)),t.operatorList){t.operatorList.lastChunk=!0;for(var n=0;n<t.renderTasks.length;n++)t.renderTasks[n].operatorListChanged()}}},this),e.on("UnsupportedFeature",this._onUnsupportedFeature,this),e.on("JpegDecode",function(e){if(this.destroyed)return Promise.reject(new Error("Worker was destroyed"));if("undefined"==typeof document)return Promise.reject(new Error('"document" is not defined.'));var t=y(e,2),n=t[0],i=t[1];return 3!==i&&1!==i?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise(function(e,t){var r=new Image;r.onload=function(){var t=r.width,n=r.height,o=t*n,s=4*o,l=new Uint8ClampedArray(o*i),c=document.createElement("canvas");c.width=t,c.height=n;var d=c.getContext("2d");d.drawImage(r,0,0);var u=d.getImageData(0,0,t,n).data;if(3===i)for(var h=0,p=0;h<s;h+=4,p+=3)l[p]=u[h],l[p+1]=u[h+1],l[p+2]=u[h+2];else if(1===i)for(var f=0,m=0;f<s;f+=4,m++)l[m]=u[f];e({data:l,width:t,height:n}),(0,a.releaseImageResources)(r),c.width=0,c.height=0,c=null,d=null},r.onerror=function(){t(new Error("JpegDecode failed to load image")),(0,a.releaseImageResources)(r)},r.src=n})},this),e.on("FetchBuiltInCMap",function(e){return this.destroyed?Promise.reject(new Error("Worker was destroyed")):this.CMapReaderFactory.fetch({name:e.name})},this)}},{key:"_onUnsupportedFeature",value:function(e){var t=e.featureId;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(e){var t=this;if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request"));var n=e-1;if(n in this.pagePromises)return this.pagePromises[n];var i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(function(e){if(t.destroyed)throw new Error("Transport destroyed");var i=new N(n,e,t,t._params.pdfBug);return t.pageCache[n]=i,i});return this.pagePromises[n]=i,i}},{key:"getPageIndex",value:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch(function(e){return Promise.reject(new Error(e))})}},{key:"getAnnotations",value:function(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageLayout",value:function(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getViewerPreferences",value:function(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}},{key:"getOpenActionDestination",value:function(){return this.messageHandler.sendWithPromise("GetOpenActionDestination",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var e=this;return this.messageHandler.sendWithPromise("GetMetadata",null).then(function(t){return{info:t[0],metadata:t[1]?new p.Metadata(t[1]):null,contentDispositionFilename:e._fullReader?e._fullReader.filename:null}})}},{key:"getStats",value:function(){return this.messageHandler.sendWithPromise("GetStats",null)}},{key:"startCleanup",value:function(){var e=this;this.messageHandler.sendWithPromise("Cleanup",null).then(function(){for(var t=0,n=e.pageCache.length;t<n;t++){var i=e.pageCache[t];i&&i.cleanup()}e.commonObjs.clear(),e.fontLoader.clear()})}},{key:"loadingParams",get:function(){var e=this._params;return(0,o.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableCreateObjectURL:e.disableCreateObjectURL,disableFontFace:e.disableFontFace,nativeImageDecoderSupport:e.nativeImageDecoderSupport})}}]),e}(),V=function(){function e(){w(this,e),this._objs=Object.create(null)}return S(e,[{key:"_ensureObj",value:function(e){return this._objs[e]?this._objs[e]:this._objs[e]={capability:(0,o.createPromiseCapability)(),data:null,resolved:!1}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)return this._ensureObj(e).capability.promise.then(t),null;var n=this._objs[e];if(!n||!n.resolved)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}},{key:"has",value:function(e){var t=this._objs[e];return!!t&&t.resolved}},{key:"resolve",value:function(e,t){var n=this._ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)}},{key:"clear",value:function(){for(var e in this._objs){var t=this._objs[e].data;"undefined"!=typeof Image&&t instanceof Image&&(0,a.releaseImageResources)(t)}this._objs=Object.create(null)}}]),e}(),U=function(){function e(t){w(this,e),this._internalRenderTask=t,this.onContinue=null}return S(e,[{key:"cancel",value:function(){this._internalRenderTask.cancel()}},{key:"then",value:function(e,t){return(0,a.deprecated)("RenderTask.then method, use the `promise` getter instead."),this.promise.then.apply(this.promise,arguments)}},{key:"promise",get:function(){return this._internalRenderTask.capability.promise}}]),e}(),z=(B=new WeakSet,function(){function e(t){var n=t.callback,i=t.params,r=t.objs,a=t.commonObjs,s=t.operatorList,l=t.pageNumber,c=t.canvasFactory,d=t.webGLContext,u=t.useRequestAnimationFrame,h=void 0!==u&&u,p=t.pdfBug,f=void 0!==p&&p;w(this,e),this.callback=n,this.params=i,this.objs=r,this.commonObjs=a,this.operatorListIdx=null,this.operatorList=s,this.pageNumber=l,this.canvasFactory=c,this.webGLContext=d,this._pdfBug=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===h&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,o.createPromiseCapability)(),this.task=new U(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=i.canvasContext.canvas}return S(e,[{key:"initializeGraphics",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.cancelled){if(this._canvas){if(B.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");B.add(this._canvas)}this._pdfBug&&d.default.StepperManager&&d.default.StepperManager.enabled&&(this.stepper=d.default.StepperManager.create(this.pageNumber-1),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var t=this.params,n=t.canvasContext,i=t.viewport,r=t.transform,o=t.imageLayer,a=t.background;this.gfx=new c.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,o),this.gfx.beginDrawing({transform:r,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}}},{key:"cancel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&B.delete(this._canvas),this.callback(e||new a.RenderingCancelledException("Rendering cancelled, page ".concat(this.pageNumber),"canvas"))}},{key:"operatorListChanged",value:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var e=this;this._useRequestAnimationFrame?window.requestAnimationFrame(function(){e._nextBound().catch(e.cancel.bind(e))}):Promise.resolve().then(this._nextBound).catch(this.cancel.bind(this))}},{key:"_next",value:(t=r.default.mark(function e(){return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.cancelled){e.next=2;break}return e.abrupt("return");case 2:this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&B.delete(this._canvas),this.callback()));case 4:case"end":return e.stop()}},e,this)}),n=function(){var e=this,n=arguments;return new Promise(function(i,r){var o=t.apply(e,n);function a(e){v(o,i,r,a,s,"next",e)}function s(e){v(o,i,r,a,s,"throw",e)}a(void 0)})},function(){return n.apply(this,arguments)})}]),e;var t,n}());t.version="2.2.228";t.build="d7afb74a"},function(e,t,n){"use strict";e.exports=n(149)},function(e,t,n){"use strict";(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(e){var n,i=Object.prototype,r=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function c(e,t,n,i){var r=t&&t.prototype instanceof g?t:g,o=Object.create(r.prototype),a=new I(i||[]);return o._invoke=function(e,t,n){var i=u;return function(r,o){if(i===p)throw new Error("Generator is already running");if(i===f){if("throw"===r)throw o;return x()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=C(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===u)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=p;var l=d(e,t,n);if("normal"===l.type){if(i=n.done?f:h,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=f,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u="suspendedStart",h="suspendedYield",p="executing",f="completed",m={};function g(){}function v(){}function y(){}var b={};b[a]=function(){return this};var w=Object.getPrototypeOf,_=w&&w(w(E([])));_&&_!==i&&r.call(_,a)&&(b=_);var S=y.prototype=g.prototype=Object.create(b);function k(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function P(e){var n;this._invoke=function(i,o){function a(){return new Promise(function(n,a){!function n(i,o,a,s){var l=d(e[i],e,o);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"===t(u)&&r.call(u,"__await")?Promise.resolve(u.__await).then(function(e){n("next",e,a,s)},function(e){n("throw",e,a,s)}):Promise.resolve(u).then(function(e){c.value=e,a(c)},function(e){return n("throw",e,a,s)})}s(l.arg)}(i,o,n,a)})}return n=n?n.then(a,a):a()}}function C(e,t){var i=e.iterator[t.method];if(i===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,C(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var r=d(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,m;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function E(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function t(){for(;++i<e.length;)if(r.call(e,i))return t.value=e[i],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:n,done:!0}}return v.prototype=S.constructor=y,y.constructor=v,y[l]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(S),e},e.awrap=function(e){return{__await:e}},k(P.prototype),P.prototype[s]=function(){return this},e.AsyncIterator=P,e.async=function(t,n,i,r){var o=new P(c(t,n,i,r));return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},k(S),S[l]="Generator",S[a]=function(){return this},S.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=E,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function i(i,r){return s.type="throw",s.arg=e,t.next=i,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;A(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:E(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=n),m}},e}("object"===t(e)?e.exports:{});try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}).call(this,n(150)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLinkAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,i=t.target,r=t.rel;if(e.href=e.title=n?(0,o.removeNullCharacters)(n):"",n){var a=Object.values(y),s=a.includes(i)?i:y.NONE;e.target=b[s],e.rel="string"==typeof r?r:u}},t.getFilenameFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("?"),i=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",i)+1,i)},t.isFetchSupported=k,t.isValidFetchUrl=P,t.loadScript=function(e){return new Promise(function(t,n){var i=document.createElement("script");i.src=e,i.onload=t,i.onerror=function(){n(new Error("Cannot load script at: ".concat(i.src)))},(document.head||document.documentElement).appendChild(i)})},t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.releaseImageResources=function(e){(0,o.assert)(e instanceof Image,"Invalid `img` parameter.");var t=e.src;"string"==typeof t&&t.startsWith("blob:")&&o.URL.revokeObjectURL&&o.URL.revokeObjectURL(t);e.removeAttribute("src")},t.PDFDateString=t.DummyStatTimer=t.StatTimer=t.DOMSVGFactory=t.DOMCMapReaderFactory=t.DOMCanvasFactory=t.DEFAULT_LINK_REL=t.LinkTarget=t.RenderingCancelledException=t.PageViewport=void 0;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1);function a(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var u="noopener noreferrer nofollow";t.DEFAULT_LINK_REL=u;var h="http://www.w3.org/2000/svg",p=function(){function e(){l(this,e)}return d(e,[{key:"create",value:function(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");var n=document.createElement("canvas"),i=n.getContext("2d");return n.width=e,n.height=t,{canvas:n,context:i}}},{key:"reset",value:function(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}},{key:"destroy",value:function(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}]),e}();t.DOMCanvasFactory=p;var f=function(){function e(t){var n=t.baseUrl,i=void 0===n?null:n,r=t.isCompressed,o=void 0!==r&&r;l(this,e),this.baseUrl=i,this.isCompressed=o}return d(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=s(r.default.mark(function e(t){var n,i,a,l=this;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,this.baseUrl){e.next=3;break}throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');case 3:if(n){e.next=5;break}throw new Error("CMap name must be specified.");case 5:if(i=this.baseUrl+n+(this.isCompressed?".bcmap":""),a=this.isCompressed?o.CMapCompressionType.BINARY:o.CMapCompressionType.NONE,!k()||!P(i,document.baseURI)){e.next=9;break}return e.abrupt("return",fetch(i).then(function(){var e=s(r.default.mark(function e(t){var n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}throw new Error(t.statusText);case 2:if(!l.isCompressed){e.next=10;break}return e.t0=Uint8Array,e.next=6,t.arrayBuffer();case 6:e.t1=e.sent,n=new e.t0(e.t1),e.next=15;break;case 10:return e.t2=o.stringToBytes,e.next=13,t.text();case 13:e.t3=e.sent,n=(0,e.t2)(e.t3);case 15:return e.abrupt("return",{cMapData:n,compressionType:a});case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){throw new Error("Unable to load ".concat(l.isCompressed?"binary ":"")+"CMap at: ".concat(i))}));case 9:return e.abrupt("return",new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",i,!0),l.isCompressed&&(n.responseType="arraybuffer"),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var i;if(200===n.status||0===n.status)if(l.isCompressed&&n.response?i=new Uint8Array(n.response):!l.isCompressed&&n.responseText&&(i=(0,o.stringToBytes)(n.responseText)),i)return void e({cMapData:i,compressionType:a});t(new Error(n.statusText))}},n.send(null)}).catch(function(e){throw new Error("Unable to load ".concat(l.isCompressed?"binary ":"")+"CMap at: ".concat(i))}));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}())}]),e}();t.DOMCMapReaderFactory=f;var m=function(){function e(){l(this,e)}return d(e,[{key:"create",value:function(e,t){(0,o.assert)(e>0&&t>0,"Invalid SVG dimensions");var n=document.createElementNS(h,"svg:svg");return n.setAttribute("version","1.1"),n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+e+" "+t),n}},{key:"createElement",value:function(e){return(0,o.assert)("string"==typeof e,"Invalid SVG element type"),document.createElementNS(h,e)}}]),e}();t.DOMSVGFactory=m;var g=function(){function e(t){var n=t.viewBox,i=t.scale,r=t.rotation,o=t.offsetX,a=void 0===o?0:o,s=t.offsetY,c=void 0===s?0:s,d=t.dontFlip,u=void 0!==d&&d;l(this,e),this.viewBox=n,this.scale=i,this.rotation=r,this.offsetX=a,this.offsetY=c;var h,p,f,m,g,v,y,b,w=(n[2]+n[0])/2,_=(n[3]+n[1])/2;switch(r=(r%=360)<0?r+360:r){case 180:h=-1,p=0,f=0,m=1;break;case 90:h=0,p=1,f=1,m=0;break;case 270:h=0,p=-1,f=-1,m=0;break;default:h=1,p=0,f=0,m=-1}u&&(f=-f,m=-m),0===h?(g=Math.abs(_-n[1])*i+a,v=Math.abs(w-n[0])*i+c,y=Math.abs(n[3]-n[1])*i,b=Math.abs(n[2]-n[0])*i):(g=Math.abs(w-n[0])*i+a,v=Math.abs(_-n[1])*i+c,y=Math.abs(n[2]-n[0])*i,b=Math.abs(n[3]-n[1])*i),this.transform=[h*i,p*i,f*i,m*i,g-h*i*w-f*i*_,v-p*i*w-m*i*_],this.width=y,this.height=b}return d(e,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,i=void 0===n?this.scale:n,r=t.rotation,o=void 0===r?this.rotation:r,a=t.dontFlip,s=void 0!==a&&a;return new e({viewBox:this.viewBox.slice(),scale:i,rotation:o,offsetX:this.offsetX,offsetY:this.offsetY,dontFlip:s})}},{key:"convertToViewportPoint",value:function(e,t){return o.Util.applyTransform([e,t],this.transform)}},{key:"convertToViewportRectangle",value:function(e){var t=o.Util.applyTransform([e[0],e[1]],this.transform),n=o.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}},{key:"convertToPdfPoint",value:function(e,t){return o.Util.applyInverseTransform([e,t],this.transform)}}]),e}();t.PageViewport=g;var v=function(){function e(e,t){this.message=e,this.type=t}return e.prototype=new Error,e.prototype.name="RenderingCancelledException",e.constructor=e,e}();t.RenderingCancelledException=v;var y={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};t.LinkTarget=y;var b=["","_self","_blank","_parent","_top"];var w=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];l(this,e),this.enabled=!!t,this.started=Object.create(null),this.times=[]}return d(e,[{key:"time",value:function(e){this.enabled&&(e in this.started&&(0,o.warn)("Timer is already running for "+e),this.started[e]=Date.now())}},{key:"timeEnd",value:function(e){this.enabled&&(e in this.started||(0,o.warn)("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e])}},{key:"toString",value:function(){var e="",t=0,n=!0,i=!1,r=void 0;try{for(var o,a=this.times[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value.name;s.length>t&&(t=s.length)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}var l=!0,c=!1,d=void 0;try{for(var u,h=this.times[Symbol.iterator]();!(l=(u=h.next()).done);l=!0){var p=u.value,f=p.end-p.start;e+="".concat(p.name.padEnd(t)," ").concat(f,"ms\n")}}catch(e){c=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}return e}}]),e}();t.StatTimer=w;var _,S=function(){function e(){l(this,e),(0,o.unreachable)("Cannot initialize DummyStatTimer.")}return d(e,null,[{key:"time",value:function(e){}},{key:"timeEnd",value:function(e){}},{key:"toString",value:function(){return""}}]),e}();function k(){return"undefined"!=typeof fetch&&"undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream}function P(e,t){try{var n=(t?new o.URL(e,t):new o.URL(e)).protocol;return"http:"===n||"https:"===n}catch(e){return!1}}t.DummyStatTimer=S;var C=function(){function e(){l(this,e)}return d(e,null,[{key:"toDateObject",value:function(e){if(!e||!(0,o.isString)(e))return null;_||(_=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));var t=_.exec(e);if(!t)return null;var n=parseInt(t[1],10),i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;var r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;var a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;var s=parseInt(t[5],10);s=s>=0&&s<=59?s:0;var l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;var c=t[7]||"Z",d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;var u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===c?(a+=d,s+=u):"+"===c&&(a-=d,s-=u),new Date(Date.UTC(n,i,r,a,s,l))}}]),e}();t.PDFDateString=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function p(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var f,m=function(){function e(t){var n=t.docId,i=t.onUnsupportedFeature;u(this,e),this.constructor===e&&(0,o.unreachable)("Cannot initialize BaseFontLoader."),this.docId=n,this._onUnsupportedFeature=i,this.nativeFontFaces=[],this.styleElement=null}return p(e,[{key:"addNativeFontFace",value:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)}},{key:"insertRule",value:function(e){var t=this.styleElement;t||((t=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_".concat(this.docId),document.documentElement.getElementsByTagName("head")[0].appendChild(t));var n=t.sheet;n.insertRule(e,n.cssRules.length)}},{key:"clear",value:function(){this.nativeFontFaces.forEach(function(e){document.fonts.delete(e)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:function(){var e,t=(e=r.default.mark(function e(t){var n,i,a=this;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.attached&&!t.missingFile){e.next=2;break}return e.abrupt("return",void 0);case 2:if(t.attached=!0,!this.isFontLoadingAPISupported){e.next=19;break}if(!(n=t.createNativeFontFace())){e.next=18;break}return this.addNativeFontFace(n),e.prev=7,e.next=10,n.loaded;case 10:e.next=18;break;case 12:throw e.prev=12,e.t0=e.catch(7),this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.font}),(0,o.warn)("Failed to load font '".concat(n.family,"': '").concat(e.t0,"'.")),t.disableFontFace=!0,e.t0;case 18:return e.abrupt("return",void 0);case 19:if(!(i=t.createFontFaceRule())){e.next=25;break}if(this.insertRule(i),!this.isSyncFontLoadingSupported){e.next=24;break}return e.abrupt("return",void 0);case 24:return e.abrupt("return",new Promise(function(e){var n=a._queueLoadingCallback(e);a._prepareFontLoadEvent([i],[t],n)}));case 25:return e.abrupt("return",void 0);case 26:case"end":return e.stop()}},e,this,[[7,12]])}),function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(e){d(o,i,r,a,s,"next",e)}function s(e){d(o,i,r,a,s,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}()},{key:"_queueLoadingCallback",value:function(e){(0,o.unreachable)("Abstract method `_queueLoadingCallback`.")}},{key:"_prepareFontLoadEvent",value:function(e,t,n){(0,o.unreachable)("Abstract method `_prepareFontLoadEvent`.")}},{key:"isFontLoadingAPISupported",get:function(){(0,o.unreachable)("Abstract method `isFontLoadingAPISupported`.")}},{key:"isSyncFontLoadingSupported",get:function(){(0,o.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,o.unreachable)("Abstract method `_loadTestFont`.")}}]),e}();t.FontLoader=f,t.FontLoader=f=function(e){function t(e){var n;return u(this,t),(n=s(this,l(t).call(this,e))).loadingContext={requests:[],nextRequestId:0},n.loadTestFontId=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,m),p(t,[{key:"_queueLoadingCallback",value:function(e){var t=this.loadingContext,n={id:"pdfjs-font-loading-".concat(t.nextRequestId++),done:!1,complete:function(){for((0,o.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.requests.length>0&&t.requests[0].done;){var e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(n),n}},{key:"_prepareFontLoadEvent",value:function(e,t,n){function i(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function r(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}var a,s,l=document.createElement("canvas");l.width=1,l.height=1;var c=l.getContext("2d"),d=0;var u="lt".concat(Date.now()).concat(this.loadTestFontId++),h=this._loadTestFont,p=i(h=r(h,976,u.length,u),16);for(a=0,s=u.length-3;a<s;a+=4)p=p-1482184792+i(u,a)|0;a<u.length&&(p=p-1482184792+i(u+"XXX",a)|0),h=r(h,16,4,(0,o.string32)(p));var f="url(data:font/opentype;base64,".concat(btoa(h),");"),m='@font-face {font-family:"'.concat(u,'";src:').concat(f,"}");this.insertRule(m);var g=[];for(a=0,s=t.length;a<s;a++)g.push(t[a].loadedName);g.push(u);var v=document.createElement("div");for(v.setAttribute("style","visibility: hidden;width: 10px; height: 10px;position: absolute; top: 0px; left: 0px;"),a=0,s=g.length;a<s;++a){var y=document.createElement("span");y.textContent="Hi",y.style.fontFamily=g[a],v.appendChild(y)}document.body.appendChild(v),function e(t,n){if(++d>30)return(0,o.warn)("Load test font never loaded."),void n();c.font="30px "+t,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(u,function(){document.body.removeChild(v),n.complete()})}},{key:"isFontLoadingAPISupported",get:function(){var e="undefined"!=typeof document&&!!document.fonts;if(e&&"undefined"!=typeof navigator){var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]<63&&(e=!1)}return(0,o.shadow)(this,"isFontLoadingAPISupported",e)}},{key:"isSyncFontLoadingSupported",get:function(){var e=!1;if("undefined"==typeof navigator)e=!0;else{var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,o.shadow)(this,"isSyncFontLoadingSupported",e)}},{key:"_loadTestFont",get:function(){return(0,o.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}}]),t}();var g={get value(){return(0,o.shadow)(this,"value",(0,o.isEvalSupported)())}},v=function(){function e(t,n){var i=n.isEvalSupported,r=void 0===i||i,o=n.disableFontFace,a=void 0!==o&&o,s=n.ignoreErrors,l=void 0!==s&&s,c=n.onUnsupportedFeature,d=void 0===c?null:c,h=n.fontRegistry,p=void 0===h?null:h;for(var f in u(this,e),this.compiledGlyphs=Object.create(null),t)this[f]=t[f];this.isEvalSupported=!1!==r,this.disableFontFace=!0===a,this.ignoreErrors=!0===l,this._onUnsupportedFeature=d,this.fontRegistry=p}return p(e,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var e=(0,o.bytesToString)(new Uint8Array(this.data)),t="url(data:".concat(this.mimetype,";base64,").concat(btoa(e),");"),n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return this.fontRegistry&&this.fontRegistry.registerFont(this,t),n}},{key:"getPathGenerator",value:function(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];var n,i;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:o.UNSUPPORTED_FEATURES.font}),(0,o.warn)('getPathGenerator - ignoring character: "'.concat(e,'".')),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&g.value){for(var r,a="",s=0,l=n.length;s<l;s++)r=void 0!==(i=n[s]).args?i.args.join(","):"",a+="c."+i.cmd+"("+r+");\n";return this.compiledGlyphs[t]=new Function("c","size",a)}return this.compiledGlyphs[t]=function(e,t){for(var r=0,o=n.length;r<o;r++)"scale"===(i=n[r]).cmd&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}}]),e}();t.FontFaceObject=v},function(e,t,n){"use strict";var i=Object.create(null),r=n(4),o="undefined"!=typeof navigator&&navigator.userAgent||"",a=/Trident/.test(o),s=/CriOS/.test(o);(a||s)&&(i.disableCreateObjectURL=!0),r()&&(i.disableFontFace=!0,i.nativeImageDecoderSupport="none"),t.apiCompatibilityParams=Object.freeze(i)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var i=n(1),r=n(155),o=16,a={get value(){return(0,i.shadow)(a,"value",(0,i.isLittleEndian)())}};function s(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=t*r-n*i,l=n*i-t*r;return[r/s,n/l,i/l,t/s,(r*o-i*a)/l,(n*o-t*a)/s]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,i,r,o,a){var s=this._transformMatrix;this._transformMatrix=[s[0]*t+s[2]*n,s[1]*t+s[3]*n,s[0]*i+s[2]*r,s[1]*i+s[3]*r,s[0]*o+s[2]*a+s[4],s[1]*o+s[3]*a+s[5]],e._originalTransform(t,n,i,r,o,a)},e.setTransform=function(t,n,i,r,o,a){this._transformMatrix=[t,n,i,r,o,a],e._originalSetTransform(t,n,i,r,o,a)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=this._transformMatrix;this._transformMatrix=[i[0]*t+i[2]*n,i[1]*t+i[3]*n,i[0]*-n+i[2]*t,i[1]*-n+i[3]*t,i[4],i[5]],this._originalRotate(e)})}var l=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,i){var r;return void 0!==this.cache[e]?(r=this.cache[e],this.canvasFactory.reset(r,t,n),r.context.setTransform(1,0,0,1,0,0)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),i&&s(r.context),r},clear:function(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}();var c=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),d=function(){function e(e,t,n,i,r,o){this.ctx=e,this.current=new c,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.webGLContext=r,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new l(this.canvasFactory),e&&s(e),this._cachedGetSinglePixelWidth=null}function t(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)e.putImageData(t,0,0);else{var n,r,s,l,c,d=t.height,u=t.width,h=d%o,p=(d-h)/o,f=0===h?p:p+1,m=e.createImageData(u,o),g=0,v=t.data,y=m.data;if(t.kind===i.ImageKind.GRAYSCALE_1BPP){var b=v.byteLength,w=new Uint32Array(y.buffer,0,y.byteLength>>2),_=w.length,S=u+7>>3,k=4294967295,P=a.value?4278190080:255;for(r=0;r<f;r++){for(l=r<p?o:h,n=0,s=0;s<l;s++){for(var C=b-g,T=0,A=C>S?u:8*C-7,I=-8&A,E=0,x=0;T<I;T+=8)x=v[g++],w[n++]=128&x?k:P,w[n++]=64&x?k:P,w[n++]=32&x?k:P,w[n++]=16&x?k:P,w[n++]=8&x?k:P,w[n++]=4&x?k:P,w[n++]=2&x?k:P,w[n++]=1&x?k:P;for(;T<A;T++)0===E&&(x=v[g++],E=128),w[n++]=x&E?k:P,E>>=1}for(;n<_;)w[n++]=0;e.putImageData(m,0,r*o)}}else if(t.kind===i.ImageKind.RGBA_32BPP){for(s=0,c=u*o*4,r=0;r<p;r++)y.set(v.subarray(g,g+c)),g+=c,e.putImageData(m,0,s),s+=o;r<f&&(c=u*h*4,y.set(v.subarray(g,g+c)),e.putImageData(m,0,s))}else{if(t.kind!==i.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(c=u*(l=o),r=0;r<f;r++){for(r>=p&&(c=u*(l=h)),n=0,s=c;s--;)y[n++]=v[g++],y[n++]=v[g++],y[n++]=v[g++],y[n++]=255;e.putImageData(m,0,r*o)}}}}function n(e,t){for(var n=t.height,i=t.width,r=n%o,a=(n-r)/o,s=0===r?a:a+1,l=e.createImageData(i,o),c=0,d=t.data,u=l.data,h=0;h<s;h++){for(var p=h<a?o:r,f=3,m=0;m<p;m++)for(var g=0,v=0;v<i;v++){if(!g){var y=d[c++];g=128}u[f]=y&g?0:255,f+=4,g>>=1}e.putImageData(l,0,h*o)}}function d(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],i=0,r=n.length;i<r;i++){var o=n[i];void 0!==e[o]&&(t[o]=e[o])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function u(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function h(e,t,n,i){for(var r=e.length,o=3;o<r;o+=4){var a=e[o];if(0===a)e[o-3]=t,e[o-2]=n,e[o-1]=i;else if(a<255){var s=255-a;e[o-3]=e[o-3]*a+t*s>>8,e[o-2]=e[o-2]*a+n*s>>8,e[o-1]=e[o-1]*a+i*s>>8}}}function p(e,t,n){for(var i=e.length,r=3;r<i;r+=4){var o=n?n[e[r]]:e[r];t[r]=t[r]*o*(1/255)|0}}function f(e,t,n){for(var i=e.length,r=3;r<i;r+=4){var o=77*e[r-3]+152*e[r-2]+28*e[r-1];t[r]=n?t[r]*n[o>>8]>>8:t[r]*o>>16}}function m(e,t,n,i){var r=t.canvas,o=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var a=t.backdrop||null;if(!t.transferMap&&i.isEnabled){var s=i.composeSMask({layer:n.canvas,mask:r,properties:{subtype:t.subtype,backdrop:a}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(s,t.offsetX,t.offsetY)}!function(e,t,n,i,r,o,a){var s,l=!!o,c=l?o[0]:0,d=l?o[1]:0,u=l?o[2]:0;s="Luminosity"===r?f:p;for(var m=Math.min(i,Math.ceil(1048576/n)),g=0;g<i;g+=m){var v=Math.min(m,i-g),y=e.getImageData(0,g,n,v),b=t.getImageData(0,g,n,v);l&&h(y.data,c,d,u),s(y.data,b.data,a),e.putImageData(b,0,g)}}(o,n,r.width,r.height,t.subtype,a,t.transferMap),e.drawImage(r,0,0)}var g=["butt","round","square"],v=["miter","round","bevel"],y={},b={};for(var w in e.prototype={beginDrawing:function(e){var t=e.transform,n=e.viewport,i=e.transparency,r=void 0!==i&&i,o=e.background,a=void 0===o?null:o,s=this.ctx.canvas.width,l=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=a||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,s,l),this.ctx.restore(),r){var c=this.cachedCanvases.getCanvas("transparent",s,l,!0);this.compositeCtx=this.ctx,this.transparentCanvas=c.canvas,this.ctx=c.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),u(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,n.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,r){var o=e.argsArray,a=e.fnArray,s=t||0,l=o.length;if(l===s)return s;for(var c,d=l-s>10&&"function"==typeof n,u=d?Date.now()+15:0,h=0,p=this.commonObjs,f=this.objs;;){if(void 0!==r&&s===r.nextBreakPoint)return r.breakIt(s,n),s;if((c=a[s])!==i.OPS.dependency)this[c].apply(this,o[s]);else{var m=!0,g=!1,v=void 0;try{for(var y,b=o[s][Symbol.iterator]();!(m=(y=b.next()).done);m=!0){var w=y.value,_=w.startsWith("g_")?p:f;if(!_.has(w))return _.get(w,n),s}}catch(e){g=!0,v=e}finally{try{m||null==b.return||b.return()}finally{if(g)throw v}}}if(++s===l)return s;if(d&&++h>10){if(Date.now()>u)return n(),s;h=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=g[e]},setLineJoin:function(e){this.ctx.lineJoin=v[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)},setRenderingIntent:function(e){},setFlatness:function(e){},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],r=i[0],o=i[1];switch(r){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=o;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,n,!0),o=this.ctx,a=o.mozCurrentTransform;this.ctx.save();var s=r.context;s.scale(1/e.scaleX,1/e.scaleY),s.translate(-e.offsetX,-e.offsetY),s.transform.apply(s,a),e.startTransformInverse=s.mozCurrentTransformInverse,d(o,s),this.ctx=s,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),d(e,this.ctx),this.current.resumeSMaskCtx=e;var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),d(e,this.ctx);var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,n,i,r,o){this.ctx.transform(e,t,n,i,r,o),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,r=this.current,o=r.x,a=r.y,s=0,l=0,c=e.length;s<c;s++)switch(0|e[s]){case i.OPS.rectangle:o=t[l++],a=t[l++];var d=t[l++],u=t[l++];0===d&&(d=this.getSinglePixelWidth()),0===u&&(u=this.getSinglePixelWidth());var h=o+d,p=a+u;this.ctx.moveTo(o,a),this.ctx.lineTo(h,a),this.ctx.lineTo(h,p),this.ctx.lineTo(o,p),this.ctx.lineTo(o,a),this.ctx.closePath();break;case i.OPS.moveTo:o=t[l++],a=t[l++],n.moveTo(o,a);break;case i.OPS.lineTo:o=t[l++],a=t[l++],n.lineTo(o,a);break;case i.OPS.curveTo:o=t[l+4],a=t[l+5],n.bezierCurveTo(t[l],t[l+1],t[l+2],t[l+3],o,a),l+=6;break;case i.OPS.curveTo2:n.bezierCurveTo(o,a,t[l],t[l+1],t[l+2],t[l+3]),o=t[l+2],a=t[l+3],l+=4;break;case i.OPS.curveTo3:o=t[l+2],a=t[l+3],n.bezierCurveTo(t[l],t[l+1],o,a,o,a),l+=4;break;case i.OPS.closePath:n.closePath()}r.setCurrentPoint(o,a)},closePath:function(){this.ctx.closePath()},stroke:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.strokeColor;t.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth),t.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type?(t.save(),t.strokeStyle=n.getPattern(t,this),t.stroke(),t.restore()):t.stroke(),e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.fillColor,i=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),i=!0),this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill(),i&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=y},eoClip:function(){this.pendingClip=b},beginText:function(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.setTransform.apply(t,i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error("Can't find font for ".concat(e));if(r.fontMatrix=n.fontMatrix?n.fontMatrix:i.FONT_IDENTITY_MATRIX,0!==r.fontMatrix[0]&&0!==r.fontMatrix[3]||(0,i.warn)("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,!n.isType3Font){var o=n.loadedName||"sans-serif",a=n.black?"900":n.bold?"bold":"normal",s=n.italic?"italic":"normal",l='"'.concat(o,'", ').concat(n.fallbackName),c=t<16?16:t>100?100:t;this.current.fontSizeScale=t/c,this.ctx.font="".concat(s," ").concat(a," ").concat(c,"px ").concat(l)}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,i,r,o){this.current.textMatrix=[e,t,n,i,r,o],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,n,r){var o,a=this.ctx,s=this.current,l=s.font,c=s.textRenderingMode,d=s.fontSize/s.fontSizeScale,u=c&i.TextRenderingMode.FILL_STROKE_MASK,h=!!(c&i.TextRenderingMode.ADD_TO_PATH_FLAG),p=s.patternFill&&l.data;((l.disableFontFace||h||p)&&(o=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p?(a.save(),a.translate(t,n),a.beginPath(),o(a,d),r&&a.setTransform.apply(a,r),u!==i.TextRenderingMode.FILL&&u!==i.TextRenderingMode.FILL_STROKE||a.fill(),u!==i.TextRenderingMode.STROKE&&u!==i.TextRenderingMode.FILL_STROKE||a.stroke(),a.restore()):(u!==i.TextRenderingMode.FILL&&u!==i.TextRenderingMode.FILL_STROKE||a.fillText(e,t,n),u!==i.TextRenderingMode.STROKE&&u!==i.TextRenderingMode.FILL_STROKE||a.strokeText(e,t,n)),h)&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:a.mozCurrentTransform,x:t,y:n,fontSize:d,addToPath:o})},get isFontSubpixelAAEnabled(){var e=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10).context;e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);var r=t.fontSize;if(0!==r){var o,a=this.ctx,s=t.fontSizeScale,l=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,u=t.textHScale*d,h=e.length,p=n.vertical,f=p?1:-1,m=n.defaultVMetrics,g=r*t.fontMatrix[0],v=t.textRenderingMode===i.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;if(a.save(),t.patternFill){a.save();var y=t.fillColor.getPattern(a,this);o=a.mozCurrentTransform,a.restore(),a.fillStyle=y}a.transform.apply(a,t.textMatrix),a.translate(t.x,t.y+t.textRise),d>0?a.scale(u,-1):a.scale(u,1);var b=t.lineWidth,w=t.textMatrixScale;if(0===w||0===b){var _=t.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;_!==i.TextRenderingMode.STROKE&&_!==i.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,b=.65*this.getSinglePixelWidth())}else b/=w;1!==s&&(a.scale(s,s),b/=s),a.lineWidth=b;var S,k=0;for(S=0;S<h;++S){var P=e[S];if((0,i.isNum)(P))k+=f*P*r/1e3;else{var C,T,A,I,E,x,R,D=!1,L=(P.isSpace?c:0)+l,M=P.fontChar,W=P.accent,N=P.width;if(p)E=P.vmetric||m,x=-(x=P.vmetric?E[1]:.5*N)*g,R=E[2]*g,N=E?-E[0]:N,C=x/s,T=(k+R)/s;else C=k/s,T=0;if(n.remeasure&&N>0){var O=1e3*a.measureText(M).width/r*s;if(N<O&&this.isFontSubpixelAAEnabled){var F=N/O;D=!0,a.save(),a.scale(F,1),C/=F}else N!==O&&(C+=(N-O)/2e3*r/s)}(P.isInFont||n.missingFile)&&(v&&!W?a.fillText(M,C,T):(this.paintChar(M,C,T,o),W&&(A=C+W.offset.x/s,I=T-W.offset.y/s,this.paintChar(W.fontChar,A,I,o)))),k+=N*g+L*d,D&&a.restore()}}p?t.y-=k*u:t.x+=k*u,a.restore()}},showType3Text:function(e){var t,n,r,o,a=this.ctx,s=this.current,l=s.font,c=s.fontSize,d=s.fontDirection,u=l.vertical?1:-1,h=s.charSpacing,p=s.wordSpacing,f=s.textHScale*d,m=s.fontMatrix||i.FONT_IDENTITY_MATRIX,g=e.length;if(!(s.textRenderingMode===i.TextRenderingMode.INVISIBLE)&&0!==c){for(this._cachedGetSinglePixelWidth=null,a.save(),a.transform.apply(a,s.textMatrix),a.translate(s.x,s.y),a.scale(f,d),t=0;t<g;++t)if(n=e[t],(0,i.isNum)(n))o=u*n*c/1e3,this.ctx.translate(o,0),s.x+=o*f;else{var v=(n.isSpace?p:0)+h,y=l.charProcOperatorList[n.operatorListId];if(y)this.processingType3=n,this.save(),a.scale(c,c),a.transform.apply(a,m),this.executeOperatorList(y),this.restore(),r=i.Util.applyTransform([n.width,0],m)[0]*c+v,a.translate(r,0),s.x+=r*f;else(0,i.warn)('Type3 character "'.concat(n.operatorListId,'" is not available.'))}a.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,n,i,r,o){this.ctx.rect(n,i,r-n,o-i),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n,i=this;if("TilingPattern"===t[0]){var o=t[1],a=this.baseTransform||this.ctx.mozCurrentTransform.slice(),s={createCanvasGraphics:function(t){return new e(t,i.commonObjs,i.objs,i.canvasFactory,i.webGLContext)}};n=new r.TilingPattern(t,o,this.ctx,s,a)}else n=(0,r.getShadingPatternFromIR)(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var r=i.Util.makeCssRgb(e,t,n);this.ctx.strokeStyle=r,this.current.strokeColor=r},setFillRGBColor:function(e,t,n){var r=i.Util.makeCssRgb(e,t,n);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var n=(0,r.getShadingPatternFromIR)(e);t.fillStyle=n.getPattern(t,this,!0);var o=t.mozCurrentTransformInverse;if(o){var a=t.canvas,s=a.width,l=a.height,c=i.Util.applyTransform([0,0],o),d=i.Util.applyTransform([0,l],o),u=i.Util.applyTransform([s,0],o),h=i.Util.applyTransform([s,l],o),p=Math.min(c[0],d[0],u[0],h[0]),f=Math.min(c[1],d[1],u[1],h[1]),m=Math.max(c[0],d[0],u[0],h[0]),g=Math.max(c[1],d[1],u[1],h[1]);this.ctx.fillRect(p,f,m-p,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,i.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,i.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,t){var n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(e){this.save();var t=this.ctx;e.isolated||(0,i.info)("TODO: Support non-isolated groups."),e.knockout&&(0,i.warn)("Knockout groups not supported.");var n=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var r=i.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),o=[0,0,t.canvas.width,t.canvas.height];r=i.Util.intersect(r,o)||[0,0,0,0];var a=Math.floor(r[0]),s=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-a,1),c=Math.max(Math.ceil(r[3])-s,1),u=1,h=1;l>4096&&(u=l/4096,l=4096),c>4096&&(h=c/4096,c=4096);var p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);var f=this.cachedCanvases.getCanvas(p,l,c,!0),m=f.context;m.scale(1/u,1/h),m.translate(-a,-s),m.transform.apply(m,n),e.smask?this.smaskStack.push({canvas:f.canvas,context:m,offsetX:a,offsetY:s,scaleX:u,scaleY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(a,s),t.scale(u,h)),d(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),u(this.ctx),this.current=new c,Array.isArray(e)&&4===e.length){var i=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],i,r),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,t,n){var r=this.processingType3?this.commonObjs.get(e):this.objs.get(e);if(r){this.save();var o=this.ctx;if(o.scale(1/t,-1/n),o.drawImage(r,0,0,r.width,r.height,0,-n,t,n),this.imageLayer){var a=o.mozCurrentTransformInverse,s=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:s[0],top:s[1],width:t/a[0],height:n/a[3]})}this.restore()}else(0,i.warn)("Dependent image isn't ready yet")},paintImageMaskXObject:function(e){var t=this.ctx,i=e.width,r=e.height,o=this.current.fillColor,a=this.current.patternFill,s=this.processingType3;if(s&&void 0===s.compiled&&(s.compiled=i<=1e3&&r<=1e3?function(e){var t,n,i,r,o=e.width,a=e.height,s=o+1,l=new Uint8Array(s*(a+1)),c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),d=o+7&-8,u=e.data,h=new Uint8Array(d*a),p=0;for(t=0,r=u.length;t<r;t++)for(var f=128,m=u[t];f>0;)h[p++]=m&f?0:255,f>>=1;var g=0;for(0!==h[p=0]&&(l[0]=1,++g),n=1;n<o;n++)h[p]!==h[p+1]&&(l[n]=h[p]?2:1,++g),p++;for(0!==h[p]&&(l[n]=2,++g),t=1;t<a;t++){i=t*s,h[(p=t*d)-d]!==h[p]&&(l[i]=h[p]?1:8,++g);var v=(h[p]?4:0)+(h[p-d]?8:0);for(n=1;n<o;n++)c[v=(v>>2)+(h[p+1]?4:0)+(h[p-d+1]?8:0)]&&(l[i+n]=c[v],++g),p++;if(h[p-d]!==h[p]&&(l[i+n]=h[p]?2:4,++g),g>1e3)return null}for(i=t*s,0!==h[p=d*(a-1)]&&(l[i]=8,++g),n=1;n<o;n++)h[p]!==h[p+1]&&(l[i+n]=h[p]?4:8,++g),p++;if(0!==h[p]&&(l[i+n]=4,++g),g>1e3)return null;var y=new Int32Array([0,s,-1,0,-s,0,0,0,1]),b=[];for(t=0;g&&t<=a;t++){for(var w=t*s,_=w+o;w<_&&!l[w];)w++;if(w!==_){var S,k=[w%s,t],P=l[w],C=w;do{var T=y[P];do{w+=T}while(!l[w]);5!==(S=l[w])&&10!==S?(P=S,l[w]=0):(P=S&51*P>>4,l[w]&=P>>2|P<<2),k.push(w%s),k.push(w/s|0),l[w]||--g}while(C!==w);b.push(k),--t}}return function(e){e.save(),e.scale(1/o,-1/a),e.translate(0,-a),e.beginPath();for(var t=0,n=b.length;t<n;t++){var i=b[t];e.moveTo(i[0],i[1]);for(var r=2,s=i.length;r<s;r+=2)e.lineTo(i[r],i[r+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:i,height:r}):null),s&&s.compiled)s.compiled(t);else{var l=this.cachedCanvases.getCanvas("maskCanvas",i,r),c=l.context;c.save(),n(c,e),c.globalCompositeOperation="source-in",c.fillStyle=a?o.getPattern(c,this):o,c.fillRect(0,0,i,r),c.restore(),this.paintInlineImageXObject(l.canvas)}},paintImageMaskXObjectRepeat:function(e,t,i,r){var o=e.width,a=e.height,s=this.current.fillColor,l=this.current.patternFill,c=this.cachedCanvases.getCanvas("maskCanvas",o,a),d=c.context;d.save(),n(d,e),d.globalCompositeOperation="source-in",d.fillStyle=l?s.getPattern(d,this):s,d.fillRect(0,0,o,a),d.restore();for(var u=this.ctx,h=0,p=r.length;h<p;h+=2)u.save(),u.transform(t,0,0,i,r[h],r[h+1]),u.scale(1,-1),u.drawImage(c.canvas,0,0,o,a,0,-1,1,1),u.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,i=this.current.fillColor,r=this.current.patternFill,o=0,a=e.length;o<a;o++){var s=e[o],l=s.width,c=s.height,d=this.cachedCanvases.getCanvas("maskCanvas",l,c),u=d.context;u.save(),n(u,s),u.globalCompositeOperation="source-in",u.fillStyle=r?i.getPattern(u,this):i,u.fillRect(0,0,l,c),u.restore(),t.save(),t.transform.apply(t,s.transform),t.scale(1,-1),t.drawImage(d.canvas,0,0,l,c,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var t=this.processingType3?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,i.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,r){var o=this.processingType3?this.commonObjs.get(e):this.objs.get(e);if(o){for(var a=o.width,s=o.height,l=[],c=0,d=r.length;c<d;c+=2)l.push({transform:[t,0,0,n,r[c],r[c+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(o,l)}else(0,i.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){var n=e.width,i=e.height,r=this.ctx;this.save(),r.scale(1/n,-1/i);var o,a,s=r.mozCurrentTransformInverse,l=s[0],c=s[1],d=Math.max(Math.sqrt(l*l+c*c),1),u=s[2],h=s[3],p=Math.max(Math.sqrt(u*u+h*h),1);if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)o=e;else{var f=(a=this.cachedCanvases.getCanvas("inlineImage",n,i)).context;t(f,e),o=a.canvas}for(var m=n,g=i,v="prescale1";d>2&&m>1||p>2&&g>1;){var y=m,b=g;d>2&&m>1&&(d/=m/(y=Math.ceil(m/2))),p>2&&g>1&&(p/=g/(b=Math.ceil(g/2))),(f=(a=this.cachedCanvases.getCanvas(v,y,b)).context).clearRect(0,0,y,b),f.drawImage(o,0,0,m,g,0,0,y,b),o=a.canvas,m=y,g=b,v="prescale1"===v?"prescale2":"prescale1"}if(r.drawImage(o,0,0,m,g,0,-i,n,i),this.imageLayer){var w=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:e,left:w[0],top:w[1],width:n/s[0],height:i/s[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,n){var i=this.ctx,r=e.width,o=e.height,a=this.cachedCanvases.getCanvas("inlineImage",r,o);t(a.context,e);for(var s=0,l=n.length;s<l;s++){var c=n[s];if(i.save(),i.transform.apply(i,c.transform),i.scale(1,-1),i.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,-1,1,1),this.imageLayer){var d=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:e,left:d[0],top:d[1],width:r,height:o})}i.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){(0,i.warn)("Unsupported 'paintXObject' command.")},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){},beginMarkedContentProps:function(e,t){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===b?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth:function(e){if(null===this._cachedGetSinglePixelWidth){var t=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1],t[2]*t[2]+t[3]*t[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]}},i.OPS)e.prototype[i.OPS[w]]=e.prototype[w];return e}();t.CanvasGraphics=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShadingPatternFromIR=function(e){var t=r[e[0]];if(!t)throw new Error("Unknown IR type: ".concat(e[0]));return t.fromIR(e)},t.TilingPattern=void 0;var i=n(1),r={RadialAxial:{fromIR:function(e){var t=e[1],n=e[2],i=e[3],r=e[4],o=e[5],a=e[6];return{type:"Pattern",getPattern:function(e){var s;"axial"===t?s=e.createLinearGradient(i[0],i[1],r[0],r[1]):"radial"===t&&(s=e.createRadialGradient(i[0],i[1],o,r[0],r[1],a));for(var l=0,c=n.length;l<c;++l){var d=n[l];s.addColorStop(d[0],d[1])}return s}}}}},o=function(){function e(e,t,n,i,r,o,a,s){var l,c=t.coords,d=t.colors,u=e.data,h=4*e.width;c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=o,o=a,a=l),c[i+1]>c[r+1]&&(l=i,i=r,r=l,l=a,a=s,s=l),c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=o,o=a,a=l);var p=(c[n]+t.offsetX)*t.scaleX,f=(c[n+1]+t.offsetY)*t.scaleY,m=(c[i]+t.offsetX)*t.scaleX,g=(c[i+1]+t.offsetY)*t.scaleY,v=(c[r]+t.offsetX)*t.scaleX,y=(c[r+1]+t.offsetY)*t.scaleY;if(!(f>=y))for(var b,w,_,S,k,P,C,T,A,I=d[o],E=d[o+1],x=d[o+2],R=d[a],D=d[a+1],L=d[a+2],M=d[s],W=d[s+1],N=d[s+2],O=Math.round(f),F=Math.round(y),B=O;B<=F;B++){B<g?(b=p-(p-m)*(A=B<f?0:f===g?1:(f-B)/(f-g)),w=I-(I-R)*A,_=E-(E-D)*A,S=x-(x-L)*A):(b=m-(m-v)*(A=B>y?1:g===y?0:(g-B)/(g-y)),w=R-(R-M)*A,_=D-(D-W)*A,S=L-(L-N)*A),k=p-(p-v)*(A=B<f?0:B>y?1:(f-B)/(f-y)),P=I-(I-M)*A,C=E-(E-W)*A,T=x-(x-N)*A;for(var j=Math.round(Math.min(b,k)),V=Math.round(Math.max(b,k)),U=h*B+4*j,z=j;z<=V;z++)A=(A=(b-z)/(b-k))<0?0:A>1?1:A,u[U++]=w-(w-P)*A|0,u[U++]=_-(_-C)*A|0,u[U++]=S-(S-T)*A|0,u[U++]=255}}function t(t,n,i){var r,o,a=n.coords,s=n.colors;switch(n.type){case"lattice":var l=n.verticesPerRow,c=Math.floor(a.length/l)-1,d=l-1;for(r=0;r<c;r++)for(var u=r*l,h=0;h<d;h++,u++)e(t,i,a[u],a[u+1],a[u+l],s[u],s[u+1],s[u+l]),e(t,i,a[u+l+1],a[u+1],a[u+l],s[u+l+1],s[u+1],s[u+l]);break;case"triangles":for(r=0,o=a.length;r<o;r+=3)e(t,i,a[r],a[r+1],a[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}return function(e,n,i,r,o,a,s,l){var c,d,u,h,p=Math.floor(e[0]),f=Math.floor(e[1]),m=Math.ceil(e[2])-p,g=Math.ceil(e[3])-f,v=Math.min(Math.ceil(Math.abs(m*n[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(g*n[1]*1.1)),3e3),b=m/v,w=g/y,_={coords:i,colors:r,offsetX:-p,offsetY:-f,scaleX:1/b,scaleY:1/w},S=v+4,k=y+4;if(l.isEnabled)c=l.drawFigures({width:v,height:y,backgroundColor:a,figures:o,context:_}),(d=s.getCanvas("mesh",S,k,!1)).context.drawImage(c,2,2),c=d.canvas;else{var P=(d=s.getCanvas("mesh",S,k,!1)).context,C=P.createImageData(v,y);if(a){var T=C.data;for(u=0,h=T.length;u<h;u+=4)T[u]=a[0],T[u+1]=a[1],T[u+2]=a[2],T[u+3]=255}for(u=0;u<o.length;u++)t(C,o[u],_);P.putImageData(C,2,2),c=d.canvas}return{canvas:c,offsetX:p-2*b,offsetY:f-2*w,scaleX:b,scaleY:w}}}();r.Mesh={fromIR:function(e){var t=e[2],n=e[3],r=e[4],a=e[5],s=e[6],l=e[8];return{type:"Pattern",getPattern:function(e,c,d){var u;if(d)u=i.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(u=i.Util.singularValueDecompose2dScale(c.baseTransform),s){var h=i.Util.singularValueDecompose2dScale(s);u=[u[0]*h[0],u[1]*h[1]]}var p=o(a,u,t,n,r,d?null:l,c.cachedCanvases,c.webGLContext);return d||(e.setTransform.apply(e,c.baseTransform),s&&e.transform.apply(e,s)),e.translate(p.offsetX,p.offsetY),e.scale(p.scaleX,p.scaleY),e.createPattern(p.canvas,"no-repeat")}}}},r.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var a=function(){var e=1,t=2;function n(e,t,n,i,r){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=i,this.baseTransform=r,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(e){var t=this.operatorList,n=this.bbox,r=this.xstep,o=this.ystep,a=this.paintType,s=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+s);var d=n[0],u=n[1],h=n[2],p=n[3],f=i.Util.singularValueDecompose2dScale(this.matrix),m=i.Util.singularValueDecompose2dScale(this.baseTransform),g=[f[0]*m[0],f[1]*m[1]],v=this.getSizeAndScale(r,this.ctx.canvas.width,g[0]),y=this.getSizeAndScale(o,this.ctx.canvas.height,g[1]),b=e.cachedCanvases.getCanvas("pattern",v.size,y.size,!0),w=b.context,_=c.createCanvasGraphics(w);return _.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(_,a,l),_.transform(v.scale,0,0,y.scale,0,0),_.transform(1,0,0,1,-d,-u),this.clipBbox(_,n,d,u,h,p),_.executeOperatorList(t),this.ctx.transform(1,0,0,1,d,u),this.ctx.scale(1/v.scale,1/y.scale),b.canvas},getSizeAndScale:function(e,t,n){e=Math.abs(e);var i=Math.max(3e3,t),r=Math.ceil(e*n);return r>=i?r=i:n=r/e,{scale:n,size:r}},clipBbox:function(e,t,n,i,r,o){if(Array.isArray(t)&&4===t.length){var a=r-n,s=o-i;e.ctx.rect(n,i,a,s),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(n,r,o){var a=n.ctx,s=n.current;switch(r){case e:var l=this.ctx;a.fillStyle=l.fillStyle,a.strokeStyle=l.strokeStyle,s.fillColor=l.fillStyle,s.strokeColor=l.strokeStyle;break;case t:var c=i.Util.makeCssRgb(o[0],o[1],o[2]);a.fillStyle=c,a.strokeStyle=c,s.fillColor=c,s.strokeColor=c;break;default:throw new i.FormatError("Unsupported paint type: ".concat(r))}},getPattern:function(e,t){(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix);var n=this.createPatternCanvas(t);return e.createPattern(n,"repeat")}},n}();t.TilingPattern=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;var i=Object.create(null);t.GlobalWorkerOptions=i,i.workerPort=void 0===i.workerPort?null:i.workerPort,i.workerSrc=void 0===i.workerSrc?"":i.workerSrc},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=p;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function l(e,t){return c.apply(this,arguments)}function c(){var e;return e=r.default.mark(function e(t,n){var i,o=arguments;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.length>2&&void 0!==o[2]?o[2]:null,t){e.next=3;break}return e.abrupt("return",void 0);case 3:return e.abrupt("return",t.apply(i,n));case 4:case"end":return e.stop()}},e)}),(c=function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(e){s(o,i,r,a,l,"next",e)}function l(e){s(o,i,r,a,l,"throw",e)}a(void 0)})}).apply(this,arguments)}function d(e){if("object"!==a(e))return e;switch(e.name){case"AbortException":return new o.AbortException(e.message);case"MissingPDFException":return new o.MissingPDFException(e.message);case"UnexpectedResponseException":return new o.UnexpectedResponseException(e.message,e.status);default:return new o.UnknownErrorException(e.message,e.details)}}function u(e){return!(e instanceof Error)||e instanceof o.AbortException||e instanceof o.MissingPDFException||e instanceof o.UnexpectedResponseException||e instanceof o.UnknownErrorException?e:new o.UnknownErrorException(e.message,e.toString())}function h(e,t,n){t?e.resolve():e.reject(n)}function p(e,t,n){var i=this;this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null);var r=this.callbacksCapabilities=Object.create(null),o=this.actionHandler=Object.create(null);this._onComObjOnMessage=function(e){var t=e.data;if(t.targetName===i.sourceName)if(t.stream)i._processStreamMessage(t);else if(t.isReply){var a=t.callbackId;if(!(t.callbackId in r))throw new Error("Cannot resolve callback ".concat(a));var s=r[a];delete r[a],"error"in t?s.reject(d(t.error)):s.resolve(t.data)}else{if(!(t.action in o))throw new Error("Unknown action from worker: ".concat(t.action));var l=o[t.action];if(t.callbackId){var c=i.sourceName,h=t.sourceName;Promise.resolve().then(function(){return l[0].call(l[1],t.data)}).then(function(e){n.postMessage({sourceName:c,targetName:h,isReply:!0,callbackId:t.callbackId,data:e})},function(e){n.postMessage({sourceName:c,targetName:h,isReply:!0,callbackId:t.callbackId,error:u(e)})})}else t.streamId?i._createStreamSink(t):l[0].call(l[1],t.data)}},n.addEventListener("message",this._onComObjOnMessage)}p.prototype={on:function(e,t,n){var i=this.actionHandler;if(i[e])throw new Error('There is already an actionName called "'.concat(e,'"'));i[e]=[t,n]},send:function(e,t,n){var i={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t};this.postMessage(i,n)},sendWithPromise:function(e,t,n){var i=this.callbackId++,r={sourceName:this.sourceName,targetName:this.targetName,action:e,data:t,callbackId:i},a=(0,o.createPromiseCapability)();this.callbacksCapabilities[i]=a;try{this.postMessage(r,n)}catch(e){a.reject(e)}return a.promise},sendWithStream:function(e,t,n,i){var r=this,a=this.streamId++,s=this.sourceName,l=this.targetName;return new o.ReadableStream({start:function(n){var i=(0,o.createPromiseCapability)();return r.streamControllers[a]={controller:n,startCall:i,isClosed:!1},r.postMessage({sourceName:s,targetName:l,action:e,streamId:a,data:t,desiredSize:n.desiredSize}),i.promise},pull:function(e){var t=(0,o.createPromiseCapability)();return r.streamControllers[a].pullCall=t,r.postMessage({sourceName:s,targetName:l,stream:"pull",streamId:a,desiredSize:e.desiredSize}),t.promise},cancel:function(e){var t=(0,o.createPromiseCapability)();return r.streamControllers[a].cancelCall=t,r.streamControllers[a].isClosed=!0,r.postMessage({sourceName:s,targetName:l,stream:"cancel",reason:e,streamId:a}),t.promise}},n)},_createStreamSink:function(e){var t=this,n=this,i=this.actionHandler[e.action],r=e.streamId,a=e.desiredSize,s=this.sourceName,c=e.sourceName,d=(0,o.createPromiseCapability)(),u=function(e){var n=e.stream,i=e.chunk,o=e.transfers,a=e.success,l=e.reason;t.postMessage({sourceName:s,targetName:c,stream:n,streamId:r,chunk:i,success:a,reason:l},o)},h={enqueue:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(!this.isCancelled){var i=this.desiredSize;this.desiredSize-=t,i>0&&this.desiredSize<=0&&(this.sinkCapability=(0,o.createPromiseCapability)(),this.ready=this.sinkCapability.promise),u({stream:"enqueue",chunk:e,transfers:n})}},close:function(){this.isCancelled||(this.isCancelled=!0,u({stream:"close"}),delete n.streamSinks[r])},error:function(e){this.isCancelled||(this.isCancelled=!0,u({stream:"error",reason:e}))},sinkCapability:d,onPull:null,onCancel:null,isCancelled:!1,desiredSize:a,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[r]=h,l(i[0],[e.data,h],i[1]).then(function(){u({stream:"start_complete",success:!0})},function(e){u({stream:"start_complete",success:!1,reason:e})})},_processStreamMessage:function(e){var t=this,n=this.sourceName,i=e.sourceName,r=e.streamId,a=function(e){var o=e.stream,a=e.success,s=e.reason;t.comObj.postMessage({sourceName:n,targetName:i,stream:o,success:a,streamId:r,reason:s})},s=function(){Promise.all([t.streamControllers[e.streamId].startCall,t.streamControllers[e.streamId].pullCall,t.streamControllers[e.streamId].cancelCall].map(function(e){return e&&(t=e.promise,Promise.resolve(t).catch(function(){}));var t})).then(function(){delete t.streamControllers[e.streamId]})};switch(e.stream){case"start_complete":h(this.streamControllers[e.streamId].startCall,e.success,d(e.reason));break;case"pull_complete":h(this.streamControllers[e.streamId].pullCall,e.success,d(e.reason));break;case"pull":if(!this.streamSinks[e.streamId]){a({stream:"pull_complete",success:!0});break}this.streamSinks[e.streamId].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[e.streamId].sinkCapability.resolve(),this.streamSinks[e.streamId].desiredSize=e.desiredSize,l(this.streamSinks[e.streamId].onPull).then(function(){a({stream:"pull_complete",success:!0})},function(e){a({stream:"pull_complete",success:!1,reason:e})});break;case"enqueue":(0,o.assert)(this.streamControllers[e.streamId],"enqueue should have stream controller"),this.streamControllers[e.streamId].isClosed||this.streamControllers[e.streamId].controller.enqueue(e.chunk);break;case"close":if((0,o.assert)(this.streamControllers[e.streamId],"close should have stream controller"),this.streamControllers[e.streamId].isClosed)break;this.streamControllers[e.streamId].isClosed=!0,this.streamControllers[e.streamId].controller.close(),s();break;case"error":(0,o.assert)(this.streamControllers[e.streamId],"error should have stream controller"),this.streamControllers[e.streamId].controller.error(d(e.reason)),s();break;case"cancel_complete":h(this.streamControllers[e.streamId].cancelCall,e.success,d(e.reason)),s();break;case"cancel":if(!this.streamSinks[e.streamId])break;l(this.streamSinks[e.streamId].onCancel,[d(e.reason)]).then(function(){a({stream:"cancel_complete",success:!0})},function(e){a({stream:"cancel_complete",success:!1,reason:e})}),this.streamSinks[e.streamId].sinkCapability.reject(d(e.reason)),this.streamSinks[e.streamId].isCancelled=!0,delete this.streamSinks[e.streamId];break;default:throw new Error("Unexpected stream case")}},postMessage:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)},destroy:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=n(1),r=n(159);function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,i.assert)("string"==typeof t,"Metadata: input is not a string"),t=this._repair(t);var n=(new r.SimpleXMLParser).parseFromString(t);this._metadata=Object.create(null),n&&this._parse(n)}var t,n,a;return t=e,(n=[{key:"_repair",value:function(e){return e.replace(/^([^<]+)/,"").replace(/>\\376\\377([^<]+)/g,function(e,t){for(var n=t.replace(/\\([0-3])([0-7])([0-7])/g,function(e,t,n,i){return String.fromCharCode(64*t+8*n+1*i)}).replace(/&(amp|apos|gt|lt|quot);/g,function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error("_repair: ".concat(t," isn't defined."))}),i="",r=0,o=n.length;r<o;r+=2){var a=256*n.charCodeAt(r)+n.charCodeAt(r+1);i+=a>=32&&a<127&&60!==a&&62!==a&&38!==a?String.fromCharCode(a):"&#x"+(65536+a).toString(16).substring(1)+";"}return">"+i})}},{key:"_parse",value:function(e){var t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var n=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===n&&t.hasChildNodes())for(var i=t.childNodes,r=0,o=i.length;r<o;r++){var a=i[r];if("rdf:description"===a.nodeName.toLowerCase())for(var s=0,l=a.childNodes.length;s<l;s++)if("#text"!==a.childNodes[s].nodeName.toLowerCase()){var c=a.childNodes[s],d=c.nodeName.toLowerCase();this._metadata[d]=c.textContent.trim()}}}},{key:"get",value:function(e){var t=this._metadata[e];return void 0!==t?t:null}},{key:"getAll",value:function(){return this._metadata}},{key:"has",value:function(e){return void 0!==this._metadata[e]}}])&&o(t.prototype,n),a&&o(t,a),e}();t.Metadata=a},function(e,t,n){"use strict";function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=void 0;var h={NoError:0,EndOfDocument:-1,UnterminatedCdat:-2,UnterminatedXmlDeclaration:-3,UnterminatedDoctypeDeclaration:-4,UnterminatedComment:-5,MalformedElement:-6,OutOfMemory:-7,UnterminatedAttributeValue:-8,UnterminatedElement:-9,ElementNeverBegun:-10};function p(e,t){var n=e[t];return" "===n||"\n"===n||"\r"===n||"\t"===n}var f=function(){function e(){c(this,e)}return u(e,[{key:"_resolveEntities",value:function(e){var t=this;return e.replace(/&([^;]+);/g,function(e,n){if("#x"===n.substring(0,2))return String.fromCharCode(parseInt(n.substring(2),16));if("#"===n.substring(0,1))return String.fromCharCode(parseInt(n.substring(1),10));switch(n){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return t.onResolveEntity(n)})}},{key:"_parseContent",value:function(e,t){var n,i=t,r=[];function o(){for(;i<e.length&&p(e,i);)++i}for(;i<e.length&&!p(e,i)&&">"!==e[i]&&"/"!==e[i];)++i;for(n=e.substring(t,i),o();i<e.length&&">"!==e[i]&&"/"!==e[i]&&"?"!==e[i];){o();for(var a,s="";i<e.length&&!p(e,i)&&"="!==e[i];)s+=e[i],++i;if(o(),"="!==e[i])return null;++i,o();var l=e[i];if('"'!==l&&"'"!==l)return null;var c=e.indexOf(l,++i);if(c<0)return null;a=e.substring(i,c),r.push({name:s,value:this._resolveEntities(a)}),i=c+1,o()}return{name:n,attributes:r,parsed:i-t}}},{key:"_parseProcessingInstruction",value:function(e,t){var n,i=t;for(;i<e.length&&!p(e,i)&&">"!==e[i]&&"/"!==e[i];)++i;n=e.substring(t,i),function(){for(;i<e.length&&p(e,i);)++i}();for(var r=i;i<e.length&&("?"!==e[i]||">"!==e[i+1]);)++i;return{name:n,value:e.substring(r,i),parsed:i-t}}},{key:"parseXml",value:function(e){for(var t=0;t<e.length;){var n=t;if("<"===e[t]){var i=void 0;switch(e[++n]){case"/":if(++n,(i=e.indexOf(">",n))<0)return void this.onError(h.UnterminatedElement);this.onEndElement(e.substring(n,i)),n=i+1;break;case"?":++n;var r=this._parseProcessingInstruction(e,n);if("?>"!==e.substring(n+r.parsed,n+r.parsed+2))return void this.onError(h.UnterminatedXmlDeclaration);this.onPi(r.name,r.value),n+=r.parsed+2;break;case"!":if("--"===e.substring(n+1,n+3)){if((i=e.indexOf("--\x3e",n+3))<0)return void this.onError(h.UnterminatedComment);this.onComment(e.substring(n+3,i)),n=i+3}else if("[CDATA["===e.substring(n+1,n+8)){if((i=e.indexOf("]]>",n+8))<0)return void this.onError(h.UnterminatedCdat);this.onCdata(e.substring(n+8,i)),n=i+3}else{if("DOCTYPE"!==e.substring(n+1,n+8))return void this.onError(h.MalformedElement);var o=e.indexOf("[",n+8),a=!1;if((i=e.indexOf(">",n+8))<0)return void this.onError(h.UnterminatedDoctypeDeclaration);if(o>0&&i>o){if((i=e.indexOf("]>",n+8))<0)return void this.onError(h.UnterminatedDoctypeDeclaration);a=!0}var s=e.substring(n+8,i+(a?1:0));this.onDoctype(s),n=i+(a?2:1)}break;default:var l=this._parseContent(e,n);if(null===l)return void this.onError(h.MalformedElement);var c=!1;if("/>"===e.substring(n+l.parsed,n+l.parsed+2))c=!0;else if(">"!==e.substring(n+l.parsed,n+l.parsed+1))return void this.onError(h.UnterminatedElement);this.onBeginElement(l.name,l.attributes,c),n+=l.parsed+(c?2:1)}}else{for(;n<e.length&&"<"!==e[n];)n++;var d=e.substring(t,n);this.onText(this._resolveEntities(d))}t=n}}},{key:"onResolveEntity",value:function(e){return"&".concat(e,";")}},{key:"onPi",value:function(e,t){}},{key:"onComment",value:function(e){}},{key:"onCdata",value:function(e){}},{key:"onDoctype",value:function(e){}},{key:"onText",value:function(e){}},{key:"onBeginElement",value:function(e,t,n){}},{key:"onEndElement",value:function(e){}},{key:"onError",value:function(e){}}]),e}(),m=function(){function e(t,n){c(this,e),this.nodeName=t,this.nodeValue=n,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}return u(e,[{key:"hasChildNodes",value:function(){return this.childNodes&&this.childNodes.length>0}},{key:"firstChild",get:function(){return this.childNodes&&this.childNodes[0]}},{key:"nextSibling",get:function(){var e=this.parentNode.childNodes;if(e){var t=e.indexOf(this);if(-1!==t)return e[t+1]}}},{key:"textContent",get:function(){return this.childNodes?this.childNodes.map(function(e){return e.textContent}).join(""):this.nodeValue||""}}]),e}(),g=function(e){function t(){var e;return c(this,t),(e=o(this,s(t).call(this)))._currentFragment=null,e._stack=null,e._errorCode=h.NoError,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,f),u(t,[{key:"parseFromString",value:function(e){if(this._currentFragment=[],this._stack=[],this._errorCode=h.NoError,this.parseXml(e),this._errorCode===h.NoError){var t=r(this._currentFragment,1)[0];if(t)return{documentElement:t}}}},{key:"onResolveEntity",value:function(e){switch(e){case"apos":return"'"}return a(s(t.prototype),"onResolveEntity",this).call(this,e)}},{key:"onText",value:function(e){if(!function(e){for(var t=0,n=e.length;t<n;t++)if(!p(e,t))return!1;return!0}(e)){var t=new m("#text",e);this._currentFragment.push(t)}}},{key:"onCdata",value:function(e){var t=new m("#text",e);this._currentFragment.push(t)}},{key:"onBeginElement",value:function(e,t,n){var i=new m(e);i.childNodes=[],this._currentFragment.push(i),n||(this._stack.push(this._currentFragment),this._currentFragment=i.childNodes)}},{key:"onEndElement",value:function(e){this._currentFragment=this._stack.pop()||[];var t=this._currentFragment[this._currentFragment.length-1];if(t)for(var n=0,i=t.childNodes.length;n<i;n++)t.childNodes[n].parentNode=t}},{key:"onError",value:function(e){this._errorCode=e}}]),t}();t.SimpleXMLParser=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1);function a(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function s(e){a(o,i,r,s,l,"next",e)}function l(e){a(o,i,r,s,l,"throw",e)}s(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),e}var u=function(){function e(t,n){var i=this;l(this,e),(0,o.assert)(n),this._queuedChunks=[],this._progressiveDone=t.progressiveDone||!1;var r=t.initialData;if(r&&r.length>0){var a=new Uint8Array(r).buffer;this._queuedChunks.push(a)}this._pdfDataRangeTransport=n,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._contentLength=t.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(function(e,t){i._onReceiveData({begin:e,chunk:t})}),this._pdfDataRangeTransport.addProgressListener(function(e,t){i._onProgress({loaded:e,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(function(e){i._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(function(){i._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}return d(e,[{key:"_onReceiveData",value:function(e){var t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{var n=this._rangeReaders.some(function(n){return n._begin===e.begin&&(n._enqueue(t),!0)});(0,o.assert)(n)}}},{key:"_onProgress",value:function(e){if(void 0===e.total){var t=this._rangeReaders[0];t&&t.onProgress&&t.onProgress({loaded:e.loaded})}else{var n=this._fullRequestReader;n&&n.onProgress&&n.onProgress({loaded:e.loaded,total:e.total})}}},{key:"_onProgressiveDone",value:function(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}},{key:"_removeRangeReader",value:function(e){var t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}},{key:"getFullReader",value:function(){(0,o.assert)(!this._fullRequestReader);var e=this._queuedChunks;return this._queuedChunks=null,new h(this,e,this._progressiveDone)}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=new p(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach(function(t){t.cancel(e)}),this._pdfDataRangeTransport.abort()}},{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}}]),e}();t.PDFDataTransportStream=u;var h=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];l(this,e),this._stream=t,this._done=i||!1,this._filename=null,this._queuedChunks=n||[],this._loaded=0;var r=!0,o=!1,a=void 0;try{for(var s,c=this._queuedChunks[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var d=s.value;this._loaded+=d.byteLength}}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}return d(e,[{key:"_enqueue",value:function(e){if(!this._done){if(this._requests.length>0)this._requests.shift().resolve({value:e,done:!1});else this._queuedChunks.push(e);this._loaded+=e.byteLength}}},{key:"read",value:function(){var e=s(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._queuedChunks.length>0)){e.next=3;break}return t=this._queuedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 3:if(!this._done){e.next=5;break}return e.abrupt("return",{value:void 0,done:!0});case 5:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[]}},{key:"progressiveDone",value:function(){this._done||(this._done=!0)}},{key:"headersReady",get:function(){return this._headersReady}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._stream._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._stream._isStreamingSupported}},{key:"contentLength",get:function(){return this._stream._contentLength}}]),e}(),p=function(){function e(t,n,i){l(this,e),this._stream=t,this._begin=n,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}return d(e,[{key:"_enqueue",value:function(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[];this._done=!0,this._stream._removeRangeReader(this)}}},{key:"read",value:function(){var e=s(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[],this._stream._removeRangeReader(this)}},{key:"isStreamingSupported",get:function(){return!1}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var i=n(1);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t){var n=t.enable,i=void 0!==n&&n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!0===i}var t,n,o;return t=e,(n=[{key:"composeSMask",value:function(e){var t=e.layer,n=e.mask,i=e.properties;return a.composeSMask(t,n,i)}},{key:"drawFigures",value:function(e){var t=e.width,n=e.height,i=e.backgroundColor,r=e.figures,o=e.context;return a.drawFigures(t,n,i,r,o)}},{key:"clear",value:function(){a.cleanup()}},{key:"isEnabled",get:function(){var e=this._enabled;return e&&(e=a.tryInitGL()),(0,i.shadow)(this,"isEnabled",e)}}])&&r(t.prototype,n),o&&r(t,o),e}();t.WebGLContext=o;var a=function(){function e(e,t,n){var i=e.createShader(n);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(i);throw new Error("Error during shader compilation: "+r)}return i}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function n(t,n){return e(t,n,t.FRAGMENT_SHADER)}function i(e,t){for(var n=e.createProgram(),i=0,r=t.length;i<r;++i)e.attachShader(n,t[i]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var o=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+o)}return n}function r(e,t,n){e.activeTexture(n);var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),i}var o,a;function s(){o||(a=document.createElement("canvas"),o=a.getContext("webgl",{premultipliedalpha:!1}))}var l="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",c="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",d=null;var u="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",h="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",p=null;return{tryInitGL:function(){try{return s(),!!o}catch(e){}return!1},composeSMask:function(e,u,h){var p=e.width,f=e.height;d||function(){var e,r;s(),e=a,a=null,r=o,o=null;var u=i(r,[t(r,l),n(r,c)]);r.useProgram(u);var h={};h.gl=r,h.canvas=e,h.resolutionLocation=r.getUniformLocation(u,"u_resolution"),h.positionLocation=r.getAttribLocation(u,"a_position"),h.backdropLocation=r.getUniformLocation(u,"u_backdrop"),h.subtypeLocation=r.getUniformLocation(u,"u_subtype");var p=r.getAttribLocation(u,"a_texCoord"),f=r.getUniformLocation(u,"u_image"),m=r.getUniformLocation(u,"u_mask"),g=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,g),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),r.STATIC_DRAW),r.enableVertexAttribArray(p),r.vertexAttribPointer(p,2,r.FLOAT,!1,0,0),r.uniform1i(f,0),r.uniform1i(m,1),d=h}();var m=d,g=m.canvas,v=m.gl;g.width=p,g.height=f,v.viewport(0,0,v.drawingBufferWidth,v.drawingBufferHeight),v.uniform2f(m.resolutionLocation,p,f),h.backdrop?v.uniform4f(m.resolutionLocation,h.backdrop[0],h.backdrop[1],h.backdrop[2],1):v.uniform4f(m.resolutionLocation,0,0,0,0),v.uniform1i(m.subtypeLocation,"Luminosity"===h.subtype?1:0);var y=r(v,e,v.TEXTURE0),b=r(v,u,v.TEXTURE1),w=v.createBuffer();return v.bindBuffer(v.ARRAY_BUFFER,w),v.bufferData(v.ARRAY_BUFFER,new Float32Array([0,0,p,0,0,f,0,f,p,0,p,f]),v.STATIC_DRAW),v.enableVertexAttribArray(m.positionLocation),v.vertexAttribPointer(m.positionLocation,2,v.FLOAT,!1,0,0),v.clearColor(0,0,0,0),v.enable(v.BLEND),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.clear(v.COLOR_BUFFER_BIT),v.drawArrays(v.TRIANGLES,0,6),v.flush(),v.deleteTexture(y),v.deleteTexture(b),v.deleteBuffer(w),g},drawFigures:function(e,r,l,c,d){p||function(){var e,r;s(),e=a,a=null,r=o,o=null;var l=i(r,[t(r,u),n(r,h)]);r.useProgram(l);var c={};c.gl=r,c.canvas=e,c.resolutionLocation=r.getUniformLocation(l,"u_resolution"),c.scaleLocation=r.getUniformLocation(l,"u_scale"),c.offsetLocation=r.getUniformLocation(l,"u_offset"),c.positionLocation=r.getAttribLocation(l,"a_position"),c.colorLocation=r.getAttribLocation(l,"a_color"),p=c}();var f=p,m=f.canvas,g=f.gl;m.width=e,m.height=r,g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight),g.uniform2f(f.resolutionLocation,e,r);var v,y,b,w=0;for(v=0,y=c.length;v<y;v++)switch(c[v].type){case"lattice":w+=((b=c[v].coords.length/c[v].verticesPerRow|0)-1)*(c[v].verticesPerRow-1)*6;break;case"triangles":w+=c[v].coords.length}var _=new Float32Array(2*w),S=new Uint8Array(3*w),k=d.coords,P=d.colors,C=0,T=0;for(v=0,y=c.length;v<y;v++){var A=c[v],I=A.coords,E=A.colors;switch(A.type){case"lattice":var x=A.verticesPerRow;b=I.length/x|0;for(var R=1;R<b;R++)for(var D=R*x+1,L=1;L<x;L++,D++)_[C]=k[I[D-x-1]],_[C+1]=k[I[D-x-1]+1],_[C+2]=k[I[D-x]],_[C+3]=k[I[D-x]+1],_[C+4]=k[I[D-1]],_[C+5]=k[I[D-1]+1],S[T]=P[E[D-x-1]],S[T+1]=P[E[D-x-1]+1],S[T+2]=P[E[D-x-1]+2],S[T+3]=P[E[D-x]],S[T+4]=P[E[D-x]+1],S[T+5]=P[E[D-x]+2],S[T+6]=P[E[D-1]],S[T+7]=P[E[D-1]+1],S[T+8]=P[E[D-1]+2],_[C+6]=_[C+2],_[C+7]=_[C+3],_[C+8]=_[C+4],_[C+9]=_[C+5],_[C+10]=k[I[D]],_[C+11]=k[I[D]+1],S[T+9]=S[T+3],S[T+10]=S[T+4],S[T+11]=S[T+5],S[T+12]=S[T+6],S[T+13]=S[T+7],S[T+14]=S[T+8],S[T+15]=P[E[D]],S[T+16]=P[E[D]+1],S[T+17]=P[E[D]+2],C+=12,T+=18;break;case"triangles":for(var M=0,W=I.length;M<W;M++)_[C]=k[I[M]],_[C+1]=k[I[M]+1],S[T]=P[E[M]],S[T+1]=P[E[M]+1],S[T+2]=P[E[M]+2],C+=2,T+=3}}l?g.clearColor(l[0]/255,l[1]/255,l[2]/255,1):g.clearColor(0,0,0,0),g.clear(g.COLOR_BUFFER_BIT);var N=g.createBuffer();g.bindBuffer(g.ARRAY_BUFFER,N),g.bufferData(g.ARRAY_BUFFER,_,g.STATIC_DRAW),g.enableVertexAttribArray(f.positionLocation),g.vertexAttribPointer(f.positionLocation,2,g.FLOAT,!1,0,0);var O=g.createBuffer();return g.bindBuffer(g.ARRAY_BUFFER,O),g.bufferData(g.ARRAY_BUFFER,S,g.STATIC_DRAW),g.enableVertexAttribArray(f.colorLocation),g.vertexAttribPointer(f.colorLocation,3,g.UNSIGNED_BYTE,!1,0,0),g.uniform2f(f.scaleLocation,d.scaleX,d.scaleY),g.uniform2f(f.offsetLocation,d.offsetX,d.offsetY),g.drawArrays(g.TRIANGLES,0,w),g.flush(),g.deleteBuffer(N),g.deleteBuffer(O),m},cleanup:function(){d&&d.canvas&&(d.canvas.width=0,d.canvas.height=0),p&&p.canvas&&(p.canvas.width=0,p.canvas.height=0),d=null,p=null}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var i,r=n(1),o=(i=n(3))&&i.__esModule?i:{default:i};var a=function(){var e=1e5,t=/\S/;var n=["left: ",0,"px; top: ",0,"px; font-size: ",0,"px; font-family: ","",";"];function i(e,i,o){var a,s=document.createElement("span"),l={style:null,angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(e._textDivs.push(s),a=i.str,!t.test(a))return l.isWhitespace=!0,void e._textDivProperties.set(s,l);var c=r.Util.transform(e._viewport.transform,i.transform),d=Math.atan2(c[1],c[0]),u=o[i.fontName];u.vertical&&(d+=Math.PI/2);var h,p,f=Math.sqrt(c[2]*c[2]+c[3]*c[3]),m=f;if(u.ascent?m=u.ascent*m:u.descent&&(m=(1+u.descent)*m),0===d?(h=c[4],p=c[5]-m):(h=c[4]+m*Math.sin(d),p=c[5]-m*Math.cos(d)),n[1]=h,n[3]=p,n[5]=f,n[7]=u.fontFamily,l.style=n.join(""),s.setAttribute("style",l.style),s.textContent=i.str,e._fontInspectorEnabled&&(s.dataset.fontName=i.fontName),0!==d&&(l.angle=d*(180/Math.PI)),i.str.length>1&&(u.vertical?l.canvasWidth=i.height*e._viewport.scale:l.canvasWidth=i.width*e._viewport.scale),e._textDivProperties.set(s,l),e._textContentStream&&e._layoutText(s),e._enhanceTextSelection){var g=1,v=0;0!==d&&(g=Math.cos(d),v=Math.sin(d));var y,b,w=(u.vertical?i.height:i.width)*e._viewport.scale,_=f;0!==d?(y=[g,v,-v,g,h,p],b=r.Util.getAxialAlignedBoundingBox([0,0,w,_],y)):b=[h,p,h+w,p+_],e._bounds.push({left:b[0],top:b[1],right:b[2],bottom:b[3],div:s,size:[w,_],m:y})}}function a(t){if(!t._canceled){var n=t._textDivs,i=t._capability,r=n.length;if(r>e)return t._renderingDone=!0,void i.resolve();if(!t._textContentStream)for(var o=0;o<r;o++)t._layoutText(n[o]);t._renderingDone=!0,i.resolve()}}function s(e){for(var t=e._bounds,n=e._viewport,i=function(e,t,n){var i=n.map(function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}});l(e,i);var r=new Array(n.length);return i.forEach(function(e){var t=e.index;r[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}}),n.map(function(t,n){var o=r[n],a=i[n];a.x1=t.top,a.y1=e-o.right,a.x2=t.bottom,a.y2=e-o.left,a.index=n,a.x1New=void 0,a.x2New=void 0}),l(t,i),i.forEach(function(e){var t=e.index;r[t].top=e.x1New,r[t].bottom=e.x2New}),r}(n.width,n.height,t),o=0;o<i.length;o++){var a=t[o].div,s=e._textDivProperties.get(a);if(0!==s.angle){var c=i[o],d=t[o],u=d.m,h=u[0],p=u[1],f=[[0,0],[0,d.size[1]],[d.size[0],0],d.size],m=new Float64Array(64);f.forEach(function(e,t){var n=r.Util.applyTransform(e,u);m[t+0]=h&&(c.left-n[0])/h,m[t+4]=p&&(c.top-n[1])/p,m[t+8]=h&&(c.right-n[0])/h,m[t+12]=p&&(c.bottom-n[1])/p,m[t+16]=p&&(c.left-n[0])/-p,m[t+20]=h&&(c.top-n[1])/h,m[t+24]=p&&(c.right-n[0])/-p,m[t+28]=h&&(c.bottom-n[1])/h,m[t+32]=h&&(c.left-n[0])/-h,m[t+36]=p&&(c.top-n[1])/-p,m[t+40]=h&&(c.right-n[0])/-h,m[t+44]=p&&(c.bottom-n[1])/-p,m[t+48]=p&&(c.left-n[0])/p,m[t+52]=h&&(c.top-n[1])/-h,m[t+56]=p&&(c.right-n[0])/p,m[t+60]=h&&(c.bottom-n[1])/-h});var g=function(e,t,n){for(var i=0,r=0;r<n;r++){var o=e[t++];o>0&&(i=i?Math.min(o,i):o)}return i},v=1+Math.min(Math.abs(h),Math.abs(p));s.paddingLeft=g(m,32,16)/v,s.paddingTop=g(m,48,16)/v,s.paddingRight=g(m,0,16)/v,s.paddingBottom=g(m,16,16)/v,e._textDivProperties.set(a,s)}else s.paddingLeft=t[o].left-i[o].left,s.paddingTop=t[o].top-i[o].top,s.paddingRight=i[o].right-t[o].right,s.paddingBottom=i[o].bottom-t[o].bottom,e._textDivProperties.set(a,s)}}function l(e,t){t.sort(function(e,t){return e.x1-t.x1||e.index-t.index});var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach(function(e){for(var t=0;t<n.length&&n[t].end<=e.y1;)t++;for(var i,r,o=n.length-1;o>=0&&n[o].start>=e.y2;)o--;var a,s,l=-1/0;for(a=t;a<=o;a++){var c;(c=(r=(i=n[a]).boundary).x2>e.x1?r.index>e.index?r.x1New:e.x1:void 0===r.x2New?(r.x2+e.x1)/2:r.x2New)>l&&(l=c)}for(e.x1New=l,a=t;a<=o;a++)void 0===(r=(i=n[a]).boundary).x2New?r.x2>e.x1?r.index>e.index&&(r.x2New=r.x2):r.x2New=l:r.x2New>l&&(r.x2New=Math.max(l,r.x2));var d=[],u=null;for(a=t;a<=o;a++){var h=(r=(i=n[a]).boundary).x2>e.x2?r:e;u===h?d[d.length-1].end=i.end:(d.push({start:i.start,end:i.end,boundary:h}),u=h)}for(n[t].start<e.y1&&(d[0].start=e.y1,d.unshift({start:n[t].start,end:e.y1,boundary:n[t].boundary})),e.y2<n[o].end&&(d[d.length-1].end=e.y2,d.push({start:e.y2,end:n[o].end,boundary:n[o].boundary})),a=t;a<=o;a++)if(void 0===(r=(i=n[a]).boundary).x2New){var p=!1;for(s=t-1;!p&&s>=0&&n[s].start>=r.y1;s--)p=n[s].boundary===r;for(s=o+1;!p&&s<n.length&&n[s].end<=r.y2;s++)p=n[s].boundary===r;for(s=0;!p&&s<d.length;s++)p=d[s].boundary===r;p||(r.x2New=l)}Array.prototype.splice.apply(n,[t,o-t+1].concat(d))}),n.forEach(function(t){var n=t.boundary;void 0===n.x2New&&(n.x2New=Math.max(e,n.x2))})}function c(e){var t=this,n=e.textContent,i=e.textContentStream,a=e.container,s=e.viewport,l=e.textDivs,c=e.textContentItemsStr,d=e.enhanceTextSelection;this._textContent=n,this._textContentStream=i,this._container=a,this._viewport=s,this._textDivs=l||[],this._textContentItemsStr=c||[],this._enhanceTextSelection=!!d,this._fontInspectorEnabled=!(!o.default.FontInspector||!o.default.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(function(){t._layoutTextCtx&&(t._layoutTextCtx.canvas.width=0,t._layoutTextCtx.canvas.height=0,t._layoutTextCtx=null)})}return c.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems:function(e,t){for(var n=0,r=e.length;n<r;n++)this._textContentItemsStr.push(e[n].str),i(this,e[n],t)},_layoutText:function(e){var t=this._container,n=this._textDivProperties.get(e);if(!n.isWhitespace){var i=e.style.fontSize,r=e.style.fontFamily;i===this._layoutTextLastFontSize&&r===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=i+" "+r,this._layoutTextLastFontSize=i,this._layoutTextLastFontFamily=r);var o=this._layoutTextCtx.measureText(e.textContent).width,a="";0!==n.canvasWidth&&o>0&&(n.scale=n.canvasWidth/o,a="scaleX(".concat(n.scale,")")),0!==n.angle&&(a="rotate(".concat(n.angle,"deg) ").concat(a)),a.length>0&&(n.originalTransform=a,e.style.transform=a),this._textDivProperties.set(e,n),t.appendChild(e)}},_render:function(e){var t=this,n=(0,r.createPromiseCapability)(),i=Object.create(null),o=document.createElement("canvas");if(o.mozOpaque=!0,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){var s=this._textContent.items,l=this._textContent.styles;this._processItems(s,l),n.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function e(){t._reader.read().then(function(r){var o=r.value;r.done?n.resolve():(Object.assign(i,o.styles),t._processItems(o.items,i),e())},n.reject)}()}n.promise.then(function(){i=null,e?t._renderTimer=setTimeout(function(){a(t),t._renderTimer=null},e):a(t)},this._capability.reject)},expandTextDivs:function(e){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(s(this),this._bounds=null);for(var t=0,n=this._textDivs.length;t<n;t++){var i=this._textDivs[t],r=this._textDivProperties.get(i);if(!r.isWhitespace)if(e){var o="",a="";1!==r.scale&&(o="scaleX("+r.scale+")"),0!==r.angle&&(o="rotate("+r.angle+"deg) "+o),0!==r.paddingLeft&&(a+=" padding-left: "+r.paddingLeft/r.scale+"px;",o+=" translateX("+-r.paddingLeft/r.scale+"px)"),0!==r.paddingTop&&(a+=" padding-top: "+r.paddingTop+"px;",o+=" translateY("+-r.paddingTop+"px)"),0!==r.paddingRight&&(a+=" padding-right: "+r.paddingRight/r.scale+"px;"),0!==r.paddingBottom&&(a+=" padding-bottom: "+r.paddingBottom+"px;"),""!==a&&i.setAttribute("style",r.style+a),""!==o&&(i.style.transform=o)}else i.style.padding=0,i.style.transform=r.originalTransform||""}}}},function(e){var t=new c({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var i=n(151),r=n(1);function o(e,t,n){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var m=function(){function e(){h(this,e)}return f(e,null,[{key:"create",value:function(e){switch(e.data.annotationType){case r.AnnotationType.LINK:return new v(e);case r.AnnotationType.TEXT:return new y(e);case r.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new w(e);case"Btn":return e.data.radioButton?new S(e):e.data.checkBox?new _(e):new k(e);case"Ch":return new P(e)}return new b(e);case r.AnnotationType.POPUP:return new C(e);case r.AnnotationType.FREETEXT:return new A(e);case r.AnnotationType.LINE:return new I(e);case r.AnnotationType.SQUARE:return new E(e);case r.AnnotationType.CIRCLE:return new x(e);case r.AnnotationType.POLYLINE:return new R(e);case r.AnnotationType.CARET:return new L(e);case r.AnnotationType.INK:return new M(e);case r.AnnotationType.POLYGON:return new D(e);case r.AnnotationType.HIGHLIGHT:return new W(e);case r.AnnotationType.UNDERLINE:return new N(e);case r.AnnotationType.SQUIGGLY:return new O(e);case r.AnnotationType.STRIKEOUT:return new F(e);case r.AnnotationType.STAMP:return new B(e);case r.AnnotationType.FILEATTACHMENT:return new j(e);default:return new g(e)}}}]),e}(),g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];h(this,e),this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,this.svgFactory=t.svgFactory,n&&(this.container=this._createContainer(i))}return f(e,[{key:"_createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data,n=this.page,i=this.viewport,o=document.createElement("section"),a=t.rect[2]-t.rect[0],s=t.rect[3]-t.rect[1];o.setAttribute("data-annotation-id",t.id);var l=r.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(o.style.transform="matrix("+i.transform.join(",")+")",o.style.transformOrigin=-l[0]+"px "+-l[1]+"px",!e&&t.borderStyle.width>0){o.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==r.AnnotationBorderStyleType.UNDERLINE&&(a-=2*t.borderStyle.width,s-=2*t.borderStyle.width);var c=t.borderStyle.horizontalCornerRadius,d=t.borderStyle.verticalCornerRadius;if(c>0||d>0){var u=c+"px / "+d+"px";o.style.borderRadius=u}switch(t.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:o.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:o.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:o.style.borderBottomStyle="solid"}t.color?o.style.borderColor=r.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):o.style.borderWidth=0}return o.style.left=l[0]+"px",o.style.top=l[1]+"px",o.style.width=a+"px",o.style.height=s+"px",o}},{key:"_createPopup",value:function(e,t,n){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));var i=new T({container:e,trigger:t,color:n.color,title:n.title,modificationDate:n.modificationDate,contents:n.contents,hideWrapper:!0}).render();i.style.left=e.style.width,e.appendChild(i)}},{key:"render",value:function(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}}]),e}(),v=function(e){function t(e){h(this,t);var n=!!(e.data.url||e.data.dest||e.data.action);return s(this,c(t).call(this,e,n))}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="linkAnnotation";var e=this.data,t=this.linkService,n=document.createElement("a");return(0,i.addLinkAttributes)(n,{url:e.url,target:e.newWindow?i.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel}),e.url||(e.action?this._bindNamedAction(n,e.action):this._bindLink(n,e.dest)),this.container.appendChild(n),this.container}},{key:"_bindLink",value:function(e,t){var n=this;e.href=this.linkService.getDestinationHash(t),e.onclick=function(){return t&&n.linkService.navigateTo(t),!1},t&&(e.className="internalLink")}},{key:"_bindNamedAction",value:function(e,t){var n=this;e.href=this.linkService.getAnchorUrl(""),e.onclick=function(){return n.linkService.executeNamedAction(t),!1},e.className="internalLink"}}]),t}(),y=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n))}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="textAnnotation";var e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}]),t}(),b=function(e){function t(){return h(this,t),s(this,c(t).apply(this,arguments))}return d(t,g),f(t,[{key:"render",value:function(){return this.container}}]),t}(),w=function(e){function t(e){h(this,t);var n=e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue;return s(this,c(t).call(this,e,n))}return d(t,b),f(t,[{key:"render",value:function(){this.container.className="textWidgetAnnotation";var e=null;if(this.renderInteractiveForms){if(this.data.multiLine?(e=document.createElement("textarea")).textContent=this.data.fieldValue:((e=document.createElement("input")).type="text",e.setAttribute("value",this.data.fieldValue)),e.disabled=this.data.readOnly,null!==this.data.maxLen&&(e.maxLength=this.data.maxLen),this.data.comb){var t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;e.classList.add("comb"),e.style.letterSpacing="calc("+t+"px - 1ch)"}}else{(e=document.createElement("div")).textContent=this.data.fieldValue,e.style.verticalAlign="middle",e.style.display="table-cell";var n=null;this.data.fontRefName&&this.page.commonObjs.has(this.data.fontRefName)&&(n=this.page.commonObjs.get(this.data.fontRefName)),this._setTextStyle(e,n)}return null!==this.data.textAlignment&&(e.style.textAlign=["left","center","right"][this.data.textAlignment]),this.container.appendChild(e),this.container}},{key:"_setTextStyle",value:function(e,t){var n=e.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",t){n.fontWeight=t.black?t.bold?"900":"bold":t.bold?"bold":"normal",n.fontStyle=t.italic?"italic":"normal";var i=t.loadedName?'"'+t.loadedName+'", ':"",r=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=i+r}}}]),t}(),_=function(e){function t(e){return h(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,b),f(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation checkBox";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(),S=function(e){function t(e){return h(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,b),f(t,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation radioButton";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="radio",e.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),t}(),k=function(e){function t(){return h(this,t),s(this,c(t).apply(this,arguments))}return d(t,v),f(t,[{key:"render",value:function(){var e=o(c(t.prototype),"render",this).call(this);return e.className="buttonWidgetAnnotation pushButton",e}}]),t}(),P=function(e){function t(e){return h(this,t),s(this,c(t).call(this,e,e.renderInteractiveForms))}return d(t,b),f(t,[{key:"render",value:function(){this.container.className="choiceWidgetAnnotation";var e=document.createElement("select");e.disabled=this.data.readOnly,this.data.combo||(e.size=this.data.options.length,this.data.multiSelect&&(e.multiple=!0));for(var t=0,n=this.data.options.length;t<n;t++){var i=this.data.options[t],r=document.createElement("option");r.textContent=i.displayValue,r.value=i.exportValue,this.data.fieldValue.includes(i.displayValue)&&r.setAttribute("selected",!0),e.appendChild(r)}return this.container.appendChild(e),this.container}}]),t}(),C=function(e){function t(e){h(this,t);var n=!(!e.data.title&&!e.data.contents);return s(this,c(t).call(this,e,n))}return d(t,g),f(t,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var e='[data-annotation-id="'+this.data.parentId+'"]',t=this.layer.querySelector(e);if(!t)return this.container;var n=new T({container:this.container,trigger:t,color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),i=parseFloat(t.style.left),r=parseFloat(t.style.width);return this.container.style.transformOrigin=-(i+r)+"px -"+t.style.top,this.container.style.left=i+r+"px",this.container.appendChild(n.render()),this.container}}]),t}(),T=function(){function e(t){h(this,e),this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.modificationDate=t.modificationDate,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}return f(e,[{key:"render",value:function(){var e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);var t=document.createElement("div");t.className="popup";var n=this.color;if(n){var o=.7*(255-n[0])+n[0],a=.7*(255-n[1])+n[1],s=.7*(255-n[2])+n[2];t.style.backgroundColor=r.Util.makeCssRgb(0|o,0|a,0|s)}var l=document.createElement("h1");l.textContent=this.title,t.appendChild(l);var c=i.PDFDateString.toDateObject(this.modificationDate);if(c){var d=document.createElement("span");d.textContent="{{date}}, {{time}}",d.dataset.l10nId="annotation_date_string",d.dataset.l10nArgs=JSON.stringify({date:c.toLocaleDateString(),time:c.toLocaleTimeString()}),t.appendChild(d)}var u=this._formatContents(this.contents);return t.appendChild(u),this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(t),e}},{key:"_formatContents",value:function(e){for(var t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/),i=0,r=n.length;i<r;++i){var o=n[i];t.appendChild(document.createTextNode(o)),i<r-1&&t.appendChild(document.createElement("br"))}return t}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}},{key:"_hide",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}]),e}(),A=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),I=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="lineAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width),r.setAttribute("stroke","transparent"),i.appendChild(r),this.container.append(i),this._createPopup(this.container,r,e),this.container}}]),t}(),E=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="squareAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.borderStyle.width,o=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",r/2),o.setAttribute("y",r/2),o.setAttribute("width",t-r),o.setAttribute("height",n-r),o.setAttribute("stroke-width",r),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),i.appendChild(o),this.container.append(i),this._createPopup(this.container,o,e),this.container}}]),t}(),x=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="circleAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.borderStyle.width,o=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-r/2),o.setAttribute("ry",n/2-r/2),o.setAttribute("stroke-width",r),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),i.appendChild(o),this.container.append(i),this._createPopup(this.container,o,e),this.container}}]),t}(),R=function(e){function t(e){var n;h(this,t);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(n=s(this,c(t).call(this,e,i,!0))).containerClassName="polylineAnnotation",n.svgElementName="svg:polyline",n}return d(t,g),f(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.vertices,o=[],a=0,s=r.length;a<s;a++){var l=r[a].x-e.rect[0],c=e.rect[3]-r[a].y;o.push(l+","+c)}o=o.join(" ");var d=e.borderStyle.width,u=this.svgFactory.createElement(this.svgElementName);return u.setAttribute("points",o),u.setAttribute("stroke-width",d),u.setAttribute("stroke","transparent"),u.setAttribute("fill","none"),i.appendChild(u),this.container.append(i),this._createPopup(this.container,u,e),this.container}}]),t}(),D=function(e){function t(e){var n;return h(this,t),(n=s(this,c(t).call(this,e))).containerClassName="polygonAnnotation",n.svgElementName="svg:polygon",n}return d(t,R),t}(),L=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),M=function(e){function t(e){var n;h(this,t);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(n=s(this,c(t).call(this,e,i,!0))).containerClassName="inkAnnotation",n.svgElementName="svg:polyline",n}return d(t,g),f(t,[{key:"render",value:function(){this.container.className=this.containerClassName;for(var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.inkLists,o=0,a=r.length;o<a;o++){for(var s=r[o],l=[],c=0,d=s.length;c<d;c++){var u=s[c].x-e.rect[0],h=e.rect[3]-s[c].y;l.push(u+","+h)}l=l.join(" ");var p=e.borderStyle.width,f=this.svgFactory.createElement(this.svgElementName);f.setAttribute("points",l),f.setAttribute("stroke-width",p),f.setAttribute("stroke","transparent"),f.setAttribute("fill","none"),this._createPopup(this.container,f,e),i.appendChild(f)}return this.container.append(i),this.container}}]),t}(),W=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),N=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),O=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),F=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),B=function(e){function t(e){h(this,t);var n=!!(e.data.hasPopup||e.data.title||e.data.contents);return s(this,c(t).call(this,e,n,!0))}return d(t,g),f(t,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),t}(),j=function(e){function t(e){var n;h(this,t);var o=(n=s(this,c(t).call(this,e,!0))).data.file,a=o.filename,d=o.content;return n.filename=(0,i.getFilenameFromUrl)(a),n.content=d,n.linkService.eventBus&&n.linkService.eventBus.dispatch("fileattachmentannotation",{source:l(n),id:(0,r.stringToPDFString)(a),filename:a,content:d}),n}return d(t,g),f(t,[{key:"render",value:function(){this.container.className="fileAttachmentAnnotation";var e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}},{key:"_download",value:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,r.warn)("Download cannot be started due to unavailable download manager")}}]),t}(),V=function(){function e(){h(this,e)}return f(e,null,[{key:"render",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var r=e.annotations[t];if(r){var o=m.create({data:r,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:e.renderInteractiveForms||!1,svgFactory:new i.DOMSVGFactory});o.isRenderable&&e.div.appendChild(o.render())}}}},{key:"update",value:function(e){for(var t=0,n=e.annotations.length;t<n;t++){var i=e.annotations[t],r=e.div.querySelector('[data-annotation-id="'+i.id+'"]');r&&(r.style.transform="matrix("+e.viewport.transform.join(",")+")")}e.div.removeAttribute("hidden")}}]),e}();t.AnnotationLayer=V},function(e,i,o){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SVGGraphics=void 0;var a,s=o(1),l=o(151),c=(a=o(4))&&a.__esModule?a:{default:a};function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var m=function(){throw new Error("Not implemented: SVGGraphics")};i.SVGGraphics=m;var g=function(e){if(Number.isInteger(e))return e.toString();var t=e.toFixed(10),n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)},v=function(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale(".concat(g(e[0])," ").concat(g(e[3]),")");if(e[0]===e[3]&&e[1]===-e[2]){var t=180*Math.acos(e[0])/Math.PI;return"rotate(".concat(g(t),")")}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate(".concat(g(e[4])," ").concat(g(e[5]),")");return"matrix(".concat(g(e[0])," ").concat(g(e[1])," ").concat(g(e[2])," ").concat(g(e[3])," ").concat(g(e[4])," ")+"".concat(g(e[5]),")")},y={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},b="http://www.w3.org/1999/xlink",w=["butt","round","square"],_=["miter","round","bevel"],S=function(){for(var e=new Uint8Array([137,80,78,71,13,10,26,10]),i=12,o=new Int32Array(256),a=0;a<256;a++){for(var l=a,d=0;d<8;d++)l=1&l?3988292384^l>>1&2147483647:l>>1&2147483647;o[a]=l}function u(e,t,n,i){var r=i,a=t.length;n[r]=a>>24&255,n[r+1]=a>>16&255,n[r+2]=a>>8&255,n[r+3]=255&a,n[r+=4]=255&e.charCodeAt(0),n[r+1]=255&e.charCodeAt(1),n[r+2]=255&e.charCodeAt(2),n[r+3]=255&e.charCodeAt(3),r+=4,n.set(t,r);var s=function(e,t,n){for(var i=-1,r=t;r<n;r++){var a=255&(i^e[r]);i=i>>>8^o[a]}return-1^i}(n,i+4,r+=t.length);n[r]=s>>24&255,n[r+1]=s>>16&255,n[r+2]=s>>8&255,n[r+3]=255&s}function h(e){var t=e.length,n=Math.ceil(t/65535),i=new Uint8Array(2+t+5*n+4),r=0;i[r++]=120,i[r++]=156;for(var o=0;t>65535;)i[r++]=0,i[r++]=255,i[r++]=255,i[r++]=0,i[r++]=0,i.set(e.subarray(o,o+65535),r),r+=65535,o+=65535,t-=65535;i[r++]=1,i[r++]=255&t,i[r++]=t>>8&255,i[r++]=255&~t,i[r++]=(65535&~t)>>8&255,i.set(e.subarray(o),r),r+=e.length-o;var a=function(e,t,n){for(var i=1,r=0,o=t;o<n;++o)r=(r+(i=(i+(255&e[o]))%65521))%65521;return r<<16|i}(e,0,e.length);return i[r++]=a>>24&255,i[r++]=a>>16&255,i[r++]=a>>8&255,i[r++]=255&a,i}function p(o,a,l,d){var p,f,m,g=o.width,v=o.height,y=o.data;switch(a){case s.ImageKind.GRAYSCALE_1BPP:f=0,p=1,m=g+7>>3;break;case s.ImageKind.RGB_24BPP:f=2,p=8,m=3*g;break;case s.ImageKind.RGBA_32BPP:f=6,p=8,m=4*g;break;default:throw new Error("invalid format")}for(var b=new Uint8Array((1+m)*v),w=0,_=0,S=0;S<v;++S)b[w++]=0,b.set(y.subarray(_,_+m),w),_+=m,w+=m;if(a===s.ImageKind.GRAYSCALE_1BPP&&d){w=0;for(var k=0;k<v;k++){w++;for(var P=0;P<m;P++)b[w++]^=255}}var C=new Uint8Array([g>>24&255,g>>16&255,g>>8&255,255&g,v>>24&255,v>>16&255,v>>8&255,255&v,p,f,0,0,0]),T=function(e){if(!(0,c.default)())return h(e);try{var i;i=parseInt(r.versions.node)>=8?e:new t(e);var o=n(176).deflateSync(i,{level:9});return o instanceof Uint8Array?o:new Uint8Array(o)}catch(e){(0,s.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return h(e)}(b),A=e.length+3*i+C.length+T.length,I=new Uint8Array(A),E=0;return I.set(e,E),u("IHDR",C,I,E+=e.length),u("IDATA",T,I,E+=i+C.length),E+=i+T.length,u("IEND",new Uint8Array(0),I,E),(0,s.createObjectURL)(I,"image/png",l)}return function(e,t,n){return p(e,void 0===e.kind?s.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}(),k=function(){function e(){h(this,e),this.fontSizeScale=1,this.fontWeight=y.fontWeight,this.fontSize=0,this.textMatrix=s.IDENTITY_MATRIX,this.fontMatrix=s.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=s.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=y.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return f(e,[{key:"clone",value:function(){return Object.create(this)}},{key:"setCurrentPoint",value:function(e,t){this.x=e,this.y=t}}]),e}(),P=0,C=0,T=0;i.SVGGraphics=m=function(){function e(t,n,i){for(var r in h(this,e),this.svgFactory=new l.DOMSVGFactory,this.current=new k,this.transformMatrix=s.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!i,this._operatorIdMapping=[],s.OPS)this._operatorIdMapping[s.OPS[r]]=r}return f(e,[{key:"save",value:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()}},{key:"restore",value:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}},{key:"group",value:function(e){this.save(),this.executeOpTree(e),this.restore()}},{key:"loadDependencies",value:function(e){for(var t=this,n=e.fnArray,i=e.argsArray,r=0,o=n.length;r<o;r++)if(n[r]===s.OPS.dependency){var a=!0,l=!1,c=void 0;try{for(var d,u=function(){var e=d.value,n=e.startsWith("g_")?t.commonObjs:t.objs,i=new Promise(function(t){n.get(e,t)});t.current.dependencies.push(i)},h=i[r][Symbol.iterator]();!(a=(d=h.next()).done);a=!0)u()}catch(e){l=!0,c=e}finally{try{a||null==h.return||h.return()}finally{if(l)throw c}}}return Promise.all(this.current.dependencies)}},{key:"transform",value:function(e,t,n,i,r,o){var a=[e,t,n,i,r,o];this.transformMatrix=s.Util.transform(this.transformMatrix,a),this.tgrp=null}},{key:"getSVG",value:function(e,t){var n=this;this.viewport=t;var i=this._initialize(t);return this.loadDependencies(e).then(function(){return n.transformMatrix=s.IDENTITY_MATRIX,n.executeOpTree(n.convertOpList(e)),i})}},{key:"convertOpList",value:function(e){for(var t=this._operatorIdMapping,n=e.argsArray,i=e.fnArray,r=[],o=0,a=i.length;o<a;o++){var s=i[o];r.push({fnId:s,fn:t[s],args:n[o]})}return function(e){var t=[],n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var l=a.value;"save"!==l.fn?"restore"===l.fn?t=n.pop():t.push(l):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return t}(r)}},{key:"executeOpTree",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=r.value,l=a.fn,c=a.fnId,d=a.args;switch(0|c){case s.OPS.beginText:this.beginText();break;case s.OPS.dependency:break;case s.OPS.setLeading:this.setLeading(d);break;case s.OPS.setLeadingMoveText:this.setLeadingMoveText(d[0],d[1]);break;case s.OPS.setFont:this.setFont(d);break;case s.OPS.showText:case s.OPS.showSpacedText:this.showText(d[0]);break;case s.OPS.endText:this.endText();break;case s.OPS.moveText:this.moveText(d[0],d[1]);break;case s.OPS.setCharSpacing:this.setCharSpacing(d[0]);break;case s.OPS.setWordSpacing:this.setWordSpacing(d[0]);break;case s.OPS.setHScale:this.setHScale(d[0]);break;case s.OPS.setTextMatrix:this.setTextMatrix(d[0],d[1],d[2],d[3],d[4],d[5]);break;case s.OPS.setTextRise:this.setTextRise(d[0]);break;case s.OPS.setTextRenderingMode:this.setTextRenderingMode(d[0]);break;case s.OPS.setLineWidth:this.setLineWidth(d[0]);break;case s.OPS.setLineJoin:this.setLineJoin(d[0]);break;case s.OPS.setLineCap:this.setLineCap(d[0]);break;case s.OPS.setMiterLimit:this.setMiterLimit(d[0]);break;case s.OPS.setFillRGBColor:this.setFillRGBColor(d[0],d[1],d[2]);break;case s.OPS.setStrokeRGBColor:this.setStrokeRGBColor(d[0],d[1],d[2]);break;case s.OPS.setStrokeColorN:this.setStrokeColorN(d);break;case s.OPS.setFillColorN:this.setFillColorN(d);break;case s.OPS.shadingFill:this.shadingFill(d[0]);break;case s.OPS.setDash:this.setDash(d[0],d[1]);break;case s.OPS.setRenderingIntent:this.setRenderingIntent(d[0]);break;case s.OPS.setFlatness:this.setFlatness(d[0]);break;case s.OPS.setGState:this.setGState(d[0]);break;case s.OPS.fill:this.fill();break;case s.OPS.eoFill:this.eoFill();break;case s.OPS.stroke:this.stroke();break;case s.OPS.fillStroke:this.fillStroke();break;case s.OPS.eoFillStroke:this.eoFillStroke();break;case s.OPS.clip:this.clip("nonzero");break;case s.OPS.eoClip:this.clip("evenodd");break;case s.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case s.OPS.paintJpegXObject:this.paintJpegXObject(d[0],d[1],d[2]);break;case s.OPS.paintImageXObject:this.paintImageXObject(d[0]);break;case s.OPS.paintInlineImageXObject:this.paintInlineImageXObject(d[0]);break;case s.OPS.paintImageMaskXObject:this.paintImageMaskXObject(d[0]);break;case s.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(d[0],d[1]);break;case s.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case s.OPS.closePath:this.closePath();break;case s.OPS.closeStroke:this.closeStroke();break;case s.OPS.closeFillStroke:this.closeFillStroke();break;case s.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case s.OPS.nextLine:this.nextLine();break;case s.OPS.transform:this.transform(d[0],d[1],d[2],d[3],d[4],d[5]);break;case s.OPS.constructPath:this.constructPath(d[0],d[1]);break;case s.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,s.warn)("Unimplemented operator ".concat(l))}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"setWordSpacing",value:function(e){this.current.wordSpacing=e}},{key:"setCharSpacing",value:function(e){this.current.charSpacing=e}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"setTextMatrix",value:function(e,t,n,i,r,o){var a=this.current;a.textMatrix=a.lineMatrix=[e,t,n,i,r,o],a.textMatrixScale=Math.sqrt(e*e+t*t),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size","".concat(g(a.fontSize),"px")),a.tspan.setAttributeNS(null,"y",g(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.appendChild(a.tspan)}},{key:"beginText",value:function(){var e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=s.IDENTITY_MATRIX,e.lineMatrix=s.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[]}},{key:"moveText",value:function(e,t){var n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size","".concat(g(n.fontSize),"px")),n.tspan.setAttributeNS(null,"y",g(-n.y))}},{key:"showText",value:function(e){var t=this.current,n=t.font,i=t.fontSize;if(0!==i){var r=t.charSpacing,o=t.wordSpacing,a=t.fontDirection,l=t.textHScale*a,c=n.vertical,d=i*t.fontMatrix[0],u=0,h=!0,p=!1,f=void 0;try{for(var m,b=e[Symbol.iterator]();!(h=(m=b.next()).done);h=!0){var w=m.value;if(null!==w)if((0,s.isNum)(w))u+=-w*i*.001;else{var _=w.width,S=w.fontChar,k=_*d+((w.isSpace?o:0)+r)*a;w.isInFont||n.missingFile?(t.xcoords.push(t.x+u*l),t.tspan.textContent+=S,u+=k):u+=k}else u+=a*o}}catch(e){p=!0,f=e}finally{try{h||null==b.return||b.return()}finally{if(p)throw f}}c?t.y-=u*l:t.x+=u*l,t.tspan.setAttributeNS(null,"x",t.xcoords.map(g).join(" ")),t.tspan.setAttributeNS(null,"y",g(-t.y)),t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size","".concat(g(t.fontSize),"px")),t.fontStyle!==y.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==y.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);var P=t.textRenderingMode&s.TextRenderingMode.FILL_STROKE_MASK;if(P===s.TextRenderingMode.FILL||P===s.TextRenderingMode.FILL_STROKE?(t.fillColor!==y.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===s.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),P===s.TextRenderingMode.STROKE||P===s.TextRenderingMode.FILL_STROKE){var C=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,C)}var T=t.textMatrix;0!==t.textRise&&((T=T.slice())[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform","".concat(v(T)," scale(1, -1)")),t.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.txtElement.appendChild(t.tspan),t.txtgrp.appendChild(t.txtElement),this._ensureTransformGroup().appendChild(t.txtElement)}}},{key:"setLeadingMoveText",value:function(e,t){this.setLeading(-t),this.moveText(e,t)}},{key:"addFontStyle",value:function(e){this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=(0,s.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(e.loadedName,'";')+" src: url(".concat(t,"); }\n")}},{key:"setFont",value:function(e){var t=this.current,n=this.commonObjs.get(e[0]),i=e[1];t.font=n,this.embedFonts&&n.data&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix?n.fontMatrix:s.FONT_IDENTITY_MATRIX;var r=n.black?n.bold?"bolder":"bold":n.bold?"bold":"normal",o=n.italic?"italic":"normal";i<0?(i=-i,t.fontDirection=-1):t.fontDirection=1,t.fontSize=i,t.fontFamily=n.loadedName,t.fontWeight=r,t.fontStyle=o,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",g(-t.y)),t.xcoords=[]}},{key:"endText",value:function(){var e=this.current;e.textRenderingMode&s.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}},{key:"setLineWidth",value:function(e){e>0&&(this.current.lineWidth=e)}},{key:"setLineCap",value:function(e){this.current.lineCap=w[e]}},{key:"setLineJoin",value:function(e){this.current.lineJoin=_[e]}},{key:"setMiterLimit",value:function(e){this.current.miterLimit=e}},{key:"setStrokeAlpha",value:function(e){this.current.strokeAlpha=e}},{key:"setStrokeRGBColor",value:function(e,t,n){this.current.strokeColor=s.Util.makeCssRgb(e,t,n)}},{key:"setFillAlpha",value:function(e){this.current.fillAlpha=e}},{key:"setFillRGBColor",value:function(e,t,n){this.current.fillColor=s.Util.makeCssRgb(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[]}},{key:"setStrokeColorN",value:function(e){this.current.strokeColor=this._makeColorN_Pattern(e)}},{key:"setFillColorN",value:function(e){this.current.fillColor=this._makeColorN_Pattern(e)}},{key:"shadingFill",value:function(e){var t=this.viewport.width,n=this.viewport.height,i=s.Util.inverseTransform(this.transformMatrix),r=s.Util.applyTransform([0,0],i),o=s.Util.applyTransform([0,n],i),a=s.Util.applyTransform([t,0],i),l=s.Util.applyTransform([t,n],i),c=Math.min(r[0],o[0],a[0],l[0]),d=Math.min(r[1],o[1],a[1],l[1]),u=Math.max(r[0],o[0],a[0],l[0]),h=Math.max(r[1],o[1],a[1],l[1]),p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x",c),p.setAttributeNS(null,"y",d),p.setAttributeNS(null,"width",u-c),p.setAttributeNS(null,"height",h-d),p.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this._ensureTransformGroup().appendChild(p)}},{key:"_makeColorN_Pattern",value:function(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}},{key:"_makeTilingPattern",value:function(e){var t=e[1],n=e[2],i=e[3]||s.IDENTITY_MATRIX,r=u(e[4],4),o=r[0],a=r[1],l=r[2],c=r[3],h=e[5],p=e[6],f=e[7],m="shading".concat(T++),g=u(s.Util.applyTransform([o,a],i),2),v=g[0],y=g[1],b=u(s.Util.applyTransform([l,c],i),2),w=b[0],_=b[1],S=u(s.Util.singularValueDecompose2dScale(i),2),k=h*S[0],P=p*S[1],C=this.svgFactory.createElement("svg:pattern");C.setAttributeNS(null,"id",m),C.setAttributeNS(null,"patternUnits","userSpaceOnUse"),C.setAttributeNS(null,"width",k),C.setAttributeNS(null,"height",P),C.setAttributeNS(null,"x","".concat(v)),C.setAttributeNS(null,"y","".concat(y));var A=this.svg,I=this.transformMatrix,E=this.current.fillColor,x=this.current.strokeColor,R=this.svgFactory.create(w-v,_-y);if(this.svg=R,this.transformMatrix=i,2===f){var D=s.Util.makeCssRgb.apply(s.Util,d(t));this.current.fillColor=D,this.current.strokeColor=D}return this.executeOpTree(this.convertOpList(n)),this.svg=A,this.transformMatrix=I,this.current.fillColor=E,this.current.strokeColor=x,C.appendChild(R.childNodes[0]),this.defs.appendChild(C),"url(#".concat(m,")")}},{key:"_makeShadingPattern",value:function(e){switch(e[0]){case"RadialAxial":var t,n="shading".concat(T++),i=e[2];switch(e[1]){case"axial":var r=e[3],o=e[4];(t=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",n),t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),t.setAttributeNS(null,"x1",r[0]),t.setAttributeNS(null,"y1",r[1]),t.setAttributeNS(null,"x2",o[0]),t.setAttributeNS(null,"y2",o[1]);break;case"radial":var a=e[3],l=e[4],c=e[5],d=e[6];(t=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",n),t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),t.setAttributeNS(null,"cx",l[0]),t.setAttributeNS(null,"cy",l[1]),t.setAttributeNS(null,"r",d),t.setAttributeNS(null,"fx",a[0]),t.setAttributeNS(null,"fy",a[1]),t.setAttributeNS(null,"fr",c);break;default:throw new Error("Unknown RadialAxial type: ".concat(e[1]))}var u=!0,h=!1,p=void 0;try{for(var f,m=i[Symbol.iterator]();!(u=(f=m.next()).done);u=!0){var g=f.value,v=this.svgFactory.createElement("svg:stop");v.setAttributeNS(null,"offset",g[0]),v.setAttributeNS(null,"stop-color",g[1]),t.appendChild(v)}}catch(e){h=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(h)throw p}}return this.defs.appendChild(t),"url(#".concat(n,")");case"Mesh":return(0,s.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(e[0]))}}},{key:"setDash",value:function(e,t){this.current.dashArray=e,this.current.dashPhase=t}},{key:"constructPath",value:function(e,t){var n=this.current,i=n.x,r=n.y,o=[],a=0,l=!0,c=!1,d=void 0;try{for(var u,h=e[Symbol.iterator]();!(l=(u=h.next()).done);l=!0){switch(0|u.value){case s.OPS.rectangle:i=t[a++],r=t[a++];var p=t[a++],f=t[a++],m=i+p,v=r+f;o.push("M",g(i),g(r),"L",g(m),g(r),"L",g(m),g(v),"L",g(i),g(v),"Z");break;case s.OPS.moveTo:i=t[a++],r=t[a++],o.push("M",g(i),g(r));break;case s.OPS.lineTo:i=t[a++],r=t[a++],o.push("L",g(i),g(r));break;case s.OPS.curveTo:i=t[a+4],r=t[a+5],o.push("C",g(t[a]),g(t[a+1]),g(t[a+2]),g(t[a+3]),g(i),g(r)),a+=6;break;case s.OPS.curveTo2:i=t[a+2],r=t[a+3],o.push("C",g(i),g(r),g(t[a]),g(t[a+1]),g(t[a+2]),g(t[a+3])),a+=4;break;case s.OPS.curveTo3:i=t[a+2],r=t[a+3],o.push("C",g(t[a]),g(t[a+1]),g(i),g(r),g(i),g(r)),a+=4;break;case s.OPS.closePath:o.push("Z")}}}catch(e){c=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(c)throw d}}o=o.join(" "),n.path&&e.length>0&&e[0]!==s.OPS.rectangle&&e[0]!==s.OPS.moveTo?o=n.path.getAttributeNS(null,"d")+o:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(n.path)),n.path.setAttributeNS(null,"d",o),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(i,r)}},{key:"endPath",value:function(){var e=this.current;if(e.path=null,this.pendingClip)if(e.element){var t="clippath".concat(P++),n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",v(this.transformMatrix));var i=e.element.cloneNode(!0);"evenodd"===this.pendingClip?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.appendChild(i),this.defs.appendChild(n),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach(function(e){e.clipGroup=null}),n.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl="url(#".concat(t,")"),this.tgrp=null}else this.pendingClip=null}},{key:"clip",value:function(e){this.pendingClip=e}},{key:"closePath",value:function(){var e=this.current;if(e.path){var t="".concat(e.path.getAttributeNS(null,"d"),"Z");e.path.setAttributeNS(null,"d",t)}}},{key:"setLeading",value:function(e){this.current.leading=-e}},{key:"setTextRise",value:function(e){this.current.textRise=e}},{key:"setTextRenderingMode",value:function(e){this.current.textRenderingMode=e}},{key:"setHScale",value:function(e){this.current.textHScale=e/100}},{key:"setRenderingIntent",value:function(e){}},{key:"setFlatness",value:function(e){}},{key:"setGState",value:function(e){var t=!0,n=!1,i=void 0;try{for(var r,o=e[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var a=u(r.value,2),l=a[0],c=a[1];switch(l){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c);break;case"CA":this.setStrokeAlpha(c);break;case"ca":this.setFillAlpha(c);break;default:(0,s.warn)("Unimplemented graphic state operator ".concat(l))}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}},{key:"fill",value:function(){var e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}},{key:"stroke",value:function(){var e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}},{key:"_setStrokeAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.current,i=n.dashArray;1!==t&&i.length>0&&(i=i.map(function(e){return t*e})),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",g(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",g(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",i.map(g).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",g(t*n.dashPhase)+"px")}},{key:"eoFill",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}},{key:"fillStroke",value:function(){this.stroke(),this.fill()}},{key:"eoFillStroke",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.closePath(),this.eoFillStroke()}},{key:"paintSolidColorImageMask",value:function(){var e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}},{key:"paintJpegXObject",value:function(e,t,n){var i=this.objs.get(e),r=this.svgFactory.createElement("svg:image");r.setAttributeNS(b,"xlink:href",i.src),r.setAttributeNS(null,"width",g(t)),r.setAttributeNS(null,"height",g(n)),r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y",g(-n)),r.setAttributeNS(null,"transform","scale(".concat(g(1/t)," ").concat(g(-1/n),")")),this._ensureTransformGroup().appendChild(r)}},{key:"paintImageXObject",value:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,s.warn)("Dependent image with object ID ".concat(e," is not ready yet"))}},{key:"paintInlineImageXObject",value:function(e,t){var n=e.width,i=e.height,r=S(e,this.forceDataSchema,!!t),o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width",g(n)),o.setAttributeNS(null,"height",g(i)),this.current.element=o,this.clip("nonzero");var a=this.svgFactory.createElement("svg:image");a.setAttributeNS(b,"xlink:href",r),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",g(-i)),a.setAttributeNS(null,"width",g(n)+"px"),a.setAttributeNS(null,"height",g(i)+"px"),a.setAttributeNS(null,"transform","scale(".concat(g(1/n)," ").concat(g(-1/i),")")),t?t.appendChild(a):this._ensureTransformGroup().appendChild(a)}},{key:"paintImageMaskXObject",value:function(e){var t=this.current,n=e.width,i=e.height,r=t.fillColor;t.maskId="mask".concat(C++);var o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",t.maskId);var a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",g(n)),a.setAttributeNS(null,"height",g(i)),a.setAttributeNS(null,"fill",r),a.setAttributeNS(null,"mask","url(#".concat(t.maskId,")")),this.defs.appendChild(o),this._ensureTransformGroup().appendChild(a),this.paintInlineImageXObject(e,o)}},{key:"paintFormXObjectBegin",value:function(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){var n=t[2]-t[0],i=t[3]-t[1],r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x",t[0]),r.setAttributeNS(null,"y",t[1]),r.setAttributeNS(null,"width",g(n)),r.setAttributeNS(null,"height",g(i)),this.current.element=r,this.clip("nonzero"),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){}},{key:"_initialize",value:function(e){var t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.appendChild(n),this.defs=n;var i=this.svgFactory.createElement("svg:g");return i.setAttributeNS(null,"transform",v(e.transform)),t.appendChild(i),this.svg=i,t}},{key:"_ensureClipGroup",value:function(){if(!this.current.clipGroup){var e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}},{key:"_ensureTransformGroup",value:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",v(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}]),e}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var r,o=(r=i(148))&&r.__esModule?r:{default:r},a=i(1),s=i(166);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function f(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(e){p(o,i,r,a,s,"next",e)}function s(e){p(o,i,r,a,s,"throw",e)}a(void 0)})}}function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var y=n(177),b=n(178),w=n(179),_=n(180),S=/^file:\/\/\/[a-zA-Z]:\//;var k=function(){function e(t){var n,i;m(this,e),this.source=t,this.url=(n=t.url,"file:"===(i=_.parse(n)).protocol||i.host?i:/^[a-z]:[/\\]/i.test(n)?_.parse("file:///".concat(n)):(i.host||(i.protocol="file:"),i)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return v(e,[{key:"getFullReader",value:function(){return(0,a.assert)(!this._fullRequestReader),this._fullRequestReader=this.isFsUrl?new E(this):new A(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=this.isFsUrl?new x(this,e,t):new I(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach(function(t){t.cancel(e)})}},{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}}]),e}();t.PDFNodeStream=k;var P=function(){function e(t){m(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;var n=t.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)(),this._headersCapability=(0,a.createPromiseCapability)()}return v(e,[{key:"read",value:function(){var e=f(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",function(){t._readCapability.resolve()}),e.on("end",function(){e.destroy(),t._done=!0,t._readCapability.resolve()}),e.on("error",function(e){t._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new a.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),C=function(){function e(t){m(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,a.createPromiseCapability)();var n=t.source;this._isStreamingSupported=!n.disableStream}return v(e,[{key:"read",value:function(){var e=f(o.default.mark(function e(){var t,n;return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,a.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",function(){t._readCapability.resolve()}),e.on("end",function(){e.destroy(),t._done=!0,t._readCapability.resolve()}),e.on("error",function(e){t._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}();function T(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}var A=function(e){function t(e){var n;m(this,t);var i=function(t){if(404===t.statusCode){var i=new a.MissingPDFException('Missing PDF "'.concat(n._url,'".'));return n._storedError=i,void n._headersCapability.reject(i)}n._headersCapability.resolve(),n._setReadableStream(t);var r=function(e){return n._readableStream.headers[e.toLowerCase()]},o=(0,s.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:e.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),l=o.allowRangeRequests,c=o.suggestedLength;n._isRangeSupported=l,n._contentLength=c||n._contentLength,n._filename=(0,s.extractFilenameFromHeader)(r)};return(n=c(this,d(t).call(this,e)))._request=null,"http:"===n._url.protocol?n._request=b.request(T(n._url,e.httpHeaders),i):n._request=w.request(T(n._url,e.httpHeaders),i),n._request.on("error",function(e){n._storedError=e,n._headersCapability.reject(e)}),n._request.end(),n}return u(t,P),t}(),I=function(e){function t(e,n,i){var r;for(var o in m(this,t),(r=c(this,d(t).call(this,e)))._httpHeaders={},e.httpHeaders){var s=e.httpHeaders[o];void 0!==s&&(r._httpHeaders[o]=s)}r._httpHeaders.Range="bytes=".concat(n,"-").concat(i-1);var l=function(e){if(404!==e.statusCode)r._setReadableStream(e);else{var t=new a.MissingPDFException('Missing PDF "'.concat(r._url,'".'));r._storedError=t}};return r._request=null,"http:"===r._url.protocol?r._request=b.request(T(r._url,r._httpHeaders),l):r._request=w.request(T(r._url,r._httpHeaders),l),r._request.on("error",function(e){r._storedError=e}),r._request.end(),r}return u(t,C),t}(),E=function(e){function t(e){var n;m(this,t),n=c(this,d(t).call(this,e));var i=decodeURIComponent(n._url.path);return S.test(n._url.href)&&(i=i.replace(/^\//,"")),y.lstat(i,function(e,t){if(e)return"ENOENT"===e.code&&(e=new a.MissingPDFException('Missing PDF "'.concat(i,'".'))),n._storedError=e,void n._headersCapability.reject(e);n._contentLength=t.size,n._setReadableStream(y.createReadStream(i)),n._headersCapability.resolve()}),n}return u(t,P),t}(),x=function(e){function t(e,n,i){var r;m(this,t),r=c(this,d(t).call(this,e));var o=decodeURIComponent(r._url.path);return S.test(r._url.href)&&(o=o.replace(/^\//,"")),r._setReadableStream(y.createReadStream(o,{start:n,end:i-1})),r}return u(t,C),t}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){if(404===e||0===e&&/^file:/.test(t))return new i.MissingPDFException('Missing PDF "'+t+'".');return new i.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){var t=e("Content-Disposition");if(t){var n=(0,r.getFilenameFromContentDispositionHeader)(t);if(/\.pdf$/i.test(n))return n}return null},t.validateRangeRequestCapabilities=function(e){var t=e.getResponseHeader,n=e.isHttp,r=e.rangeChunkSize,o=e.disableRange;(0,i.assert)(r>0,"Range chunk size must be larger than zero");var a={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t("Content-Length"),10);if(!Number.isInteger(s))return a;if(a.suggestedLength=s,s<=2*r)return a;if(o||!n)return a;if("bytes"!==t("Accept-Ranges"))return a;if("identity"!==(t("Content-Encoding")||"identity"))return a;return a.allowRangeRequests=!0,a},t.validateResponseStatus=function(e){return 200===e||206===e};var i=n(1),r=n(167)},function(e,t,n){"use strict";function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){var t=!0,n=s("filename\\*","i").exec(e);if(n){var r=d(n=n[1]);return c(r=h(r=u(r=unescape(r))))}if(n=function(e){for(var t,n=[],r=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(t=r.exec(e));){var o=t,a=i(o,4),l=a[1],c=a[2],h=a[3];if((l=parseInt(l,10))in n){if(0===l)break}else n[l]=[c,h]}for(var p=[],l=0;l<n.length&&l in n;++l){var f=i(n[l],2),c=f[0],h=f[1];h=d(h),c&&(h=unescape(h),0===l&&(h=u(h))),p.push(h)}return p.join("")}(e)){var o=h(n);return c(o)}if(n=s("filename","i").exec(e)){var a=d(n=n[1]);return c(a=h(a))}function s(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function l(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{var i=new TextDecoder(e,{fatal:!0}),r=Array.from(n,function(e){return 255&e.charCodeAt(0)});n=i.decode(new Uint8Array(r)),t=!1}catch(i){if(/^utf-?8$/i.test(e))try{n=decodeURIComponent(escape(n)),t=!1}catch(e){}}}return n}function c(e){return t&&/[\x80-\xff]/.test(e)&&(e=l("utf-8",e),t&&(e=l("iso-8859-1",e))),e}function d(e){if(e.startsWith('"')){for(var t=e.slice(1).split('\\"'),n=0;n<t.length;++n){var i=t[n].indexOf('"');-1!==i&&(t[n]=t[n].slice(0,i),t.length=n+1),t[n]=t[n].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function u(e){var t=e.indexOf("'");if(-1===t)return e;var n=e.slice(0,t),i=e.slice(t+1),r=i.replace(/^[^']*'/,"");return l(n,r)}function h(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,i){if("q"===n||"Q"===n)return i=(i=i.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}),l(t,i);try{i=atob(i)}catch(e){}return l(t,i)})}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1),a=n(166);function s(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(e){s(o,i,r,a,l,"next",e)}function l(e){s(o,i,r,a,l,"throw",e)}a(void 0)})}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}var h=function(){function e(t,n){c(this,e),this.url=t,n=n||{},this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&n.httpHeaders||{},this.withCredentials=n.withCredentials||!1,this.getXhr=n.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}return u(e,[{key:"requestRange",value:function(e,t,n){var i={begin:e,end:t};for(var r in n)i[r]=n[r];return this.request(i)}},{key:"requestFull",value:function(e){return this.request(e)}},{key:"request",value:function(e){var t=this.getXhr(),n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};for(var r in t.open("GET",this.url),t.withCredentials=this.withCredentials,this.httpHeaders){var o=this.httpHeaders[r];void 0!==o&&t.setRequestHeader(r,o)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}},{key:"onProgress",value:function(e,t){var n=this.pendingRequests[e];n&&n.onProgress&&n.onProgress(t)}},{key:"onStateChange",value:function(e,t){var n=this.pendingRequests[e];if(n){var i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4===i.readyState&&e in this.pendingRequests)if(delete this.pendingRequests[e],0===i.status&&this.isHttp)n.onError&&n.onError(i.status);else{var r=i.status||200;if(200===r&&206===n.expectedStatus||r===n.expectedStatus){var a=function(e){var t=e.response;return"string"!=typeof t?t:(0,o.stringToBytes)(t).buffer}(i);if(206===r){var s=i.getResponseHeader("Content-Range"),l=/bytes (\d+)-(\d+)\/(\d+)/.exec(s);n.onDone({begin:parseInt(l[1],10),chunk:a})}else a?n.onDone({begin:0,chunk:a}):n.onError&&n.onError(i.status)}else n.onError&&n.onError(i.status)}}}},{key:"hasPendingRequests",value:function(){for(var e in this.pendingRequests)return!0;return!1}},{key:"getRequestXhr",value:function(e){return this.pendingRequests[e].xhr}},{key:"isPendingRequest",value:function(e){return e in this.pendingRequests}},{key:"abortAllRequests",value:function(){for(var e in this.pendingRequests)this.abortRequest(0|e)}},{key:"abortRequest",value:function(e){var t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}]),e}(),p=function(){function e(t){c(this,e),this._source=t,this._manager=new h(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}return u(e,[{key:"_onRangeRequestReaderClosed",value:function(e){var t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}},{key:"getFullReader",value:function(){return(0,o.assert)(!this._fullRequestReader),this._fullRequestReader=new f(this._manager,this._source),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){var n=new m(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach(function(t){t.cancel(e)})}}]),e}();t.PDFNetworkStream=p;var f=function(){function e(t,n){c(this,e),this._manager=t;var i={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=n.url,this._fullRequestId=t.requestFull(i),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=n.disableRange||!1,this._contentLength=n.length,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}return u(e,[{key:"_onHeadersReceived",value:function(){var e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=function(e){return t.getResponseHeader(e)},i=(0,a.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),r=i.allowRangeRequests,o=i.suggestedLength;r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}},{key:"_onDone",value:function(e){e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk));this._done=!0,this._cachedChunks.length>0||(this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[])}},{key:"_onError",value:function(e){var t=this._url,n=(0,a.createResponseStatusError)(e,t);this._storedError=n,this._headersReceivedCapability.reject(n),this._requests.forEach(function(e){e.reject(n)}),this._requests=[],this._cachedChunks=[]}},{key:"_onProgress",value:function(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}},{key:"read",value:function(){var e=l(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._storedError){e.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){e.next=5;break}return t=this._cachedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 5:if(!this._done){e.next=7;break}return e.abrupt("return",{value:void 0,done:!0});case 7:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"contentLength",get:function(){return this._contentLength}},{key:"headersReady",get:function(){return this._headersReceivedCapability.promise}}]),e}(),m=function(){function e(t,n,i){c(this,e),this._manager=t;var r={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=t.requestRange(n,i,r),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}return u(e,[{key:"_close",value:function(){this.onClosed&&this.onClosed(this)}},{key:"_onDone",value:function(e){var t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t;this._done=!0,this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[],this._close()}},{key:"_onProgress",value:function(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})}},{key:"read",value:function(){var e=l(r.default.mark(function e(){var t,n;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach(function(e){e.resolve({value:void 0,done:!0})}),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},{key:"isStreamingSupported",get:function(){return!1}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var i,r=(i=n(148))&&i.__esModule?i:{default:i},o=n(1),a=n(166);function s(e,t,n,i,r,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(i,r)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(i,r){var o=e.apply(t,n);function a(e){s(o,i,r,a,l,"next",e)}function l(e){s(o,i,r,a,l,"throw",e)}a(void 0)})}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function u(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function h(e,t,n){return{method:"GET",headers:e,signal:n&&n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}var p=function(){function e(t){c(this,e),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return u(e,[{key:"getFullReader",value:function(){return(0,o.assert)(!this._fullRequestReader),this._fullRequestReader=new f(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=new m(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach(function(t){t.cancel(e)})}},{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}}]),e}();t.PDFFetchStream=p;var f=function(){function e(t){var n=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0,this._filename=null;var i=t.source;for(var r in this._withCredentials=i.withCredentials||!1,this._contentLength=i.length,this._headersCapability=(0,o.createPromiseCapability)(),this._disableRange=i.disableRange||!1,this._rangeChunkSize=i.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!i.disableStream,this._isRangeSupported=!i.disableRange,this._headers=new Headers,this._stream.httpHeaders){var s=this._stream.httpHeaders[r];void 0!==s&&this._headers.append(r,s)}var l=i.url;fetch(l,h(this._headers,this._withCredentials,this._abortController)).then(function(e){if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,l);n._reader=e.body.getReader(),n._headersCapability.resolve();var t=function(t){return e.headers.get(t)},i=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:n._stream.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),r=i.allowRangeRequests,s=i.suggestedLength;n._isRangeSupported=r,n._contentLength=s||n._contentLength,n._filename=(0,a.extractFilenameFromHeader)(t),!n._isStreamingSupported&&n._isRangeSupported&&n.cancel(new o.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}return u(e,[{key:"read",value:function(){var e=l(r.default.mark(function e(){var t,n,i,o;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._headersCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(i=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:i});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),o=new Uint8Array(n).buffer,e.abrupt("return",{value:o,done:!1});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}(),m=function(){function e(t,n,i){var r=this;c(this,e),this._stream=t,this._reader=null,this._loaded=0;var s=t.source;for(var l in this._withCredentials=s.withCredentials||!1,this._readCapability=(0,o.createPromiseCapability)(),this._isStreamingSupported=!s.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=new Headers,this._stream.httpHeaders){var d=this._stream.httpHeaders[l];void 0!==d&&this._headers.append(l,d)}this._headers.append("Range","bytes=".concat(n,"-").concat(i-1));var u=s.url;fetch(u,h(this._headers,this._withCredentials,this._abortController)).then(function(e){if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,u);r._readCapability.resolve(),r._reader=e.body.getReader()}),this.onProgress=null}return u(e,[{key:"read",value:function(){var e=l(r.default.mark(function e(){var t,n,i,o;return r.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(i=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:i});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),o=new Uint8Array(n).buffer,e.abrupt("return",{value:o,done:!1});case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}}]),e}()}])},e.exports=o()}).call(this,n(54).Buffer,n(28),n(55))},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=n(76),r=n(77),o=n(78);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,n)}function c(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),r=(e=s(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?s(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=s(e,t<0?0:0|p(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(i)return j(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function g(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,n,i,r);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,i,r){var o,a=1,s=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(r){var d=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===l)return d*a}else-1!==d&&(o-=o-d),d=-1}else for(n+l>s&&(n=s-l),o=n;o>=0;o--){for(var u=!0,h=0;h<l;h++)if(c(e,o+h)!==c(t,h)){u=!1;break}if(u)return o}return-1}function y(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var a=0;a<i;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,i){return U(j(t,e.length-n),e,n,i)}function w(e,t,n,i){return U(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function _(e,t,n,i){return w(e,t,n,i)}function S(e,t,n,i){return U(V(t),e,n,i)}function k(e,t,n,i){return U(function(e,t){for(var n,i,r,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(t,e.length-n),e,n,i)}function P(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var o,a,s,l,c=e[r],d=null,u=c>239?4:c>223?3:c>191?2:1;if(r+u<=n)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(o=e[r+1]))&&(l=(31&c)<<6|63&o)>127&&(d=l);break;case 3:o=e[r+1],a=e[r+2],128==(192&o)&&128==(192&a)&&(l=(15&c)<<12|(63&o)<<6|63&a)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:o=e[r+1],a=e[r+2],s=e[r+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),r+=u}return function(e){var t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=T));return n}(i)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,i){return d(t),t<=0?s(e,t):void 0!==n?"string"==typeof i?s(e,t).fill(n,i):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,o=Math.min(n,i);r<o;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=l.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,r),r+=a.length}return i},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):function(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return A(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,i,r){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(i>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(i,r),d=e.slice(t,n),u=0;u<s;++u)if(c[u]!==d[u]){o=c[u],a=d[u];break}return o<a?-1:a<o?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},l.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return _(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var T=4096;function A(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function I(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function E(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",o=t;o<n;++o)r+=B(e[o]);return r}function x(e,t,n){for(var i=e.slice(t,n),r="",o=0;o<i.length;o+=2)r+=String.fromCharCode(i[o]+256*i[o+1]);return r}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,n,i,r,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function L(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-n,2);r<o;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function M(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-n,4);r<o;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function W(e,t,n,i,r,o){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,i,o){return o||W(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function O(e,t,n,i,o){return o||W(e,0,n,8),r.write(e,t,n,i,52,8),n+8}l.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var r=t-e;n=new l(r,void 0);for(var o=0;o<r;++o)n[o]=this[o+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},l.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var i=this[e],r=1,o=0;++o<t&&(r*=256);)i+=this[e+o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var i=t,r=1,o=this[e+--i];i>0&&(r*=256);)o+=this[e+--i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),r.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),r.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),r.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),r.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,o=0;for(this[t]=255&e;++o<n&&(r*=256);)this[t+o]=e/r&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||D(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):M(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);D(this,e,t,n,r-1,-r)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):M(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):M(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return O(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return O(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,o=i-n;if(this===e&&n<t&&t<i)for(r=o-1;r>=0;--r)e[r+t]=this[r+n];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},l.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=l.isBuffer(e)?e:j(new l(e,i).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var i=e.length,r=null,o=[],a=0;a<i;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===i){(t-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(28))},function(e,t){var n,i,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:a}catch(e){i=a}}();var l,c=[],d=!1,u=-1;function h(){d&&l&&(d=!1,l.length?c=l.concat(c):u=-1,c.length&&p())}function p(){if(!d){var e=s(h);d=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===a||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||d||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){var i=n(20),r=n(15).document,o=i(r)&&i(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},function(e,t,n){var i=n(20);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:n)(e)}},function(e,t,n){"use strict";var i=n(40),r=n(10),o=n(82),a=n(25),s=n(33),l=n(108),c=n(42),d=n(85),u=n(17)("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,f,m,g,v){l(n,t,f);var y,b,w,_=function(e){if(!h&&e in C)return C[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",k="values"==m,P=!1,C=e.prototype,T=C[u]||C["@@iterator"]||m&&C[m],A=T||_(m),I=m?k?_("entries"):A:void 0,E="Array"==t&&C.entries||T;if(E&&(w=d(E.call(new e)))!==Object.prototype&&w.next&&(c(w,S,!0),i||"function"==typeof w[u]||a(w,u,p)),k&&T&&"values"!==T.name&&(P=!0,A=function(){return T.call(this)}),i&&!v||!h&&!P&&C[u]||a(C,u,A),s[t]=A,s[S]=p,m)if(y={values:k?A:_("values"),keys:g?A:_("keys"),entries:I},v)for(b in y)b in C||o(C,b,y[b]);else r(r.P+r.F*(h||P),t,y);return y}},function(e,t,n){var i=n(41);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==i(e)?e.split(""):Object(e)}},function(e,t,n){var i=n(62)("keys"),r=n(49);e.exports=function(e){return i[e]||(i[e]=r(e))}},function(e,t,n){var i=n(8),r=n(15),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:i.version,mode:n(40)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){t.f=n(17)},function(e,t,n){var i=n(49)("meta"),r=n(20),o=n(29),a=n(19).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(26)(function(){return l(Object.preventExtensions({}))}),d=function(e){a(e,i,{value:{i:"O"+ ++s,w:{}}})},u=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,i)){if(!l(e))return"F";if(!t)return"E";d(e)}return e[i].i},getWeak:function(e,t){if(!o(e,i)){if(!l(e))return!0;if(!t)return!1;d(e)}return e[i].w},onFreeze:function(e){return c&&u.NEED&&l(e)&&!o(e,i)&&d(e),e}}},function(e,t,n){var i=n(15),r=n(8),o=n(40),a=n(64),s=n(19).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=o?{}:i.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var i=n(41);e.exports=Array.isArray||function(e){return"Array"==i(e)}},function(e,t,n){var i=n(44),r=n(39),o=n(27),a=n(57),s=n(29),l=n(81),c=Object.getOwnPropertyDescriptor;t.f=n(18)?c:function(e,t){if(e=o(e),t=a(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return r(!i.f.call(e,t),e[t])}},function(e,t){},function(e,t,n){var i=n(50),r=n(17)("iterator"),o=n(33);e.exports=n(8).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||o[i(e)]}},function(e,t,n){var i=n(10),r=n(8),o=n(26);e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*o(function(){n(1)}),"Object",a)}},function(e,t,n){var i=n(25);e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:i(e,r,t[r]);return e}},function(e,t){e.exports=function(e,t,n,i){if(!(e instanceof t)||void 0!==i&&i in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){"use strict";var i=n(38);function r(e){var t,n;this.promise=new e(function(e,i){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=i}),this.resolve=i(t),this.reject=i(n)}e.exports.f=function(e){return new r(e)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){for(var t,n=c(e),i=n[0],a=n[1],s=new o(function(e,t,n){return 3*(t+n)/4-n}(0,i,a)),l=0,d=a>0?i-4:i,u=0;u<d;u+=4)t=r[e.charCodeAt(u)]<<18|r[e.charCodeAt(u+1)]<<12|r[e.charCodeAt(u+2)]<<6|r[e.charCodeAt(u+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;2===a&&(t=r[e.charCodeAt(u)]<<2|r[e.charCodeAt(u+1)]>>4,s[l++]=255&t);1===a&&(t=r[e.charCodeAt(u)]<<10|r[e.charCodeAt(u+1)]<<4|r[e.charCodeAt(u+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t);return s},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,o=[],a=0,s=n-r;a<s;a+=16383)o.push(d(e,a,a+16383>s?s:a+16383));1===r?(t=e[n-1],o.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],o.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return o.join("")};for(var i=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)i[s]=a[s],r[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var r,o,a=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return a.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var o,a,s=8*r-i-1,l=(1<<s)-1,c=l>>1,d=-7,u=n?r-1:0,h=n?-1:1,p=e[t+u];for(u+=h,o=p&(1<<-d)-1,p>>=-d,d+=s;d>0;o=256*o+e[t+u],u+=h,d-=8);for(a=o&(1<<-d)-1,o>>=-d,d+=i;d>0;a=256*a+e[t+u],u+=h,d-=8);if(0===o)o=1-c;else{if(o===l)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,i),o-=c}return(p?-1:1)*a*Math.pow(2,o-i)},t.write=function(e,t,n,i,r,o){var a,s,l,c=8*o-r-1,d=(1<<c)-1,u=d>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=d):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=d?(s=0,a=d):a+u>=1?(s=(t*l-1)*Math.pow(2,r),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,r),a=0));r>=8;e[n+p]=255&s,p+=f,s/=256,r-=8);for(a=a<<r|s,c+=r;c>0;e[n+p]=255&a,p+=f,a/=256,c-=8);e[n+p-f]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(189)},,function(e,t,n){e.exports=!n(18)&&!n(26)(function(){return 7!=Object.defineProperty(n(56)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){e.exports=n(25)},function(e,t,n){var i=n(29),r=n(27),o=n(110)(!1),a=n(61)("IE_PROTO");e.exports=function(e,t){var n,s=r(e),l=0,c=[];for(n in s)n!=a&&i(s,n)&&c.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~o(c,n)||c.push(n));return c}},function(e,t,n){var i=n(15).document;e.exports=i&&i.documentElement},function(e,t,n){var i=n(29),r=n(30),o=n(61)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),i(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var i=n(15),r=n(29),o=n(18),a=n(10),s=n(82),l=n(65).KEY,c=n(26),d=n(62),u=n(42),h=n(49),p=n(17),f=n(64),m=n(66),g=n(116),v=n(68),y=n(22),b=n(20),w=n(30),_=n(27),S=n(57),k=n(39),P=n(47),C=n(117),T=n(69),A=n(67),I=n(19),E=n(34),x=T.f,R=I.f,D=C.f,L=i.Symbol,M=i.JSON,W=M&&M.stringify,N=p("_hidden"),O=p("toPrimitive"),F={}.propertyIsEnumerable,B=d("symbol-registry"),j=d("symbols"),V=d("op-symbols"),U=Object.prototype,z="function"==typeof L&&!!A.f,q=i.QObject,H=!q||!q.prototype||!q.prototype.findChild,G=o&&c(function(){return 7!=P(R({},"a",{get:function(){return R(this,"a",{value:7}).a}})).a})?function(e,t,n){var i=x(U,t);i&&delete U[t],R(e,t,n),i&&e!==U&&R(U,t,i)}:R,Y=function(e){var t=j[e]=P(L.prototype);return t._k=e,t},J=z&&"symbol"==typeof L.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof L},X=function(e,t,n){return e===U&&X(V,t,n),y(e),t=S(t,!0),y(n),r(j,t)?(n.enumerable?(r(e,N)&&e[N][t]&&(e[N][t]=!1),n=P(n,{enumerable:k(0,!1)})):(r(e,N)||R(e,N,k(1,{})),e[N][t]=!0),G(e,t,n)):R(e,t,n)},K=function(e,t){y(e);for(var n,i=g(t=_(t)),r=0,o=i.length;o>r;)X(e,n=i[r++],t[n]);return e},Q=function(e){var t=F.call(this,e=S(e,!0));return!(this===U&&r(j,e)&&!r(V,e))&&(!(t||!r(this,e)||!r(j,e)||r(this,N)&&this[N][e])||t)},Z=function(e,t){if(e=_(e),t=S(t,!0),e!==U||!r(j,t)||r(V,t)){var n=x(e,t);return!n||!r(j,t)||r(e,N)&&e[N][t]||(n.enumerable=!0),n}},$=function(e){for(var t,n=D(_(e)),i=[],o=0;n.length>o;)r(j,t=n[o++])||t==N||t==l||i.push(t);return i},ee=function(e){for(var t,n=e===U,i=D(n?V:_(e)),o=[],a=0;i.length>a;)!r(j,t=i[a++])||n&&!r(U,t)||o.push(j[t]);return o};z||(s((L=function(){if(this instanceof L)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function(n){this===U&&t.call(V,n),r(this,N)&&r(this[N],e)&&(this[N][e]=!1),G(this,e,k(1,n))};return o&&H&&G(U,e,{configurable:!0,set:t}),Y(e)}).prototype,"toString",function(){return this._k}),T.f=Z,I.f=X,n(88).f=C.f=$,n(44).f=Q,A.f=ee,o&&!n(40)&&s(U,"propertyIsEnumerable",Q,!0),f.f=function(e){return Y(p(e))}),a(a.G+a.W+a.F*!z,{Symbol:L});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var ie=E(p.store),re=0;ie.length>re;)m(ie[re++]);a(a.S+a.F*!z,"Symbol",{for:function(e){return r(B,e+="")?B[e]:B[e]=L(e)},keyFor:function(e){if(!J(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){H=!0},useSimple:function(){H=!1}}),a(a.S+a.F*!z,"Object",{create:function(e,t){return void 0===t?P(e):K(P(e),t)},defineProperty:X,defineProperties:K,getOwnPropertyDescriptor:Z,getOwnPropertyNames:$,getOwnPropertySymbols:ee});var oe=c(function(){A.f(1)});a(a.S+a.F*oe,"Object",{getOwnPropertySymbols:function(e){return A.f(w(e))}}),M&&a(a.S+a.F*(!z||c(function(){var e=L();return"[null]"!=W([e])||"{}"!=W({a:e})||"{}"!=W(Object(e))})),"JSON",{stringify:function(e){for(var t,n,i=[e],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=t=i[1],(b(t)||void 0!==e)&&!J(e))return v(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!J(t))return t}),i[1]=t,W.apply(M,i)}}),L.prototype[O]||n(25)(L.prototype,O,L.prototype.valueOf),u(L,"Symbol"),u(Math,"Math",!0),u(i.JSON,"JSON",!0)},function(e,t,n){var i=n(83),r=n(63).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t,n){var i=n(18),r=n(34),o=n(27),a=n(44).f;e.exports=function(e){return function(t){for(var n,s=o(t),l=r(s),c=l.length,d=0,u=[];c>d;)n=l[d++],i&&!a.call(s,n)||u.push(e?[n,s[n]]:s[n]);return u}}},function(e,t,n){var i=n(22);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},function(e,t,n){var i=n(33),r=n(17)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||o[r]===e)}},function(e,t,n){var i=n(17)("iterator"),r=!1;try{var o=[7][i]();o.return=function(){r=!0},Array.from(o,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o=[7],a=o[i]();a.next=function(){return{done:n=!0}},o[i]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var i=n(15),r=n(8),o=n(19),a=n(18),s=n(17)("species");e.exports=function(e){var t="function"==typeof r[e]?r[e]:i[e];a&&t&&!t[s]&&o.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var i=n(20);e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){e.exports=n(163)},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var i=n(22),r=n(38),o=n(17)("species");e.exports=function(e,t){var n,a=i(e).constructor;return void 0===a||null==(n=i(a)[o])?t:r(n)}},function(e,t,n){var i,r,o,a=n(23),s=n(171),l=n(84),c=n(56),d=n(15),u=d.process,h=d.setImmediate,p=d.clearImmediate,f=d.MessageChannel,m=d.Dispatch,g=0,v={},y=function(){var e=+this;if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},b=function(e){y.call(e.data)};h&&p||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return v[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},p=function(e){delete v[e]},"process"==n(41)(u)?i=function(e){u.nextTick(a(y,e,1))}:m&&m.now?i=function(e){m.now(a(y,e,1))}:f?(o=(r=new f).port2,r.port1.onmessage=b,i=a(o.postMessage,o,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(i=function(e){d.postMessage(e+"","*")},d.addEventListener("message",b,!1)):i="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:h,clear:p}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){var i=n(22),r=n(20),o=n(75);e.exports=function(e,t){if(i(e),r(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){e.exports=n(198)},function(e,t,n){var i;
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(r,o,a,s){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],d=o.createElement("div"),u="function",h=Math.round,p=Math.abs,f=Date.now;function m(e,t,n){return setTimeout(S(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(v(e,n[t],n),!0)}function v(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function y(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==s&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign;var b=y(function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&e[i[r]]===s)&&(e[i[r]]=t[i[r]]),r++;return e},"extend","Use `assign`."),w=y(function(e,t){return b(e,t,!0)},"merge","Use `assign`.");function _(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&l(i,n)}function S(e,t){return function(){return e.apply(t,arguments)}}function k(e,t){return typeof e==u?e.apply(t&&t[0]||s,t):e}function P(e,t){return e===s?t:e}function C(e,t,n){v(E(t),function(t){e.addEventListener(t,n,!1)})}function T(e,t,n){v(E(t),function(t){e.removeEventListener(t,n,!1)})}function A(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function I(e,t){return e.indexOf(t)>-1}function E(e){return e.trim().split(/\s+/g)}function x(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function R(e){return Array.prototype.slice.call(e,0)}function D(e,t,n){for(var i=[],r=[],o=0;o<e.length;){var a=t?e[o][t]:e[o];x(r,a)<0&&i.push(e[o]),r[o]=a,o++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function L(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),o=0;o<c.length;){if((i=(n=c[o])?n+r:t)in e)return i;o++}return s}var M=1;function W(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var N="ontouchstart"in r,O=L(r,"PointerEvent")!==s,F=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B=25,j=1,V=2,U=4,z=8,q=1,H=2,G=4,Y=8,J=16,X=H|G,K=Y|J,Q=X|K,Z=["x","y"],$=["clientX","clientY"];function ee(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){k(e.options.enable,[e])&&n.handler(t)},this.init()}function te(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,o=t&j&&i-r==0,a=t&(U|z)&&i-r==0;n.isFirst=!!o,n.isFinal=!!a,o&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=ne(t));r>1&&!n.firstMultiple?n.firstMultiple=ne(t):1===r&&(n.firstMultiple=!1);var o=n.firstInput,a=n.firstMultiple,l=a?a.center:o.center,c=t.center=ie(i);t.timeStamp=f(),t.deltaTime=t.timeStamp-o.timeStamp,t.angle=se(l,c),t.distance=ae(l,c),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},o=e.prevInput||{};t.eventType!==j&&o.eventType!==U||(r=e.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y});t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=oe(t.deltaX,t.deltaY);var d=re(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=d.x,t.overallVelocityY=d.y,t.overallVelocity=p(d.x)>p(d.y)?d.x:d.y,t.scale=a?(u=a.pointers,h=i,ae(h[0],h[1],$)/ae(u[0],u[1],$)):1,t.rotation=a?function(e,t){return se(t[1],t[0],$)+se(e[1],e[0],$)}(a.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,o,a=e.lastInterval||t,l=t.timeStamp-a.timeStamp;if(t.eventType!=z&&(l>B||a.velocity===s)){var c=t.deltaX-a.deltaX,d=t.deltaY-a.deltaY,u=re(l,c,d);i=u.x,r=u.y,n=p(u.x)>p(u.y)?u.x:u.y,o=oe(c,d),e.lastInterval=t}else n=a.velocity,i=a.velocityX,r=a.velocityY,o=a.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=o}(n,t);var u,h;var m=e.element;A(t.srcEvent.target,m)&&(m=t.srcEvent.target);t.target=m}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function ne(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:ie(t),deltaX:e.deltaX,deltaY:e.deltaY}}function ie(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:h(n/t),y:h(i/t)}}function re(e,t,n){return{x:t/e||0,y:n/e||0}}function oe(e,t){return e===t?q:p(e)>=p(t)?e<0?H:G:t<0?Y:J}function ae(e,t,n){n||(n=Z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function se(e,t,n){n||(n=Z);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return 180*Math.atan2(r,i)/Math.PI}ee.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(W(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&T(this.element,this.evEl,this.domHandler),this.evTarget&&T(this.target,this.evTarget,this.domHandler),this.evWin&&T(W(this.element),this.evWin,this.domHandler)}};var le={mousedown:j,mousemove:V,mouseup:U},ce="mousedown",de="mousemove mouseup";function ue(){this.evEl=ce,this.evWin=de,this.pressed=!1,ee.apply(this,arguments)}_(ue,ee,{handler:function(e){var t=le[e.type];t&j&&0===e.button&&(this.pressed=!0),t&V&&1!==e.which&&(t=U),this.pressed&&(t&U&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var he={pointerdown:j,pointermove:V,pointerup:U,pointercancel:z,pointerout:z},pe={2:"touch",3:"pen",4:"mouse",5:"kinect"},fe="pointerdown",me="pointermove pointerup pointercancel";function ge(){this.evEl=fe,this.evWin=me,ee.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(fe="MSPointerDown",me="MSPointerMove MSPointerUp MSPointerCancel"),_(ge,ee,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=he[i],o=pe[e.pointerType]||e.pointerType,a="touch"==o,s=x(t,e.pointerId,"pointerId");r&j&&(0===e.button||a)?s<0&&(t.push(e),s=t.length-1):r&(U|z)&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:o,srcEvent:e}),n&&t.splice(s,1))}});var ve={touchstart:j,touchmove:V,touchend:U,touchcancel:z},ye="touchstart",be="touchstart touchmove touchend touchcancel";function we(){this.evTarget=ye,this.evWin=be,this.started=!1,ee.apply(this,arguments)}_(we,ee,{handler:function(e){var t=ve[e.type];if(t===j&&(this.started=!0),this.started){var n=function(e,t){var n=R(e.touches),i=R(e.changedTouches);t&(U|z)&&(n=D(n.concat(i),"identifier",!0));return[n,i]}.call(this,e,t);t&(U|z)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var _e={touchstart:j,touchmove:V,touchend:U,touchcancel:z},Se="touchstart touchmove touchend touchcancel";function ke(){this.evTarget=Se,this.targetIds={},ee.apply(this,arguments)}_(ke,ee,{handler:function(e){var t=_e[e.type],n=function(e,t){var n=R(e.touches),i=this.targetIds;if(t&(j|V)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,a=R(e.changedTouches),s=[],l=this.target;if(o=n.filter(function(e){return A(e.target,l)}),t===j)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;r=0;for(;r<a.length;)i[a[r].identifier]&&s.push(a[r]),t&(U|z)&&delete i[a[r].identifier],r++;if(!s.length)return;return[D(o.concat(s),"identifier",!0),s]}.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}});var Pe=2500,Ce=25;function Te(){ee.apply(this,arguments);var e=S(this.handler,this);this.touch=new ke(this.manager,e),this.mouse=new ue(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function Ae(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout(function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)},Pe)}}_(Te,ee,{handler:function(e,t,n){var i="touch"==n.pointerType,r="mouse"==n.pointerType;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)(function(e,t){e&j?(this.primaryTouch=t.changedPointers[0].identifier,Ae.call(this,t)):e&(U|z)&&Ae.call(this,t)}).call(this,t,n);else if(r&&function(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(t-r.x),a=Math.abs(n-r.y);if(o<=Ce&&a<=Ce)return!0}return!1}.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ie=L(d.style,"touchAction"),Ee=Ie!==s,xe="auto",Re="manipulation",De="none",Le="pan-x",Me="pan-y",We=function(){if(!Ee)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||r.CSS.supports("touch-action",n)}),e}();function Ne(e,t){this.manager=e,this.set(t)}Ne.prototype={set:function(e){"compute"==e&&(e=this.compute()),Ee&&this.manager.element.style&&We[e]&&(this.manager.element.style[Ie]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return v(this.manager.recognizers,function(t){k(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(I(e,De))return De;var t=I(e,Le),n=I(e,Me);if(t&&n)return De;if(t||n)return t?Le:Me;if(I(e,Re))return Re;return xe}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=I(i,De)&&!We[De],o=I(i,Me)&&!We[Me],a=I(i,Le)&&!We[Le];if(r){var s=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(s&&l&&c)return}if(!a||!o)return r||o&&n&X||a&&n&K?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Oe=1,Fe=2,Be=4,je=8,Ve=je,Ue=16;function ze(e){this.options=l({},this.defaults,e||{}),this.id=M++,this.manager=null,this.options.enable=P(this.options.enable,!0),this.state=Oe,this.simultaneous={},this.requireFail=[]}function qe(e){return e&Ue?"cancel":e&je?"end":e&Be?"move":e&Fe?"start":""}function He(e){return e==J?"down":e==Y?"up":e==H?"left":e==G?"right":""}function Ge(e,t){var n=t.manager;return n?n.get(e):e}function Ye(){ze.apply(this,arguments)}function Je(){Ye.apply(this,arguments),this.pX=null,this.pY=null}function Xe(){Ye.apply(this,arguments)}function Ke(){ze.apply(this,arguments),this._timer=null,this._input=null}function Qe(){Ye.apply(this,arguments)}function Ze(){Ye.apply(this,arguments)}function $e(){ze.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function et(e,t){return(t=t||{}).recognizers=P(t.recognizers,et.defaults.preset),new tt(e,t)}ze.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Ge(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)?this:(e=Ge(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===x(t,e=Ge(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=Ge(e,this);var t=x(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<je&&i(t.options.event+qe(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=je&&i(t.options.event+qe(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(32|Oe)))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!k(this.options.enable,[this,t]))return this.reset(),void(this.state=32);this.state&(Ve|Ue|32)&&(this.state=Oe),this.state=this.process(t),this.state&(Fe|Be|je|Ue)&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},_(Ye,ze,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=t&(Fe|Be),r=this.attrTest(e);return i&&(n&z||!r)?t|Ue:i||r?n&U?t|je:t&Fe?t|Be:Fe:32}}),_(Je,Ye,{defaults:{event:"pan",threshold:10,pointers:1,direction:Q},getTouchAction:function(){var e=this.options.direction,t=[];return e&X&&t.push(Me),e&K&&t.push(Le),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,o=e.deltaX,a=e.deltaY;return r&t.direction||(t.direction&X?(r=0===o?q:o<0?H:G,n=o!=this.pX,i=Math.abs(e.deltaX)):(r=0===a?q:a<0?Y:J,n=a!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return Ye.prototype.attrTest.call(this,e)&&(this.state&Fe||!(this.state&Fe)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=He(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),_(Xe,Ye,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[De]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Fe)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),_(Ke,ze,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[xe]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||e.eventType&(U|z)&&!r)this.reset();else if(e.eventType&j)this.reset(),this._timer=m(function(){this.state=Ve,this.tryEmit()},t.time,this);else if(e.eventType&U)return Ve;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===Ve&&(e&&e.eventType&U?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),_(Qe,Ye,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[De]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Fe)}}),_(Ze,Ye,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:X|K,pointers:1},getTouchAction:function(){return Je.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return n&(X|K)?t=e.overallVelocity:n&X?t=e.overallVelocityX:n&K&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&p(t)>this.options.velocity&&e.eventType&U},emit:function(e){var t=He(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),_($e,ze,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Re]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),e.eventType&j&&0===this.count)return this.failTimeout();if(i&&r&&n){if(e.eventType!=U)return this.failTimeout();var o=!this.pTime||e.timeStamp-this.pTime<t.interval,a=!this.pCenter||ae(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,a&&o?this.count+=1:this.count=1,this._input=e,0===this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=Ve,this.tryEmit()},t.interval,this),Fe):Ve}return 32},failTimeout:function(){return this._timer=m(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ve&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),et.VERSION="2.0.7",et.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Qe,{enable:!1}],[Xe,{enable:!1},["rotate"]],[Ze,{direction:X}],[Je,{direction:X},["swipe"]],[$e],[$e,{event:"doubletap",taps:2},["tap"]],[Ke]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function tt(e,t){var n;this.options=l({},et.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new((n=this).options.inputClass||(O?ge:F?ke:N?Te:ue))(n,te),this.touchAction=new Ne(this,this.options.touchAction),nt(this,!0),v(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function nt(e,t){var n,i=e.element;i.style&&(v(e.options.cssProps,function(r,o){n=L(i.style,o),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}tt.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&r.state&Ve)&&(r=t.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&n.state&(Fe|Be|je)&&(r=t.curRecognizer=n),o++}},get:function(e){if(e instanceof ze)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=x(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return v(E(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==s){var n=this.handlers;return v(E(e),function(e){t?n[e]&&n[e].splice(x(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=o.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&nt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(et,{INPUT_START:j,INPUT_MOVE:V,INPUT_END:U,INPUT_CANCEL:z,STATE_POSSIBLE:Oe,STATE_BEGAN:Fe,STATE_CHANGED:Be,STATE_ENDED:je,STATE_RECOGNIZED:Ve,STATE_CANCELLED:Ue,STATE_FAILED:32,DIRECTION_NONE:q,DIRECTION_LEFT:H,DIRECTION_RIGHT:G,DIRECTION_UP:Y,DIRECTION_DOWN:J,DIRECTION_HORIZONTAL:X,DIRECTION_VERTICAL:K,DIRECTION_ALL:Q,Manager:tt,Input:ee,TouchAction:Ne,TouchInput:ke,MouseInput:ue,PointerEventInput:ge,TouchMouseInput:Te,SingleTouchInput:we,Recognizer:ze,AttrRecognizer:Ye,Tap:$e,Pan:Je,Swipe:Ze,Pinch:Xe,Rotate:Qe,Press:Ke,on:C,off:T,each:v,merge:w,extend:b,assign:l,inherit:_,bindFn:S,prefixed:L}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=et,(i=function(){return et}.call(t,n,t,e))===s||(e.exports=i)}(window,document)},function(e,t,n){n(104);var i=n(8).Object;e.exports=function(e,t,n){return i.defineProperty(e,t,n)}},function(e,t,n){var i=n(10);i(i.S+i.F*!n(18),"Object",{defineProperty:n(19).f})},function(e,t,n){e.exports=n(106)},function(e,t,n){n(32),n(43),e.exports=n(64).f("iterator")},function(e,t,n){var i=n(58),r=n(46);e.exports=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var i=n(47),r=n(39),o=n(42),a={};n(25)(a,n(17)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=i(a,{next:r(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var i=n(19),r=n(22),o=n(34);e.exports=n(18)?Object.defineProperties:function(e,t){r(e);for(var n,a=o(t),s=a.length,l=0;s>l;)i.f(e,n=a[l++],t[n]);return e}},function(e,t,n){var i=n(27),r=n(48),o=n(111);e.exports=function(e){return function(t,n,a){var s,l=i(t),c=r(l.length),d=o(a,c);if(e&&n!=n){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===n)return e||d||0;return!e&&-1}}},function(e,t,n){var i=n(58),r=Math.max,o=Math.min;e.exports=function(e,t){return(e=i(e))<0?r(e+t,0):o(e,t)}},function(e,t,n){"use strict";var i=n(113),r=n(86),o=n(33),a=n(27);e.exports=n(59)(Array,"Array",function(e,t){this._t=a(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t){e.exports=function(){}},function(e,t,n){e.exports=n(115)},function(e,t,n){n(87),n(70),n(118),n(119),e.exports=n(8).Symbol},function(e,t,n){var i=n(34),r=n(67),o=n(44);e.exports=function(e){var t=i(e),n=r.f;if(n)for(var a,s=n(e),l=o.f,c=0;s.length>c;)l.call(e,a=s[c++])&&t.push(a);return t}},function(e,t,n){var i=n(27),r=n(88).f,o={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"[object Window]"==o.call(e)?function(e){try{return r(e)}catch(e){return a.slice()}}(e):r(i(e))}},function(e,t,n){n(66)("asyncIterator")},function(e,t,n){n(66)("observable")},function(e,t,n){var i=n(8),r=i.JSON||(i.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},function(e,t,n){var i=n(1);e.exports=function(e){if(i(e))return e}},function(e,t,n){n(123),e.exports=n(8).Array.isArray},function(e,t,n){var i=n(10);i(i.S,"Array",{isArray:n(68)})},function(e,t,n){var i=n(7);e.exports=function(e,t){var n=[],r=!0,o=!1,a=void 0;try{for(var s,l=i(e);!(r=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}return n}},function(e,t,n){n(43),n(32),e.exports=n(126)},function(e,t,n){var i=n(22),r=n(71);e.exports=n(8).getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return i(t.call(e))}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(e,t,n){n(129),e.exports=n(8).Object.entries},function(e,t,n){var i=n(10),r=n(89)(!0);i(i.S,"Object",{entries:function(e){return r(e)}})},function(e,t,n){n(131),e.exports=n(8).Object.keys},function(e,t,n){var i=n(30),r=n(34);n(72)("keys",function(){return function(e){return r(i(e))}})},function(e,t,n){n(133),e.exports=n(8).Object.assign},function(e,t,n){var i=n(10);i(i.S+i.F,"Object",{assign:n(134)})},function(e,t,n){"use strict";var i=n(18),r=n(34),o=n(67),a=n(44),s=n(30),l=n(60),c=Object.assign;e.exports=!c||n(26)(function(){var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach(function(e){t[e]=e}),7!=c({},e)[n]||Object.keys(c({},t)).join("")!=i})?function(e,t){for(var n=s(e),c=arguments.length,d=1,u=o.f,h=a.f;c>d;)for(var p,f=l(arguments[d++]),m=u?r(f).concat(u(f)):r(f),g=m.length,v=0;g>v;)p=m[v++],i&&!h.call(f,p)||(n[p]=f[p]);return n}:c},function(e,t,n){n(136),e.exports=n(8).Object.values},function(e,t,n){var i=n(10),r=n(89)(!1);i(i.S,"Object",{values:function(e){return r(e)}})},function(e,t,n){var i=n(1);e.exports=function(e){if(i(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}},function(e,t,n){var i=n(51),r=n(142);e.exports=function(e){if(r(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return i(e)}},function(e,t,n){n(32),n(140),e.exports=n(8).Array.from},function(e,t,n){"use strict";var i=n(23),r=n(10),o=n(30),a=n(90),s=n(91),l=n(48),c=n(141),d=n(71);r(r.S+r.F*!n(92)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,r,u,h=o(e),p="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=0,y=d(h);if(g&&(m=i(m,f>2?arguments[2]:void 0,2)),null==y||p==Array&&s(y))for(n=new p(t=l(h.length));t>v;v++)c(n,v,g?m(h[v],v):h[v]);else for(u=y.call(h),n=new p;!(r=u.next()).done;v++)c(n,v,g?a(u,m,[r.value,v],!0):r.value);return n.length=v,n}})},function(e,t,n){"use strict";var i=n(19),r=n(39);e.exports=function(e,t,n){t in e?i.f(e,t,r(0,n)):e[t]=n}},function(e,t,n){e.exports=n(143)},function(e,t,n){n(43),n(32),e.exports=n(144)},function(e,t,n){var i=n(50),r=n(17)("iterator"),o=n(33);e.exports=n(8).isIterable=function(e){var t=Object(e);return void 0!==t[r]||"@@iterator"in t||o.hasOwnProperty(i(t))}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(e,t,n){n(70),n(32),n(43),n(147),n(153),n(156),n(158),e.exports=n(8).Map},function(e,t,n){"use strict";var i=n(148),r=n(94);e.exports=n(149)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=i.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return i.def(r(this,"Map"),0===e?0:e,t)}},i,!0)},function(e,t,n){"use strict";var i=n(19).f,r=n(47),o=n(73),a=n(23),s=n(74),l=n(45),c=n(59),d=n(86),u=n(93),h=n(18),p=n(65).fastKey,f=n(94),m=h?"_s":"size",g=function(e,t){var n,i=p(t);if("F"!==i)return e._i[i];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var d=e(function(e,i){s(e,d,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[m]=0,null!=i&&l(i,n,e[c],e)});return o(d.prototype,{clear:function(){for(var e=f(this,t),n=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete n[i.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=f(this,t),i=g(n,e);if(i){var r=i.n,o=i.p;delete n._i[i.i],i.r=!0,o&&(o.n=r),r&&(r.p=o),n._f==i&&(n._f=r),n._l==i&&(n._l=o),n[m]--}return!!i},forEach:function(e){f(this,t);for(var n,i=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(i(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!g(f(this,t),e)}}),h&&i(d.prototype,"size",{get:function(){return f(this,t)[m]}}),d},def:function(e,t,n){var i,r,o=g(e,t);return o?o.v=n:(e._l=o={i:r=p(t,!0),k:t,v:n,p:i=e._l,n:void 0,r:!1},e._f||(e._f=o),i&&(i.n=o),e[m]++,"F"!==r&&(e._i[r]=o)),e},getEntry:g,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=f(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?d(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,d(1))},n?"entries":"values",!n,!0),u(t)}}},function(e,t,n){"use strict";var i=n(15),r=n(10),o=n(65),a=n(26),s=n(25),l=n(73),c=n(45),d=n(74),u=n(20),h=n(42),p=n(19).f,f=n(150)(0),m=n(18);e.exports=function(e,t,n,g,v,y){var b=i[e],w=b,_=v?"set":"add",S=w&&w.prototype,k={};return m&&"function"==typeof w&&(y||S.forEach&&!a(function(){(new w).entries().next()}))?(w=t(function(t,n){d(t,w,e,"_c"),t._c=new b,null!=n&&c(n,v,t[_],t)}),f("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in S&&(!y||"clear"!=e)&&s(w.prototype,e,function(n,i){if(d(this,w,e),!t&&y&&!u(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,i);return t?this:r})}),y||p(w.prototype,"size",{get:function(){return this._c.size}})):(w=g.getConstructor(t,e,v,_),l(w.prototype,n),o.NEED=!0),h(w,e),k[e]=w,r(r.G+r.W+r.F,k),y||g.setStrong(w,e,v),w}},function(e,t,n){var i=n(23),r=n(60),o=n(30),a=n(48),s=n(151);e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,d=4==e,u=6==e,h=5==e||u,p=t||s;return function(t,s,f){for(var m,g,v=o(t),y=r(v),b=i(s,f,3),w=a(y.length),_=0,S=n?p(t,w):l?p(t,0):void 0;w>_;_++)if((h||_ in y)&&(g=b(m=y[_],_,v),e))if(n)S[_]=g;else if(g)switch(e){case 3:return!0;case 5:return m;case 6:return _;case 2:S.push(m)}else if(d)return!1;return u?-1:c||d?d:S}}},function(e,t,n){var i=n(152);e.exports=function(e,t){return new(i(e))(t)}},function(e,t,n){var i=n(20),r=n(68),o=n(17)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),i(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var i=n(10);i(i.P+i.R,"Map",{toJSON:n(154)("Map")})},function(e,t,n){var i=n(50),r=n(155);e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},function(e,t,n){var i=n(45);e.exports=function(e,t){var n=[];return i(e,!1,n.push,n,t),n}},function(e,t,n){n(157)("Map")},function(e,t,n){"use strict";var i=n(10);e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,n){n(159)("Map")},function(e,t,n){"use strict";var i=n(10),r=n(38),o=n(23),a=n(45);e.exports=function(e){i(i.S,e,{from:function(e){var t,n,i,s,l=arguments[1];return r(this),(t=void 0!==l)&&r(l),null==e?new this:(n=[],t?(i=0,s=o(l,arguments[2],2),a(e,!1,function(e){n.push(s(e,i++))})):a(e,!1,n.push,n),new this(n))}})}},function(e,t,n){e.exports=n(161)},function(e,t,n){n(162);var i=n(8).Object;e.exports=function(e,t){return i.getOwnPropertyDescriptor(e,t)}},function(e,t,n){var i=n(27),r=n(69).f;n(72)("getOwnPropertyDescriptor",function(){return function(e,t){return r(i(e),t)}})},function(e,t,n){n(87),e.exports=n(8).Object.getOwnPropertySymbols},function(e,t,n){var i=n(35);e.exports=function(e,t,n){return t in e?i(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){n(166),e.exports=n(8).parseInt},function(e,t,n){var i=n(10),r=n(167);i(i.G+i.F*(parseInt!=r),{parseInt:r})},function(e,t,n){var i=n(15).parseInt,r=n(168).trim,o=n(96),a=/^[-+]?0[xX]/;e.exports=8!==i(o+"08")||22!==i(o+"0x16")?function(e,t){var n=r(String(e),3);return i(n,t>>>0||(a.test(n)?16:10))}:i},function(e,t,n){var i=n(10),r=n(46),o=n(26),a=n(96),s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),d=function(e,t,n){var r={},s=o(function(){return!!a[e]()||"​"!="​"[e]()}),l=r[e]=s?t(u):a[e];n&&(r[n]=l),i(i.P+i.F*s,"String",r)},u=d.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(c,"")),e};e.exports=d},function(e,t,n){n(70),n(32),n(43),n(170),n(174),n(175),e.exports=n(8).Promise},function(e,t,n){"use strict";var i,r,o,a,s=n(40),l=n(15),c=n(23),d=n(50),u=n(10),h=n(20),p=n(38),f=n(74),m=n(45),g=n(97),v=n(98).set,y=n(172)(),b=n(75),w=n(99),_=n(173),S=n(100),k=l.TypeError,P=l.process,C=P&&P.versions,T=C&&C.v8||"",A=l.Promise,I="process"==d(P),E=function(){},x=r=b.f,R=!!function(){try{var e=A.resolve(1),t=(e.constructor={})[n(17)("species")]=function(e){e(E,E)};return(I||"function"==typeof PromiseRejectionEvent)&&e.then(E)instanceof t&&0!==T.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(e){}}(),D=function(e){var t;return!(!h(e)||"function"!=typeof(t=e.then))&&t},L=function(e,t){if(!e._n){e._n=!0;var n=e._c;y(function(){for(var i=e._v,r=1==e._s,o=0,a=function(t){var n,o,a,s=r?t.ok:t.fail,l=t.resolve,c=t.reject,d=t.domain;try{s?(r||(2==e._h&&N(e),e._h=1),!0===s?n=i:(d&&d.enter(),n=s(i),d&&(d.exit(),a=!0)),n===t.promise?c(k("Promise-chain cycle")):(o=D(n))?o.call(n,l,c):l(n)):c(i)}catch(e){d&&!a&&d.exit(),c(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&M(e)})}},M=function(e){v.call(l,function(){var t,n,i,r=e._v,o=W(e);if(o&&(t=w(function(){I?P.emit("unhandledRejection",r,e):(n=l.onunhandledrejection)?n({promise:e,reason:r}):(i=l.console)&&i.error&&i.error("Unhandled promise rejection",r)}),e._h=I||W(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},W=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){v.call(l,function(){var t;I?P.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})})},O=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),L(t,!0))},F=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw k("Promise can't be resolved itself");(t=D(e))?y(function(){var i={_w:n,_d:!1};try{t.call(e,c(F,i,1),c(O,i,1))}catch(e){O.call(i,e)}}):(n._v=e,n._s=1,L(n,!1))}catch(e){O.call({_w:n,_d:!1},e)}}};R||(A=function(e){f(this,A,"Promise","_h"),p(e),i.call(this);try{e(c(F,this,1),c(O,this,1))}catch(e){O.call(this,e)}},(i=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(73)(A.prototype,{then:function(e,t){var n=x(g(this,A));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=I?P.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new i;this.promise=e,this.resolve=c(F,e,1),this.reject=c(O,e,1)},b.f=x=function(e){return e===A||e===a?new o(e):r(e)}),u(u.G+u.W+u.F*!R,{Promise:A}),n(42)(A,"Promise"),n(93)("Promise"),a=n(8).Promise,u(u.S+u.F*!R,"Promise",{reject:function(e){var t=x(this);return(0,t.reject)(e),t.promise}}),u(u.S+u.F*(s||!R),"Promise",{resolve:function(e){return S(s&&this===a?A:this,e)}}),u(u.S+u.F*!(R&&n(92)(function(e){A.all(e).catch(E)})),"Promise",{all:function(e){var t=this,n=x(t),i=n.resolve,r=n.reject,o=w(function(){var n=[],o=0,a=1;m(e,!1,function(e){var s=o++,l=!1;n.push(void 0),a++,t.resolve(e).then(function(e){l||(l=!0,n[s]=e,--a||i(n))},r)}),--a||i(n)});return o.e&&r(o.v),n.promise},race:function(e){var t=this,n=x(t),i=n.reject,r=w(function(){m(e,!1,function(e){t.resolve(e).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}})},function(e,t){e.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var i=n(15),r=n(98).set,o=i.MutationObserver||i.WebKitMutationObserver,a=i.process,s=i.Promise,l="process"==n(41)(a);e.exports=function(){var e,t,n,c=function(){var i,r;for(l&&(i=a.domain)&&i.exit();e;){r=e.fn,e=e.next;try{r()}catch(i){throw e?n():t=void 0,i}}t=void 0,i&&i.enter()};if(l)n=function(){a.nextTick(c)};else if(!o||i.navigator&&i.navigator.standalone)if(s&&s.resolve){var d=s.resolve(void 0);n=function(){d.then(c)}}else n=function(){r.call(i,c)};else{var u=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=u=!u}}return function(i){var r={fn:i,next:void 0};t&&(t.next=r),e||(e=r,n()),t=r}}},function(e,t,n){var i=n(15).navigator;e.exports=i&&i.userAgent||""},function(e,t,n){"use strict";var i=n(10),r=n(8),o=n(15),a=n(97),s=n(100);i(i.P+i.R,"Promise",{finally:function(e){var t=a(this,r.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},function(e,t,n){"use strict";var i=n(10),r=n(75),o=n(99);i(i.S,"Promise",{try:function(e){var t=r.f(this),n=o(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}})},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";var i=n(181),r=n(183);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){r.isString(e)&&(e=b(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),u=["%","/","?",";","#"].concat(d),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(184);function b(e,t,n){if(e&&r.isObject(e)&&e instanceof o)return e;var i=new o;return i.parse(e,t,n),i}o.prototype.parse=function(e,t,n){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var w=l.exec(b);if(w)return this.path=b,this.href=b,this.pathname=w[1],w[2]?(this.search=w[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var _=a.exec(b);if(_){var S=(_=_[0]).toLowerCase();this.protocol=S,b=b.substr(_.length)}if(n||_||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===b.substr(0,2);!k||_&&g[_]||(b=b.substr(2),this.slashes=!0)}if(!g[_]&&(k||_&&!v[_])){for(var P,C,T=-1,A=0;A<h.length;A++){-1!==(I=b.indexOf(h[A]))&&(-1===T||I<T)&&(T=I)}-1!==(C=-1===T?b.lastIndexOf("@"):b.lastIndexOf("@",T))&&(P=b.slice(0,C),b=b.slice(C+1),this.auth=decodeURIComponent(P)),T=-1;for(A=0;A<u.length;A++){var I;-1!==(I=b.indexOf(u[A]))&&(-1===T||I<T)&&(T=I)}-1===T&&(T=b.length),this.host=b.slice(0,T),b=b.slice(T),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var x=this.hostname.split(/\./),R=(A=0,x.length);A<R;A++){var D=x[A];if(D&&!D.match(p)){for(var L="",M=0,W=D.length;M<W;M++)D.charCodeAt(M)>127?L+="x":L+=D[M];if(!L.match(p)){var N=x.slice(0,A),O=x.slice(A+1),F=D.match(f);F&&(N.push(F[1]),O.unshift(F[2])),O.length&&(b="/"+O.join(".")+b),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=i.toASCII(this.hostname));var B=this.port?":"+this.port:"",j=this.hostname||"";this.host=j+B,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[S])for(A=0,R=d.length;A<R;A++){var V=d[A];if(-1!==b.indexOf(V)){var U=encodeURIComponent(V);U===V&&(U=escape(V)),b=b.split(V).join(U)}}var z=b.indexOf("#");-1!==z&&(this.hash=b.substr(z),b=b.slice(0,z));var q=b.indexOf("?");if(-1!==q?(this.search=b.substr(q),this.query=b.substr(q+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,q)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var H=this.search||"";this.path=B+H}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(n=n.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+i},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(r.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,i=Object.keys(this),a=0;a<i.length;a++){var s=i[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var d=l[c];"protocol"!==d&&(n[d]=e[d])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var u=Object.keys(e),h=0;h<u.length;h++){var p=u[h];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),w=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=w||b||n.host&&e.pathname,S=_,k=n.pathname&&n.pathname.split("/")||[],P=(f=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(P&&(n.hostname="",n.port=null,n.host&&(""===k[0]?k[0]=n.host:k.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),_=_&&(""===f[0]||""===k[0])),w)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,k=f;else if(f.length)k||(k=[]),k.pop(),k=k.concat(f),n.search=e.search,n.query=e.query;else if(!r.isNullOrUndefined(e.search)){if(P)n.hostname=n.host=k.shift(),(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=e.search,n.query=e.query,r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!k.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var C=k.slice(-1)[0],T=(n.host||e.host||k.length>1)&&("."===C||".."===C)||""===C,A=0,I=k.length;I>=0;I--)"."===(C=k[I])?k.splice(I,1):".."===C?(k.splice(I,1),A++):A&&(k.splice(I,1),A--);if(!_&&!S)for(;A--;A)k.unshift("..");!_||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),T&&"/"!==k.join("/").substr(-1)&&k.push("");var E,x=""===k[0]||k[0]&&"/"===k[0].charAt(0);P&&(n.hostname=n.host=x?"":k.length?k.shift():"",(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(_=_||n.host&&k.length)&&!x&&k.unshift(""),k.length?n.pathname=k.join("/"):(n.pathname=null,n.path=null),r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,i){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof i&&i;a.global!==a&&a.window!==a&&a.self;var s,l=2147483647,c=36,d=1,u=26,h=38,p=700,f=72,m=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=c-d,S=Math.floor,k=String.fromCharCode;function P(e){throw new RangeError(w[e])}function C(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function T(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+C((e=e.replace(b,".")).split("."),t).join(".")}function A(e){for(var t,n,i=[],r=0,o=e.length;r<o;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<o?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function I(e){return C(e,function(e){var t="";return e>65535&&(t+=k((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=k(e)}).join("")}function E(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function x(e,t,n){var i=0;for(e=n?S(e/p):e>>1,e+=S(e/t);e>_*u>>1;i+=c)e=S(e/_);return S(i+(_+1)*e/(e+h))}function R(e){var t,n,i,r,o,a,s,h,p,v,y,b=[],w=e.length,_=0,k=m,C=f;for((n=e.lastIndexOf(g))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&P("not-basic"),b.push(e.charCodeAt(i));for(r=n>0?n+1:0;r<w;){for(o=_,a=1,s=c;r>=w&&P("invalid-input"),((h=(y=e.charCodeAt(r++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:c)>=c||h>S((l-_)/a))&&P("overflow"),_+=h*a,!(h<(p=s<=C?d:s>=C+u?u:s-C));s+=c)a>S(l/(v=c-p))&&P("overflow"),a*=v;C=x(_-o,t=b.length+1,0==o),S(_/t)>l-k&&P("overflow"),k+=S(_/t),_%=t,b.splice(_++,0,k)}return I(b)}function D(e){var t,n,i,r,o,a,s,h,p,v,y,b,w,_,C,T=[];for(b=(e=A(e)).length,t=m,n=0,o=f,a=0;a<b;++a)(y=e[a])<128&&T.push(k(y));for(i=r=T.length,r&&T.push(g);i<b;){for(s=l,a=0;a<b;++a)(y=e[a])>=t&&y<s&&(s=y);for(s-t>S((l-n)/(w=i+1))&&P("overflow"),n+=(s-t)*w,t=s,a=0;a<b;++a)if((y=e[a])<t&&++n>l&&P("overflow"),y==t){for(h=n,p=c;!(h<(v=p<=o?d:p>=o+u?u:p-o));p+=c)C=h-v,_=c-v,T.push(k(E(v+C%_,0))),h=S(C/_);T.push(k(E(h,0))),o=x(n,w,i==r),n=0,++i}++n,++t}return T.join("")}s={version:"1.4.1",ucs2:{decode:A,encode:I},decode:R,encode:D,toASCII:function(e){return T(e,function(e){return y.test(e)?"xn--"+D(e):e})},toUnicode:function(e){return T(e,function(e){return v.test(e)?R(e.slice(4).toLowerCase()):e})}},void 0===(r=function(){return s}.call(t,n,t,e))||(e.exports=r)}()}).call(this,n(182)(e),n(28))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(185),t.encode=t.stringify=n(186)},function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var l=1e3;o&&"number"==typeof o.maxKeys&&(l=o.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var d=0;d<c;++d){var u,h,p,f,m=e[d].replace(s,"%20"),g=m.indexOf(n);g>=0?(u=m.substr(0,g),h=m.substr(g+1)):(u=m,h=""),p=decodeURIComponent(u),f=decodeURIComponent(h),i(a,p)?r(a[p])?a[p].push(f):a[p]=[a[p],f]:a[p]=f}return a};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),function(a){var s=encodeURIComponent(i(a))+n;return r(e[a])?o(e[a],function(e){return s+encodeURIComponent(i(e))}).join(t):s+encodeURIComponent(i(e[a]))}).join(t):s?encodeURIComponent(i(s))+n+encodeURIComponent(i(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";n.r(t),function(e,t){var i,r=n(79),o=n.n(r),a=n(11),s=n.n(a),l=n(9),c=n.n(l),d=n(0),u=n.n(d);n(191);!function(i){if("object"===("undefined"==typeof exports?"undefined":u()(exports))&&void 0!==e)e.exports=i();else if("function"==typeof define&&n(192))define([],i);else{("undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:this).LC=i()}window&&(!window.LC||window.LC&&!window.LC.shapeToJSON)&&(window.LC=i())}(function(){return function e(t,n,r){function o(s,l){if(!n[s]){if(!t[s]){if(!l&&("function"==typeof i&&i))return i(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n||e)},d,d.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){var i,r,o,a,l,d,u,h,p,f,m,g=function(e,t){return function(){return e.apply(t,arguments)}},v=[].slice,y=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=e("./actions"),a=e("./bindEvents"),l=e("./math"),(d=e("./shapes")).createShape,f=d.shapeToJSON,r=d.JSONToShape,u=e("./canvasRenderer").renderShapeToContext,e("./svgRenderer").renderShapeToSVG,h=e("./renderSnapshotToImage"),p=e("./renderSnapshotToSVG"),e("../tools/Pencil"),m=e("./util"),i="infinite",t.exports=function(){function e(e,t){var n,r;this.setImageSize=g(this.setImageSize,this),r=null,n=null,e instanceof HTMLElement?(n=e,r=t):r=e,this.opts=r||{},this.config={zoomMin:r.zoomMin||.2,zoomMax:r.zoomMax||4,zoomStep:r.zoomStep||.2},this.colors={primary:r.primaryColor||"#000",secondary:r.secondaryColor||"#fff",background:r.backgroundColor||"transparent"},this.watermarkImage=r.watermarkImage,this.watermarkScale=r.watermarkScale||1,this.backgroundCanvas=document.createElement("canvas"),this.backgroundCanvas.className="background-canvas",this.backgroundCtx=this.backgroundCanvas.getContext("2d"),this.canvas=document.createElement("canvas"),this.canvas.style["background-color"]="transparent",this.buffer=document.createElement("canvas"),this.buffer.style["background-color"]="transparent",this.ctx=this.canvas.getContext("2d"),this.bufferCtx=this.buffer.getContext("2d"),this.backingScale=m.getBackingScale(this.ctx),this.backgroundShapes=r.backgroundShapes||[],this._shapesInProgress=[],this.shapes=[],this.undoStack=[],this.redoStack=[],this.isDragging=!1,this.isDrawAble=!0,this.isTmpDrawAble=!0,this.rotateDeg=0,this.position={x:0,y:0},this.scale=1,this.setTool(new this.opts.tools[0](this)),this.width=r.imageSize.width||i,this.height=r.imageSize.height||i,this.setZoom(this.scale),r.snapshot&&this.loadSnapshot(r.snapshot),this.isBound=!1,n&&this.bindToElement(n)}return e.prototype.setWatermarkImageToLcBackground=function(e){this.watermarkImageToLcBackground=e,this.containerEl.setAttribute("watermarkImageToLcBackground",this.watermarkImageToLcBackground)},e.prototype.bindToElement=function(e){var t,n,i;if(!this.containerEl)return this.containerEl=e,this._unsubscribeEvents=a(this,this.containerEl,this.opts.keyboardShortcuts),this.containerEl.style["background-color"]=this.colors.background,this.containerEl.appendChild(this.backgroundCanvas),this.containerEl.appendChild(this.canvas),this.isBound=!0,i=this,n=function(){return i.keepPanInImageBounds(),i.repaintAllLayers()},this.respondToSizeChange=m.matchElementSize(this.containerEl,[this.backgroundCanvas,this.canvas],this.backingScale,n),this.watermarkImage&&(this.watermarkImage.onload=function(e){return function(){return e.repaintLayer("background")}}(this)),null!=(t=this.tool)&&t.didBecomeActive(this),n();console.warn("Trying to bind Literally Canvas to a DOM element more than once is unsupported.")},e.prototype._teardown=function(){var e;return null!=(e=this.tool)&&e.willBecomeInactive(this),"function"==typeof this._unsubscribeEvents&&this._unsubscribeEvents(),this.tool=null,this.containerEl=null,this.isBound=!1},e.prototype.trigger=function(e,t){return this.canvas.dispatchEvent(new CustomEvent(e,{detail:t})),null},e.prototype.on=function(e,t){var n,i;return n=function(e){return t(e.detail)},this.canvas.addEventListener(e,n),i=this,function(){return i.canvas.removeEventListener(e,n)}},e.prototype.getRenderScale=function(){return this.scale*this.backingScale},e.prototype.clientCoordsToDrawingCoords=function(e,t){var n,i,r=this.canvas.width,o=this.canvas.height;switch(this.rotateDeg){case 0:n=e,i=t;break;case 90:n=t,i=o-e;break;case 180:n=r-e,i=o-t;break;case 270:n=r-t,i=e;break;default:n=e,i=t}return{x:(n*this.backingScale-this.position.x)/this.getRenderScale(),y:(i*this.backingScale-this.position.y)/this.getRenderScale()}},e.prototype.drawingCoordsToClientCoords=function(e,t){return{x:e*this.getRenderScale()+this.position.x,y:t*this.getRenderScale()+this.position.y}},e.prototype.setImageSize=function(e,t){return this.width=e||i,this.height=t||i,this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("imageSizeChange",{width:this.width,height:this.height})},e.prototype.setTool=function(e){var t;if(this.isBound&&null!=(t=this.tool)&&t.willBecomeInactive(this),this.tool=e,this.trigger("toolChange",{tool:e}),this.isBound)return this.tool.didBecomeActive(this)},e.prototype.setShapesInProgress=function(e){return this._shapesInProgress=e},e.prototype.pointerDown=function(e,t){var n;return n=this.clientCoordsToDrawingCoords(e,t),this.tool.usesSimpleAPI?(this.tool.begin(n.x,n.y,this),this.isDragging=!0,this.trigger("drawStart",{tool:this.tool})):(this.isDragging=!0,this.trigger("lc-pointerdown",{tool:this.tool,x:n.x,y:n.y,rawX:e,rawY:t}))},e.prototype.pointerMove=function(e,t){return m.requestAnimationFrame((n=this,function(){var i,r;return i=n.clientCoordsToDrawingCoords(e,t),null!=(r=n.tool)&&r.usesSimpleAPI?n.isDragging?(n.tool.continue(i.x,i.y,n),n.trigger("drawContinue",{tool:n.tool})):void 0:n.isDragging?n.trigger("lc-pointerdrag",{tool:n.tool,x:i.x,y:i.y,rawX:e,rawY:t}):n.trigger("lc-pointermove",{tool:n.tool,x:i.x,y:i.y,rawX:e,rawY:t})}));var n},e.prototype.pointerUp=function(e,t){var n;return n=this.clientCoordsToDrawingCoords(e,t),this.tool.usesSimpleAPI?this.isDragging?(this.tool.end(n.x,n.y,this),this.isDragging=!1,this.trigger("drawEnd",{tool:this.tool})):void 0:(this.isDragging=!1,this.trigger("lc-pointerup",{tool:this.tool,x:n.x,y:n.y,rawX:e,rawY:t}))},e.prototype.setColor=function(e,t){if(this.colors[e]=t,this.isBound){switch(e){case"background":this.containerEl.style.backgroundColor=this.colors.background,this.repaintLayer("background");break;case"primary":this.repaintLayer("main");break;case"secondary":this.repaintLayer("main")}return this.trigger(e+"ColorChange",this.colors[e]),"background"===e?this.trigger("drawingChange"):void 0}},e.prototype.getColor=function(e){return this.colors[e]},e.prototype.saveShape=function(e,t,n,i,r,a){i=null!=i&&null!=i&&i,null==t&&(t=!0),null==n&&(n=null),n||(n=this.shapes.length?this.shapes[this.shapes.length-1].id:null),e.authorUserId=r;var s="saveShape_"+(new Date).getTime()+c()(1e4*Math.random()),l=new o.AddShapeAction(this,e,n,s,i,r,a);return this.execute(l),this.isDrawAble&&t&&this.trigger("shapeSave",{shape:e,previousShapeId:n,executeId:s,shapeId:e.id,action:{actionName:l.actionName}}),this.trigger("drawingChange")},e.prototype.pan=function(e,t){return this.setPan(this.position.x-e,this.position.y-t)},e.prototype.keepPanInImageBounds=function(){var e,t,n,r;return t=this.getRenderScale(),n=(e=this.position).x,r=e.y,this.width!==i&&(n=this.canvas.width>this.width*t?(this.canvas.width-this.width*t)/2:Math.max(Math.min(0,n),this.canvas.width-this.width*t)),this.height!==i&&(r=this.canvas.height>this.height*t?(this.canvas.height-this.height*t)/2:Math.max(Math.min(0,r),this.canvas.height-this.height*t)),this.position={x:n,y:r}},e.prototype.setPan=function(e,t){return this.position={x:e,y:t},this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("pan",{x:this.position.x,y:this.position.y})},e.prototype.zoom=function(e){var t;return t=this.scale+e,t=Math.max(t,this.config.zoomMin),t=Math.min(t,this.config.zoomMax),t=Math.round(100*t)/100,this.setZoom(t)},e.prototype.setZoom=function(e){var t;return t=this.scale,this.scale=e,this.position.x=l.scalePositionScalar(this.position.x,this.canvas.width,t,this.scale),this.position.y=l.scalePositionScalar(this.position.y,this.canvas.height,t,this.scale),this.keepPanInImageBounds(),this.repaintAllLayers(),this.trigger("zoom",{oldScale:t,newScale:this.scale})},e.prototype.setWatermarkImage=function(e){if(this.watermarkImage=e,this.watermarkImageToLcBackground){if(m.addImageOnload(e,(t=this,function(){return t.repaintLayer("background")})),e.width)return this.repaintLayer("background")}else this.customCanvasBackgroundElement.style.backgroundImage="url("+s()(e.src)+")";var t},e.prototype.repaintAllLayers=function(){var e,t,n,i;for(e=0,n=(i=["background","main"]).length;e<n;e++)t=i[e],this.repaintLayer(t);return null},e.prototype.repaintLayer=function(e,t){var n;if(null==t&&(t="main"===e),this.isBound){switch(e){case"background":if(!this.watermarkImageToLcBackground)return;this.backgroundCtx.clearRect(0,0,this.backgroundCanvas.width,this.backgroundCanvas.height),i=this,n=function(){return i.repaintLayer("background")},this.watermarkImage&&this._renderWatermark(this.backgroundCtx,!0,n),this.draw(this.backgroundShapes,this.backgroundCtx,n);break;case"main":n=function(e){return function(){return e.repaintLayer("main",!0)}}(this),t&&(this.buffer.width=this.canvas.width,this.buffer.height=this.canvas.height,this.bufferCtx.clearRect(0,0,this.buffer.width,this.buffer.height),this.draw(this.shapes,this.bufferCtx,n)),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.canvas.width>0&&this.canvas.height>0&&(this.ctx.fillStyle="#ccc",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.clipped(function(e){return function(){return e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.drawImage(e.buffer,0,0)}}(this),this.ctx),this.clipped(function(e){return function(){return e.transformed(function(){var t,n,i,r,o;for(r=[],t=0,n=(i=e._shapesInProgress).length;t<n;t++)o=i[t],r.push(u(e.ctx,o,{bufferCtx:e.bufferCtx,shouldOnlyDrawLatest:!0}));return r},e.ctx,e.bufferCtx)}}(this),this.ctx,this.bufferCtx))}var i;return this.trigger("repaint",{layerKey:e})}},e.prototype._renderWatermark=function(e,t,n){if(null==t&&(t=!0),this.watermarkImage.width)return e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.scale(this.watermarkScale,this.watermarkScale),t&&e.scale(this.backingScale,this.backingScale),e.drawImage(this.watermarkImage,-this.watermarkImage.width/2,-this.watermarkImage.height/2),e.restore();this.watermarkImage.onload=n},e.prototype.drawShapeInProgress=function(e){return this.repaintLayer("main",!1),this.clipped((t=this,function(){return t.transformed(function(){return u(t.ctx,e,{bufferCtx:t.bufferCtx,shouldOnlyDrawLatest:!0})},t.ctx,t.bufferCtx)}),this.ctx,this.bufferCtx);var t},e.prototype.draw=function(e,t,n){var i,r;if(e.length)return i=function(){var i,r,o,a;for(o=[],i=0,r=e.length;i<r;i++)a=e[i],o.push(u(t,a,{retryCallback:n}));return o},this.clipped((r=this,function(){return r.transformed(i,t)}),t)},e.prototype.clipped=function(){var e,t,n,r,o,a,s,l,c,d,u,h;for(n=arguments[0],e=2<=arguments.length?v.call(arguments,1):[],u=this.width===i?0:this.position.x,h=this.height===i?0:this.position.y,d=function(){switch(this.width){case i:return this.canvas.width;default:return this.width*this.getRenderScale()}}.call(this),r=function(){switch(this.height){case i:return this.canvas.height;default:return this.height*this.getRenderScale()}}.call(this),o=0,s=e.length;o<s;o++)(t=e[o]).save(),t.beginPath(),t.rect(u,h,d,r),t.clip();for(n(),c=[],a=0,l=e.length;a<l;a++)t=e[a],c.push(t.restore());return c},e.prototype.transformed=function(){var e,t,n,i,r,o,a,s,l;for(n=arguments[0],i=0,o=(e=2<=arguments.length?v.call(arguments,1):[]).length;i<o;i++)(t=e[i]).save(),t.translate(Math.floor(this.position.x),Math.floor(this.position.y)),l=this.getRenderScale(),t.scale(l,l);for(n(),s=[],r=0,a=e.length;r<a;r++)t=e[r],s.push(t.restore());return s},e.prototype.sendClear=function(e){var t=!1;if(e){for(var n=0;n<this.shapes.length;n++)if(this.shapes[n].authorUserId===e){t=!0;break}}else t=!0;if(t){var i="clear_"+(new Date).getTime()+c()(1e4*Math.random());this.trigger("sendClear",{clearActionId:i,action:{actionName:"ClearAction"}})}},e.prototype.clear=function(e,t,n,i,r){var a,s;if(null==e&&(e=!0),s=this.shapes,a=[],0!==this.shapes.length){if(i&&this.shapes.length>0){for(var l=!1,d=0;d<this.shapes.length;d++)this.shapes[d].authorUserId!==i?a.push(this.shapes[d]):l=!0;if(!l)return}this.setShapesInProgress([]);var u=t||"clear_"+(new Date).getTime()+c()(1e4*Math.random()),h=new o.ClearAction(this,s,a,u,n,i,r);return this.execute(h),this.repaintLayer("main"),e&&this.trigger("clear",{clearActionId:u,oldShapes:s,action:{actionName:h.actionName}}),this.trigger("drawingChange",{})}},e.prototype.execute=function(e){return this.undoStack.push(e),e.do(),this.redoStack.length>0&&this.trigger("doClearRedoStack",{doClearRedoStack:this.redoStack}),this.redoStack=[]},e.prototype.goToStackPosition=function(e){},e.prototype.sendUndo=function(e){if(this.undoStack.length){var t;if(e){for(var n=this.undoStack.length-1;n>=0;n--)if(e===this.undoStack[n].authorUserId){t=this.undoStack[n];break}}else t=this.undoStack[this.undoStack.length-1];t&&(t.executeId="undo_"+(new Date).getTime()+c()(1e4*Math.random()),this.trigger("sendUndo",{action:t,executeId:t.executeId}))}},e.prototype.undo=function(e,t){var n;if(null==e&&(e=!0),this.undoStack.length){if(t){for(var i=this.undoStack.length-1;i>=0;i--)if(this.undoStack[i]&&this.undoStack[i].id===t){n=this.undoStack[i],this.undoStack.splice(i,1);break}}else n=this.undoStack.pop();return n?(n.undo(),n.executeId="undo_"+(new Date).getTime()+c()(1e4*Math.random()),this.redoStack.push(n),this.undoStack.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("seq")&&void 0!==t&&t.hasOwnProperty("seq")&&void 0!==e.seq&&void 0!==t.seq?e.seq-t.seq:0}),this.redoStack.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("seq")&&void 0!==t&&t.hasOwnProperty("seq")&&void 0!==e.seq&&void 0!==t.seq?t.seq-e.seq:0}),e&&this.trigger("undo",{action:n,executeId:n.executeId}),this.trigger("drawingChange",{})):void 0}},e.prototype.sendRedo=function(e){if(this.redoStack.length){var t;if(e){for(var n=this.redoStack.length-1;n>=0;n--)if(e===this.redoStack[n].authorUserId){t=this.redoStack[n];break}}else t=this.redoStack[this.redoStack.length-1];t&&(t.executeId="redo_"+(new Date).getTime()+c()(1e4*Math.random()),this.trigger("sendRedo",{action:t,executeId:t.executeId}))}},e.prototype.redo=function(e,t){var n;if(null==e&&(e=!0),this.redoStack.length){if(t){for(var i=this.redoStack.length-1;i>=0;i--)if(this.redoStack[i]&&this.redoStack[i].id===t){n=this.redoStack[i],this.redoStack.splice(i,1);break}}else n=this.redoStack.pop();if(n){this.undoStack.push(n);return n.do(!0),this.undoStack.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("seq")&&void 0!==t&&t.hasOwnProperty("seq")&&void 0!==e.seq&&void 0!==t.seq?e.seq-t.seq:0}),this.redoStack.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("seq")&&void 0!==t&&t.hasOwnProperty("seq")&&void 0!==e.seq&&void 0!==t.seq?t.seq-e.seq:0}),n.executeId="redo_"+(new Date).getTime()+c()(1e4*Math.random()),e&&this.trigger("redo",{action:n,executeId:n.executeId}),this.trigger("drawingChange",{})}}},e.prototype.canUndo=function(){if(this.isOnlyUndoRedoClearMyselfShape&&this.myselfId){for(var e=!1,t=this.undoStack.length-1;t>=0;t--)if(this.undoStack[t].authorUserId==this.myselfId){e=!0;break}return e}return!!this.undoStack.length},e.prototype.canRedo=function(){if(this.isOnlyUndoRedoClearMyselfShape&&this.myselfId){for(var e=!1,t=0;t<this.redoStack.length;t++)this.redoStack[t].authorUserId==this.myselfId&&(e=!0);return e}return!!this.redoStack.length},e.prototype.getPixel=function(e,t){var n,i;return n=this.drawingCoordsToClientCoords(e,t),(i=this.ctx.getImageData(n.x,n.y,1,1).data)[3]?"rgb("+i[0]+", "+i[1]+", "+i[2]+")":null},e.prototype.getContentBounds=function(){return m.getBoundingRect(this.shapes.concat(this.backgroundShapes).map(function(e){return e.getBoundingRect()}),this.width===i?0:this.width,this.height===i?0:this.height)},e.prototype.getDefaultImageRect=function(e,t){var n;return null==e&&(e={width:0,height:0}),null==t&&(t={top:0,right:0,bottom:0,left:0}),m.getDefaultImageRect(function(){var e,t,i,r;for(r=[],e=0,t=(i=this.shapes.concat(this.backgroundShapes)).length;e<t;e++)n=i[e],r.push(n.getBoundingRect(this.ctx));return r}.call(this),e,t)},e.prototype.getImage=function(e){return null==e&&(e={}),null==e.includeWatermark&&(e.includeWatermark=!0),null==e.scaleDownRetina&&(e.scaleDownRetina=!0),null==e.scale&&(e.scale=1),e.scaleDownRetina||(e.scale*=this.backingScale),e.includeWatermark&&(e.watermarkImage=this.watermarkImage,e.watermarkScale=this.watermarkScale,e.scaleDownRetina||(e.watermarkScale*=this.backingScale)),h(this.getSnapshot(),e)},e.prototype.canvasForExport=function(){return this.repaintAllLayers(),m.combineCanvases(this.backgroundCanvas,this.canvas)},e.prototype.canvasWithBackground=function(e){return m.combineCanvases(e,this.canvasForExport())},e.prototype.getSnapshot=function(e){var t,n,i,r,o,a;for(null==e&&(e=null),null==e&&(e=["shapes","imageSize","colors","position","scale","backgroundShapes"]),a={},t=0,i=(r=["colors","position","scale"]).length;t<i;t++)n=r[t],y.call(e,n)>=0&&(a[n]=this[n]);return y.call(e,"shapes")>=0&&(a.shapes=function(){var e,t,n,i;for(i=[],e=0,t=(n=this.shapes).length;e<t;e++)o=n[e],i.push(f(o));return i}.call(this)),y.call(e,"backgroundShapes")>=0&&(a.backgroundShapes=function(){var e,t,n,i;for(i=[],e=0,t=(n=this.backgroundShapes).length;e<t;e++)o=n[e],i.push(f(o));return i}.call(this)),y.call(e,"imageSize")>=0&&(a.imageSize={width:this.width,height:this.height}),a},e.prototype.getSnapshotJSON=function(){return console.warn("lc.getSnapshotJSON() is deprecated. use JSON.stringify(lc.getSnapshot()) instead."),s()(this.getSnapshot())},e.prototype.getSVGString=function(e){return null==e&&(e={}),p(this.getSnapshot(),e)},e.prototype.loadSnapshot=function(e){var t,n,i,a,s,l,c,d,u,h;if(e){if(e.colors)for(t=0,a=(l=["primary","secondary","background"]).length;t<a;t++)i=l[t],this.setColor(i,e.colors[i]);if(e.shapes)for(this.shapes=[],n=0,s=(c=e.shapes).length;n<s;n++)h=c[n],(u=r(h))&&this.execute(new o.AddShapeAction(this,u));return e.backgroundShapes&&(this.backgroundShapes=function(){var t,n,i,o;for(o=[],t=0,n=(i=e.backgroundShapes).length;t<n;t++)d=i[t],o.push(r(d));return o}()),e.imageSize&&(this.width=e.imageSize.width,this.height=e.imageSize.height),e.position&&(this.position=e.position),e.scale&&(this.scale=e.scale),this.repaintAllLayers(),this.trigger("snapshotLoad"),this.trigger("drawingChange",{})}},e.prototype.loadSnapshotJSON=function(e){return console.warn("lc.loadSnapshotJSON() is deprecated. use lc.loadSnapshot(JSON.parse(snapshot)) instead."),this.loadSnapshot(JSON.parse(e))},e}()},{"../tools/Pencil":24,"./actions":3,"./bindEvents":4,"./canvasRenderer":5,"./math":10,"./renderSnapshotToImage":11,"./renderSnapshotToSVG":12,"./shapes":13,"./svgRenderer":14,"./util":15}],2:[function(e,t,n){var i,r,o,a;e("./fontmetrics.js"),a=function(e){var t,n,i,r,o,a;for(n=0,r=0,o=(t=e.split(" ")).length;r<o;r++)i=t[r],a=c()(i.replace("px",""),10),isNaN(a)||(n=a);if(!n)throw"Font size not found";return{fontSize:n,fontFamily:e.substring(t[0].length+1).replace("bold ","").replace("italic ","").replace("underline ","")}},o=function(e,t,n){var i,r,o,a,s,l,c,d,u,h;if(!t.length)return["",""];for(r=0,l=0,c=0,h=!1;;)if(a=(s=!(o=(r+=1)>=t.length)&&t[r].match(/\s/))||o,u=t.substring(0,r),(i=!n||e.measureTextWidth(u).width<=n)&&(c=r),a&&h&&(h=!1,i&&(l=r)),h=!s,o||!i){if(i)return[t,""];if(l>0){for(d=l+1;d<t.length&&t[d].match("/s/");)d+=1;return[t.substring(0,l),t.substring(d)]}return[t.substring(0,c),t.substring(c)]}},r=function(e,t,n){var i,r,a,s,l,c,d,u,h;for(a=[],i=0,r=(h=t.split(/\r\n|\r|\n/g)).length;i<r;i++)if(u=h[i],s=(l=o(e,u,n))[0],d=l[1],s)for(;s;)a.push(s),s=(c=o(e,d,n))[0],d=c[1];else a.push(u);return a},i=function(){function e(e,t,n,i,o){var s,l,c,d;this.text=t,this.font=n,this.forcedWidth=i,this.forcedHeight=o,s=(c=a(this.font)).fontFamily,l=c.fontSize,e.font=this.font,e.textBaseline="baseline",this.emDashWidth=e.measureTextWidth("—",l,s).width,this.caratWidth=e.measureTextWidth("|",l,s).width,this.lines=r(e,this.text,this.forcedWidth),this.metricses=this.lines.map((d=this,function(t){return e.measureText2(t||"X",l,d.font)})),this.metrics={ascent:Math.max.apply(Math,this.metricses.map(function(e){return e.ascent})),descent:Math.max.apply(Math,this.metricses.map(function(e){return e.descent})),fontsize:Math.max.apply(Math,this.metricses.map(function(e){return e.fontsize})),leading:Math.max.apply(Math,this.metricses.map(function(e){return e.leading})),width:Math.max.apply(Math,this.metricses.map(function(e){return e.width})),height:Math.max.apply(Math,this.metricses.map(function(e){return e.height})),bounds:{minx:Math.min.apply(Math,this.metricses.map(function(e){return e.bounds.minx})),miny:Math.min.apply(Math,this.metricses.map(function(e){return e.bounds.miny})),maxx:Math.max.apply(Math,this.metricses.map(function(e){return e.bounds.maxx})),maxy:Math.max.apply(Math,this.metricses.map(function(e){return e.bounds.maxy}))}},this.boundingBoxWidth=Math.ceil(this.metrics.width)}return e.prototype.draw=function(e,t,n){var i,r,o,a,s,l;for(e.textBaseline="top",e.font=this.font,i=0,l=[],r=0,o=(s=this.lines).length;r<o;r++)a=s[r],e.fillText(a,t,n+i*this.metrics.leading),l.push(i+=1);return l},e.prototype.getWidth=function(e){return null==e&&(e=!1),this.forcedWidth?this.forcedWidth:e?this.metrics.bounds.maxx+this.caratWidth:this.metrics.bounds.maxx},e.prototype.getHeight=function(){return this.forcedHeight||this.metrics.leading*this.lines.length},e}(),t.exports=i},{"./fontmetrics.js":7}],3:[function(e,t,n){var i,r;r=function(){function e(e,t,n,i,r,o,a){this.lc=e,this.oldShapes=t,this.newShapes=n,this.executeId=i,this.id=i,this.clearActionId=i,this.authorUserId=r,this.toAuthorUserId=o,this.seq=a,this.actions=[],this.actionName="ClearAction"}return e.prototype.do=function(){var e=[];this.actions=[];for(var t=this.lc.undoStack.length-1;t>=0;t--){var n=this.lc.undoStack[t];"AddShapeAction"===n.actionName&&(this.toAuthorUserId?this.lc.undoStack[t].authorUserId===this.toAuthorUserId?(this.actions.push(n),this.lc.undoStack.splice(t,1)):e.push(this.lc.undoStack[t].shape):(this.actions.push(n),this.lc.undoStack.splice(t,1)))}return this.lc.shapes=e.reverse(),this.lc.repaintLayer("main")},e.prototype.undo=function(){var e=[];this.lc.undoStack=this.lc.undoStack.concat(this.actions),this.actions=[],this.lc.undoStack.sort(function(e,t){return void 0!==e&&e.hasOwnProperty("seq")&&void 0!==t&&t.hasOwnProperty("seq")&&void 0!==e.seq&&void 0!==t.seq?e.seq-t.seq:0});for(var t=0;t<this.lc.undoStack.length;t++){"AddShapeAction"===this.lc.undoStack[t].actionName&&e.push(this.lc.undoStack[t].shape)}return this.lc.shapes=e,this.lc.repaintLayer("main")},e}(),i=function(){function e(e,t,n,i,r,o,a){this.lc=e,this.shape=t,this.previousShapeId=null!=n?n:null,this.doNotPaint=r,this.executeId=i,this.shapeId=t.id,this.id=t.id,this.authorUserId=o,this.seq=a,this.actionName="AddShapeAction"}return e.prototype.do=function(e,t){var n,i,r,o,a,s;if(e=null!=e&&e,this.lc.shapes.length&&this.lc.shapes[this.lc.shapes.length-1].id!==this.previousShapeId&&null!==this.previousShapeId){for(o=[],n=!1,i=0,r=(a=this.lc.shapes).length;i<r;i++)s=a[i],o.push(s),s.id===this.previousShapeId&&(o.push(this.shape),n=!0);n||o.push(this.shape),this.lc.shapes=o}else this.lc.shapes.push(this.shape);if((e||!this.doNotPaint)&&!t)return this.lc.repaintLayer("main")},e.prototype.undo=function(){var e,t,n,i,r;if(this.lc.shapes[this.lc.shapes.length-1].id===this.shape.id)this.lc.shapes.pop();else{for(n=[],e=0,t=(i=this.lc.shapes).length;e<t;e++)(r=i[e]).id!==this.shape.id&&n.push(r);this.lc.shapes=n}return this.lc.repaintLayer("main")},e}(),t.exports={ClearAction:r,AddShapeAction:i}},{}],4:[function(e,t,n){var i,r;i=function(e,t){var n,i,r;return i=t.changedTouches[0].clientX,r=t.changedTouches[0].clientY,[i-(n=e.getBoundingClientRect()).left,r-n.top]},r=function(e,t){var n;return n=e.getBoundingClientRect(),{left:t.clientX-n.left,top:t.clientY-n.top}},t.exports=function(e,t,n){var o,a,s,l,c,d;return null==n&&(n=!1),d=[],a=function(n){var i;return n.preventDefault(),i=r(t,n),e.pointerMove(i.left,i.top)},s=function(n){var i;n.preventDefault(),t.onselectstart=function(){return!0},i=r(t,n),e.pointerUp(i.left,i.top);try{var o=document.getElementsByTagName("iframe");if(o&&o.length>0)for(var l=0;l<o.length;l++){var c=o[l].parentNode;if(c){var d=c.getElementsByClassName("ifreamTempLayer");if(d&&d.length>0)for(var u=d.length-1;u>=0;u--)c.removeChild(d[u])}}}catch(n){console.error("yslc error:",n)}return document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",s),t.addEventListener("mousemove",a)},t.addEventListener("mousedown",function(n){var i;if("canvas"===n.target.tagName.toLowerCase()){n.preventDefault(),t.onselectstart=function(){return!1},i=r(t,n),e.pointerDown(i.left,i.top);try{var o=document.getElementsByTagName("iframe");if(o&&o.length>0)for(var l=0;l<o.length;l++){var c=o[l].parentNode;if(c){var d=c.getElementsByClassName("ifreamTempLayer");if(d&&d.length>0)for(var u=d.length-1;u>=0;u--)c.removeChild(d[u]);var h=document.createElement("div");h.className="ifreamTempLayer",c.appendChild(h)}}}catch(n){console.error("yslc error:",n)}return t.removeEventListener("mousemove",a),document.addEventListener("mousemove",a),document.addEventListener("mouseup",s)}}),c=function(n){return n.preventDefault(),e.pointerMove.apply(e,i(t,n))},l=function(n){n.preventDefault();try{var r=document.getElementsByTagName("iframe");if(r&&r.length>0)for(var o=0;o<r.length;o++){var a=r[o].parentNode;if(a){var s=a.getElementsByClassName("ifreamTempLayer");if(s&&s.length>0)for(var d=s.length-1;d>=0;d--)a.removeChild(s[d])}}}catch(n){console.error("yslc error:",n)}return e.pointerUp.apply(e,i(t,n)),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",l),document.removeEventListener("touchcancel",l)},t.addEventListener("touchstart",function(n){if("canvas"===n.target.tagName.toLowerCase()){n.preventDefault();try{var r=document.getElementsByTagName("iframe");if(r&&r.length>0)for(var o=0;o<r.length;o++){var a=r[o].parentNode;if(a){var s=a.getElementsByClassName("ifreamTempLayer");if(s&&s.length>0)for(var d=s.length-1;d>=0;d--)a.removeChild(s[d]);var u=document.createElement("div");u.className="ifreamTempLayer",a.appendChild(u)}}}catch(n){console.error("yslc error:",n)}return 1===n.touches.length?(e.pointerDown.apply(e,i(t,n)),document.addEventListener("touchmove",c),document.addEventListener("touchend",l),document.addEventListener("touchcancel",l)):e.pointerMove.apply(e,i(t,n))}}),n&&(console.warn("Keyboard panning is deprecated."),o=function(t){switch(t.keyCode){case 37:e.pan(-10,0);break;case 38:e.pan(0,-10);break;case 39:e.pan(10,0);break;case 40:e.pan(0,10)}return e.repaintAllLayers()},d.push(function(){return document.removeEventListener(o)})),function(){var e,t,n,i;for(i=[],t=0,n=d.length;t<n;t++)e=d[t],i.push(e());return i}}},{}],5:[function(e,t,n){var i,r,o,a,s,l,c,d,u,h;s=e("./lineEndCapShapes"),u={},l=function(){},d=function(e,t,n){var i;if(null==n&&(n={}),null==n.shouldIgnoreUnsupportedShapes&&(n.shouldIgnoreUnsupportedShapes=!1),null==n.retryCallback&&(n.retryCallback=l),null==n.shouldOnlyDrawLatest&&(n.shouldOnlyDrawLatest=!1),null==n.bufferCtx&&(n.bufferCtx=null),i=n.bufferCtx,u[t.className])return n.shouldOnlyDrawLatest&&u[t.className].drawLatestFunc?u[t.className].drawLatestFunc(e,i,t,n.retryCallback):u[t.className].drawFunc(e,t,n.retryCallback);if(n.shouldIgnoreUnsupportedShapes)return console.warn("Can't render shape of type "+t.className+" to canvas");throw"Can't render shape of type "+t.className+" to canvas"},c=function(e,t,n){return d(e.getContext("2d"),t,n)},(r=function(e,t,n){return u[e]={drawFunc:t,drawLatestFunc:n}})("Rectangle",function(e,t){var n,i;return n=t.x,i=t.y,t.strokeWidth%2!=0&&(n+=.5,i+=.5),e.fillStyle=t.fillColor,e.fillRect(n,i,t.width,t.height),e.lineWidth=t.strokeWidth,e.strokeStyle=t.strokeColor,e.strokeRect(n,i,t.width,t.height)}),r("Ellipse",function(e,t){var n,i,r,o;return e.save(),o=Math.floor(t.width/2),r=Math.floor(t.height/2),n=t.x+o,i=t.y+r,e.translate(n,i),e.scale(1,Math.abs(t.height/t.width)),e.beginPath(),e.arc(0,0,Math.abs(o),0,2*Math.PI),e.closePath(),e.restore(),e.fillStyle=t.fillColor,e.fill(),e.lineWidth=t.strokeWidth,e.strokeStyle=t.strokeColor,e.stroke()}),r("SelectionBox",(h=function(e,t,n){var i,r;if(i=t.x,r=t.y,0!==n)return e.fillStyle="#fff",e.fillRect(i,r,n,n),e.strokeStyle="#000",e.strokeRect(i,r,n,n)},function(e,t){return h(e,t.getTopLeftHandleRect(),t.handleSize),h(e,t.getTopRightHandleRect(),t.handleSize),h(e,t.getBottomLeftHandleRect(),t.handleSize),h(e,t.getBottomRightHandleRect(),t.handleSize),t.backgroundColor&&(e.fillStyle=t.backgroundColor,e.fillRect(t._br.x-t.margin,t._br.y-t.margin,t._br.width+2*t.margin,t._br.height+2*t.margin)),e.lineWidth=1,e.strokeStyle="#000",e.setLineDash([2,4]),e.strokeRect(t._br.x-t.margin,t._br.y-t.margin,t._br.width+2*t.margin,t._br.height+2*t.margin),e.setLineDash([])})),r("Image",function(e,t,n){return t.image.width?1===t.scale?e.drawImage(t.image,t.x,t.y):e.drawImage(t.image,t.x,t.y,t.image.width*t.scale,t.image.height*t.scale):n?t.image.onload=n:void 0}),r("Line",function(e,t){var n,i,r,o,a;if(t.x1!==t.x2||t.y1!==t.y2)return i=t.x1,r=t.x2,o=t.y1,a=t.y2,t.strokeWidth%2!=0&&(i+=.5,r+=.5,o+=.5,a+=.5),e.lineWidth=t.strokeWidth,e.strokeStyle=t.color,e.lineCap=t.capStyle,t.dash&&e.setLineDash(t.dash),e.beginPath(),e.moveTo(i,o),e.lineTo(r,a),e.stroke(),t.dash&&e.setLineDash([]),n=Math.max(2.2*t.strokeWidth,5),t.endCapShapes[0]&&s[t.endCapShapes[0]].drawToCanvas(e,i,o,Math.atan2(o-a,i-r),n,t.color),t.endCapShapes[1]?s[t.endCapShapes[1]].drawToCanvas(e,r,a,Math.atan2(a-o,r-i),n,t.color):void 0}),i=function(e,t,n,i){var r,o,a,s;if(null==n&&(n=!1),null==i&&(i="round"),t.length){for(e.lineCap=i,e.strokeStyle=t[0].color,e.lineWidth=t[0].size,e.beginPath(),t[0].size%2==0?e.moveTo(t[0].x,t[0].y):e.moveTo(t[0].x+.5,t[0].y+.5),r=0,o=(s=t.slice(1)).length;r<o;r++)a=s[r],t[0].size%2==0?e.lineTo(a.x,a.y):e.lineTo(a.x+.5,a.y+.5);return n?e.closePath():void 0}},r("LinePath",o=function(e,t){return i(e,t.smoothedPoints),e.stroke()},a=function(e,t,n){var r,o,a;return n.tail?(o=(a=n.smoothedPoints.length-n.segmentSize*n.tailSize)<2*n.segmentSize?0:a,r=a+n.segmentSize+1,i(t,n.smoothedPoints.slice(o,r)),t.stroke()):(i(t,n.smoothedPoints),t.stroke())}),r("ErasedLinePath",function(e,t){return e.save(),e.globalCompositeOperation="destination-out",o(e,t),e.restore()},function(e,t,n){return e.save(),e.globalCompositeOperation="destination-out",t.save(),t.globalCompositeOperation="destination-out",a(0,t,n),e.restore(),t.restore()}),r("Text",function(e,t){return t.renderer||t._makeRenderer(e),e.fillStyle=t.color,t.renderer.draw(e,t.x,t.y)}),r("Polygon",function(e,t){return e.fillStyle=t.fillColor,i(e,t.points,t.isClosed,"butt"),e.fill(),e.stroke()}),t.exports={defineCanvasRenderer:r,renderShapeToCanvas:c,renderShapeToContext:d}},{"./lineEndCapShapes":8}],6:[function(e,t,n){t.exports={imageURLPrefix:"lib/img",primaryColor:"hsla(0, 0%, 0%, 1)",secondaryColor:"hsla(0, 0%, 100%, 1)",backgroundColor:"transparent",strokeWidths:[1,2,5,10,20,30],defaultStrokeWidth:5,toolbarPosition:"top",keyboardShortcuts:!1,imageSize:{width:"infinite",height:"infinite"},backgroundShapes:[],watermarkImage:null,watermarkScale:1,zoomMin:.2,zoomMax:4,zoomStep:.2,snapshot:null,onInit:function(){},tools:[e("../tools/Pencil"),e("../tools/Eraser"),e("../tools/Line"),e("../tools/Rectangle"),e("../tools/Ellipse"),e("../tools/Text"),e("../tools/Polygon"),e("../tools/Pan"),e("../tools/Eyedropper")]}},{"../tools/Ellipse":19,"../tools/Eraser":20,"../tools/Eyedropper":21,"../tools/Line":22,"../tools/Pan":23,"../tools/Pencil":24,"../tools/Polygon":25,"../tools/Rectangle":26,"../tools/Text":28}],7:[function(e,t,n){!function(){if(!document.defaultView.getComputedStyle)throw"ERROR: 'document.defaultView.getComputedStyle' not found. This library only works in browsers that can report computed CSS values.";CanvasRenderingContext2D.prototype.measureTextWidth=CanvasRenderingContext2D.prototype.measureText;CanvasRenderingContext2D.prototype.measureText2=function(e,t,n){var i=this.measureTextWidth(e),r=!/\S/.test(e);i.fontsize=t;var o=document.createElement("div");o.style.position="absolute",o.style.opacity=0,o.style.font=n,o.innerHTML=e+"<br/>"+e,document.body.appendChild(o),i.leading=1.2*t;var a=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)}(o,"height");if((a=a.replace("px",""))>=2*t&&(i.leading=a/2|0),document.body.removeChild(o),r)i.ascent=0,i.descent=0,i.bounds={minx:0,maxx:i.width,miny:0,maxy:0},i.height=0;else{var s=document.createElement("canvas");s.width=i.width+100,s.height=3*t,s.style.opacity=1,s.style.font=n;var l=s.getContext("2d");l.font=n;var c=s.width,d=s.height,u=d/2;l.fillStyle="white",l.fillRect(-1,-1,c+2,d+2),l.fillStyle="black",l.fillText(e,50,u);for(var h=l.getImageData(0,0,c,d).data,p=0,f=4*c,m=h.length;++p<m&&255===h[p];);var g=p/f|0;for(p=m-1;--p>0&&255===h[p];);var v=p/f|0;for(p=0;p<m&&255===h[p];)(p+=f)>=m&&(p=p-m+4);var y=p%f/4|0,b=1;for(p=m-3;p>=0&&255===h[p];)(p-=f)<0&&(p=m-3-4*b++);var w=p%f/4+1|0;i.ascent=u-g,i.descent=v-u,i.bounds={minx:y-50,maxx:w-50,miny:0,maxy:v-g},i.height=v-g+1}return i}}()},{}],8:[function(e,t,n){var i;t.exports={arrow:(i=function(e,t,n,i,r){return[{x:e+Math.cos(n+Math.PI/2)*i/2,y:t+Math.sin(n+Math.PI/2)*i/2},{x:e+Math.cos(n)*r,y:t+Math.sin(n)*r},{x:e+Math.cos(n-Math.PI/2)*i/2,y:t+Math.sin(n-Math.PI/2)*i/2}]},{drawToCanvas:function(e,t,n,r,o,a,s){var l;return null==s&&(s=0),s=s||o,e.fillStyle=a,e.lineWidth=0,e.strokeStyle="transparent",e.beginPath(),l=i(t,n,r,o,s),e.moveTo(l[0].x,l[0].y),e.lineTo(l[1].x,l[1].y),e.lineTo(l[2].x,l[2].y),e.fill()},svg:function(e,t,n,r,o,a){return null==a&&(a=0),"<polygon fill='"+o+"' stroke='none' points='"+i(e,t,n,r,a=a||r).map(function(e){return e.x+","+e.y})+"' />"}})}},{}],9:[function(e,t,n){var i,r,o;o={},r=function(e){return o=e},i=function(e){return o[e]||e},t.exports={localize:r,_:i}},{}],10:[function(e,t,n){var i,r,o,a;e("./shapes").Point,e("./util"),(r={}).toPoly=function(e){var t,n,r,a,s,l,c;for(l=[],c=[],n=0,t=0,r=e.length;t<r;t++)s=e[t],a=o(s,i(e,n)),l=l.concat([a[0]]),c=[a[1]].concat(c),n+=1;return l.concat(c)},i=function(e,t){return e.length<3&&{x:0,y:0},0===t?i(e,t+1):t===e.length-1?i(e,t-1):r.diff(e[t-1],e[t+1])},r.diff=function(e,t){return{x:t.x-e.x,y:t.y-e.y}},a=function(e){var t;return t=r.len(e),{x:e.x/t,y:e.y/t}},o=function(e,t){return(t=a(t)).x=t.x*e.size/2,t.y=t.y*e.size/2,[{x:e.x-t.y,y:e.y+t.x,color:e.color},{x:e.x+t.y,y:e.y-t.x,color:e.color}]},r.len=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},r.scalePositionScalar=function(e,t,n,i){return e+(t*n-t*i)/2},t.exports=r},{"./shapes":13,"./util":15}],11:[function(e,t,n){var i,r,o;o=e("./util"),i=e("./shapes").JSONToShape,r=function(e,t,n){if(t.width)return e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.scale(n,n),e.drawImage(t,-t.width/2,-t.height/2),e.restore()},t.exports=function(e,t){var n,a,s,l,c,d,u,h;return null==t&&(t={}),null==t.scale&&(t.scale=1),d=function(){var t,n,r,o;for(o=[],t=0,n=(r=e.shapes).length;t<n;t++)c=r[t],o.push(i(c));return o}(),a=[],e.backgroundShapes&&(a=function(){var t,n,r,o;for(o=[],t=0,n=(r=e.backgroundShapes).length;t<n;t++)c=r[t],o.push(i(c));return o}()),null==t.margin&&(t.margin={top:0,right:0,bottom:0,left:0}),l=e.imageSize||{width:"infinite",height:"infinite"},s=e.colors||{background:"transparent"},n=d.concat(a),u=document.createElement("canvas"),h=u.getContext("2d"),t.rect?(t.rect.x-=t.margin.left,t.rect.y-=t.margin.top,t.rect.width+=t.margin.left+t.margin.right,t.rect.height+=t.margin.top+t.margin.bottom):t.rect=o.getDefaultImageRect(function(){var e,t,i;for(i=[],e=0,t=n.length;e<t;e++)c=n[e],i.push(c.getBoundingRect(h));return i}(),l,t.margin),u.width=t.rect.width*t.scale,u.height=t.rect.height*t.scale,h.fillStyle=s.background,h.fillRect(0,0,u.width,u.height),t.rect.width&&t.rect.height?(t.watermarkImage&&r(h,t.watermarkImage,t.watermarkScale),o.combineCanvases(u,o.renderShapes(a,t.rect,t.scale),o.renderShapes(d,t.rect,t.scale))):null}},{"./shapes":13,"./util":15}],12:[function(e,t,n){var i,r;r=e("./util"),i=e("./shapes").JSONToShape,t.exports=function(e,t){var n,o,a,s,l,c,d,u;return null==t&&(t={}),u=function(){var t,n,r,o;for(o=[],t=0,n=(r=e.shapes).length;t<n;t++)d=r[t],o.push(i(d));return o}(),o=[],e.backgroundShapes&&(o=function(){var t,n,r,o;for(o=[],t=0,n=(r=e.backgroundShapes).length;t<n;t++)d=r[t],o.push(i(d));return o}()),null==t.margin&&(t.margin={top:0,right:0,bottom:0,left:0}),c=e.imageSize||{width:"infinite",height:"infinite"},a=e.colors||{background:"transparent"},n=u.concat(o),l=document.createElement("canvas"),s=l.getContext("2d"),t.rect?(t.rect.x-=t.margin.left,t.rect.y-=t.margin.top,t.rect.width+=t.margin.left+t.margin.right,t.rect.height+=t.margin.top+t.margin.bottom):t.rect=r.getDefaultImageRect(function(){var e,t,i;for(i=[],e=0,t=n.length;e<t;e++)d=n[e],i.push(d.getBoundingRect(s));return i}(),c,t.margin),LC.renderShapesToSVG(o.concat(u),t.rect,a.background)}},{"./shapes":13,"./util":15}],13:[function(e,t,n){var i,r,o,a,s,l,c,d,u,h,p,f,m,g,v,y,b,w,_,S;S=e("./util"),r=e("./TextRenderer"),e("./lineEndCapShapes"),g=e("./canvasRenderer"),h=g.defineCanvasRenderer,y=g.renderShapeToContext,v=e("./svgRenderer"),p=v.defineSVGRenderer,b=v.renderShapeToSVG,_={},u=function(e,t,n,i,r,o,a,s,l,c,d,u,h,p,f,m,g){var v;return(v=new _[e](t,n,i,r,o,a,s,l,c,d,u,h,p,f,m,g)).id=S.getGUID(),v},i=function(e){var t,n,i,r;return t=e.className,n=e.data,i=e.id,t in _?(r=_[t].fromJSON(n))?(i&&(r.id=i),r):(console.log("Unreadable shape:",t,n),null):(console.log("Unknown shape:",t,n),null)},w=function(e){return{className:e.className,data:e.toJSON(),id:e.id}},d=function(e,t){return t?d(s(s(c(e))),t-1):e},c=function(e){var t,n,i,r,o;for(o=[],t=0,r=0,n=(e=[e[0]].concat(e).concat(S.last(e))).length;r<n;r++)i=e[r],o[2*t]=i,e[t+1]&&(o[2*t+1]=l(i,e[t+1])),t+=1;return o},s=function(e){var t,n,i,r,o;for(t=[],n=0,o=0,i=e.length;o<i;o++)r=e[o],e[n+1]&&(t[n]=l(r,e[n+1])),n+=1;return t},l=function(e,t){return u("Point",{x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2,size:e.size+(t.size-e.size)/2,color:e.color})},(f=function(e,t){var n,i,r,o,a,s,l,c;for(o in(n=function(e,n,i,r,o,a,s,l,c,d,u,h,p,f,m,g){return t.constructor.call(this,e,n,i,r,o,a,s,l,c,d,u,h,p,f,m,g),this}).prototype.className=e,n.fromJSON=t.fromJSON,t.draw&&(a=t.draw,s=t.draw||function(e,t,n){return this.draw(e,t,n)},i=function(e,t,n){return a.call(t,e,n)},r=function(e,t,n,i){return s.call(n,e,t,i)},delete t.draw,t.drawLatest&&delete t.drawLatest,h(e,i,r)),t.toSVG&&(l=t.toSVG,c=function(e){return l.call(e)},delete t.toSVG,p(e,c)),n.prototype.draw=function(e,t){return y(e,this,{retryCallback:t})},n.prototype.drawLatest=function(e,t,n){return y(e,this,{retryCallback:n,bufferCtx:t,shouldOnlyDrawLatest:!0})},n.prototype.toSVG=function(){return b(this)},t)"fromJSON"!==o&&(n.prototype[o]=t[o]);return _[e]=n,n})("Image",{constructor:function(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.scale=e.scale||1,this.image=e.image||null},getBoundingRect:function(){return{x:this.x,y:this.y,width:this.image.width*this.scale,height:this.image.height*this.scale}},toJSON:function(){return{x:this.x,y:this.y,imageSrc:this.image.src,imageObject:this.image,scale:this.scale}},fromJSON:function(e){var t,n;return t=null,(null!=(n=e.imageObject)?n.width:void 0)?t=e.imageObject:(t=new Image).src=e.imageSrc,u("Image",{x:e.x,y:e.y,image:t,scale:e.scale})},move:function(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),f("Rectangle",{constructor:function(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||1,this.strokeColor=e.strokeColor||"black",this.fillColor=e.fillColor||"transparent"},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(e){return u("Rectangle",e)},move:function(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),f("Ellipse",{constructor:function(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.width=e.width||0,this.height=e.height||0,this.strokeWidth=e.strokeWidth||1,this.strokeColor=e.strokeColor||"black",this.fillColor=e.fillColor||"transparent"},getBoundingRect:function(){return{x:this.x-this.strokeWidth/2,y:this.y-this.strokeWidth/2,width:this.width+this.strokeWidth,height:this.height+this.strokeWidth}},toJSON:function(){return{x:this.x,y:this.y,width:this.width,height:this.height,strokeWidth:this.strokeWidth,strokeColor:this.strokeColor,fillColor:this.fillColor}},fromJSON:function(e){return u("Ellipse",e)},move:function(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),f("Line",{constructor:function(e){return null==e&&(e={}),this.x1=e.x1||0,this.y1=e.y1||0,this.x2=e.x2||0,this.y2=e.y2||0,this.strokeWidth=e.strokeWidth||1,this.color=e.color||"black",this.capStyle=e.capStyle||"round",this.endCapShapes=e.endCapShapes||[null,null],this.dash=e.dash||null},getBoundingRect:function(){return{x:Math.min(this.x1,this.x2)-this.strokeWidth/2,y:Math.min(this.y1,this.y2)-this.strokeWidth/2,width:Math.abs(this.x2-this.x1)+this.strokeWidth/2,height:Math.abs(this.y2-this.y1)+this.strokeWidth/2}},toJSON:function(){return{x1:this.x1,y1:this.y1,x2:this.x2,y2:this.y2,strokeWidth:this.strokeWidth,color:this.color,capStyle:this.capStyle,dash:this.dash,endCapShapes:this.endCapShapes}},fromJSON:function(e){return u("Line",e)},move:function(e){return null==e&&(e={}),this.x1=this.x1-e.xDiff,this.y1=this.y1-e.yDiff,this.x2=this.x2-e.xDiff,this.y2=this.y2-e.yDiff},setUpperLeft:function(e){var t,n,i;return null==e&&(e={}),n=(t=this.getBoundingRect()).x-e.x,i=t.y-e.y,this.move({xDiff:n,yDiff:i})}}),a=function(e){var t,n,i,r,o;if(!e.length)return!1;for(o=e[0].size,t=e[0].color,r=0,n=e.length;r<n;r++)if((i=e[r]).size===o&&i.color===t||console.log(o,t,i.size,i.color),i.size!==o||i.color!==t)return!1;return!0},o=function(e,t){var n,r,o,a,s;return r=null,t.points?r=function(){var e,r,o,a;for(a=[],r=0,e=(o=t.points).length;r<e;r++)n=o[r],a.push(i(n));return a}():t.pointCoordinatePairs&&(r=function(){var e,n,r,o,l;for(l=[],n=0,e=(r=t.pointCoordinatePairs).length;n<e;n++)o=r[n],a=o[0],s=o[1],l.push(i({className:"Point",data:{x:a,y:s,size:t.pointSize,color:t.pointColor,smooth:t.smooth}}));return l}()),o=null,t.smoothedPointCoordinatePairs&&(o=function(){var e,n,r,o,l;for(l=[],n=0,e=(r=t.smoothedPointCoordinatePairs).length;n<e;n++)o=r[n],a=o[0],s=o[1],l.push(i({className:"Point",data:{x:a,y:s,size:t.pointSize,color:t.pointColor,smooth:t.smooth}}));return l}()),r[0]?u(e,{points:r,smoothedPoints:o,order:t.order,tailSize:t.tailSize,smooth:t.smooth}):null},f("LinePath",m={constructor:function(e){var t,n,i,r,o;if(null==e&&(e={}),i=e.points||[],this.order=e.order||3,this.tailSize=e.tailSize||3,this.smooth=!("smooth"in e)||e.smooth,this.segmentSize=Math.pow(2,this.order),this.sampleSize=this.tailSize+1,e.smoothedPoints)return this.points=e.points,this.smoothedPoints=e.smoothedPoints;for(this.points=[],o=[],r=0,t=i.length;r<t;r++)n=i[r],o.push(this.addPoint(n));return o},getBoundingRect:function(){return S.getBoundingRect(this.points.map(function(e){return{x:e.x-e.size/2,y:e.y-e.size/2,width:e.size,height:e.size}}))},toJSON:function(){var e,t;return a(this.points)?{order:this.order,tailSize:this.tailSize,smooth:this.smooth,pointCoordinatePairs:function(){var e,n,i,r;for(r=[],n=0,e=(i=this.points).length;n<e;n++)t=i[n],r.push([t.x,t.y]);return r}.call(this),smoothedPointCoordinatePairs:function(){var e,n,i,r;for(r=[],n=0,e=(i=this.smoothedPoints).length;n<e;n++)t=i[n],r.push([t.x,t.y]);return r}.call(this),pointSize:this.points[0].size,pointColor:this.points[0].color}:{order:this.order,tailSize:this.tailSize,smooth:this.smooth,points:function(){var t,n,i,r;for(r=[],n=0,t=(i=this.points).length;n<t;n++)e=i[n],r.push(w(e));return r}.call(this)}},fromJSON:function(e){return o("LinePath",e)},addPoint:function(e){if(this.points.push(e),this.smooth)return!this.smoothedPoints||this.points.length<this.sampleSize?this.smoothedPoints=d(this.points,this.order):(this.tail=S.last(d(S.last(this.points,this.sampleSize),this.order),this.segmentSize*this.tailSize),this.smoothedPoints=this.smoothedPoints.slice(0,this.smoothedPoints.length-this.segmentSize*(this.tailSize-1)).concat(this.tail));this.smoothedPoints=this.points},move:function(e){var t,n,i;for(null==e&&(e={}),i=0,t=(n=this.smooth?this.smoothedPoints:this.points).length;i<t;i++)n[i].move(e);return this.points=this.smoothedPoints},setUpperLeft:function(e){var t,n,i;return null==e&&(e={}),n=(t=this.getBoundingRect()).x-e.x,i=t.y-e.y,this.move({xDiff:n,yDiff:i})}}),f("ErasedLinePath",{constructor:m.constructor,toJSON:m.toJSON,addPoint:m.addPoint,getBoundingRect:m.getBoundingRect,fromJSON:function(e){return o("ErasedLinePath",e)}}),f("Point",{constructor:function(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.size=e.size||0,this.color=e.color||""},getBoundingRect:function(){return{x:this.x-this.size/2,y:this.y-this.size/2,width:this.size,height:this.size}},toJSON:function(){return{x:this.x,y:this.y,size:this.size,color:this.color}},fromJSON:function(e){return u("Point",e)},move:function(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),f("Polygon",{constructor:function(e){var t,n,i,r,o;for(null==e&&(e={}),this.points=e.points,this.fillColor=e.fillColor||"white",this.strokeColor=e.strokeColor||"black",this.strokeWidth=e.strokeWidth,this.dash=e.dash||null,null==e.isClosed&&(e.isClosed=!0),this.isClosed=e.isClosed,o=[],i=0,t=(r=this.points).length;i<t;i++)(n=r[i]).color=this.strokeColor,o.push(n.size=this.strokeWidth);return o},addPoint:function(e,t){return this.points.push(LC.createShape("Point",{x:e,y:t}))},getBoundingRect:function(){return S.getBoundingRect(this.points.map(function(e){return e.getBoundingRect()}))},toJSON:function(){return{strokeWidth:this.strokeWidth,fillColor:this.fillColor,strokeColor:this.strokeColor,dash:this.dash,isClosed:this.isClosed,pointCoordinatePairs:this.points.map(function(e){return[e.x,e.y]})}},fromJSON:function(e){return e.points=e.pointCoordinatePairs.map(function(t){var n,i;return n=t[0],i=t[1],u("Point",{x:n,y:i,size:e.strokeWidth,color:e.strokeColor})}),u("Polygon",e)},move:function(e){var t,n,i,r,o;for(null==e&&(e={}),o=[],i=0,t=(r=this.points).length;i<t;i++)n=r[i],o.push(n.move(e));return o},setUpperLeft:function(e){var t,n,i;return null==e&&(e={}),n=(t=this.getBoundingRect()).x-e.x,i=t.y-e.y,this.move({xDiff:n,yDiff:i})}}),f("Text",{constructor:function(e){return null==e&&(e={}),this.x=e.x||0,this.y=e.y||0,this.v=e.v||0,this.text=e.text||"",this.color=e.color||"black",this.font=e.font||"18px sans-serif",this.forcedWidth=e.forcedWidth||null,this.forcedHeight=e.forcedHeight||null},_makeRenderer:function(e){if(e.lineHeight=1.2,this.renderer=new r(e,this.text,this.font,this.forcedWidth,this.forcedHeight),this.v<1)return console.log("repairing baseline"),this.v=1,this.x-=this.renderer.metrics.bounds.minx,this.y-=this.renderer.metrics.leading-this.renderer.metrics.descent},setText:function(e){return this.text=e,this.renderer=null},setFont:function(e){return this.font=e,this.renderer=null},setPosition:function(e,t){return this.x=e,this.y=t},setSize:function(e,t){return this.forcedWidth=Math.max(e,0),this.forcedHeight=Math.max(t,0),this.renderer=null},enforceMaxBoundingRect:function(e){var t,n,i;if(t=this.getBoundingRect(e.ctx),i={x:-e.position.x/e.scale,y:-e.position.y/e.scale,width:e.canvas.width/e.scale,height:e.canvas.height/e.scale},t.x+t.width>i.x+i.width)return n=t.x-i.x,this.forcedWidth=i.width-n-10,this.renderer=null},getBoundingRect:function(e,t){if(null==t&&(t=!1),!this.renderer){if(!e)throw"Must pass ctx if text hasn't been rendered yet";this._makeRenderer(e)}return{x:Math.floor(this.x),y:Math.floor(this.y),width:Math.ceil(this.renderer.getWidth(!0)),height:Math.ceil(this.renderer.getHeight())}},toJSON:function(){return{x:this.x,y:this.y,text:this.text,color:this.color,font:this.font,forcedWidth:this.forcedWidth,forcedHeight:this.forcedHeight,v:this.v}},fromJSON:function(e){return u("Text",e)},move:function(e){return null==e&&(e={}),this.x=this.x-e.xDiff,this.y=this.y-e.yDiff},setUpperLeft:function(e){return null==e&&(e={}),this.x=e.x,this.y=e.y}}),f("SelectionBox",{constructor:function(e){return null==e&&(e={}),this.shape=e.shape,null!=e.handleSize?this.handleSize=e.handleSize:this.handleSize=10,this.margin=4,this.backgroundColor=e.backgroundColor||null,this._br=this.shape.getBoundingRect(e.ctx)},toJSON:function(){return{shape:w(this.shape),backgroundColor:this.backgroundColor}},fromJSON:function(e){var t,n;return n=e.shape,e.handleSize,e.margin,t=e.backgroundColor,u("SelectionBox",{shape:i(n),backgroundColor:t})},getTopLeftHandleRect:function(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomLeftHandleRect:function(){return{x:this._br.x-this.handleSize-this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getTopRightHandleRect:function(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y-this.handleSize-this.margin,width:this.handleSize,height:this.handleSize}},getBottomRightHandleRect:function(){return{x:this._br.x+this._br.width+this.margin,y:this._br.y+this._br.height+this.margin,width:this.handleSize,height:this.handleSize}},getBoundingRect:function(){return{x:this._br.x-this.margin,y:this._br.y-this.margin,width:this._br.width+2*this.margin,height:this._br.height+2*this.margin}}}),t.exports={defineShape:f,createShape:u,JSONToShape:i,shapeToJSON:w}},{"./TextRenderer":2,"./canvasRenderer":5,"./lineEndCapShapes":8,"./svgRenderer":14,"./util":15}],14:[function(e,t,n){var i,r,o,a;r=e("./lineEndCapShapes"),a={},o=function(e,t){if(null==t&&(t={}),null==t.shouldIgnoreUnsupportedShapes&&(t.shouldIgnoreUnsupportedShapes=!1),a[e.className])return a[e.className](e);if(t.shouldIgnoreUnsupportedShapes)return console.warn("Can't render shape of type "+e.className+" to SVG"),"";throw"Can't render shape of type "+e.className+" to SVG"},(i=function(e,t){return a[e]=t})("Rectangle",function(e){var t,n,i,r,o,a,s,l;return r=e.x,s=e.y,o=e.x+e.width,l=e.y+e.height,i=Math.min(r,o),a=Math.min(s,l),n=Math.max(r,o)-i,t=Math.max(s,l)-a,e.strokeWidth%2!=0&&(i+=.5,a+=.5),"<rect x='"+i+"' y='"+a+"' width='"+n+"' height='"+t+"' stroke='"+e.strokeColor+"' fill='"+e.fillColor+"' stroke-width='"+e.strokeWidth+"' />"}),i("SelectionBox",function(e){return""}),i("Ellipse",function(e){var t,n;return n=Math.floor(e.width/2),t=Math.floor(e.height/2),"<ellipse cx='"+(e.x+n)+"' cy='"+(e.y+t)+"' rx='"+Math.abs(n)+"' ry='"+Math.abs(t)+"' stroke='"+e.strokeColor+"' fill='"+e.fillColor+"' stroke-width='"+e.strokeWidth+"' />"}),i("Image",function(e){return"<image x='"+e.x+"' y='"+e.y+"' width='"+e.image.naturalWidth*e.scale+"' height='"+e.image.naturalHeight*e.scale+"' xlink:href='"+e.image.src+"' />"}),i("Line",function(e){var t,n,i,o,a,s,l;return i=e.dash?"stroke-dasharray='"+e.dash.join(", ")+"'":"",n="",t=Math.max(2.2*e.strokeWidth,5),o=e.x1,a=e.x2,s=e.y1,l=e.y2,e.strokeWidth%2!=0&&(o+=.5,a+=.5,s+=.5,l+=.5),e.endCapShapes[0]&&(n+=r[e.endCapShapes[0]].svg(o,s,Math.atan2(s-l,o-a),t,e.color)),e.endCapShapes[1]&&(n+=r[e.endCapShapes[1]].svg(a,l,Math.atan2(l-s,a-o),t,e.color)),"<g> <line x1='"+o+"' y1='"+s+"' x2='"+a+"' y2='"+l+"' "+i+" stroke-linecap='"+e.capStyle+"' stroke='"+e.color+" 'stroke-width='"+e.strokeWidth+"' /> "+n+" </g>"}),i("LinePath",function(e){return"<polyline fill='none' points='"+e.smoothedPoints.map(function(e){var t;return t=e.strokeWidth%2==0?0:.5,e.x+t+","+(e.y+t)}).join(" ")+"' stroke='"+e.points[0].color+"' stroke-linecap='round' stroke-width='"+e.points[0].size+"' />"}),i("ErasedLinePath",function(e){return""}),i("Polygon",function(e){return e.isClosed?"<polygon fill='"+e.fillColor+"' points='"+e.points.map(function(e){var t;return t=e.strokeWidth%2==0?0:.5,e.x+t+","+(e.y+t)}).join(" ")+"' stroke='"+e.strokeColor+"' stroke-width='"+e.strokeWidth+"' />":"<polyline fill='"+e.fillColor+"' points='"+e.points.map(function(e){var t;return t=e.strokeWidth%2==0?0:.5,e.x+t+","+(e.y+t)}).join(" ")+"' stroke='none' /> <polyline fill='none' points='"+e.points.map(function(e){var t;return t=e.strokeWidth%2==0?0:.5,e.x+t+","+(e.y+t)}).join(" ")+"' stroke='"+e.strokeColor+"' stroke-width='"+e.strokeWidth+"' />"}),i("Text",function(e){var t,n,i;return i=e.forcedWidth?"width='"+e.forcedWidth+"px'":"",t=e.forcedHeight?"height='"+e.forcedHeight+"px'":"",n=e.text.split(/\r\n|\r|\n/g),e.renderer&&(n=e.renderer.lines),"<text x='"+e.x+"' y='"+e.y+"' "+i+" "+t+" fill='"+e.color+"' style='font: "+e.font+";'> "+n.map(function(t,n){var i;return i=0===n?0:"1.2em","<tspan x='"+e.x+"' dy='"+i+"' alignment-baseline='text-before-edge'> "+t+" </tspan>"}).join("")+" </text>"}),t.exports={defineSVGRenderer:i,renderShapeToSVG:o}},{"./lineEndCapShapes":8}],15:[function(e,t,n){var i,r,o,a,s,l=[].slice;o=Array.prototype.slice,i=e("./canvasRenderer").renderShapeToContext,r=e("./svgRenderer").renderShapeToSVG,a={addImageOnload:function(e,t){var n;return n=e.onload,e.onload=function(){return"function"==typeof n&&n(),t()},e},last:function(e,t){return null==t&&(t=null),t?o.call(e,Math.max(e.length-t,0)):e[e.length-1]},classSet:function(e){var t,n;for(n in t=[],e)e[n]&&t.push(n);return t.join(" ")},matchElementSize:function(e,t,n,i){var r;return null==i&&(i=function(){}),r=function(){var n,r,o;for(r=0,o=t.length;r<o;r++)(n=t[r]).style.width=e.offsetWidth+"px",n.style.height=e.offsetHeight+"px",null!=n.width&&(n.setAttribute("width",e.offsetWidth),n.setAttribute("height",e.offsetHeight));return i()},e.addEventListener("resize",r),window.addEventListener("resize",r),window.addEventListener("orientationchange",r),r(),r},combineCanvases:function(){var e,t,n,i,r,o,a,s;for(n=1<=arguments.length?l.call(arguments,0):[],(e=document.createElement("canvas")).width=n[0].width,e.height=n[0].height,r=0,a=n.length;r<a;r++)t=n[r],e.width=Math.max(t.width,e.width),e.height=Math.max(t.height,e.height);for(i=e.getContext("2d"),o=0,s=n.length;o<s;o++)t=n[o],i.drawImage(t,0,0);return e},renderShapes:function(e,t,n,r){var o,a,s,l;for(null==n&&(n=1),null==r&&(r=null),(r=r||document.createElement("canvas")).width=t.width*n,r.height=t.height*n,(o=r.getContext("2d")).translate(-t.x*n,-t.y*n),o.scale(n,n),a=0,s=e.length;a<s;a++)l=e[a],i(o,l);return r},renderShapesToSVG:function(e,t,n){var i,o,a,s;return a=t.x,s=t.y,("<svg xmlns='http://www.w3.org/2000/svg' width='"+(o=t.width)+"' height='"+(i=t.height)+"' viewBox='0 0 "+o+" "+i+"'> <rect width='"+o+"' height='"+i+"' x='0' y='0' fill='"+n+"' /> <g transform='translate("+-a+", "+-s+")'> "+e.map(r).join("")+" </g> </svg>").replace(/(\r\n|\n|\r)/gm,"")},getBoundingRect:function(e,t,n){var i,r,o,a,s,l,c;if(!e.length)return{x:0,y:0,width:t,height:n};for(s=e[0].x,l=e[0].y,o=e[0].x+e[0].width,a=e[0].y+e[0].height,i=0,r=e.length;i<r;i++)c=e[i],s=Math.floor(Math.min(c.x,s)),l=Math.floor(Math.min(c.y,l)),o=Math.ceil(Math.max(o,c.x+c.width)),a=Math.ceil(Math.max(a,c.y+c.height));return{x:s=t?0:s,y:l=n?0:l,width:(o=t||o)-s,height:(a=n||a)-l}},getDefaultImageRect:function(e,t,n){var i,r,o;return null==t&&(t={width:0,height:0}),null==n&&(n={top:0,right:0,bottom:0,left:0}),o=t.width,i=t.height,(r=a.getBoundingRect(e,"infinite"===o?0:o,"infinite"===i?0:i)).x-=n.left,r.y-=n.top,r.width+=n.left+n.right,r.height+=n.top+n.bottom,r},getBackingScale:function(e){return null==window.devicePixelRatio?1:window.devicePixelRatio>1?window.devicePixelRatio:1},getGUID:(s=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},function(){return s()+s()+"-"+s()+"-"+s()+"-"+s()+"-"+s()+s()+s()}),requestAnimationFrame:function(e){return window.requestAnimationFrame?window.requestAnimationFrame(e):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(e):window.mozRequestAnimationFrame?window.mozRequestAnimationFrame(e):setTimeout(e,0)},cancelAnimationFrame:function(e){return window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.webkitCancelRequestAnimationFrame?window.webkitCancelRequestAnimationFrame(e):window.webkitCancelAnimationFrame?window.webkitCancelAnimationFrame(e):window.mozCancelAnimationFrame?window.mozCancelAnimationFrame(e):clearTimeout(e)}},t.exports=a},{"./canvasRenderer":5,"./svgRenderer":14}],16:[function(e,t,n){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.CustomEvent.prototype,window.CustomEvent=e}()},{}],17:[function(e,t,n){var i=!1;CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(){i||(console.warn("context2D.setLineDash is a no-op in this browser."),i=!0)}),t.exports=null},{}],18:[function(e,t,n){var i,r,o,a,s,l,c,d,u,h,p,f,m,g,v,y,b;e("./ie_customevent"),e("./ie_setLineDash"),i=e("./core/LiterallyCanvas"),s=e("./core/defaultOptions"),o=e("./core/canvasRenderer"),v=e("./core/svgRenderer"),g=e("./core/shapes"),b=e("./core/util"),p=e("./core/renderSnapshotToImage"),f=e("./core/renderSnapshotToSVG"),u=e("./core/localization").localize,a={snapshotToShapes:function(e){var t,n,i,r,o;for(r=[],t=0,n=(i=e.shapes).length;t<n;t++)o=i[t],r.push(g.JSONToShape(o));return r},snapshotJSONToShapes:function(e){return a.snapshotToShapes(JSON.parse(e))}},r=e("./tools/base"),y={Pencil:e("./tools/Pencil"),Eraser:e("./tools/Eraser"),Line:e("./tools/Line"),Rectangle:e("./tools/Rectangle"),Ellipse:e("./tools/Ellipse"),Text:e("./tools/Text"),Polygon:e("./tools/Polygon"),Pan:e("./tools/Pan"),Eyedropper:e("./tools/Eyedropper"),SelectShape:e("./tools/SelectShape"),Tool:r.Tool,ToolWithStroke:r.ToolWithStroke},l=s.tools,s.imageURLPrefix,m=function(e){return e,s.imageURLPrefix=e},c=function(e,t){var n,i,r,o,a;for(o in null==t&&(t={}),s)o in t||(t[o]=s[o]);for(i=0,r=(a=e.children).length;i<r;i++)n=a[i],e.removeChild(n);return d(e,t)},d=function(e,t){var n,r,o;o=e.className,-1===[" "," "].join(e.className).indexOf(" literally ")&&(e.className=e.className+" literally"),e.className=e.className+" toolbar-hidden",(n=document.createElement("div")).className="lc-drawing",e.appendChild(n);var a=document.createElement("div");a.className="custom-canvas-background",a.id="customCanvasView",n.appendChild(a);var s=document.createElement("div");s.className="pdf-container",n.appendChild(s);var l=document.createElement("div");l.className="draw-permission",e.appendChild(l);var c=document.createElement("div");c.className="temporary-draw-permission",e.appendChild(c);var d=document.createElement("span");d.className="laser-mark",e.appendChild(d);var u=document.createElement("div");return u.className="literally-data-loading-wrap",u.style.zIndex=100,u.style.display="none",e.appendChild(u),(r=new i(n,t)).customCanvasBackgroundElement=a,r.loadingElement=u,r.watermarkImageToLcBackground=void 0===t.watermarkImageToLcBackground||t.watermarkImageToLcBackground,n.setAttribute("watermarkImageToLcBackground",r.watermarkImageToLcBackground),r.isDrawAble?(l.className=l.className.replace(/( yes| no)/g,""),l.className+=" yes"):(l.className=l.className.replace(/( yes| no)/g,""),l.className+=" no"),r.isTmpDrawAble?(c.className=c.className.replace(/( yes| no)/g,""),c.className+=" yes"):(c.className=c.className.replace(/( yes| no)/g,""),c.className+=" no"),r.teardown=function(){var t,n,i;try{for(r._teardown(),n=(i=e.children).length-1;n>=0;n--)(t=i[n])&&e.removeChild(t);return e.className=o}catch(e){return void console.error("ys_lc error:",e)}},"onInit"in t&&t.onInit(r),r},h=function(e){return e.fn.literallycanvas=function(e){return null==e&&(e={}),this.each(function(t,n){return n.literallycanvas=c(n,e)}),this}},"undefined"!=typeof window&&(window.LC={init:c},window.$&&h(window.$)),t.exports={init:c,registerJQueryPlugin:h,util:b,tools:y,setDefaultImageURLPrefix:m,defaultTools:l,defineShape:g.defineShape,createShape:g.createShape,JSONToShape:g.JSONToShape,shapeToJSON:g.shapeToJSON,defineCanvasRenderer:o.defineCanvasRenderer,renderShapeToContext:o.renderShapeToContext,renderShapeToCanvas:o.renderShapeToCanvas,renderShapesToCanvas:b.renderShapes,defineSVGRenderer:v.defineSVGRenderer,renderShapeToSVG:v.renderShapeToSVG,renderShapesToSVG:b.renderShapesToSVG,snapshotToShapes:a.snapshotToShapes,snapshotJSONToShapes:a.snapshotJSONToShapes,renderSnapshotToImage:p,renderSnapshotToSVG:f,localize:u}},{"./core/LiterallyCanvas":1,"./core/canvasRenderer":5,"./core/defaultOptions":6,"./core/localization":9,"./core/renderSnapshotToImage":11,"./core/renderSnapshotToSVG":12,"./core/shapes":13,"./core/svgRenderer":14,"./core/util":15,"./ie_customevent":16,"./ie_setLineDash":17,"./tools/Ellipse":19,"./tools/Eraser":20,"./tools/Eyedropper":21,"./tools/Line":22,"./tools/Pan":23,"./tools/Pencil":24,"./tools/Polygon":25,"./tools/Rectangle":26,"./tools/SelectShape":27,"./tools/Text":28,"./tools/base":29}],19:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").ToolWithStroke,r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Ellipse",t.prototype.iconName="ellipse",t.prototype.begin=function(e,t,n){return this.currentShape=r("Ellipse",{x:e,y:t,strokeWidth:this.strokeWidth,strokeColor:n.getColor("primary"),fillColor:n.getColor("secondary")})},t.prototype.continue=function(e,t,n){return this.currentShape.width=e-this.currentShape.x,this.currentShape.height=t-this.currentShape.y,n.drawShapeInProgress(this.currentShape)},t.prototype.end=function(e,t,n){return n.saveShape(this.currentShape)},t}()},{"../core/shapes":13,"./base":29}],20:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./Pencil"),r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Eraser",t.prototype.iconName="eraser",t.prototype.makePoint=function(e,t,n){return r("Point",{x:e,y:t,size:this.strokeWidth,color:"#000"})},t.prototype.makeShape=function(){return r("ErasedLinePath")},t}()},{"../core/shapes":13,"./Pencil":24}],21:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").Tool,r=function(e,t){var n,i,r;return i=t.x,r=t.y,(n=e.getImageData(i,r,1,1).data)[3]?"rgb("+n[0]+", "+n[1]+", "+n[2]+")":null},t.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.strokeOrFill="stroke"}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Eyedropper",t.prototype.iconName="eyedropper",t.prototype.optionsStyle="stroke-or-fill",t.prototype.readColor=function(e,t,n){var i,o,a;return a=n.getDefaultImageRect(),i=n.getImage(),(o=r(i.getContext("2d"),{x:e-a.x,y:t-a.y}))||n.getColor("background"),"stroke"===this.strokeOrFill?n.setColor("primary",o):n.setColor("secondary",o)},t.prototype.begin=function(e,t,n){return this.readColor(e,t,n)},t.prototype.continue=function(e,t,n){return this.readColor(e,t,n)},t}()},{"./base":29}],22:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").ToolWithStroke,r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Line",t.prototype.iconName="line",t.prototype.optionsStyle="line-options-and-stroke-width",t.prototype.begin=function(e,t,n){return this.currentShape=r("Line",{x1:e,y1:t,x2:e,y2:t,strokeWidth:this.strokeWidth,dash:function(){switch(!1){case!this.isDashed:return[2*this.strokeWidth,4*this.strokeWidth];default:return null}}.call(this),endCapShapes:this.hasEndArrow?[null,"arrow"]:null,color:n.getColor("primary")})},t.prototype.continue=function(e,t,n){return this.currentShape.x2=e,this.currentShape.y2=t,n.drawShapeInProgress(this.currentShape)},t.prototype.end=function(e,t,n){return n.saveShape(this.currentShape)},t}()},{"../core/shapes":13,"./base":29}],23:[function(e,t,n){var i,r={}.hasOwnProperty;i=e("./base").Tool,e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)r.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Pan",t.prototype.iconName="pan",t.prototype.usesSimpleAPI=!1,t.prototype.didBecomeActive=function(e){var t,n;return t=[],this.unsubscribe=function(){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(e());return r},t.push(e.on("lc-pointerdown",(n=this,function(t){var i,r;return i=t.rawX,r=t.rawY,n.oldPosition=e.position,n.pointerStart={x:i,y:r}}))),t.push(e.on("lc-pointerdrag",function(t){return function(n){var i,r,o;return r=n.rawX,o=n.rawY,i={x:(r-t.pointerStart.x)*e.backingScale,y:(o-t.pointerStart.y)*e.backingScale},e.setPan(t.oldPosition.x+i.x,t.oldPosition.y+i.y)}}(this)))},t.prototype.willBecomeInactive=function(e){return this.unsubscribe()},t}()},{"../core/shapes":13,"./base":29}],24:[function(e,t,n){var i,r,a={}.hasOwnProperty;i=e("./base").ToolWithStroke,r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)a.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Pencil",t.prototype.iconName="pencil",t.prototype.eventTimeThreshold=10,t.prototype.begin=function(e,t,n){return this.color=n.getColor("primary"),this.currentShape=this.makeShape(),this.currentShape.addPoint(this.makePoint(e,t,n)),this.lastEventTime=o()()},t.prototype.continue=function(e,t,n){var i;if((i=o()()-this.lastEventTime)>this.eventTimeThreshold)return this.lastEventTime+=i,this.currentShape.addPoint(this.makePoint(e,t,n)),n.drawShapeInProgress(this.currentShape)},t.prototype.end=function(e,t,n){return n.saveShape(this.currentShape),this.currentShape=void 0},t.prototype.makePoint=function(e,t,n){return r("Point",{x:e,y:t,size:this.strokeWidth,color:this.color})},t.prototype.makeShape=function(){return r("LinePath")},t}()},{"../core/shapes":13,"./base":29}],25:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").ToolWithStroke,r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Polygon",t.prototype.iconName="polygon",t.prototype.usesSimpleAPI=!1,t.prototype.didBecomeActive=function(e){var n,i,r,o,a,s,l,c;return t.__super__.didBecomeActive.call(this,e),l=[],this.polygonUnsubscribe=function(){var e,t,n,i;for(i=[],t=0,n=l.length;t<n;t++)e=l[t],i.push(e());return i},this.points=null,this.maybePoint=null,c=this,r=function(){return c._getWillFinish()?c._close(e):(e.trigger("lc-polygon-started"),c.points?c.points.push(c.maybePoint):c.points=[c.maybePoint],c.maybePoint={x:c.maybePoint.x,y:c.maybePoint.y},e.setShapesInProgress(c._getShapes(e)),e.repaintLayer("main"))},i=function(t){return function(n){var i,r;if(i=n.x,r=n.y,t.maybePoint)return t.maybePoint.x=i,t.maybePoint.y=r,e.setShapesInProgress(t._getShapes(e)),e.repaintLayer("main")}}(this),n=function(t){return function(n){var i,r;return i=n.x,r=n.y,t.maybePoint={x:i,y:r},e.setShapesInProgress(t._getShapes(e)),e.repaintLayer("main")}}(this),s=function(t){return function(){return t.maybePoint={x:1/0,y:1/0},t._close(e)}}(this),a=function(t){return function(){return t.maybePoint=t.points[0],t._close(e)}}(this),o=function(t){return function(){return t._cancel(e)}}(this),l.push(e.on("drawingChange",function(t){return function(){return t._cancel(e)}}(this))),l.push(e.on("lc-pointerdown",n)),l.push(e.on("lc-pointerdrag",i)),l.push(e.on("lc-pointermove",i)),l.push(e.on("lc-pointerup",r)),l.push(e.on("lc-polygon-finishopen",s)),l.push(e.on("lc-polygon-finishclosed",a)),l.push(e.on("lc-polygon-cancel",o))},t.prototype.willBecomeInactive=function(e){return t.__super__.willBecomeInactive.call(this,e),(this.points||this.maybePoint)&&this._cancel(e),this.polygonUnsubscribe()},t.prototype._getArePointsClose=function(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)<10},t.prototype._getWillClose=function(){return!!(this.points&&this.points.length>1)&&(!!this.maybePoint&&this._getArePointsClose(this.points[0],this.maybePoint))},t.prototype._getWillFinish=function(){return!!(this.points&&this.points.length>1)&&(!!this.maybePoint&&(this._getArePointsClose(this.points[0],this.maybePoint)||this._getArePointsClose(this.points[this.points.length-1],this.maybePoint)))},t.prototype._cancel=function(e){return e.trigger("lc-polygon-stopped"),this.maybePoint=null,this.points=null,e.setShapesInProgress([]),e.repaintLayer("main")},t.prototype._close=function(e){return e.trigger("lc-polygon-stopped"),e.setShapesInProgress([]),this.points.length>2&&e.saveShape(this._getShape(e,!1)),this.maybePoint=null,this.points=null},t.prototype._getShapes=function(e,t){var n;return null==t&&(t=!0),(n=this._getShape(e,t))?[n]:[]},t.prototype._getShape=function(e,t){var n;return null==t&&(t=!0),n=[],this.points&&(n=n.concat(this.points)),!t&&n.length<3?null:(t&&this.maybePoint&&n.push(this.maybePoint),n.length>1?r("Polygon",{isClosed:this._getWillClose(),strokeColor:e.getColor("primary"),fillColor:e.getColor("secondary"),strokeWidth:this.strokeWidth,points:n.map(function(e){return r("Point",e)})}):null)},t.prototype.optionsStyle="polygon-and-stroke-width",t}()},{"../core/shapes":13,"./base":29}],26:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").ToolWithStroke,r=e("../core/shapes").createShape,t.exports=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Rectangle",t.prototype.iconName="rectangle",t.prototype.begin=function(e,t,n){return this.currentShape=r("Rectangle",{x:e,y:t,strokeWidth:this.strokeWidth,strokeColor:n.getColor("primary"),fillColor:n.getColor("secondary")})},t.prototype.continue=function(e,t,n){return this.currentShape.width=e-this.currentShape.x,this.currentShape.height=t-this.currentShape.y,n.drawShapeInProgress(this.currentShape)},t.prototype.end=function(e,t,n){return n.saveShape(this.currentShape)},t}()},{"../core/shapes":13,"./base":29}],27:[function(e,t,n){var i,r,o={}.hasOwnProperty;i=e("./base").Tool,r=e("../core/shapes").createShape,t.exports=function(e){function t(e){this.selectCanvas=document.createElement("canvas"),this.selectCanvas.style["background-color"]="transparent",this.selectCtx=this.selectCanvas.getContext("2d")}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="SelectShape",t.prototype.usesSimpleAPI=!1,t.prototype.didBecomeActive=function(e){var t,n,i,o,a;return o=[],this._selectShapeUnsubscribe=function(){var e,t,n,i;for(i=[],t=0,n=o.length;t<n;t++)e=o[t],i.push(e());return i},a=this,t=function(t){var n,i,o,s;if(o=t.x,s=t.y,a.didDrag=!1,i=a._getPixel(o,s,e,a.selectCtx),a.selectedShape=e.shapes[i],null!=a.selectedShape)return e.trigger("shapeSelected",{selectedShape:a.selectedShape}),e.setShapesInProgress([a.selectedShape,r("SelectionBox",{shape:a.selectedShape,handleSize:0})]),e.repaintLayer("main"),n=a.selectedShape.getBoundingRect(),a.dragOffset={x:o-n.x,y:s-n.y}},n=function(t){return function(n){var i,o;if(i=n.x,o=n.y,null!=t.selectedShape)return t.didDrag=!0,t.selectedShape.setUpperLeft({x:i-t.dragOffset.x,y:o-t.dragOffset.y}),e.setShapesInProgress([t.selectedShape,r("SelectionBox",{shape:t.selectedShape,handleSize:0})]),e.repaintLayer("main")}}(this),i=function(t){return function(n){if(n.x,n.y,t.didDrag)return t.didDrag=!1,e.trigger("shapeMoved",{shape:t.selectedShape}),e.trigger("drawingChange",{}),e.repaintLayer("main"),t._drawSelectCanvas(e)}}(this),o.push(e.on("lc-pointerdown",t)),o.push(e.on("lc-pointerdrag",n)),o.push(e.on("lc-pointerup",i)),this._drawSelectCanvas(e)},t.prototype.willBecomeInactive=function(e){return this._selectShapeUnsubscribe(),e.setShapesInProgress([])},t.prototype._drawSelectCanvas=function(e){var t,n;return this.selectCanvas.width=e.canvas.width,this.selectCanvas.height=e.canvas.height,this.selectCtx.clearRect(0,0,this.selectCanvas.width,this.selectCanvas.height),t=e.shapes.map((n=this,function(e,t){return r("SelectionBox",{shape:e,handleSize:0,backgroundColor:"#"+n._intToHex(t)})})),e.draw(t,this.selectCtx)},t.prototype._intToHex=function(e){return("000000"+e.toString(16)).slice(-6)},t.prototype._getPixel=function(e,t,n,i){var r,o;return r=n.drawingCoordsToClientCoords(e,t),(o=i.getImageData(r.x,r.y,1,1).data)[3]?c()(this._rgbToHex(o[0],o[1],o[2]),16):null},t.prototype._componentToHex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype._rgbToHex=function(e,t,n){return""+this._componentToHex(e)+this._componentToHex(t)+this._componentToHex(n)},t}()},{"../core/shapes":13,"./base":29}],28:[function(e,t,n){var i,r,o,a={}.hasOwnProperty;i=e("./base").Tool,r=e("../core/shapes").createShape,o=function(e,t){return!(e.x<t.x)&&(!(e.y<t.y)&&(!(e.x>t.x+t.width)&&!(e.y>t.y+t.height)))},t.exports=function(e){function t(){this.text="",this.font="bold 18px sans-serif",this.currentShape=null,this.currentShapeState=null,this.initialShapeBoundingRect=null,this.dragAction=null,this.didDrag=!1}return function(e,t){for(var n in t)a.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.name="Text",t.prototype.iconName="text",t.prototype.didBecomeActive=function(e){var t,n,i;return t=[],this.unsubscribe=function(){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(e());return r},i=this,function(){return i._ensureNotEditing(e),i._clearCurrentShape(e),e.repaintLayer("main")},n=function(t){return function(){return t._updateInputEl(e)}}(this),t.push(e.on("zoom",n)),t.push(e.on("imageSizeChange",n)),t.push(e.on("snapshotLoad",function(t){return function(){return t._clearCurrentShape(e),e.repaintLayer("main")}}(this))),t.push(e.on("primaryColorChange",function(t){return function(n){if(t.currentShape)return t.currentShape.color=n,t._updateInputEl(e),e.repaintLayer("main")}}(this))),t.push(e.on("setFont",function(t){return function(n){if(t.currentShape)return t.font=n,t.currentShape.setFont(n),t._setShapesInProgress(e),t._updateInputEl(e),e.repaintLayer("main")}}(this)))},t.prototype.willBecomeInactive=function(e){return this.currentShape&&(this._ensureNotEditing(e),this.commit(e)),this.unsubscribe()},t.prototype.setText=function(e){return this.text=e},t.prototype._ensureNotEditing=function(e){if("editing"===this.currentShapeState)return this._exitEditingState(e)},t.prototype._clearCurrentShape=function(e){return this.currentShape=null,this.initialShapeBoundingRect=null,this.currentShapeState=null,e.setShapesInProgress([])},t.prototype.commit=function(e){return this.currentShape.text&&e.saveShape(this.currentShape),this._clearCurrentShape(e),e.repaintLayer("main")},t.prototype._getSelectionShape=function(e,t){return null==t&&(t=null),r("SelectionBox",{shape:this.currentShape,ctx:e,backgroundColor:t})},t.prototype._setShapesInProgress=function(e){switch(this.currentShapeState){case"selected":return e.setShapesInProgress([this._getSelectionShape(e.ctx),this.currentShape]);case"editing":return e.setShapesInProgress([this._getSelectionShape(e.ctx,"#fff")]);default:return e.setShapesInProgress([this.currentShape])}},t.prototype.begin=function(e,t,n){var i,a,s;if(this.dragAction="none",this.didDrag=!1,"selected"===this.currentShapeState||"editing"===this.currentShapeState?(i=this.currentShape.getBoundingRect(n.ctx),(s=this._getSelectionShape(n.ctx)).getBoundingRect(),o(a={x:e,y:t},i)&&(this.dragAction="move"),o(a,s.getBottomRightHandleRect())&&(this.dragAction="resizeBottomRight"),o(a,s.getTopLeftHandleRect())&&(this.dragAction="resizeTopLeft"),o(a,s.getBottomLeftHandleRect())&&(this.dragAction="resizeBottomLeft"),o(a,s.getTopRightHandleRect())&&(this.dragAction="resizeTopRight"),"none"===this.dragAction&&"editing"===this.currentShapeState&&(this.dragAction="stop-editing",this._exitEditingState(n))):(this.color=n.getColor("primary"),this.currentShape=r("Text",{x:e,y:t,text:this.text,color:this.color,font:this.font,v:1}),this.dragAction="place",this.currentShapeState="selected"),"none"!==this.dragAction)return this.initialShapeBoundingRect=this.currentShape.getBoundingRect(n.ctx),this.dragOffset={x:e-this.initialShapeBoundingRect.x,y:t-this.initialShapeBoundingRect.y},this._setShapesInProgress(n),n.repaintLayer("main");this.commit(n)},t.prototype.continue=function(e,t,n){var i,r,o;if("none"!==this.dragAction){switch(o=(i=this.initialShapeBoundingRect).x+i.width,r=i.y+i.height,this.dragAction){case"place":this.currentShape.x=e,this.currentShape.y=t,this.didDrag=!0;break;case"move":this.currentShape.x=e-this.dragOffset.x,this.currentShape.y=t-this.dragOffset.y,this.didDrag=!0;break;case"resizeBottomRight":this.currentShape.setSize(e-(this.dragOffset.x-this.initialShapeBoundingRect.width)-i.x,t-(this.dragOffset.y-this.initialShapeBoundingRect.height)-i.y);break;case"resizeTopLeft":this.currentShape.setSize(o-e+this.dragOffset.x,r-t+this.dragOffset.y),this.currentShape.setPosition(e-this.dragOffset.x,t-this.dragOffset.y);break;case"resizeBottomLeft":this.currentShape.setSize(o-e+this.dragOffset.x,t-(this.dragOffset.y-this.initialShapeBoundingRect.height)-i.y),this.currentShape.setPosition(e-this.dragOffset.x,this.currentShape.y);break;case"resizeTopRight":this.currentShape.setSize(e-(this.dragOffset.x-this.initialShapeBoundingRect.width)-i.x,r-t+this.dragOffset.y),this.currentShape.setPosition(this.currentShape.x,t-this.dragOffset.y)}return this._setShapesInProgress(n),n.repaintLayer("main"),this._updateInputEl(n)}},t.prototype.end=function(e,t,n){if(this.currentShape)return this.currentShape.setSize(this.currentShape.forcedWidth,0),"selected"===this.currentShapeState&&("place"===this.dragAction||"move"===this.dragAction&&!this.didDrag)&&this._enterEditingState(n),this._setShapesInProgress(n),n.repaintLayer("main"),this._updateInputEl(n)},t.prototype._enterEditingState=function(e){var t,n;if(this.currentShapeState="editing",this.inputEl)throw"State error";return this.inputEl=document.createElement("textarea"),this.inputEl.className="text-tool-input",this.inputEl.style.position="absolute",this.inputEl.style.transformOrigin="0px 0px",this.inputEl.style.backgroundColor="transparent",this.inputEl.style.border="none",this.inputEl.style.outline="none",this.inputEl.style.margin="0",this.inputEl.style.padding="4px",this.inputEl.style.zIndex="1000",this.inputEl.style.overflow="hidden",this.inputEl.style.resize="none",this.inputEl.value=this.currentShape.text,this.inputEl.addEventListener("mousedown",function(e){return e.stopPropagation()}),this.inputEl.addEventListener("touchstart",function(e){return e.stopPropagation()}),n=this,t=function(t){return n.currentShape.setText(t.target.value),n.currentShape.enforceMaxBoundingRect(e),n._setShapesInProgress(e),e.repaintLayer("main"),n._updateInputEl(e),t.stopPropagation()},this.inputEl.addEventListener("keydown",function(t){return function(){return t._updateInputEl(e,!0)}}(this)),this.inputEl.addEventListener("keyup",t),this.inputEl.addEventListener("change",t),this._updateInputEl(e),e.containerEl.appendChild(this.inputEl),this.inputEl.focus(),this._setShapesInProgress(e)},t.prototype._exitEditingState=function(e){return this.currentShapeState="selected",e.containerEl.removeChild(this.inputEl),this.inputEl=null,this._setShapesInProgress(e),e.repaintLayer("main")},t.prototype._updateInputEl=function(e,t){var n,i;if(null==t&&(t=!1),this.inputEl)return n=this.currentShape.getBoundingRect(e.ctx,!0),this.inputEl.style.font=this.currentShape.font,this.inputEl.style.color=this.currentShape.color,this.inputEl.style.left=e.position.x/e.backingScale+n.x*e.scale-4+"px",this.inputEl.style.top=e.position.y/e.backingScale+n.y*e.scale-4+"px",t&&!this.currentShape.forcedWidth?this.inputEl.style.width=n.width+10+this.currentShape.renderer.emDashWidth+"px":this.inputEl.style.width=n.width+12+"px",this.inputEl.style.height=t?n.height+10+this.currentShape.renderer.metrics.leading+"px":n.height+10+"px",i="scale("+e.scale+")",this.inputEl.style.transform=i,this.inputEl.style.webkitTransform=i,this.inputEl.style.MozTransform=i,this.inputEl.style.msTransform=i,this.inputEl.style.OTransform=i},t.prototype.optionsStyle="font",t}()},{"../core/shapes":13,"./base":29}],29:[function(e,t,n){var i,r,o={}.hasOwnProperty;(r={}).Tool=i=function(){function e(){}return e.prototype.name=null,e.prototype.iconName=null,e.prototype.usesSimpleAPI=!0,e.prototype.begin=function(e,t,n){},e.prototype.continue=function(e,t,n){},e.prototype.end=function(e,t,n){},e.prototype.optionsStyle=null,e.prototype.didBecomeActive=function(e){},e.prototype.willBecomeInactive=function(e){},e}(),r.ToolWithStroke=function(e){function t(e){this.strokeWidth=e.opts.defaultStrokeWidth}return function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,i),t.prototype.optionsStyle="stroke-width",t.prototype.didBecomeActive=function(e){var t,n;return t=[],this.unsubscribe=function(){var e,n,i,r;for(r=[],n=0,i=t.length;n<i;n++)e=t[n],r.push(e());return r},t.push(e.on("setStrokeWidth",(n=this,function(t){return n.strokeWidth=t,e.trigger("toolDidUpdateOptions")})))},t.prototype.willBecomeInactive=function(e){return this.unsubscribe()},t}(),t.exports=r},{}]},{},[18])(18)})}.call(this,n(188)(e),n(28))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){n(190),e.exports=n(8).Date.now},function(e,t,n){var i=n(10);i(i.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){var i=n(2);e.exports=function(e,t){if(null==e)return{};var n,r,o={},a=i(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){e.exports=n(196)},function(e,t,n){n(197),e.exports=n(8).Object.getPrototypeOf},function(e,t,n){var i=n(30),r=n(85);n(72)("getPrototypeOf",function(){return function(e){return r(i(e))}})},function(e,t,n){n(199),e.exports=n(8).Object.setPrototypeOf},function(e,t,n){var i=n(10);i(i.S,"Object",{setPrototypeOf:n(200).set})},function(e,t,n){var i=n(20),r=n(22),o=function(e,t){if(r(e),!i(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,i){try{(i=n(23)(Function.call,n(69).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:i(e,n),e}}({},!1):void 0),check:o}},function(e,t,n){e.exports=n(202)},function(e,t,n){n(203);var i=n(8).Object;e.exports=function(e,t){return i.create(e,t)}},function(e,t,n){var i=n(10);i(i.S,"Object",{create:n(47)})},function(e,t,n){var i=n(101);function r(t,n){return e.exports=r=i||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var i=n(35),r=n.n(i),o=n(0),a=n.n(o),s=n(11),l=n.n(s),c=n(3),d=n.n(c),u=n(4),h=n.n(u),p=n(2),f=n.n(p),m=n(5),g=n.n(m),v=n(6),y=n.n(v),b=n(1),w=n.n(b),_=n(24),S=n.n(_),k=function(e){return"object"===a()(e)&&"[object object]"===Object.prototype.toString.call(e).toLowerCase()&&!e.length};if(!(Object&&Object.shallowAssign&&Object&&Object.customAssign)){var P=function(e){try{return S.a.apply(S.a,arguments)}catch(o){for(var t=e,n=1;n<arguments.length;n++){var i=arguments[n];if(i&&"object"===a()(i))for(var r in i)t[r]=i[r]}return e}};Object&&Object.shallowAssign||(Object.shallowAssign=P),Object&&Object.customAssign||(Object.customAssign=P)}Object&&Object.deepAssign||(Object.deepAssign=function(e){for(var t=e,n=1;n<arguments.length;n++){var i=arguments[n];if(i&&"object"===a()(i))for(var r in i)void 0===t[r]?"object"===a()(i[r])&&(w()(i[r])||k(i[r]))?t[r]=Object.deepAssign(w()(i[r])?[]:{},i[r]):t[r]=i[r]:"object"===a()(i[r])&&(w()(i[r])||k(i[r]))?t[r]=Object.deepAssign(w()(i[r])?[]:{},"object"===a()(t[r])?t[r]:w()(i[r])?[]:{},i[r]):t[r]=i[r]}return e});var C=!1;try{var T=r()({},"passive",{get:function(){C={passive:!0}}});window.addEventListener("test",null,T)}catch(e){console.error("[whiteboarrd-sdk]passiveEvents err:",e)}var A=new(function(){function e(){g()(this,e)}return y()(e,[{key:"addEvent",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];try{e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}catch(n){L.Logger.error(Global.logType,"add dom event fail , event type is "+t+" , element:",e)}}},{key:"removeEvent",value:function(e,t,n,i){try{e.addEventListener?e.removeEventListener(t,n,i):e.attachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}catch(n){L.Logger.error(Global.logType,"remove dom event fail , event type is "+t+" , element:",e)}}},{key:"isEmptyJson",value:function(e){return 0===f()(e).length}},{key:"isFullScreenStatus",value:function(){return document.fullscreen||document.mozFullScreen||document.webkitIsFullScreen||document.webkitFullScreen||document.msFullScreen||!1}},{key:"launchFullscreen",value:function(e){e&&(e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}},{key:"exitFullscreen",value:function(){document.exitFullScreen?document.exitFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():element.msExitFullscreen&&element.msExitFullscreen()}},{key:"getFullscreenElement",value:function(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement}},{key:"addFullscreenchange",value:function(e){this.addEvent(document,"fullscreenchange",e,!1),this.addEvent(document,"webkitfullscreenchange",e,!1),this.addEvent(document,"mozfullscreenchange",e,!1),this.addEvent(document,"MSFullscreenChange",e,!1),this.addEvent(document,"msfullscreenchange",e,!1),this.addEvent(document,"fullscreeneventchange",e,!1)}},{key:"removeFullscreenchange",value:function(e){this.removeEvent(document,"fullscreenchange",e,!1),this.removeEvent(document,"webkitfullscreenchange",e,!1),this.removeEvent(document,"mozfullscreenchange",e,!1),this.removeEvent(document,"MSFullscreenChange",e,!1),this.removeEvent(document,"msfullscreenchange",e,!1),this.removeEvent(document,"fullscreeneventchange",e,!1)}},{key:"shallowCompareJson",value:function(e,t){return e===t}},{key:"deepCompareJson",value:function(e,t){if("object"!==a()(e)||w()(e)||"object"!==a()(e)||w()(e))return L.Logger.warning(Global.logType,"deepCompareJson arguments must is json!"),e===t;for(var n=Object.deepAssign({},t),i=!0,r=0,o=h()(e);r<o.length;r++){var s=d()(o[r],2),l=s[0],c=s[1];if(!n.hasOwnProperty(l)){i=!1;break}if(c!==n[l]){i=!1,delete n[l];break}delete n[l]}return i&&!f()(n).length}},{key:"isFunction",value:function(e){return"function"==typeof e}},{key:"isJson",value:function(e){return"object"===a()(e)&&"[object object]"===Object.prototype.toString.call(e).toLowerCase()&&!e.length}},{key:"setLocalStorageItem",value:function(e,t){try{window.localStorage?window.localStorage.setItem?window.localStorage.setItem(e,t):L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage.setItem , key is "+e+" , value is "+t+"!"):this.isPrintNotSupportLocalStorage||(this.isPrintNotSupportLocalStorage=!0,L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage!"))}catch(e){this.isPrintNotSupportLocalStorage||(this.isPrintNotSupportLocalStorage=!0,L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage , error info:",e))}}},{key:"getLocalStorageItem",value:function(e){try{return window.localStorage?window.localStorage.getItem?window.localStorage.getItem(e):(L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage.getItem , key is "+e+" !"),""):(this.isPrintNotSupportLocalStorage||(this.isPrintNotSupportLocalStorage=!0,L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage!")),"")}catch(e){return this.isPrintNotSupportLocalStorage||(this.isPrintNotSupportLocalStorage=!0,L.Logger.warning(Global.logType,"[whiteboard-sdk]Browser does not support localStorage , error info:",e)),""}}},{key:"toJsonStringify",value:function(e){if(!e)return e;try{if(!k(e))return e;var t=l()(e);t&&(e=t)}catch(e){}return e}},{key:"toJsonParse",value:function(e){if(!e)return e;try{if("string"!=typeof e)return e;var t=JSON.parse(e);t&&(e=t)}catch(e){}return e}},{key:"getPcSDKVersion",value:function(){return YS&&YS.getSdkVersion&&YS.getSdkVersion()?Number(YS.getSdkVersion().replace(/./g,"").replace(/v/g,"")):0}},{key:"getItem",value:function(e,t,n){var i,r,o,a,s;if(w()(e))return i=e.find(function(n,i){return r=i+1===e.length?-1:i,n.hostname===t}),n?r&&!isNaN(r)&&e[r+1]?e[r+1].hostname:"":i&&i.protocol&&i.hostname&&i.port?(o=i.protocol,a=i.hostname,s=i.port,o+"://"+a+":"+s):""}},{key:"onElementResize",value:function(e,t){try{if(!(e instanceof HTMLElement))throw new TypeError("Parameter 1 is not instance of 'HTMLElement'.");if(/^(area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr|script|style|textarea|title)$/i.test(e.tagName))throw new TypeError("Unsupported tag type. Change the tag or wrap it in a supported tag(e.g. div).");if("function"!=typeof t)throw new TypeError("Parameter 2 is not of type 'function'.");var n=e.offsetWidth||1,i=e.offsetHeight||1,r=1e4*n,o=1e4*i,a=document.createElement("div");a.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;z-index=-10000;overflow:hidden;visibility:hidden;";var s=a.cloneNode(!1),l=document.createElement("div");l.style.cssText="transition:0s;animation:none;";var c=l.cloneNode(!1);l.style.width=r+"px",l.style.height=o+"px",c.style.width="250%",c.style.height="250%",a.appendChild(l),s.appendChild(c),e.appendChild(a),e.appendChild(s),a.offsetParent!==e&&(e.style.position="relative"),a.scrollTop=s.scrollTop=o,a.scrollLeft=s.scrollLeft=r;var d=0,u=0,h=function(){d===n&&u===i||(n=d,i=u,t())},p=function(){d=e.offsetWidth||1,u=e.offsetHeight||1,d===n&&u===i||requestAnimationFrame(h),a.scrollTop=s.scrollTop=o,a.scrollLeft=s.scrollLeft=r};a.addEventListener("scroll",p,C),s.addEventListener("scroll",p,C)}catch(e){L.Logger.error(Global.logType,"[whiteboarrd-sdk]onElementResize err:",e)}}}]),e}()),I=window.Log||{error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.error.apply(console,e)},log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.log.apply(console,e)},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.info.apply(console,e)},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.warn.apply(console,e)},warning:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.warn.apply(console,e)},trace:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.trace.apply(console,e)},debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(void 0!==L.Logger.panel){for(var n="",i=0;i<e.length;i++)n+="object"===a()(e[i])?A.toJsonStringify(e[i]):e[i];L.Logger.panel.value=L.Logger.panel.value+"\n"+n}console.debug.apply(console,e)}};window.Log=I;var E=n(21),x=n.n(E),R=n(16),D=n.n(R),M=n(7),W=n.n(M),N=n(31),O=n.n(N),F={newpptVersions:2017091401,remoteNewpptUpdateTime:2018032113,isSkipPageing:!1,isPlayVideoing:!1};F.allDocumentRemarkInfoMap=new O.a,F.docAddress=/http:/.test(window.location.protocol)?"http://api.roadofcloud.com:80":"https://api.roadofcloud.com:443",F.laterAddressList=[],F.backupDocAddressList=[],F.docAddressList=[],F.hasGetDocAddressIndexByLocalStorage=!1,F.docAddressKey="",F.localStorageDocAddressKey="",F.nowUseDocAddress=A.getItem(F.docAddressList,F.docAddressKey),F.showPageFromId=void 0,F.preloadFile=null,F.extendShowPageFromId=void 0,F.protocol="",F.port="",F.logType={fileName:"whiteBoardSDK"},window.WBGlobal=F;var B=F;window.WhiteboardGlobalShare=window.WhiteboardGlobalShare||{};var j={WHITEBOARD_SDK_VERSION:"v2.1.0",WHITEBOARD_SDK_TIME:"2018102313",dynamicPptVersions:2017091401,remoteDynamicPptUpdateTime:2018042223,dynamicPptDebugLog:!1};console.info("[whiteboard-sdk]whiteboard sdk version is "+j.WHITEBOARD_SDK_VERSION+" , update time is "+j.WHITEBOARD_SDK_TIME);var V=j,U={};U.commonWhiteboard={webAddress:/http:/.test(window.location.protocol)?"http://api.roadofcloud.com:80":"https://api.roadofcloud.com:443",docAddress:/http:/.test(window.location.protocol)?"http://api.roadofcloud.com:80":"https://api.roadofcloud.com:443",backupDocAddressList:[],myUserId:void 0,myRole:void 0,myName:void 0,isConnectedRoom:!1,isPlayback:!1,deviceType:void 0,clientType:void 0},U.defaultWhiteboard={sendH5DocumentRoomInfo:{},isBackEvent:!1,hasExtendDocument:!1,showpageNotice:!1,loadDynamicPptView:!0,loadH5DocumentView:!0,isMobile:!1,mediaShareToID:void 0,associatedMsgID:void 0,associatedUserID:void 0,clientMediaShare:!1,mediaSharePauseWhenOver:!1,isLoadAudioPlayer:!0,isLoadVideoPlayer:!0,isLoadDocumentRemark:!0,canRemark:!1,secondaryColor:"#ffffff",initWhiteboardProductionOptions:{},documentToolBarConfig:{parentNode:void 0,isDrag:!0,isLoadFullScreen:!0,isLoadRemark:!1,isLoadVolume:!1,initDragPosition:{left:50,top:98},fullScreenElementId:void 0},documentRemarkConfig:{parentNode:void 0,isDrag:!0,initDragPosition:{left:50,top:98}},whiteboardToolBarConfig:{parentNode:void 0,isDrag:!0,pencilWidthScale:1,eraserWidthScale:2,initDragPosition:{left:2,top:2},loadWhiteboardTools:{mouse:!0,laser:!0,pen:!0,text:!0,shape:!0,eraser:!0,clear:!0,undo:!0,redo:!0,setting:!0}},isShowReloadFileTip:!0,pptVolumeSynchronization:!1,insertPictureRule:"default",languageType:"ch",rootBackgroundColor:"transparent",primaryColor:"#000000",backgroundColor:"#ffffff",pencilWidth:5,shapeWidth:5,eraserWidth:15,fontSize:18,fontFamily:"微软雅黑",showShapeAuthor:!1,synchronization:!0,isOnlyUndoRedoClearMyselfShape:!1,canDraw:!0,canPage:!0,addPage:!0,actionClick:!0,defaultWhiteboardScale:16/9,isUseKeyboardPage:!0,isLoadDocumentToolBar:!0,isLoadWhiteboardToolBar:!0,isDisconnectedClearWhiteboardData:!1,isNativePlayAudio:!1,audioPlayerConfig:{parentNode:void 0,controlCallback:{play:void 0,pause:void 0},isLoadControl:!0,controlPermissions:{hasPlayOrPause:!0,hasChangeProgress:!0,hasClose:!0}},videoPlayerConfig:{parentNode:void 0,controlCallback:{play:void 0,pause:void 0},isLoadControl:!0,controlPermissions:{hasPlayOrPause:!0,hasChangeProgress:!0,hasClose:!0}},clickCapture:!1,isSyncMouseSwitch:!0,isGeneralDocumentAlwayCanvas:!1,isMeeting:!1,canWBPinch:!1};var z=U,q=n(36),H=n.n(q),G=n(9),Y=n.n(G),J=n(37),X=n.n(J),K=n(53),Q=n.n(K);Q.a.GlobalWorkerOptions.workerSrc="./literally/js/pdf.worker.js";var Z=null,$=null,ee={fileid:0,page:0,preloadDatas:{},totalPage:0,url:"",data:null,loadedPages:[],scale:1},te=null;function ne(e,t,n){if(e<0)return"The pdf page number must greater than 0!";if(e>ee.totalPage)return"The pdf page number must less than ".concat(ee.totalPage,"!");ee.page=e,clearTimeout(te),(document.getElementsByClassName("pdf-canvas")||[]).forEach(function(e){e.classList.contains("hide")||e.classList.add("hide")});var i=document.getElementById("pdf_page".concat(e)),r=ee.preloadDatas["page".concat(e)];if(i)return i.classList.remove("hide"),void t(r.viewport);r.pageEle?t(r.viewport):r=ee.preloadDatas["page".concat(e)]=H()({},r,{},ie(e));var o=r,a=o.pageEle,s=o.canvas;r.rendered||re(e,n||e,ee.data,{pageEle:a,canvas:s},t)}function ie(e){var t=document.createElement("div"),n=document.createElement("canvas");return t.appendChild(n),t.classList.add("pdf-canvas"),t.id="pdf_page".concat(e),n.id="pdf_canvas".concat(e),Z.appendChild(t),{pageEle:t,canvas:n}}function re(e,t,n,i){var r=i.pageEle,o=i.canvas,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return n.getPage(t).then(function(t){var n=t.getViewport({scale:1}),i=o.getContext("2d");"function"==typeof a&&(a(n),ee.preloadDatas["page".concat(e)].viewport=n,ee.preloadDatas["page".concat(e)].pdfPage=t);var s=t.getViewport({scale:r.offsetWidth/n.width*window.devicePixelRatio,rotation:0});return o.width=s.width,o.height=s.height,1===window.devicePixelRatio&&(o.style.width=Math.floor(s.width)+"px",o.style.height=Math.floor(s.height)+"px"),e!==ee.page&&r.classList.add("hide"),t.render({canvasContext:i,viewport:s}).then(function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return ee.preloadDatas&&ee.preloadDatas["page".concat(e)]?(ee.preloadDatas["page".concat(e)].rendered=!0,new X.a(function(e,t){e.apply(void 0,n)})):new X.a(function(e,t){e.apply(void 0,n)})})})}function oe(e){if(!ee.preloadDatas||!ee.preloadDatas["page".concat(e)])return new X.a(function(e,t){return t("The data is incomplete.")});var t=ee.preloadDatas["page".concat(e)],n=t.viewport,i=t.pageEle,r=t.canvas,o=t.pdfPage;if(!(n&&i&&r&&o))return new X.a(function(e,t){return t("The data is incomplete.")});var a=n.clone({scale:i.offsetWidth/n.width*window.devicePixelRatio}),s=document.createElement("canvas"),l=s.getContext("2d");return s.width=a.width,s.height=a.height,1===window.devicePixelRatio&&(s.style.width=Math.floor(a.width)+"px",s.style.height=Math.floor(a.height)+"px"),o.render({canvasContext:l,viewport:a}).then(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return i.removeChild(r),s.id="pdf_canvas".concat(e),i.appendChild(s),ee.preloadDatas["page".concat(e)].canvas=s,new X.a(function(e){return e.apply(void 0,n)})})}var ae={preloadPDF:function(e){var t=e.fileid,n=e.url,i=e.page,r=void 0===i?1:i;e.onload,t!==ee.fileid&&(ee={fileid:t,page:r,preloadDatas:{},totalPage:0,url:n,data:null,loadedPages:[]}),Q.a.getDocument(n).then(function(e){var t=ie(r),n=t.pageEle,i=t.canvas;ee.preloadDatas["page".concat(r)]={pdf:e,pageEle:n,canvas:i},re(r,1,e,{pageEle:n,canvas:i})})},loadPDF:function(e,t){var n=t.fileid,i=t.url,r=t.page,o=void 0===r?1:r,a=t.onload,s=void 0===a?function(){}:a;Z=e,n!==ee.fileid&&(ee={fileid:n,page:o,preloadDatas:{},totalPage:0,url:i,data:null,loadedPages:[]}),ee=H()({},ee,{fileid:n,url:i,page:o});var l=function(){$=!0;var e=ee.preloadDatas["page".concat(o)],t=e.pageEle,n=e.canvas;n.offsetWidth!==t.offsetWidth&&(n.style.width=t.offsetWidth+"px",n.style.height=t.offsetHeight+"px",oe(o)),s.apply(void 0,arguments);var i=setTimeout(function(){$=!1,clearTimeout(i)},300)};ee.preloadDatas["page".concat(o)]?(ee.data=ee.preloadDatas["page".concat(o)].pdf,ne(o,l,1)):Q.a.getDocument(i).then(function(e){ee.totalPage=e.numPage,ee.data=e,ee.preloadDatas["page".concat(o)]||(ee.preloadDatas["page".concat(o)]={pdf:e}),ne(o,l,1)})},changePage:ne,clear:function(e){e!==ee.fileid&&(Z instanceof HTMLElement&&(Z.innerHTML=""),ee={fileid:0,page:0,preloadDatas:{},totalPage:0,url:"",data:null,loadedPages:[]})},setScale:function(e){var t=ee,n=t.page;if(t.data&&(e&&(te&&clearTimeout(te),te=null,oe(n).then().catch(function(e){})),1===window.devicePixelRatio&&!$&&ee.preloadDatas&&ee.preloadDatas["page".concat(n)])){var i=ee.preloadDatas["page".concat(n)].canvas;i.style.width="100%",i.style.height="100%",te&&clearTimeout(te),te=setTimeout(function(){te=null,oe(n).then().catch(function(e){})},300)}}},se=n(102),le=n.n(se);n(187),navigator.userAgent.match(/AppleWebKit.*Mobile.*/);if(window.L&&window.L.Logger&&window.L.Logger.debug&&window.L.Logger.trace&&window.L.Logger.info&&window.L.Logger.warning&&window.L.Logger.error||(window.L=window.L||{},window.L.Logger=window.L.Logger||{},window.L.Logger.debug=window.L.Logger.debug||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.debug.apply(console,e)},window.L.Logger.trace=window.L.Logger.trace||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.trace.apply(console,e)},window.L.Logger.info=window.L.Logger.info||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.info.apply(console,e)},window.L.Logger.warning=window.L.Logger.warning||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.warn.apply(console,e)},window.L.Logger.error=window.L.Logger.error||function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.error.apply(console,e)}),!(Object&&Object.shallowAssign&&Object&&Object.customAssign)){var ce=function(e){try{return S.a.apply(S.a,arguments)}catch(s){var t=void 0;try{t=w()(e)?e.slice(0):JSON.parse(l()(e))}catch(n){t=e}for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i&&"object"===a()(i))for(var r in i)t[r]=i[r]}if("object"===a()(t))for(var o in t)e[o]=t[o];return e}};Object&&Object.shallowAssign||(Object.shallowAssign=ce),Object&&Object.customAssign||(Object.customAssign=ce)}Object&&Object.deepAssign||(Object.deepAssign=function(e){var t=void 0;if("object"!==a()(e)||w()(e))t="object"===a()(e)&&w()(e)?e.slice(0):e;else try{t=JSON.parse(l()(e))}catch(n){t=e}for(var n=1;n<arguments.length;n++){var i=arguments[n];if(i&&"object"===a()(i))for(var r in i)void 0===t[r]?"object"===a()(i[r])?w()(i[r])?t[r]=i[r].slice(0):t[r]=JSON.parse(l()(i[r])):t[r]=i[r]:"object"===a()(i[r])?t[r]=Object.deepAssign(w()(i[r])?[]:{},"object"===a()(t[r])?t[r]:w()(i[r])?[]:{},i[r]):t[r]=i[r]}if("object"===a()(t))for(var o in t)e[o]=t[o];return e}),String.prototype.colorHex=function(){if(/^(rgb|RGB)/.test(this)){for(var e=this.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),t="#",n=0;n<e.length;n++){var i=Number(e[n]).toString(16);"0"===i&&(i+=i),t+=i}return 7!==t.length&&(t=this),t}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(this))return this;var r=this.replace(/#/,"").split("");if(6===r.length)return this;if(3===r.length){for(var o="#",a=0;a<r.length;a+=1)o+=r[a]+r[a];return o}},String.prototype.colorRgb=function(){var e=this.toLowerCase();if(e&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){for(var t="#",n=1;n<4;n+=1)t+=e.slice(n,n+1).concat(e.slice(n,n+1));e=t}for(var i=[],r=1;r<7;r+=2)i.push(Y()("0x"+e.slice(r,r+2)));return"RGB("+i.join(",")+")"}return e};var de=function(e,t,n,i){i=null!=i&&null!=i&&i,e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},ue=function(e,t,n,i){e.addEventListener?e.removeEventListener(t,n,i):e.attachEvent?e.detachEvent("on"+t,n):e["on"+t]=null},he=new(function(){function e(){g()(this,e),this.whiteboardToolsInfo={primaryColor:"#000000",secondaryColor:"#ffffff",backgroundColor:"#ffffff",pencilWidth:5,shapeWidth:5,eraserWidth:15,fontSize:18,fontFamily:"微软雅黑",fontStyle:"normal",fontWeight:"normal"},this.defaultProductionOptions={whiteboardClear:!0,defaultWhiteboardScale:16/9,whiteboardMagnification:1,pdfWBMagnification:1.5,containerWidthAndHeight:{width:0,height:0},minHeight:void 0,rotateDeg:0,baseWhiteboardWidth:960,proprietaryTools:!1,deawPermission:!0,tempDeawPermission:!0,saveRedoStack:!0,saveUndoStack:!0,remindContentTime:3e3,showShapeAuthor:!1,showMyselfRemindContent:!1,isOnlyUndoRedoClearMyselfShape:!1,synchronizationWhiteboard:!0,clickCapture:!1},this.whiteboardInstanceIDPrefix="whiteboard_",this.whiteboardInstanceDefaultID="whiteboard_default",this.whiteboardInstanceStore={},this.whiteboardThumbnailStore={},this.uniqueWhiteboard=!1,this.minMagnification=1,this.maxMagnification=3,this.historyPenTool=void 0,this.historyShapeTool=void 0,this.useWhiteboardTool={tool_pencil:!1,tool_highlighter:!1,tool_line:!1,tool_arrow:!1,tool_dashed:!1,tool_eraser:!1,tool_text:!1,tool_rectangle:!1,tool_rectangle_empty:!1,tool_ellipse:!1,tool_ellipse_empty:!1,tool_polygon:!1,tool_eyedropper:!1,tool_selectShape:!1,tool_mouse:!1,tool_laser:!1,action_undo:!1,action_redo:!1,action_clear:!1,zoom_big:!1,zoom_small:!1,zoom_default:!1},this.specialWhiteboardInstanceIDPrefix="specialWhiteboardInstanceIDPrefix_",this.awaitSaveToWhiteboardInstanceSignallingArray=[],this.commonActiveTool="tool_pencil",this.basicTemplateWhiteboardSignallingList={},this.pdfViewport=null,this.scale=0,this.isStopPropagation=!1}return y()(e,[{key:"setViewport",value:function(e){this.pdfViewport=e}},{key:"getSpecialWhiteboardInstanceIDPrefix",value:function(){return this.specialWhiteboardInstanceIDPrefix}},{key:"setUniqueWhiteboard",value:function(e){this.uniqueWhiteboard=e}},{key:"activeCommonWhiteboardTool",value:function(e){/^tool_/.test(e)&&(this.commonActiveTool=e);for(var t=0,n=x()(this.whiteboardInstanceStore);t<n.length;t++){var i=n[t];if(!i.proprietaryTools){var r=i.id;this.activeWhiteboardTool(e,r)}}}},{key:"updateCommonWhiteboardToolsInfo",value:function(e){e&&"object"===a()(e)&&Object.deepAssign(this.whiteboardToolsInfo,e)}},{key:"getWhiteboardDefaultFiledata",value:function(e){var t={fileid:0,currpage:1,pagenum:1,filetype:"whiteboard",filename:"whiteboard",swfpath:"",pptslide:1,pptstep:0,steptotal:0};return e&&"object"===a()(e)&&Object.deepAssign(t,e),t}},{key:"handlerPubmsg_SharpsChange",value:function(e){if(e){e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),this._saveBasicTemplateWhiteboardSignallingData(e,"pubmsg");var t=e.data.whiteboardID,n=this._getWhiteboardInstanceById(t);if(!n)return e.source="pubmsg",void this.awaitSaveToWhiteboardInstanceSignallingArray.push(e);if(e&&null!=e.data&&("shapeSaveEvent"===e.data.eventType||"clearEvent"===e.data.eventType||"redoEvent"===e.data.eventType||"laserMarkEvent"===e.data.eventType))if(e.source="pubmsg","laserMarkEvent"===e.data.eventType)this._receiveSnapshot(e,n);else{var i=e.id.substring(e.id.lastIndexOf("###_")+4);if(i){var r=i.split("_");i="".concat(r[0],"_").concat(r[1],"_").concat(r[2]);var o=r[1],a=r[2],s=this.getWhiteboardFiledata(t);s.fileid==o&&s.currpage==a&&(this._receiveSnapshot(e,n),e.remindContent=e.data&&e.data.nickname||e.remindContent,n.showShapeAuthor&&e.remindContent&&e.fromID!=n.myselfId&&this._handlerShowRemoteRemindContentFromPubmsgData(n,e)),null===n.waitingProcessShapeData[i]||void 0===n.waitingProcessShapeData[i]?(n.waitingProcessShapeData[i]=[],n.waitingProcessShapeData[i].push(e)):n.waitingProcessShapeData[i].push(e)}}}}},{key:"handlerDelmsg_SharpsChange",value:function(e){if(e){e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),this._saveBasicTemplateWhiteboardSignallingData(e,"delmsg");var t=e.data.whiteboardID,n=this._getWhiteboardInstanceById(t);if(!n){e.source="delmsg";for(var i=this.awaitSaveToWhiteboardInstanceSignallingArray.length-1;i>=0;i--){if(this.awaitSaveToWhiteboardInstanceSignallingArray[i].id===e.id){this.awaitSaveToWhiteboardInstanceSignallingArray.splice(i,1);break}}return}var r=e.id.substring(e.id.lastIndexOf("###_")+4);if(r){var o=r.split("_");r="".concat(o[0],"_").concat(o[1],"_").concat(o[2]);var a=o[1],s=o[2],l=this.getWhiteboardFiledata(t);if(e.source="delmsg",l.fileid==a&&l.currpage==s&&this._receiveSnapshot(e,n),n.waitingProcessShapeData[r]&&w()(n.waitingProcessShapeData[r])&&n.waitingProcessShapeData[r].length>0)for(var c=n.waitingProcessShapeData[r].length-1;c>=0;c--){if(n.waitingProcessShapeData[r][c].id===e.id){n.waitingProcessShapeData[r].splice(c,1);break}}}}}},{key:"handlerMsglist_SharpsChange",value:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n];i.data&&"string"==typeof i.data&&(i.data=JSON.parse(i.data)),this._saveBasicTemplateWhiteboardSignallingData(i,"msglist");var r=i.data.whiteboardID,o=this._getWhiteboardInstanceById(r);if(o){if(null!=i.data&&("shapeSaveEvent"===i.data.eventType||"clearEvent"===i.data.eventType||"redoEvent"===i.data.eventType)){i.source="msglist";var a=i.id.substring(i.id.lastIndexOf("###_")+4);if(a){var s=a.split("_");a="".concat(s[0],"_").concat(s[1],"_").concat(s[2]);var l=s[1],c=s[2],d=this.getWhiteboardFiledata(r);d.fileid==l&&d.currpage==c&&(t[o.id]=!0),null===o.waitingProcessShapeData[a]||void 0===o.waitingProcessShapeData[a]?(o.waitingProcessShapeData[a]=[],o.waitingProcessShapeData[a].push(i)):o.waitingProcessShapeData[a].push(i)}}}else i.source="msglist",this.awaitSaveToWhiteboardInstanceSignallingArray.push(i)}if(t&&f()(t).length)for(var u=0,h=f()(t);u<h.length;u++){var p=h[u];this.saveWhiteboardStackToStorage(p),this.updateWhiteboardFiledata(p,{}),this.loadCurrpageWhiteboard(p)}}},{key:"preloadWhiteboardImg",value:function(e,t,n,i,r){if(e)if(t)this.loadPdf({url:e,page:i,fileid:n,preload:!0});else{var o=new Image;o.onload=function(){r&&"function"==typeof r&&r()},o.onerror=function(t){L.Logger.error(B.logType,"preload img  fail , img url is "+e)},o.src=e}else L.Logger.warning(B.logType,"preload img url is not esixt!")}},{key:"productionWhiteboard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.whiteboardElementId,n=e.thumbnailId,i=e.productionOptions,r=void 0===i?{}:i,o=e.handler,a=void 0===o?{}:o,s=e.id;if(t){var l=this._getWhiteboardInstanceID(s),c=this._getWhiteboardInstanceByID(l);if(c)return L.Logger.error(B.logType,"The production whiteboard(whiteboardInstanceID:"+l+") fails, the whiteboard already exists!"),c;c={};var d=document.getElementById(t);if(!d)return L.Logger.error(B.logType,"Whiteboard elements do not exist , element id is:"+t+"!"),c;var u=document.createElement("div"),h=t+"_whiteboardInstance";return u.className="whiteboard-instance-element",u.id=h,d.appendChild(u),r=Object.deepAssign({},this.defaultProductionOptions,r),this.whiteboardInstanceStore[l]=c,c.filedata=r.filedata||this.getWhiteboardDefaultFiledata({fileid:"whiteboard_default"===l?0:s}),c.baseWhiteboardWidth=r.baseWhiteboardWidth,c.whiteboardInstanceID=l,c.parcelAncestorElementId=r.parcelAncestorElementId,c.isBaseboard=r.isBaseboard,c.needLooadBaseboard=r.needLooadBaseboard,c.dependenceBaseboardWhiteboardID=r.dependenceBaseboardWhiteboardID,c.defaultWhiteboardScale=r.defaultWhiteboardScale,c.watermarkImageScale=r.defaultWhiteboardScale,c.whiteboardMagnification=r.whiteboardMagnification,c.remindContentTime=r.remindContentTime,c.showShapeAuthor=r.showShapeAuthor,c.showMyselfRemindContent=r.showMyselfRemindContent,c.associatedMsgID=r.associatedMsgID,c.associatedUserID=r.associatedUserID,c.proprietaryTools=r.proprietaryTools,c.minHeight=r.minHeight,c.rotateDeg=r.rotateDeg,c.deawPermission=r.deawPermission,c.tempDeawPermission=r.tempDeawPermission,c.nickname=r.nickname,c.userid=r.userid,c.insertPictureRule=r.insertPictureRule||"default",c.synchronizationWhiteboard=r.synchronizationWhiteboard,c.clickCapture=!!r.clickCapture,c.canWBPinch=r.canWBPinch,c.whiteboardToolsInfo=Object.deepAssign({},this.whiteboardToolsInfo),r.primaryColor&&(c.whiteboardToolsInfo.primaryColor=r.primaryColor),r.secondaryColor&&(c.whiteboardToolsInfo.secondaryColor=r.secondaryColor),r.backgroundColor&&(c.whiteboardToolsInfo.backgroundColor=r.backgroundColor),r.pencilWidth&&(c.whiteboardToolsInfo.pencilWidth=r.pencilWidth),r.shapeWidth&&(c.whiteboardToolsInfo.shapeWidth=r.shapeWidth),r.eraserWidth&&(c.whiteboardToolsInfo.eraserWidth=r.eraserWidth),r.fontSize&&(c.whiteboardToolsInfo.fontSize=r.fontSize),r.fontFamily&&(c.whiteboardToolsInfo.fontFamily=r.fontFamily),r.fontStyle&&(c.whiteboardToolsInfo.fontStyle=r.fontStyle),r.fontWeight&&(c.whiteboardToolsInfo.fontWeight=r.fontWeight),c.saveRedoStack=r.saveRedoStack,c.saveUndoStack=r.saveUndoStack,c.imageThumbnailId=r.imageThumbnailId,c.imageThumbnailTipContent=r.imageThumbnailTipContent,c.registerWhiteboardToolsList={},c.stackStorage={},c.handler={},c.handler.sendSignallingToServer=a.sendSignallingToServer,c.handler.delSignallingToServer=a.delSignallingToServer,c.handler.resizeWhiteboardSizeCallback=a.resizeWhiteboardSizeCallback,c.handler.noticeUpdateToolDescCallback=a.noticeUpdateToolDescCallback,c.handler.noticeUpdateWhiteboardFiledataCallback=a.noticeUpdateWhiteboardFiledataCallback,c.handler.whiteboardWatermarkImageOnloadCallback=a.whiteboardWatermarkImageOnloadCallback,c.handler.whiteboardWatermarkImageOnFailureCallback=a.whiteboardWatermarkImageOnFailureCallback,c.handler.receiveActionCommandCallback=a.receiveActionCommandCallback,c.active=!0,c.containerWidthAndHeight=r.containerWidthAndHeight,c.useImgOriginalSizeToContainerWidthAndHeight=r.useImgOriginalSizeToContainerWidthAndHeight,c.myselfId=r.myselfId,c.isOnlyUndoRedoClearMyselfShape=r.isOnlyUndoRedoClearMyselfShape,c.historyPenTool=this.historyPenTool,c.historyShapeTool=this.historyShapeTool,c.useToolKey=r.useToolKey,c.waitingProcessShapeData={},c.whiteboardElementId=t,c.whiteboardElement=d,c.whiteboardInstanceElementId=h,c.whiteboardInstanceElement=u,c.id=s,c.thumbnailId=n,c.lc=window.LC.init(c.whiteboardInstanceElement),c.lc.backingScale=1,c.lc.setColor("primary",c.whiteboardToolsInfo.primaryColor),c.lc.setColor("secondary",c.whiteboardToolsInfo.secondaryColor),c.lc.setColor("background",c.whiteboardToolsInfo.backgroundColor),c.lc.setWatermarkImageToLcBackground(!1),c.lc.setZoom(1),c.lc.setPan(0,0),c.lc.on("shapeSave",this._handlerShapeSaveEvent.bind(this,c)),c.lc.on("sendUndo",this._handlerUndoEvent.bind(this,c)),c.lc.on("sendRedo",this._handlerRedoEvent.bind(this,c)),c.lc.on("sendClear",this._handlerClearEvent.bind(this,c)),c.lc.on("drawingChange",this._handlerDrawingChangeEvent.bind(this,c)),c.activeTool=void 0,c.lc.myselfId=c.myselfId,c.lc.isOnlyUndoRedoClearMyselfShape=c.isOnlyUndoRedoClearMyselfShape,r.whiteboardClear&&this.clearWhiteboardAllDataById(s),this._changeWhiteboardDeawPermission(c.deawPermission,c),this._changeWhiteboardTemporaryDeawPermission(c.tempDeawPermission,c),this._saveAwaitSaveToWhiteboardInstanceSignallingToWhiteboardInstance(c),this.activeWhiteboardTool(c.proprietaryTools?c.useToolKey?c.useToolKey:"tool_pencil":this.commonActiveTool,s),this._zoomIsDisable(c),this._actionIsDisable(c),this._noticeUpdateToolDesc(c),this._resizeWhiteboardHandler(c),this._noticeNpdateWhiteboardToolsInfo(c),this.handleWBPinch(c),c}L.Logger.error(B.logType,"whiteboardElementId is required!")}},{key:"handleWBPinch",value:function(e){var t=this,n=new le.a(e.whiteboardElement);n.set({touchAction:"pan-x pan-y"}),n.get("pinch").set({enable:!0}),n.on("pinchstart",function(){!e.canWBPinch||e.deawPermission&&e.lc.isTmpDrawAble||(t.scale=e.whiteboardMagnification||1)}),n.on("pinch",function(n){!e.canWBPinch||e.deawPermission&&e.lc.isTmpDrawAble||(e.whiteboardMagnification=Math.max(1,Math.min(t.scale*n.scale,3)),t._resizeWhiteboardHandler(e))}),n.on("pinchend",function(){!e.canWBPinch||e.deawPermission&&e.lc.isTmpDrawAble||(e.whiteboardMagnification>1?t.isStopPropagation=!0:t.isStopPropagation=!1)}),n.on("pan",function(n){!e.canWBPinch||e.deawPermission&&e.lc.isTmpDrawAble||(4===n.direction&&!t.isStopPropagation&&e.whiteboardMagnification>1&&(t.isDirectionRight=!0,t.isStopPropagation=!0),4!==n.direction&&(t.isDirectionRight=!1))}),e.whiteboardElement.addEventListener("touchmove",function(n){if(!(!e.canWBPinch||e.deawPermission&&e.lc.isTmpDrawAble)){var i=document.getElementById("defaultRoadofcloudTotalDocument");i.offsetWidth+i.scrollLeft+3>i.scrollWidth&&!t.isDirectionRight&&(t.isStopPropagation=!1),t.isStopPropagation&&n.stopPropagation()}})}},{key:"changeWhiteboardExclusiveAttribute",value:function(e,t){if(t&&"object"===a()(t)){var n=this._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error(B.logType,"[changeWhiteboardExclusiveAttribute]There are no white board Numbers that belong to id "+e);for(var i in t)n.hasOwnProperty(i)&&(n[i]=t[i],"myselfId"===i||"isOnlyUndoRedoClearMyselfShape"===i?n.lc&&(n.lc[i]=n[i]):"defaultWhiteboardScale"===i?n.currentWatermarkImageUrl||(n.watermarkImageScale=n.defaultWhiteboardScale,n.lc.watermarkImage=null,this._resizeWhiteboardHandler(n)):"insertPictureRule"===i&&this._resizeWhiteboardHandler(n))}}},{key:"updateImageThumbnailId",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?(n.imageThumbnailId=t,this._saveImageBase64ToImageThumbnail(n)):L.Logger.error(B.logType,"[updateImageThumbnailId]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardSaveRedoStackAndSaveUndoStack",value:function(e,t){var n=t.saveRedoStack,i=t.saveUndoStack,r=this._getWhiteboardInstanceById(e);r?(r.saveRedoStack=void 0!==n?n:r.saveRedoStack,r.saveUndoStack=void 0!==i?i:r.saveUndoStack):L.Logger.error(B.logType,"[updateSaveRedoStackAndSaveUndoStack]There are no white board Numbers that belong to id "+e)}},{key:"updateIsBaseboard",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?n.isBaseboard=t:L.Logger.error(B.logType,"[updateIsBaseboard]There are no white board Numbers that belong to id "+e)}},{key:"updateDependenceBaseboardWhiteboardID",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?n.dependenceBaseboardWhiteboardID=t:L.Logger.error(B.logType,"[updateDependenceBaseboardWhiteboardID]There are no white board Numbers that belong to id "+e)}},{key:"updateShowRemindContent",value:function(e,t,n){var i=this._getWhiteboardInstanceById(e);i?(i.showShapeAuthor=t||i.showShapeAuthor,i.showMyselfRemindContent=n||i.showMyselfRemindContent):L.Logger.error(B.logType,"[updateShowRemindContent]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardAssociatedMsgID",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?n.associatedMsgID=t:L.Logger.error(B.logType,"[updateWhiteboardAssociatedMsgID]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardAssociatedUserID",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?n.associatedUserID=t:L.Logger.error(B.logType,"[updateWhiteboardAssociatedUserID]There are no white board Numbers that belong to id "+e)}},{key:"hasWhiteboardById",value:function(e){var t=this._getWhiteboardInstanceById(e);return null!=t}},{key:"clearWhiteboardAllDataById",value:function(e){var t=this._getWhiteboardInstanceById(e);t?this._clearWhiteboardAllDataByInstance(t):L.Logger.error(B.logType,"[clear]There are no white board Numbers that belong to id "+e)}},{key:"productionSpecialId",value:function(e){return this.specialWhiteboardInstanceIDPrefix+e}},{key:"destroyWhiteboardInstance",value:function(e){var t=this._getWhiteboardInstanceById(e);t?this._destroyWhiteboardInstance(t):L.Logger.error(B.logType,"[destroy]There are no white board Numbers that belong to id "+e)}},{key:"clearRedoAndUndoStack",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?this._clearRedoAndUndoStack(n,t):L.Logger.error(B.logType,"[clearRedoAndUndoStack]There are no white board Numbers that belong to id "+e)}},{key:"resetDedaultWhiteboardMagnification",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t){var n=this.defaultProductionOptions.whiteboardMagnification;t.whiteboardMagnification=n,this._zoomIsDisable(t),this._resizeWhiteboardHandler(t)}else L.Logger.error(B.logType,"[resetDedaultWhiteboardMagnification]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardMagnification",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?n.whiteboardMagnification=t:L.Logger.error(B.logType,"[updateWhiteboardMagnification]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardWatermarkImageScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultProductionOptions.watermarkImageScale,n=this._getWhiteboardInstanceById(e);n?this._updateWhiteboardWatermarkImageScale(n,t):L.Logger.error(B.logType,"[updateWhiteboardWatermarkImageScale]There are no white board Numbers that belong to id "+e)}},{key:"getFileExt",value:function(e){if(""!=e)return"."+e.replace(/.+\./,"")}},{key:"setWhiteboardWatermarkImage",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.resetDedaultWhiteboardMagnification,r=void 0===i||i,o=n.loadSucceedCallback,a=n.loadFailureCallback,s=n.timeoutCallback,l=n.isPDF,c=n.fileid,d=this;L.Logger.debug(B.logType,"[setWhiteboardWatermarkImage]setWhiteboardWatermarkImage watermarkImageUrl:"+t);var u=d._getWhiteboardInstanceById(e);if(u)if(u.currentWatermarkImageUrl=t,ae.clear(c),r&&d.resetDedaultWhiteboardMagnification(e),t){if(d.showWhiteboardCanvasBackground(e),d._showWhiteboardLoading(u),clearTimeout(u.setWhiteboardWatermarkImageTimer),l){var h=Number((t.match(/-(\d+)\./)||[])[1])||void 0;return void d.loadPdf({url:t,page:h,fileid:c},function(e){u.lc.watermarkImage=null,u.lc.setWatermarkImage(""),d.setViewport(e),u.watermarkImageScale=e.width/e.height,u.useImgOriginalSizeToContainerWidthAndHeight&&(u.containerWidthAndHeight={width:e.width,height:e.height}),d._resizeWhiteboardByScale(u,{watermarkImageScale:e.width/e.height}),d._hideWhiteboardLoading(u),"function"==typeof u.handler.whiteboardWatermarkImageOnloadCallback&&u.handler.whiteboardWatermarkImageOnloadCallback({width:e.width,height:e.height}),o&&"function"==typeof o&&o(t),clearTimeout(p)})}var p=null,f=new Image;f.onload=function(){if(d.setViewport(null),u.currentWatermarkImageUrl){var e=f.width/f.height;u.useImgOriginalSizeToContainerWidthAndHeight&&(u.containerWidthAndHeight={width:f.width,height:f.height}),u.lc.setWatermarkImage(f),d._resizeWhiteboardByScale(u,{watermarkImage:f,watermarkImageScale:e}),u.handler.whiteboardWatermarkImageOnloadCallback&&"function"==typeof u.handler.whiteboardWatermarkImageOnloadCallback&&u.handler.whiteboardWatermarkImageOnloadCallback({width:f.width,height:f.height})}else u.lc.watermarkImage=null,d._resizeWhiteboardHandler(u);d._hideWhiteboardLoading(u),o&&"function"==typeof o&&o(t),clearTimeout(p)},f.onerror=function(e){L.Logger.error(B.logType,"img load fail , img url is "+t),a&&"function"==typeof a&&a(t),u&&u.handler&&u.handler.whiteboardWatermarkImageOnFailureCallback&&u.currentWatermarkImageUrl&&u.currentWatermarkImageUrl===t&&u.handler.whiteboardWatermarkImageOnFailureCallback(t)},f.src=t,p=setTimeout(function(){"function"==typeof s&&s()},6e4)}else d.hideWhiteboardCanvasBackground(e),u.lc.watermarkScale=1,d._resizeWhiteboardByScale(u,{isChangeWatermarkScale:!1}),d._hideWhiteboardLoading(u),u.lc.watermarkImage=null,this.pdfViewport=null,ae.clear(),u.lc.customCanvasBackgroundElement.style.backgroundImage="";else L.Logger.error(B.logType,"[setWhiteboardWatermarkImage]There are no white board Numbers that belong to id "+e)}},{key:"loadPdf",value:function(e,t){if(e.preload)ae.preloadPDF(H()({},e,{onload:t}));else{var n=document.getElementsByClassName("pdf-container")[0];ae.loadPDF(n,H()({},e,{onload:t}))}}},{key:"resizeWhiteboardHandler",value:function(e){if(void 0===e)for(var t=0,n=x()(this.whiteboardInstanceStore);t<n.length;t++){var i=n[t];this._resizeWhiteboardHandler(i)}else{var r=this._getWhiteboardInstanceById(e);if(!r)return void L.Logger.error(B.logType,"[resizeWhiteboardHandler]There are no white board Numbers that belong to id "+e);this._resizeWhiteboardHandler(r)}}},{key:"updateContainerWidthAndHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.width,i=t.height,r=this._getWhiteboardInstanceById(e);r?void 0!==n&&void 0!==i?(r.containerWidthAndHeight={width:n,height:i},this._resizeWhiteboardHandler(r)):L.Logger.error(B.logType,"[updateContainerWidthAndHeight]width or height is not exist , [width:"+n+" , height:"+i+"]!"):L.Logger.error(B.logType,"[updateContainerWidthAndHeight]There are no white board Numbers that belong to id "+e)}},{key:"hideWhiteboardCanvasBackground",value:function(e){var t=this._getWhiteboardInstanceById(e);t?t.lc&&t.lc.backgroundCanvas&&(t.lc.backgroundCanvas.style.display="none",t.lc.customCanvasBackgroundElement.style.display="none"):L.Logger.error(B.logType,"[hideWhiteboardCanvasBackground]There are no white board Numbers that belong to id "+e)}},{key:"showWhiteboardCanvasBackground",value:function(e){var t=this._getWhiteboardInstanceById(e);t?t.lc&&t.lc.backgroundCanvas&&(t.lc.backgroundCanvas.style.display="",t.lc.customCanvasBackgroundElement.style.display=""):L.Logger.error(B.logType,"[showWhiteboardCanvasBackground]There are no white board Numbers that belong to id "+e)}},{key:"hideWhiteboard",value:function(e){var t=this._getWhiteboardInstanceById(e);t&&t.whiteboardElement&&(t.whiteboardElement.style.display="none")}},{key:"showWhiteboard",value:function(e){var t=this._getWhiteboardInstanceById(e);t&&t.whiteboardElement&&(t.whiteboardElement.style.display="block")}},{key:"updateTextFont",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.fontSize,i=t.fontFamily,r=t.fontStyle,o=t.fontWeight,a=this._getWhiteboardInstanceById(e);a?(a.whiteboardToolsInfo.fontSize=void 0!==n?n:a.whiteboardToolsInfo.fontSize,a.whiteboardToolsInfo.fontFamily=void 0!==i?i:a.whiteboardToolsInfo.fontFamily,a.whiteboardToolsInfo.fontStyle=void 0!==r?r:a.whiteboardToolsInfo.fontStyle,a.whiteboardToolsInfo.fontWeight=void 0!==o?o:a.whiteboardToolsInfo.fontWeight,this._noticeNpdateWhiteboardToolsInfo(a),this._updateTextFont(a)):L.Logger.error(B.logType,"[updateTextFont]There are no white board Numbers that belong to id "+e)}},{key:"updateEraserWidth",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).eraserWidth,n=this._getWhiteboardInstanceById(e);n?(n.whiteboardToolsInfo.eraserWidth=void 0!==t?t:n.whiteboardToolsInfo.eraserWidth,this._noticeNpdateWhiteboardToolsInfo(n),this._updateEraserWidth(n)):L.Logger.error(B.logType,"[updateEraserWidth]There are no white board Numbers that belong to id "+e)}},{key:"updatePencilWidth",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).pencilWidth,n=this._getWhiteboardInstanceById(e);n?(n.whiteboardToolsInfo.pencilWidth=void 0!==t?t:n.whiteboardToolsInfo.pencilWidth,this._noticeNpdateWhiteboardToolsInfo(n),this._updatePencilWidth(n)):L.Logger.error(B.logType,"[updatePencilWidth]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardToolsInfo",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?t&&"object"===a()(t)&&(Object.deepAssign(n.whiteboardToolsInfo,t),this._noticeNpdateWhiteboardToolsInfo(n)):L.Logger.error(B.logType,"[updateWhiteboardToolsInfo]There are no white board Numbers that belong to id "+e)}},{key:"updateShapeWidth",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).shapeWidth,n=this._getWhiteboardInstanceById(e);n?(n.whiteboardToolsInfo.shapeWidth=void 0!==t?t:n.whiteboardToolsInfo.shapeWidth,this._noticeNpdateWhiteboardToolsInfo(n),this._updateShapeWidth(n)):L.Logger.error(B.logType,"[uploadShapeWidth]There are no white board Numbers that belong to id "+e)}},{key:"updateColor",value:function(e,t){if(t&&"object"===a()(t)){var n=this._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error(B.logType,"[updateColor]There are no white board Numbers that belong to id "+e);for(var i={},r=0,o=h()(t);r<o.length;r++){var s=d()(o[r],2),l=s[0],c=s[1],u=l.replace(/Color/g,"");i[u]=c,n.whiteboardToolsInfo[u+"Color"]=c,this._noticeNpdateWhiteboardToolsInfo(n)}this._updateColor(n,i)}}},{key:"getActiveTool",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return t.activeTool;L.Logger.error(B.logType,"[getActiveTool]There are no white board Numbers that belong to id "+e)}},{key:"activeWhiteboardTool",value:function(e,t){if(void 0!==this.useWhiteboardTool[e])if(null!=t){var n=this._getWhiteboardInstanceById(t);if(n)if(/^tool_/.test(e)){if("tool_pencil"===e||"tool_highlighter"===e||"tool_line"===e||"tool_arrow"===e||"tool_dashed"===e?n.historyPenTool=e:"tool_rectangle"!==e&&"tool_rectangle_empty"!==e&&"tool_ellipse"!==e&&"tool_ellipse_empty"!==e&&"tool_polygon"!==e||(n.historyShapeTool=e),n.activeTool=e,this._setWhiteboardTools(e,n),this._handlerActiveToolLaser(e,n),"tool_text"===e?this._updateTextFont(n):"tool_eraser"===e?this._updateEraserWidth(n):"tool_pencil"===e||"tool_highlighter"===e||"tool_line"===e||"tool_arrow"==e||"tool_dashed"===e?this._updatePencilWidth(n):"tool_rectangle"!==e&&"tool_rectangle_empty"!==e&&"tool_ellipse"!==e&&"tool_ellipse_empty"!==e&&"tool_polygon"!==e||this._updateShapeWidth(n),"tool_ellipse_empty"===e||"tool_rectangle_empty"===e?n.lc.setColor("secondary","transparent"):"tool_rectangle"===e||"tool_ellipse"===e||"tool_polygon"===e?n.lc.setColor("secondary",n.whiteboardToolsInfo.primaryColor):n.lc.setColor("secondary",n.whiteboardToolsInfo.secondaryColor),"tool_highlighter"===e){var i=n.whiteboardToolsInfo.primaryColor.colorRgb().toLowerCase().replace("rgb","rgba").replace(")",",0.5)");n.lc.setColor("primary",i)}else n.lc.setColor("primary",n.whiteboardToolsInfo.primaryColor);n.handler.receiveActionCommandCallback&&n.handler.receiveActionCommandCallback("changeWhiteboardActiveTool",{id:n.id,activeTool:n.activeTool}),this._toolIsUse(n)}else if(/^action_/.test(e)){if("action_undo"===e){var r=n.isOnlyUndoRedoClearMyselfShape&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendUndo(r):n.lc.undo()}else if("action_redo"===e){var o=n.isOnlyUndoRedoClearMyselfShape&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendRedo(o):n.lc.redo()}else if("action_clear"===e){var a=n.isOnlyUndoRedoClearMyselfShape&&n.myselfId?n.myselfId:void 0;n.synchronizationWhiteboard?n.lc.sendClear(a):n.lc.clear()}this._actionIsDisable(n)}else/^zoom_/.test(e)&&("zoom_big"===e?n.whiteboardMagnification<this.maxMagnification&&(n.whiteboardMagnification+=.5):"zoom_small"===e?n.whiteboardMagnification>this.minMagnification&&(n.whiteboardMagnification-=.5):"zoom_default"===e&&(n.whiteboardMagnification=this.defaultProductionOptions.whiteboardMagnification),n.whiteboardMagnification>this.maxMagnification?n.whiteboardMagnification=this.maxMagnification:n.whiteboardMagnification<this.minMagnification&&(n.whiteboardMagnification=this.minMagnification),this._zoomIsDisable(n),this._resizeWhiteboardHandler(n),["zoom_big","zoom_small","zoom_default"].includes(e)&&ae.setScale(!0));else L.Logger.error(B.logType,"[activeWhiteboardTool]There are no white board Numbers that belong to id "+t)}else L.Logger.error(B.logType,"[activeWhiteboardTool]id is undefined or null ");else L.Logger.error(B.logType,"The whiteboard does not have the "+e+" tool!")}},{key:"useHistoryPenTool",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t){var n=t.historyPenTool||"tool_pencil";this.activeWhiteboardTool(n,e)}else L.Logger.error(B.logType,"[useHistoryPenTool]There are no white board Numbers that belong to id "+e)}},{key:"useHistoryShapeTool",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t){var n=t.historyShapeTool||"tool_rectangle";this.activeWhiteboardTool(n,e)}else L.Logger.error(B.logType,"[useHistoryShapeTool]There are no white board Numbers that belong to id "+e)}},{key:"changeWhiteboardTemporaryDeawPermission",value:function(e,t){var n=void 0;void 0!==t&&(n=this._getWhiteboardInstanceById(t)),n?this._changeWhiteboardTemporaryDeawPermission(e,n):L.Logger.error(B.logType,"[changeWhiteboardTemporaryDeawPermission]There are no white board Numbers that belong to id "+t)}},{key:"updateWhiteboardProperty",value:function(e,t){if(t&&"object"===a()(t)){var n=this._getWhiteboardInstanceById(e);if(!n)return void L.Logger.error(B.logType,"[updateWhiteboardProperty]There are no white board Numbers that belong to id "+e);if(void 0!==t.deawPermission&&this.changeWhiteboardDeawPermission(t.deawPermission,e),void 0!==t.canWBPinch&&(n.canWBPinch=t.canWBPinch),void 0!==t.showShapeAuthor&&this.changeWhiteboardExclusiveAttribute(e,{showShapeAuthor:t.showShapeAuthor}),void 0!==t.myselfId&&this.changeWhiteboardExclusiveAttribute(e,{myselfId:t.myselfId}),void 0!==t.isOnlyUndoRedoClearMyselfShape&&this.changeWhiteboardExclusiveAttribute(e,{isOnlyUndoRedoClearMyselfShape:t.isOnlyUndoRedoClearMyselfShape}),void 0!==t.nickname&&this.changeWhiteboardExclusiveAttribute(e,{nickname:t.nickname}),void 0!==t.primary||void 0!==t.secondary||void 0!==t.background||void 0!==t.primaryColor||void 0!==t.secondaryColor||void 0!==t.backgroundColor){var i={};for(var r in t)"primary"!==r&&"secondary"!==r&&"background"!==r&&"primaryColor"!==r&&"secondaryColor"!==r&&"backgroundColor"!==r||(i[r]=t[r]);this.updateColor(e,i)}if(void 0!==t.synchronizationWhiteboard&&this.changeWhiteboardExclusiveAttribute(e,{synchronizationWhiteboard:t.synchronizationWhiteboard}),void 0!==t.defaultWhiteboardScale&&this.changeWhiteboardExclusiveAttribute(e,{defaultWhiteboardScale:t.defaultWhiteboardScale}),void 0!==t.associatedMsgID&&this.updateWhiteboardAssociatedMsgID(e,t.associatedMsgID),void 0!==t.associatedUserID&&this.updateWhiteboardAssociatedUserID(e,t.associatedUserID),void 0!==t.pencilWidth||void 0!==t.shapeWidth||void 0!==t.eraserWidth||void 0!==t.fontSize||void 0!==t.fontFamily){var o={};void 0!==t.pencilWidth&&(o.pencilWidth=Number(t.pencilWidth)),void 0!==t.shapeWidth&&(o.shapeWidth=Number(t.shapeWidth)),void 0!==t.eraserWidth&&(o.eraserWidth=Number(t.eraserWidth)),void 0!==t.fontSize&&(o.fontSize=Number(t.fontSize)),void 0!==t.fontFamily&&(o.fontFamily=t.fontFamily),this.updateWhiteboardToolsInfo(e,o),void 0===t.fontSize&&void 0===t.fontFamily||this.updateTextFont(e),void 0!==t.pencilWidth&&("tool_pencil"!==n.activeTool&&"tool_highlighter"!==n.activeTool&&"tool_line"!==n.activeTool&&"tool_arrow"!==n.activeTool&&"tool_dashed"!==n.activeTool||this.updatePencilWidth(e)),void 0!==t.shapeWidth&&("tool_rectangle"!==n.activeTool&&"tool_rectangle_empty"!==n.activeTool&&"tool_ellipse"!==n.activeTool&&"tool_ellipse_empty"!==n.activeTool&&"tool_polygon"!==n.activeTool||this.updateShapeWidth(e)),void 0!==t.eraserWidth&&"tool_eraser"===n.activeTool&&this.updateEraserWidth(e)}void 0!==t.insertPictureRule&&this.changeWhiteboardExclusiveAttribute(e,{insertPictureRule:t.insertPictureRule})}}},{key:"changeWhiteboardDeawPermission",value:function(e,t){var n=void 0;void 0!==t&&(n=this._getWhiteboardInstanceById(t)),n?this._changeWhiteboardDeawPermission(e,n):L.Logger.error(B.logType,"[changeWhiteboardDeawPermission]There are no white board Numbers that belong to id "+t)}},{key:"registerWhiteboardTools",value:function(e,t){if(t&&"object"===a()(t)){var n=this._getWhiteboardInstanceById(e);if(n){for(var i={},r=0,o=h()(t);r<o.length;r++){var s=d()(o[r],2),l=s[0],c=s[1];void 0!==this.useWhiteboardTool[l]?(i[l]=this._productionToolDesc(l,c),this.useWhiteboardTool[l]=!0):L.Logger.warning(B.logType,"The whiteboard does not have the "+l+" tool!")}n.registerWhiteboardToolsList=i,n.isRegisterWhiteboardTool=!0,this._zoomIsDisable(n),this._zoomIsDisable(n),this._noticeUpdateToolDesc(n)}else L.Logger.error(B.logType,"[registerWhiteboardTools]There are no white board Numbers that belong to id "+e)}else L.Logger.error(B.logType,"[initWhiteboardTools] tools desc cannot be empty and type json!")}},{key:"hasWhiteboardFiledata",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return!!(t.filedata&&"object"===a()(t.filedata)&&f()(t.filedata).length>0);L.Logger.error(B.logType,"[hasWhiteboardFiledata]There are no white board Numbers that belong to id "+e)}},{key:"updateWhiteboardFiledata",value:function(e,t){var n=this._getWhiteboardInstanceById(e);n?this._updateWhiteboardFiledata(n,t):L.Logger.error(B.logType,"[updateWhiteboardFiledata]There are no white board Numbers that belong to id "+e)}},{key:"getRegisterWhiteboardToolsList",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return Object.deepAssign({},t.registerWhiteboardToolsList);L.Logger.error(B.logType,"[getRegisterWhiteboardToolsList]There are no white board Numbers that belong to id "+e)}},{key:"getWhiteboardFiledata",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return"number"!=typeof t.filedata.currpage&&(t.filedata.currpage=Number(t.filedata.currpage)),"number"!=typeof t.filedata.pagenum&&(t.filedata.pagenum=Number(t.filedata.pagenum)),"number"!=typeof t.filedata.pptslide&&(t.filedata.pptslide=Number(t.filedata.pptslide)),"number"!=typeof t.filedata.pptstep&&(t.filedata.pptstep=Number(t.filedata.pptstep)),"number"!=typeof t.filedata.steptotal&&(t.filedata.steptotal=Number(t.filedata.steptotal)),t.filedata.baseurl=t.filedata.baseurl,Object.deepAssign({},t.filedata);L.Logger.error(B.logType,"[getWhiteboardFiledata]There are no white board Numbers that belong to id "+e)}},{key:"clearWhiteboardDataByFileidAndCurrpage",value:function(e,t,n){var i=this._getWhiteboardInstanceById(e);i?null!=t&&null!==n&&(i.waitingProcessShapeData["SharpsChange_"+t+"_"+n]=void 0,i.stackStorage["redoStack_"+t+"_"+n]=void 0,i.stackStorage["undoStack_"+t+"_"+n]=void 0,delete i.waitingProcessShapeData["SharpsChange_"+t+"_"+n],delete i.stackStorage["redoStack_"+t+"_"+n],delete i.stackStorage["undoStack_"+t+"_"+n]):L.Logger.error(B.logType,"[clearWhiteboardDataByFileidAndCurrpage]There are no white board Numbers that belong to id "+e)}},{key:"loadCurrpageWhiteboard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.loadRedoStack,i=void 0===n||n,r=t.callback,o=this._getWhiteboardInstanceById(e);if(o){this._clearRedoAndUndoStack(o),this._basicTemplateWhiteboardSignallingListToWhiteboardInstance(o);var a=o.filedata,s=a.fileid,l=a.currpage;if(void 0===o.waitingProcessShapeData||null===o.waitingProcessShapeData)o.waitingProcessShapeData={};else{var c=o.waitingProcessShapeData["SharpsChange_"+s+"_"+l];null!=c&&c.length>0&&this._batchReceiveSnapshot(c,o)}if(i){var d=o.stackStorage["redoStack_"+s+"_"+l];d&&d.length>0&&(o.lc.redoStack=d)}this._actionIsDisable(o),r&&"function"==typeof r&&r()}else L.Logger.error(B.logType,"[loadCurrpageWhiteboard]There are no white board Numbers that belong to id "+e)}},{key:"saveWhiteboardStackToStorage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.saveRedoStack,i=t.saveUndoStack,r=this._getWhiteboardInstanceById(e);if(r){n=void 0!==n?n:r.saveRedoStack,i=void 0!==i?i:r.saveUndoStack;var o=this.getWhiteboardFiledata(e),a=o.fileid,s=o.currpage;n&&(r.stackStorage["redoStack_"+a+"_"+s]=r.lc.redoStack.slice(0))}else L.Logger.error(B.logType,"[saveWhiteboardStackToStorage]There are no white board Numbers that belong to id "+e)}},{key:"showWhiteboardLoading",value:function(e){var t=this._getWhiteboardInstanceById(e);t?this._showWhiteboardLoading(t):L.Logger.error(B.logType,"[showWhiteboardLoading]There are no white board Numbers that belong to id "+e)}},{key:"hideWhiteboardLoading",value:function(e){var t=this._getWhiteboardInstanceById(e);t?this._hideWhiteboardLoading(t):L.Logger.error(B.logType,"[showWhiteboardLoading]There are no white board Numbers that belong to id "+e)}},{key:"isWhiteboardTextEditing",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return"Text"==t.lc.tool.name.toString()&&"editing"==t.lc.tool.currentShapeState;L.Logger.error(B.logType,"[isWhiteboardTextEditing]There are no white board Numbers that belong to id "+e)}},{key:"checkWhiteboardCanvasSize",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).isResize,n=void 0!==t&&t,i=this._getWhiteboardInstanceById(e);if(i)return i.lc&&i.lc.canvas?(0===i.lc.canvas.width||0===i.lc.canvas.height)&&(n&&this._resizeWhiteboardHandler(i),!0):void 0;L.Logger.error(B.logType,"[checkWhiteboardCanvasSize]There are no white board Numbers that belong to id "+e)}},{key:"downCanvasImageToLocalFile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png",n=this._getWhiteboardInstanceById(e);if(n){var i=this._convertCanvasToImageBase64(n,t);!function(e,t){var n=document.createElementNS("http://www.w3.org/1999/xhtml","a");n.href=e,n.download=t;var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(i)}(i=i.replace(function(e){return"image/"+(e=e.toLocaleLowerCase().replace(/jpg/i,"jpeg")).match(/png|jpeg|bmp|gif/)[0]}(t),"image/octet-stream"),(n.nickname?n.nickname+"_":"")+n.id+"_"+(new Date).getTime()+"."+t)}else L.Logger.error(B.logType,"[downCanvasImageToLocalFile]There are no white board Numbers that belong to id "+e)}},{key:"getWhiteboardToolsInfo",value:function(e){var t=this._getWhiteboardInstanceById(e);if(t)return Object.deepAssign({},t.whiteboardToolsInfo);L.Logger.error(B.logType,"[getWhiteboardToolsInfo]There are no white board Numbers that belong to id "+e)}},{key:"_clearRedoAndUndoStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.clear,i=void 0===n||n,r=t.redo,o=void 0===r||r,a=t.undo,s=void 0===a||a,l=this;i&&l._clearLc(e,{triggerEvent:!1}),o&&l._clearLcRedoStack(e),s&&l._clearLcUndoStack(e),l._actionIsDisable(e),setTimeout(function(){l._resizeWhiteboardHandler(e)},0)}},{key:"_updateWhiteboardFiledata",value:function(e,t){t&&"object"===a()(t)&&(void 0!==t.currpage&&(t.currpage=Number(t.currpage)),void 0!==t.pagenum&&(t.pagenum=Number(t.pagenum)),void 0!==t.pptslide&&(t.pptslide=Number(t.pptslide)),void 0!==t.pptstep&&(t.pptstep=Number(t.pptstep)),void 0!==t.steptotal&&(t.steptotal=Number(t.steptotal)),Object.deepAssign(e.filedata,t),e.filedata.baseurl=t.baseurl,e&&e.handler&&e.handler.noticeUpdateWhiteboardFiledataCallback&&e.handler&&e.handler.noticeUpdateWhiteboardFiledataCallback&&e.handler.noticeUpdateWhiteboardFiledataCallback(e.filedata))}},{key:"_batchReceiveSnapshot",value:function(e,t){var n=this;w()(e)?(e.forEach(function(i,r){var o=!0;r===e.length-1&&(o=!1),n._handlerRemoteDataToWhiteboard(i,o,t)}),n._actionIsDisable(t)):L.Logger.error(B.logType,"shapesArray must be an array!")}},{key:"_receiveSnapshot",value:function(e,t){this._handlerRemoteDataToWhiteboard(e,!1,t),this._actionIsDisable(t)}},{key:"_handlerRemoteDataToWhiteboard",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(e.data&&"string"==typeof e.data&&(e.data=JSON.parse(e.data)),null!=e.data&&null!=e.data.eventType)if("delmsg"===e.source)switch(e.data.eventType){case"shapeSaveEvent":case"clearEvent":case"undoEvent":e.data.actionName&&"AddShapeAction"===e.data.actionName?(n.lc.undo(!1,e.data.shapeId),this._removeRemindContentByElementId(n,"whiteboard_remind_"+e.data.shapeId)):e.data.actionName&&"ClearAction"===e.data.actionName&&n.lc.undo(!1,e.data.clearActionId)}else switch(e.data.eventType){case"shapeSaveEvent":if(n&&n.lc&&n.lc.undoStack&&n.lc.undoStack.length>0)for(var i=!1,r=n.lc.undoStack.length-1;r>=0;r--){var o=n.lc.undoStack[r];switch(o.actionName){case"AddShapeAction":o.shapeId===e.data.shapeId&&(o.undo&&o.undo(),n.lc.undoStack.splice(r,1),i=!0)}if(i)break}e.data&&e.data.data&&e.data.data.data&&(e.data.data=window.LC.JSONToShape(e.data.data)),n.lc.saveShape(e.data.data,!1,null,t,e.fromID,e.seq);break;case"undoEvent":e.data.actionName&&"AddShapeAction"===e.data.actionName?(n.lc.undo(!1,e.data.shapeId),this._removeRemindContentByElementId(n,"whiteboard_remind_"+e.data.shapeId)):e.data.actionName&&"ClearAction"===e.data.actionName&&n.lc.undo(!1,e.data.clearActionId);break;case"redoEvent":if(e.data.actionName&&"AddShapeAction"===e.data.actionName){for(var a=!0,s=n.lc.undoStack.length-1;s>=0;s--)if(e.data.shapeId===n.lc.undoStack[s].shapeId){a=!1;break}if(a){for(var l=!1,c=n.lc.redoStack.length-1;c>=0;c--)if(e.data.shapeId===n.lc.redoStack[c].shapeId){l=!0;break}if(l)n.lc.redo(!1,e.data.shapeId);else{e.data&&e.data.data&&e.data.data.data&&(e.data.data=window.LC.JSONToShape(e.data.data));var d=e.data.otherInfo,u=void 0===d?{authorUserId:e.fromID,seq:e.seq}:d;n.lc.saveShape(e.data.data,!1,null,t,u.authorUserId,u.seq)}}}else if(e.data.actionName&&"ClearAction"===e.data.actionName){for(var h=!0,p=n.lc.undoStack.length-1;p>=0;p--)if(e.data.clearActionId===n.lc.undoStack[p].id){h=!1;break}if(h){for(var f=!1,m=n.lc.redoStack.length-1;m>=0;m--)if(e.data.clearActionId===n.lc.redoStack[m].id){f=!0;break}if(f)n.lc.redo(!1,e.data.clearActionId),this._removeAllRemindContent(n);else{var g=e.data.otherInfo,v=void 0===g?{authorUserId:e.fromID,toAuthorUserId:void 0,seq:e.seq}:g;n.lc.clear(!1,e.data.clearActionId,v.authorUserId,v.toAuthorUserId,v.seq),this._removeAllRemindContent(n)}}}break;case"clearEvent":n.lc.clear(!1,e.data.clearActionId,e.fromID,e.data.toAuthorUserId,e.seq),this._removeAllRemindContent(n);break;case"laserMarkEvent":var y=n.lc.containerEl.parentNode.getElementsByClassName("laser-mark")[0];switch(e.data.actionName){case"show":y.style.display="block";break;case"hide":y.style.display="none";break;case"move":if(e.data&&e.data.laser){var b=e.data.laser.left,w=e.data.laser.top;y.style.left=b+"%",y.style.top=w+"%"}}}}},{key:"_productionToolDesc",value:function(e,t){return{toolKey:e,disabled:!1}}},{key:"_noticeUpdateToolDesc",value:function(e){e&&e.isRegisterWhiteboardTool&&e.handler&&e.handler.noticeUpdateToolDescCallback&&e.handler.noticeUpdateToolDescCallback(e.registerWhiteboardToolsList)}},{key:"_updateToolDesc",value:function(e,t,n){if(e.registerWhiteboardToolsList[t])for(var i=0,r=h()(n);i<r.length;i++){var o=d()(r[i],2),a=o[0],s=o[1];void 0!==e.registerWhiteboardToolsList[t][a]&&(e.registerWhiteboardToolsList[t][a]=s)}for(var l=0,c=f()(e.registerWhiteboardToolsList);l<c.length;l++){var u=c[l];/tool_/g.test(u)?e.registerWhiteboardToolsList[u].isUse=u===e.activeTool:/zoom_/g.test(u)&&(e.registerWhiteboardToolsList[u].zoom=e.whiteboardMagnification)}}},{key:"_batchUpdateToolDesc",value:function(e,t){if(w()(t)){var n=!0,i=!1,r=void 0;try{for(var o,a=W()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;w()(s)&&this._updateToolDesc(e,s[0],s[1])}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}else L.Logger.error(B.logType,"updateDescArray must be an array , whiteboard id is "+e.id+"!")}},{key:"_setWhiteboardTools",value:function(e,t){var n=this;n._automaticTraverseWhiteboardInstance(t,function(t){var i=n._productionToolByCore(e,t);t.lc.setTool(i)})}},{key:"_productionToolByCore",value:function(e,t){var n=void 0;if(void 0===this.useWhiteboardTool[e])return L.Logger.error(B.logType,"The whiteboard does not have the "+e+" tool!"),n;switch(e){case"tool_pencil":case"tool_highlighter":n=new window.LC.tools.Pencil(t.lc);break;case"tool_line":n=new window.LC.tools.Line(t.lc);break;case"tool_arrow":(n=new window.LC.tools.Line(t.lc)).hasEndArrow=!0;break;case"tool_dashed":(n=new window.LC.tools.Line(t.lc)).isDashed=!0;break;case"tool_eraser":n=new window.LC.tools.Eraser(t.lc);break;case"tool_text":n=new window.LC.tools.Text(t.lc);break;case"tool_rectangle":case"tool_rectangle_empty":n=new window.LC.tools.Rectangle(t.lc);break;case"tool_ellipse":case"tool_ellipse_empty":n=new window.LC.tools.Ellipse(t.lc);break;case"tool_polygon":n=new window.LC.tools.Polygon(t.lc);break;case"tool_eyedropper":n=new window.LC.tools.Eyedropper(t.lc);break;case"tool_selectShape":n=new window.LC.tools.SelectShape(t.lc);break;case"tool_mouse":case"tool_laser":n=t.lc.tool;break;default:L.Logger.warning(B.logType,"Tool "+e+" is not created in the whiteboard core layer!"),n=t.lc.tool}return n}},{key:"_getWhiteboardInstanceID",value:function(e){var t=this.uniqueWhiteboard||null==e?this.whiteboardInstanceDefaultID:this.whiteboardInstanceIDPrefix+e;e&&"string"==typeof e&&(new RegExp(this.specialWhiteboardInstanceIDPrefix,"g").test(e)&&(t=e));return t}},{key:"_getWhiteboardInstanceById",value:function(e){var t=this._getWhiteboardInstanceID(e);return this.whiteboardInstanceStore[t]}},{key:"_getWhiteboardInstanceByID",value:function(e){return this.whiteboardInstanceStore[e]}},{key:"_resizeWhiteboardByScale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.watermarkImage,i=t.isChangeCanvas,r=void 0===i||i,o=t.isChangeWatermarkScale,a=void 0===o||o,s=t.watermarkImageScale;s=void 0!==s?s:e.watermarkImageScale;var l=e.lc;if(l){var c=e.whiteboardElement,d=e.whiteboardInstanceElement,u=e.containerWidthAndHeight.width,h=e.containerWidthAndHeight.height;if(e.parcelAncestorElementId){var p=document.getElementById(e.parcelAncestorElementId);p&&(u=p.clientWidth,h=p.clientHeight)}var f={},m={},g=0,v=0,y=0,b=0;if(h*s<u?(g=Math.round(h*s*e.whiteboardMagnification),v=Math.round(h*e.whiteboardMagnification),"relativeOriginalSize"===e.insertPictureRule&&n&&n.width<u&&n.height<h&&(g=n.width,v=n.height),c.style.width=g+"px",c.style.height=v+"px",d.style.width=g+"px",d.style.height=v+"px",void 0!==e.minHeight&&null!==e.minHeight&&(y=e.minHeight*s,b=e.minHeight,c.style.minWidth=y+"px",c.style.minHeight=b+"px",d.style.minWidth=y+"px",d.style.minHeight=b+"px",m.minWidth=y+"px",m.minHegiht=b+"px"),m.top="0%",m.left="50%",m.marginTop="0px",m.marginLeft=-g/2+"px",m.width=g+"px",m.height=v+"px"):(g=Math.round(u*e.whiteboardMagnification),v=Math.round(u/s*e.whiteboardMagnification),"relativeOriginalSize"===e.insertPictureRule&&n&&n.width<u&&n.height<h&&(g=n.width,v=n.height),c.style.width=g+"px",c.style.height=v+"px",d.style.width=g+"px",d.style.height=v+"px",void 0!==e.minHeight&&null!==e.minHeight&&(y=e.minHeight*s,b=e.minHeight,c.style.minWidth=y+"px",c.style.minHeight=b+"px",d.style.minWidth=y+"px",d.style.minHeight=b+"px",m.minWidth=y+"px",m.minHegiht=b+"px"),m.top="50%",m.left="0%",m.marginTop=-v/2+"px",m.marginLeft="0px",m.width=g+"px",m.height=v+"px"),r){l.respondToSizeChange();var w=d.clientWidth,_=d.clientHeight,S=(w+_)/(e.baseWhiteboardWidth+e.baseWhiteboardWidth*s);if(l.setZoom(S),l.setPan(0,0),a&&n){var k=n,P=(w/k.width+_/k.height)/2;"relativeOriginalSize"===e.insertPictureRule&&k&&k.width<u&&k.height<h&&(P=1),l.watermarkScale=P,l.setWatermarkImage(n)}}f.style=m,f.addClassName=e.whiteboardMagnification>1?"custom-scroll-bar":"",f.loadScrollBar=e.whiteboardMagnification>1,e.handler&&e.handler.resizeWhiteboardSizeCallback&&"function"==typeof e.handler.resizeWhiteboardSizeCallback?e.handler.resizeWhiteboardSizeCallback(f):f=null,this.pdfViewport&&ae.setScale()}}},{key:"_clearWhiteboardAllDataByInstance",value:function(e){var t=this;e?(e.lc.clear(!1),e.lc.redoStack.length=0,e.lc.undoStack.length=0,e.stackStorage={},e.waitingProcessShapeData={},this._removeAllRemindContent(e),setTimeout(function(){t._resizeWhiteboardHandler(e)},0)):L.Logger.error(B.logType,"[_clear]The whiteboard instance does not exist!")}},{key:"_resizeWhiteboardHandler",value:function(e){if(e&&e.lc){var t=e.lc.watermarkImage;if(t&&t.src||this.pdfViewport){var n=this.pdfViewport||t,i=n.width,r=n.height;this._resizeWhiteboardByScale(e,{watermarkImage:t,watermarkImageScale:i/r})}else this._resizeWhiteboardByScale(e,{isChangeWatermarkScale:!1});this._updateAllRemindContent(e)}}},{key:"_updateWhiteboardWatermarkImageScale",value:function(e,t){e.watermarkImageScale=t,this._resizeWhiteboardHandler(e)}},{key:"_productionWhiteboardRemindContent",value:function(e,t,n,i,r){var o=this;if(e&&i)try{if(e&&e.lc&&e.lc.containerEl.parentNode&&"function"==typeof e.lc.drawingCoordsToClientCoords){var a=e.lc.drawingCoordsToClientCoords(t,n);if(a){var s=document.createElement("span");s.className="remind-content",s.style.position="absolute",s.style.left=a.x+"px",s.style.top=a.y+"px",s.innerHTML=i;var l=r?"whiteboard_remind_"+r:"whiteboard_remind_"+(new Date).getTime();s.setAttribute("data-position-x",t),s.setAttribute("data-position-y",n),s.setAttribute("id",l),e.lc.containerEl.parentNode.appendChild(s),setTimeout(function(){o._removeRemindContentByElementId(e,l),s=null},e.remindContentTime)}}}catch(e){L.Logger.error(B.logType,"productionWhiteboardRemindContent error:",e)}}},{key:"_updateAllRemindContent",value:function(e){try{if(e.lc&&e.lc.containerEl.parentNode){var t=e.lc.containerEl.parentNode.getElementsByClassName("remind-content");if(t&&t.length>0)for(var n=0;n<t.length;n++){var i=t[n],r=Number(i.getAttribute("data-position-x")),o=Number(i.getAttribute("data-position-y")),a=e.lc.drawingCoordsToClientCoords(r,o);i.style.left=a.x+"px",i.style.top=a.y+"px"}}}catch(e){L.Logger.error(B.logType,"updateAllRemindContent error:",e)}}},{key:"_removeRemindContentByElementId",value:function(e,t){if(e&&e.lc&&e.lc.containerEl.parentNode){var n=document.getElementById(t);n&&(n.innerHTML="",e.lc.containerEl.parentNode.removeChild(n),n=null)}}},{key:"_removeAllRemindContent",value:function(e){if(e&&e.lc&&e.lc.containerEl.parentNode)try{if(e.lc&&e.lc.containerEl.parentNode){var t=e.lc.containerEl.parentNode.getElementsByClassName("remind-content");if(t&&t.length>0)for(var n=t.length-1;n>=0;n--){var i=t[n];i.innerHTML="",e.lc.containerEl.parentNode.removeChild(i),i=null}}}catch(e){L.Logger.error(B.logType,"removeAllRemindContent error:",e)}}},{key:"_handlerShapeSaveEvent",value:function(e,t){e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("currentWhiteboardId",{id:e.id}),this._sendWhiteboardMessageToSignallingServer(e,"shapeSaveEvent",t),this._actionIsDisable(e)}},{key:"_handlerUndoEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"undoEvent",t),this._actionIsDisable(e)}},{key:"_handlerRedoEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"redoEvent",t),this._actionIsDisable(e)}},{key:"_handlerClearEvent",value:function(e,t){this._sendWhiteboardMessageToSignallingServer(e,"clearEvent",t),this._actionIsDisable(e)}},{key:"_handlerDrawingChangeEvent",value:function(e){this._saveImageBase64ToImageThumbnail(e)}},{key:"_saveImageBase64ToImageThumbnail",value:function(e){if(e.imageThumbnailId){var t=document.getElementById(e.imageThumbnailId);if(t&&"img"===t.nodeName.toLowerCase()){var n=this._convertCanvasToImageBase64(e,"jpg");t.src=n,e.imageThumbnailTipContent&&document.getElementById(e.imageThumbnailId+"_imageDescribe")?document.getElementById(e.imageThumbnailId+"_imageDescribe").innerHTML=e.imageThumbnailTipContent:e.nickname&&document.getElementById(e.imageThumbnailId+"_imageDescribe")&&(document.getElementById(e.imageThumbnailId+"_imageDescribe").innerHTML=e.nickname)}}}},{key:"_destroyWhiteboardInstance",value:function(e){clearTimeout(e.noticeUpdateToolDescTimer),clearTimeout(e.laserTimer),clearTimeout(e.setWhiteboardWatermarkImageTimer),this.basicTemplateWhiteboardSignallingList[e.id]&&(this.basicTemplateWhiteboardSignallingList[e.id]=null,delete this.basicTemplateWhiteboardSignallingList[e.id]),this._clearWhiteboardAllDataByInstance(e);var t=e.whiteboardInstanceID,n=e.whiteboardElement;e.lc&&"function"==typeof e.lc.teardown&&e.lc.teardown(),n?n.innerHTML="":L.Logger.warning(B.logType,"[destroy] whiteboard elements do not exist , element id is:"+e.whiteboardElementId+"!");var i=e.thumbnailId?document.getElementById(e.thumbnailId):void 0;i&&(i.innerHTML="");for(var r=0,o=f()(e);r<o.length;r++){var a=o[r];e[a]=null,delete e[a]}this.whiteboardInstanceStore[t]=null,delete this.whiteboardInstanceStore[t]}},{key:"_clearLc",value:function(e){(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).triggerEvent;e&&e.lc?(e.lc.clear(!1),this._removeAllRemindContent(e)):L.Logger.warning(B.logType,"clear whiteboard is not exist!")}},{key:"_clearLcRedoStack",value:function(e){e&&e.lc?e.lc.redoStack.length=0:L.Logger.warning(B.logType,"clearRedoStack whiteboard is not exist!")}},{key:"_clearLcUndoStack",value:function(e){e&&e.lc?e.lc.undoStack.length=0:L.Logger.warning(B.logType,"clearUndoStack whiteboard is not exist!")}},{key:"_showWhiteboardLoading",value:function(e){e.lc.loadingElement&&(e.lc.loadingElement.style.display="block")}},{key:"_hideWhiteboardLoading",value:function(e){e.lc.loadingElement&&(e.lc.loadingElement.style.display="none")}},{key:"_changeWhiteboardTemporaryDeawPermission",value:function(e,t){this._automaticTraverseWhiteboardInstance(t,function(t){var n=t.lc;if(n.isTmpDrawAble!==e){n.isTmpDrawAble=e;var i=n.containerEl.parentNode.getElementsByClassName("temporary-draw-permission")[0];n.isTmpDrawAble?(i.className=i.className.replace(/( yes| no)/g,""),i.className+=" yes"):(i.className=i.className.replace(/( yes| no)/g,""),i.className+=" no")}})}},{key:"_changeWhiteboardDeawPermission",value:function(e,t){this._automaticTraverseWhiteboardInstance(t,function(t){t.deawPermission=e;var n=t.lc;if(n.isDrawAble!==e){n.isDrawAble=e;var i=n.containerEl.parentNode.getElementsByClassName("draw-permission")[0];n.isDrawAble?(i.className=i.className.replace(/( yes| no)/g,""),i.className+=" yes"):(i.className=i.className.replace(/( yes| no)/g,""),i.className+=" no")}})}},{key:"_handlerActiveToolLaser",value:function(e,t){var n=this;n._automaticTraverseWhiteboardInstance(t,function(t){var i=t.lc.containerEl.parentNode,r=i.getElementsByClassName("temporary-draw-permission")[0],o=i.getElementsByClassName("laser-mark")[0];if("tool_laser"===e){var a;ue(r,"mousemove",t._laserEventHandler_mousemove),ue(i,"mouseenter",t._laserEventHandler_mouseenter),ue(i,"mouseleave",t._laserEventHandler_mouseleave),t._laserEventHandler_mousemove=function(e){var i,s,l=e.offsetX,c=e.offsetY,d=r.clientWidth,u=r.clientHeight;switch(t.rotateDeg){case 0:i=l,s=c;break;case 90:i=c,s=u-l;break;case 180:i=d-l,s=u-c;break;case 270:i=d-c,s=l;break;default:i=l,s=c}var h=i/d*100,p=s/u*100;o.style.left=h+"%",o.style.top=p+"%";var f=(new Date).getTime();return f-a>=40&&(a=f,function(){if(t.laserPosition&&(Math.abs(h-t.laserPosition.left)>.3||Math.abs(p-t.laserPosition.top)>.3)){var e={laser:{left:h,top:p},action:{actionName:"move"}};t.laserPosition=e.laser,n._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",e)}}()),!1},t._laserEventHandler_mouseenter=function(e){return a=(new Date).getTime(),n._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",{action:{actionName:"show"}}),o.style.display="block",!1},t._laserEventHandler_mouseleave=function(e){return n._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",{action:{actionName:"hide"}}),o.style.display="none",!1},n._changeWhiteboardTemporaryDeawPermission(!1,t),t.selectLaserTool=!0,ue(r,"mousemove",t._laserEventHandler_mousemove),ue(i,"mouseenter",t._laserEventHandler_mouseenter),ue(i,"mouseleave",t._laserEventHandler_mouseleave),r.className=r.className.replace(/ cursor-none/g,""),r.className+=" cursor-none",t.laserPosition=t.laserPosition||{left:0,top:0},de(r,"mousemove",t._laserEventHandler_mousemove),de(i,"mouseenter",t._laserEventHandler_mouseenter),de(i,"mouseleave",t._laserEventHandler_mouseleave)}else n._changeWhiteboardTemporaryDeawPermission("tool_mouse"!==e,t),ue(r,"mousemove",t._laserEventHandler_mousemove),ue(i,"mouseenter",t._laserEventHandler_mouseenter),ue(i,"mouseleave",t._laserEventHandler_mouseleave),r.className=r.className.replace(/ cursor-none/g,""),o.style.display="none",t.selectLaserTool&&(n._sendWhiteboardMessageToSignallingServer(t,"laserMarkEvent",{action:{actionName:"hide"}}),t.selectLaserTool=!1)})}},{key:"_sendSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.idPrefix,i=t.data,r=t.name,o=t.assignId,a=t.do_not_save,s=t.expiresabs,l=t.associatedMsgID,c=t.associatedUserID;if(e){if(e.handler&&e.handler.sendSignallingToServer&&"function"==typeof e.handler.sendSignallingToServer){var d=e.filedata,u=d.currpage,h=d.fileid;if(void 0===u||void 0===h)return void L.Logger.error(B.logType,"[_sendSignallingToServer]whiteboardInstance.filedata do not contain  currpage or fileid , [ currpage , fileid ]is ["+u+","+h+"]!");i&&"string"==typeof i&&(i=JSON.parse(i)),i.whiteboardID=e.id,i.isBaseboard=e.isBaseboard,i.nickname=e.nickname,void 0!==e.dependenceBaseboardWhiteboardID&&(i.dependenceBaseboardWhiteboardID=e.dependenceBaseboardWhiteboardID),l=l||e.associatedMsgID,c=c||e.associatedUserID;var p=o||n+"###_"+r+"_"+h+"_"+u,f="__allExceptSender";"shapeSaveEvent"!==i.eventType&&"undoEvent"!==i.eventType&&"redoEvent"!==i.eventType&&"clearEvent"!==i.eventType||(f="__all");var m=Object.deepAssign({},i);"__all"!==f&&this._saveBasicTemplateWhiteboardSignallingData({name:r,id:p,toID:f,data:m,do_not_save:a,expiresabs:s,associatedMsgID:l,associatedUserID:c},"pubmsg"),e.handler.sendSignallingToServer(r,p,f,i,a,s,l,c)}}else L.Logger.error(B.logType,"[_sendSignallingToServer]whiteboardInstance is not exist!")}},{key:"_delSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.idPrefix,i=t.data,r=t.name,o=t.assignId;if(e){if(e.handler&&e.handler.delSignallingToServer&&"function"==typeof e.handler.delSignallingToServer){var a=e.filedata,s=a.currpage,l=a.fileid;if(void 0===s||void 0===l)return void L.Logger.error(B.logType,"[_delSignallingToServer]whiteboardInstance.filedata do not contain  currpage or fileid , [ currpage , fileid ]is ["+s+","+l+"]!");i.whiteboardID=e.id,i.isBaseboard=e.isBaseboard,void 0!==e.dependenceBaseboardWhiteboardID&&(i.dependenceBaseboardWhiteboardID=e.dependenceBaseboardWhiteboardID);var c=o||n+"###_"+r+"_"+l+"_"+s,d="__allExceptSender";"shapeSaveEvent"!==i.eventType&&"undoEvent"!==i.eventType&&"redoEvent"!==i.eventType&&"clearEvent"!==i.eventType||(d="__all");var u=Object.deepAssign({},i);"__all"!==d&&this._saveBasicTemplateWhiteboardSignallingData({name:r,id:c,toID:d,data:u},"delmsg"),e.handler.delSignallingToServer(r,c,d,i)}}else L.Logger.error(B.logType,"[_delSignallingToServer]whiteboardInstance is not exist!")}},{key:"_sendWhiteboardMessageToSignallingServer",value:function(e,t,n){var i,r,o,a,s,l,c;switch(t){case"shapeSaveEvent":if(null!=(l=window.LC.shapeToJSON(n.shape))&&null!=l.className&&("LinePath"==l.className||"ErasedLinePath"==l.className))l.data.smoothedPointCoordinatePairs=null,delete l.data.smoothedPointCoordinatePairs,l.data.pointCoordinatePairs.forEach(function(e){e[0]=Math.round(e[0]),e[1]=Math.round(e[1])});c={eventType:t,actionName:n.action.actionName,shapeId:n.shapeId,data:l},i=n.shapeId,r=c,o="SharpsChange",a=void 0,s=void 0,this._sendSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a,do_not_save:s});break;case"undoEvent":if("AddShapeAction"===n.action.actionName){var d=n.action.shapeId;i=d,r=c={eventType:t,actionName:n.action.actionName,shapeId:d},o="SharpsChange",a=void 0,this._delSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a})}else if("ClearAction"===n.action.actionName){var u=n.action.id;i=u,r=c={eventType:t,actionName:n.action.actionName,clearActionId:u},o="SharpsChange",a=void 0,this._delSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a})}break;case"redoEvent":if("AddShapeAction"===n.action.actionName){if(null!=(l=window.LC.shapeToJSON(n.action.shape))&&null!=l.className&&("LinePath"==l.className||"ErasedLinePath"==l.className))l.data.smoothedPointCoordinatePairs=null,delete l.data.smoothedPointCoordinatePairs,l.data.pointCoordinatePairs.forEach(function(e){e[0]=Math.round(e[0]),e[1]=Math.round(e[1])});var h=n.action.shapeId,p={authorUserId:n.action.authorUserId,seq:n.action.seq},f=h,m=c={eventType:t,actionName:n.action.actionName,shapeId:h,data:l,otherInfo:p};this._sendSignallingToServer(e,{idPrefix:f,data:m,name:"SharpsChange",assignId:void 0,do_not_save:void 0})}else if("ClearAction"===n.action.actionName){var g=n.action.id,v={authorUserId:n.action.authorUserId,seq:n.action.seq,toAuthorUserId:n.action.toAuthorUserId};i=g,r=c={eventType:t,actionName:n.action.actionName,clearActionId:g,otherInfo:v},o="SharpsChange",a=void 0,s=void 0,this._sendSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a,do_not_save:s})}break;case"clearEvent":var y=n.clearActionId;i=y,r=c={eventType:t,actionName:n.action.actionName,clearActionId:y},o="SharpsChange",a=void 0,s=void 0,e&&e.isOnlyUndoRedoClearMyselfShape&&e.myselfId&&(c.toAuthorUserId=e.myselfId),this._sendSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a,do_not_save:s});break;case"laserMarkEvent":c={eventType:t,actionName:n.action.actionName},n&&n.laser&&(c.laser=n.laser),i="laserMarkEvent",r=c,o="SharpsChange",a=void 0,s=!0,this._sendSignallingToServer(e,{idPrefix:i,data:r,name:o,assignId:a,do_not_save:s})}}},{key:"_updateTextFont",value:function(e){this._automaticTraverseWhiteboardInstance(e,function(e){var t=e.whiteboardToolsInfo.fontSize,n=e.whiteboardToolsInfo.fontFamily,i=e.whiteboardToolsInfo.fontStyle,r=e.whiteboardToolsInfo.fontWeight,o=e.lc.tool;"Text"===o.name&&(o.font=i+" "+r+" "+t+"px "+n)})}},{key:"_updateEraserWidth",value:function(e){this._automaticTraverseWhiteboardInstance(e,function(e){var t=e.whiteboardToolsInfo.eraserWidth;e.lc.trigger("setStrokeWidth",t)})}},{key:"_updatePencilWidth",value:function(e){this._automaticTraverseWhiteboardInstance(e,function(e){var t=e.whiteboardToolsInfo.pencilWidth;e.lc.trigger("setStrokeWidth",t)})}},{key:"_updateShapeWidth",value:function(e){this._automaticTraverseWhiteboardInstance(e,function(e){var t=e.whiteboardToolsInfo.shapeWidth;e.lc.trigger("setStrokeWidth",t)})}},{key:"_updateColor",value:function(e,t){if(t&&"object"===a()(t)){this._automaticTraverseWhiteboardInstance(e,function(e){for(var n=0,i=f()(t);n<i.length;n++){var r=i[n].replace(/Color/g,"");if(e.lc.setColor(r,e.whiteboardToolsInfo[r+"Color"]),"primary"!==r&&"secondary"!==r||"tool_rectangle"!==e.activeTool&&"tool_rectangle_empty"!==e.activeTool&&"tool_ellipse"!==e.activeTool&&"tool_ellipse_empty"!==e.activeTool&&"tool_polygon"!==e.activeTool||("tool_ellipse_empty"===e.activeTool||"tool_rectangle_empty"===e.activeTool?e.lc.setColor("secondary","transparent"):e.lc.setColor("secondary",e.whiteboardToolsInfo.primaryColor)),"primary"===r&&"tool_highlighter"===e.activeTool){var o=e.whiteboardToolsInfo[r+"Color"].colorRgb().toLowerCase().replace("rgb","rgba").replace(")",",0.5)");e.lc.setColor(r,o)}}})}}},{key:"_actionIsDisable",value:function(e){var t=this;t._automaticTraverseWhiteboardInstance(e,function(e){if(e.active){if(0===e.lc.shapes.length)t._batchUpdateToolDesc(e,[["action_clear",{disabled:!0}],["tool_eraser",{disabled:!0}],["tool_eyedropper",{disabled:!0}]]),t._noticeUpdateToolDesc(e);else{var n=[["action_clear",{disabled:!1}],["tool_eraser",{disabled:!1}],["tool_eyedropper",{disabled:!1}]];if(e.isOnlyUndoRedoClearMyselfShape&&e.myselfId){n=[["action_clear",{disabled:!0}],["tool_eraser",{disabled:!0}],["tool_eyedropper",{disabled:!0}]];for(var i=0;i<e.lc.shapes.length;i++)if(e.lc.shapes[i].authorUserId==e.myselfId){n=[["action_clear",{disabled:!1}],["tool_eraser",{disabled:!1}],["tool_eyedropper",{disabled:!1}]];break}}t._batchUpdateToolDesc(e,n),t._noticeUpdateToolDesc(e)}e.lc.canRedo()?(t._updateToolDesc(e,"action_redo",{disabled:!1}),t._noticeUpdateToolDesc(e)):(t._updateToolDesc(e,"action_redo",{disabled:!0}),t._noticeUpdateToolDesc(e)),e.lc.canUndo()?(t._updateToolDesc(e,"action_undo",{disabled:!1}),t._noticeUpdateToolDesc(e)):(t._updateToolDesc(e,"action_undo",{disabled:!0}),t._noticeUpdateToolDesc(e))}})}},{key:"_zoomIsDisable",value:function(e){var t=this;t._automaticTraverseWhiteboardInstance(e,function(e){if(e.active){var n=[];n=e.whiteboardMagnification<=t.minMagnification?[["zoom_small",{disabled:!0}],["zoom_default",{disabled:!0}],["zoom_big",{disabled:!1}]]:e.whiteboardMagnification>t.minMagnification&&e.whiteboardMagnification<t.maxMagnification?[["zoom_small",{disabled:!1}],["zoom_default",{disabled:!1}],["zoom_big",{disabled:!1}]]:[["zoom_small",{disabled:!1}],["zoom_default",{disabled:!1}],["zoom_big",{disabled:!0}]],t._batchUpdateToolDesc(e,n),t._noticeUpdateToolDesc(e)}})}},{key:"_toolIsUse",value:function(e){for(var t=0,n=f()(e.registerWhiteboardToolsList);t<n.length;t++){var i=n[t];/tool_/g.test(i)?e.registerWhiteboardToolsList[i].isUse=i===e.activeTool:/zoom_/g.test(i)&&(e.registerWhiteboardToolsList[i].zoom=e.whiteboardMagnification)}this._noticeUpdateToolDesc(e)}},{key:"_automaticTraverseWhiteboardInstance",value:function(e,t){if(e)t&&"function"==typeof t&&t(e);else for(var n=0,i=x()(this.whiteboardInstanceStore);n<i.length;n++){var r=i[n];t&&"function"==typeof t&&t(r)}}},{key:"_saveAwaitSaveToWhiteboardInstanceSignallingToWhiteboardInstance",value:function(e){for(var t=!1,n=0;n<this.awaitSaveToWhiteboardInstanceSignallingArray.length;n++){var i=this.awaitSaveToWhiteboardInstanceSignallingArray[n];if(i.data&&"string"==typeof i.data&&(i.data=JSON.parse(i.data)),i.data.whiteboardID===e.id){var r=i.id.substring(i.id.lastIndexOf("###_")+4);if(r){var o=r.split("_");r="".concat(o[0],"_").concat(o[1],"_").concat(o[2]),e.waitingProcessShapeData[r]?e.waitingProcessShapeData[r].push(i):(e.waitingProcessShapeData[r]=[],e.waitingProcessShapeData[r].push(i)),t=!0,this.awaitSaveToWhiteboardInstanceSignallingArray.splice(n,1,null)}}}if(t)for(var a=this.awaitSaveToWhiteboardInstanceSignallingArray.length-1;a>=0;a--)null===this.awaitSaveToWhiteboardInstanceSignallingArray[a]&&this.awaitSaveToWhiteboardInstanceSignallingArray.splice(a,1)}},{key:"_basicTemplateWhiteboardSignallingListToWhiteboardInstance",value:function(e){e.needLooadBaseboard&&!e.isBaseboard&&void 0!==e.dependenceBaseboardWhiteboardID&&!e.isHandleBasicTemplateWhiteboardSignallingList&&e.id!==e.dependenceBaseboardWhiteboardID&&this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID]&&w()(this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID])&&(this._batchReceiveSnapshot(this.basicTemplateWhiteboardSignallingList[e.dependenceBaseboardWhiteboardID],e),e.isHandleBasicTemplateWhiteboardSignallingList=!0)}},{key:"_convertCanvasToImage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"png";if(e&&e.lc&&e.lc.canvas){var n=e.lc.canvas,i=new Image;return i.src=n.toDataURL("image/"+t),i}}},{key:"_convertCanvasToImageBase64",value:function(e,t){if(e&&e.lc&&e.lc.canvas)return e.lc.canvas.toDataURL("image/"+t)}},{key:"_saveBasicTemplateWhiteboardSignallingData",value:function(e,t){e&&e.data&&e.data.isBaseboard&&void 0!==e.data.whiteboardID&&(e.source=t,this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID]=this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID]||[],this.basicTemplateWhiteboardSignallingList[e.data.whiteboardID].push(e))}},{key:"_handlerShowRemoteRemindContentFromPubmsgData",value:function(e,t){var n,i,r;if("pubmsg"===t.source&&t.data&&"shapeSaveEvent"===t.data.eventType)if("LinePath"==t.data.data.className){var o=t.data.data.points.length;o>0&&(n=t.data.data.points[o-1].x,i=t.data.data.points[o-1].y,r=t.remindContent),this._productionWhiteboardRemindContent(e,n,i,r,t.data.shapeId)}else"Rectangle"==t.data.data.className||"Ellipse"==t.data.data.className?(t.data.data.width>0&&t.data.data.height>0?(n=t.data.data.x+t.data.data.width,i=t.data.data.y):t.data.data.width>0&&t.data.data.height<0?(n=t.data.data.x+t.data.data.width,i=t.data.data.y+t.data.data.height):t.data.data.width<0&&t.data.data.height<0?(n=t.data.data.x,i=t.data.data.y+t.data.data.height):t.data.data.width<0&&t.data.data.height>0&&(n=t.data.data.x,i=t.data.data.y),r=t.remindContent,this._productionWhiteboardRemindContent(e,n,i,r,t.data.shapeId)):"Text"==t.data.data.className?(n=t.data.data.x+t.data.data.renderer.metrics.width,i=t.data.data.y+20*t.data.data.renderer.metricses.length,r=t.remindContent,this._productionWhiteboardRemindContent(e,n,i,r,t.data.shapeId)):"Line"==t.data.data.className&&(n=t.data.data.x2,i=t.data.data.y2,r=t.remindContent,this._productionWhiteboardRemindContent(e,n,i,r,t.data.shapeId))}},{key:"_noticeNpdateWhiteboardToolsInfo",value:function(e){e.handler&&"function"==typeof e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("updateWhiteboardToolsInfo",{id:e.id,whiteboardToolsInfo:Object.deepAssign({},e.whiteboardToolsInfo)})}}]),e}()),pe=n(51),fe=n.n(pe),me=new(function(){function e(){g()(this,e)}return y()(e,[{key:"createElement",value:function(e,t,n,i,r){var o=document.createElement(e);if(void 0!==t&&o.setAttribute("id",t),void 0!==n&&(o.className=n),i&&"object"===a()(i))for(var s=0,l=h()(i);s<l.length;s++){var c=d()(l[s],2),u=c[0],p=c[1];o.style[u]=p}if(r&&"object"===a()(r))for(var f=0,m=h()(r);f<m.length;f++){var g=d()(m[f],2),v=g[0],y=g[1];o.setAttribute(v,y)}return o}},{key:"appendChild",value:function(e,t){try{e&&t&&e.appendChild&&e.appendChild(t)}catch(e){L.Logger.error(B.logType,"[sdk-whiteboard]DoomUtils.appendChild error ",e)}}},{key:"removeChild",value:function(e,t){try{e&&(t&&t.removeChild?t.removeChild(e):e.parentNode&&e.parentNode.removeChild&&e.parentNode.removeChild(e))}catch(e){L.Logger.error(B.logType,"[sdk-whiteboard]DoomUtils.removeChild error ",e)}}},{key:"removeAllChild",value:function(e){e&&(e.innerHTML="")}},{key:"hasClass",value:function(e,t){return!(!e||"string"!=typeof t)&&(new RegExp(" "+t+" ").test(e.className)||new RegExp(" "+t).test(e.className)||new RegExp(t+" ").test(e.className))}},{key:"resetClass",value:function(e,t){e&&"string"==typeof t&&(e.className=" "+t)}},{key:"addClass",value:function(e,t){if(e)if("string"==typeof t)e.className?e.className=e.className.replace(new RegExp(" "+t,"g"),"").replace(new RegExp(t+" ","g"),"")+" "+t:e.className=" "+t;else if(w()(t)){var n=!0,i=!1,r=void 0;try{for(var o,a=W()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e.className?e.className=e.className.replace(new RegExp(" "+s,"g"),"").replace(new RegExp(s+" ","g"),"")+" "+s:e.className=" "}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}},{key:"removeClass",value:function(e,t){if(e)if("string"==typeof t)e.className?e.className=e.className.replace(new RegExp(" "+t,"g"),"").replace(new RegExp(t+" ","g"),""):e.className=" ";else if(w()(t)){var n=!0,i=!1,r=void 0;try{for(var o,a=W()(t);!(n=(o=a.next()).done);n=!0){var s=o.value;e.className?e.className=e.className.replace(new RegExp(" "+s,"g"),"").replace(new RegExp(s+" ","g"),""):e.className=" "}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}},{key:"updateStyle",value:function(e,t){if(e&&t&&"object"===a()(t))for(var n=0,i=h()(t);n<i.length;n++){var r=d()(i[n],2),o=r[0],s=r[1];e.style[o]=s}}},{key:"show",value:function(e){if(w()(e)){var t=!0,n=!1,i=void 0;try{for(var r,o=W()(e);!(t=(r=o.next()).done);t=!0){var a=r.value;this.updateStyle(a,{display:""})}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}else this.updateStyle(e,{display:""})}},{key:"hide",value:function(e){if(w()(e)){var t=!0,n=!1,i=void 0;try{for(var r,o=W()(e);!(t=(r=o.next()).done);t=!0){var a=r.value;this.updateStyle(a,{display:"none"})}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}}else this.updateStyle(e,{display:"none"})}}]),e}()),ge=n(52),ve=n.n(ge),ye=new(function(){function e(){g()(this,e),this.defaultProductionOptions={synchronizationDynamicPpt:!0,dynamicPptActionClick:!0,maxForceReloadNumber:10,forceReloadInterval:6e4,languageType:"ch"},this.dynamicPptInstanceIDPrefix="dynamicPpt_",this.dynamicPptInstanceDefaultID="dynamicPpt_default",this.dynamicPptInstanceStore={},this.uniqueDynamicPpt=!1,this.specialDynamicPptInstanceIDPrefix="specialDynamicPptInstanceIDPrefix_",this.slideLoadFile={timer:null,pptslide:-1,fileid:-1}}return y()(e,[{key:"productionDynamicPpt",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.dynamicPptElementId,i=t.productionOptions,r=void 0===i?{}:i,o=t.handler,a=void 0===o?{}:o,s=t.id;if(n){var l=this._getDynamicPptInstanceID(s),c=this.getDynamicPptInstanceByID(l);if(c)return L.Logger.error(B.logType,"The production dynamicPpt(dynamicPptInstanceID:"+l+") fails, the dynamicPpt already exists!"),c;c={},r=Object.deepAssign({},this.defaultProductionOptions,r);var d=document.getElementById(n);if(!d)return L.Logger.error(B.logType,"DynamicPpt elements do not exist , element id is:"+n+"!"),c;var u=document.createElement("div"),h=n+"_dynamicPptInstance";u.className="dynamicPpt-instance-element",u.id=h,u.style.width="100%",u.style.height="100%";var p=document.createElement("iframe"),f=n+"_dynamicPptIframe";p.className="dynamicPpt-iframe-element",p.id=f,p.name=n+"_dynamicPptIframeName",p.allowFullScreen=!0,p.frameborder=0,p.scrolling="no",p.allow="autoplay",p.width="100%",p.height="100%",p.style.width="100%",p.style.height="100%",p.style.border="none",p.style.padding="0",p.style.margin="0",u.appendChild(p);var m=document.createElement("div"),g=n+"_dynamicPptLoading";m.className="dynamicPpt-loading-element roadofcloud-loading",m.id=g;var v=document.createElement("span");v.className="ys-loading-reload-number",v.style.display="none",m.appendChild(v),u.appendChild(m);var y=document.createElement("div"),b=n+"_dynamicPptAction";return y.className="dynamicPpt-action-element roadofcloud-action",y.style.width="100%",y.style.height="100%",y.style.zIndex=98,y.style.display=r.dynamicPptActionClick?"none":"block",y.style.position="absolute",y.style.top="0",y.style.left="0",y.id=b,u.appendChild(y),u.appendChild(y),d.appendChild(u),this.dynamicPptInstanceStore[l]=c,c.dynamicPptInstanceID=l,c.handler={},c.handler.sendSignallingToServer=a.sendSignallingToServer,c.handler.delSignallingToServer=a.delSignallingToServer,c.handler.receiveActionCommandCallback=a.receiveActionCommandCallback,c.dynamicPptElementId=n,c.dynamicPptElement=d,c.dynamicPptInstanceElementId=h,c.dynamicPptInstanceElement=u,c.dynamicPptIframeElementId=f,c.dynamicPptIframeElement=p,c.dynamicPptLoadingElementId=g,c.dynamicPptLoadingElement=m,c.dynamicPptReloadNumberElement=v,c.dynamicPptActionElementId=b,c.dynamicPptActionElement=y,c.id=s,c.remoteData={},c.awitExecutePostMessageArray=[],c.dynamicPptActionJson={},c.associatedMsgID=r.associatedMsgID,c.associatedUserID=r.associatedUserID,c.synchronizationDynamicPpt=r.synchronizationDynamicPpt,c.dynamicPptActionClick=r.dynamicPptActionClick,c.forceReloadNumber=0,c.maxForceReloadNumber=r.maxForceReloadNumber,c.forceReloadInterval=r.forceReloadInterval,c.isShowReloadFileTip=r.isShowReloadFileTip,c.languageType=r.languageType,c.isMeeting=r.isMeeting,c.againreconnectNum=0,r.againreconnectElementParentNode&&(c.againreconnectElementParentNode=r.againreconnectElementParentNode),c.dynamicPptIframeElement.onload=function(){clearTimeout(c.forceReloadNumberTimer),c.forceReloadNumberTimer=null,c.forceReloadNumber<c.maxForceReloadNumber&&e._iframeReloadMonitor(c,"dynamicPptLoaded")},c}L.Logger.error(B.logType,"dynamicPptElementId is required!")}},{key:"destroyDynamicPptInstance",value:function(e){var t=this.getDynamicPptInstanceByID(e);t?this._destroyDynamicPptInstance(t):L.Logger.error(B.logType,"[destroy]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"receiveWindowMessageEvent",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);n?t.source===n.dynamicPptIframeElement.contentWindow&&this._receiveWindowMessageEvent(e,n,t):L.Logger.error(B.logType,"[receiveWindowMessageEvent]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"changeDynamicPptSize",value:function(e){var t=this,n=this.getDynamicPptInstanceByID(e);if(n){var i={action:"resizeHandler",width:n.dynamicPptElement.clientWidth,height:n.dynamicPptElement.clientHeight};this._postMessage(n,i),setTimeout(function(){var e={action:"resizeHandler",width:n.dynamicPptElement.clientWidth,height:n.dynamicPptElement.clientHeight};t._postMessage(n,e)},250)}else L.Logger.error(B.logType,"[changeDynamicPptSize]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"hasDynamicPptById",value:function(e){var t=this.getDynamicPptInstanceByID(e);return null!=t}},{key:"setDynamicPptIframeSrc",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this.getDynamicPptInstanceByID(e);if(o){var a="";o.isLoadFinished=!1,o.awitExecutePostMessageArray.length=0,clearTimeout(o.forceReloadNumberTimer),o.forceReloadNumberTimer=null,o.forceReloadNumber=r.forceReloadNumber||0;var s=i.fileid,l=i.pptslide,c=i.pptstep;if(o.playback=r.playback,o.againreconnectElement&&(o.againreconnectElement.parentNode&&o.againreconnectElement.parentNode.removeChild(o.againreconnectElement),o.againreconnectElement=void 0),s==o.fileid&&t&&r.isAgainreconnect||(o.againreconnectNum=0),o.fileid=s,o.awitJumpToAnimPptslide=l,o.awitJumpToAnimPptstep=c,n.isClientPlayAudio=!0,t){a=t;for(var u=!1,p=0,f=h()(n);p<f.length;p++){var m=d()(f[p],2),g=m[0],v=m[1];null!=v&&(u?a+="&"+g+"="+v:(u=!0,a+=(/\?/g.test(a)?"&":"?")+g+"="+v))}o.iframeSrc=a,this._showLoading(o),this._iframeReloadMonitor(o,"setDynamicPptIframeSrc")}else o.iframeSrc=a;r.isAgainreconnect&&(o.dynamicPptIframeElement.src=""),o.dynamicPptIframeElement.src=a,L.Logger.debug(B.logType,"set dynamic ppt src:",a)}else L.Logger.error(B.logType,"[setDynamicPptIframeSrc]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"getIframeSrc",value:function(e){var t=this.getDynamicPptInstanceByID(e);if(t)return t.iframeSrc;L.Logger.error(B.logType,"[getIframeSrc]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"jumpToAnimation",value:function(e,t,n,i,r,o){var a=this.getDynamicPptInstanceByID(e);a?this._jumpToAnimation(a,t,n,i,r,o):L.Logger.error(B.logType,"[jumpToAnimation]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"nextSlide",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);n?n.isLoadFinished?n.remoteData&&n.remoteData.pptslide>=n.remoteData.pptslidesCount?L.Logger.warning(B.logType,"[nextPage]dynamic ppt is on the last page , cannot execute nextPage method."):this._postMessage(n,{action:"gotoNextSlide",autoStart:t}):L.Logger.info(B.logType,"[nextPage]dynamic ppt is not load finished  , cannot execute nextPage method"):L.Logger.error(B.logType,"[nextPage]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"prevSlide",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);n?n.isLoadFinished?n.remoteData&&n.remoteData.pptslide<=1?L.Logger.warning(B.logType,"[prevPage]dynamic ppt is  on page 1 , cannot execute prevPage method."):this._postMessage(n,{action:"gotoPreviousSlide",autoStart:t}):L.Logger.info(B.logType,"[prevPage]dynamic ppt is not load finished  , cannot execute prevPage method"):L.Logger.error(B.logType,"[prevPage]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"nextStep",value:function(e){var t=this.getDynamicPptInstanceByID(e);t?t.isLoadFinished?this._postMessage(t,{action:"gotoNextStep"}):L.Logger.info(B.logType,"[nextStep]dynamic ppt is not load finished  , cannot execute nextStep method"):L.Logger.error(B.logType,"[nextStep]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"prevStep",value:function(e){var t=this.getDynamicPptInstanceByID(e);t?t.isLoadFinished?this._postMessage(t,{action:"gotoPreviousStep"}):L.Logger.info(B.logType,"[prevStep]dynamic ppt is not load finished  , cannot execute prevStep method"):L.Logger.error(B.logType,"[prevStep]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"updateDynamicPptProperty",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);n?(void 0!==t.associatedMsgID&&(n.associatedMsgID=t.associatedMsgID),void 0!==t.associatedUserID&&(n.associatedUserID=t.associatedUserID),void 0!==t.synchronizationDynamicPpt&&(n.synchronizationDynamicPpt=t.synchronizationDynamicPpt,this._postMessage(n,{action:"changePublishDynamicPptMediaPermission_video",publishDynamicPptMediaPermission_video:n.synchronizationDynamicPpt})),void 0!==t.dynamicPptActionClick&&(n.dynamicPptActionClick=t.dynamicPptActionClick,n.dynamicPptActionElement.style.display=n.dynamicPptActionClick?"none":"block",this._postMessage(n,{action:"changeDynamicPptActionClick",dynamicPptActionClick:n.dynamicPptActionClick})),void 0!==t.canPage&&this._postMessage(n,{action:"changeNewpptPagingPage",newpptPagingPage:t.canPage}),void 0!==t.isShowReloadFileTip&&(n.isShowReloadFileTip=t.isShowReloadFileTip),void 0!==t.languageType&&(n.languageType=t.languageType,this._isShowReloadFileShowReloadNumber(n),n.againreconnectElement&&this._setAgainreconnectInfo(n))):L.Logger.error(B.logType,"[updateDynamicPptProperty]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"postMessageDynamicPptTriggerAction",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);if(n){var i=t.slide,r=t.fileid;n.fileid!=r||n.remoteData.pptslide!==i+1?(n.dynamicPptActionJson[i+1]=n.dynamicPptActionJson[i+1]||[],n.dynamicPptActionJson[i+1].push(t)):this._postMessage(n,t)}else L.Logger.error(B.logType,"[postMessageDynamicPptTriggerAction]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"postMessage",value:function(e,t){var n=this.getDynamicPptInstanceByID(e);n?this._postMessage(n,t):L.Logger.error(B.logType,"[postMessage]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"isLoadFinished",value:function(e){var t=this.getDynamicPptInstanceByID(e);if(t)return t.isLoadFinished;L.Logger.error(B.logType,"[isLoadFinished]There are no dynamic ppt Numbers that belong to id "+e)}},{key:"getDynamicPptInstanceByID",value:function(e){var t=this._getDynamicPptInstanceID(e);return this.dynamicPptInstanceStore[t]}},{key:"_jumpToAnimation",value:function(e,t,n,i,r,o){clearTimeout(this.slideLoadFile.timer),this.slideLoadFile={timer:null,pptslide:t,fileid:e.fileid},this.slideLoadFile.timer=setTimeout(function(){e.handler.receiveActionCommandCallback("slideLoadTimeout",{id:e.id,loadTimeoutFile:{pptslide:t,pptstep:n,currpage:t,steptotal:e.remoteData.pptstepTotal,fileid:e.fileid,pagenum:e.remoteData.pptslidesCount},fileType:"PPT"})},6e4),e.isLoadFinished&&(e.remoteData.pptslide>e.remoteData.pptslidesCount||e.remoteData.pptslide<1)&&(e.remoteData.pptslide>e.remoteData.pptslidesCount&&(t=e.remoteData.pptslidesCount,e.remoteData.pptslide=e.remoteData.pptslidesCount),e.remoteData.pptslide<1&&(t=1,e.remoteData.pptslide=1),e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("dynamicPptSlideChange",{id:e.id,updateFileData:{pptslide:e.remoteData.pptslide,pptstep:e.remoteData.pptstep,currpage:e.remoteData.pptslide,steptotal:e.remoteData.pptstepTotal,fileid:e.fileid,pagenum:e.remoteData.pptslidesCount}}));var a={action:"jumpToAnim",data:{slide:t,step:n,timeOffset:r,autoStart:o,initiative:i}};this._postMessage(e,a)}},{key:"_postMessage",value:function(e,t){if(e.isLoadFinished)try{if(e.dynamicPptIframeElement&&e.dynamicPptIframeElement.src){var n={source:"ys_dynamicPPT",data:t};n=l()(n),e.dynamicPptIframeElement&&e.dynamicPptIframeElement.contentWindow&&e.dynamicPptIframeElement.contentWindow.postMessage&&(L.Logger.debug(B.logType,"[_postMessage]dynamic ppt postMessage instanceId is "+e.id+",sendData:"+n),e.dynamicPptIframeElement.contentWindow.postMessage(n,"*"))}}catch(e){L.Logger.error(B.logType,"[_postMessage] dynamic ppt postMessage error:",e)}else e.awitExecutePostMessageArray.push(t)}},{key:"_showLoading",value:function(e){e.dynamicPptLoadingElement.style.display="block",this._isShowReloadFileShowReloadNumber(e)}},{key:"_hideLoading",value:function(e){e.dynamicPptLoadingElement.style.display="none",this._isShowReloadFileShowReloadNumber(e)}},{key:"_getDynamicPptInstanceID",value:function(e){var t=this.uniqueDynamicPpt||null==e?this.dynamicPptInstanceDefaultID:this.dynamicPptInstanceIDPrefix+e;e&&"string"==typeof e&&(new RegExp(this.specialDynamicPptInstanceIDPrefix,"g").test(e)&&(t=e));return t}},{key:"_destroyDynamicPptInstance",value:function(e){var t=e.dynamicPptInstanceID,n=e.dynamicPptElement;n?n.innerHTML="":L.Logger.warning(B.logType,"[destroy] dynamicPpt elements do not exist , element id is:"+e.dynamicPptElementId+"!");for(var i=0,r=f()(e);i<r.length;i++){var o=r[i];e[o]=null,delete e[o]}this.dynamicPptInstanceStore[t]=null,delete this.dynamicPptInstanceStore[t]}},{key:"_receiveWindowMessageEvent",value:function(e,t,n){var i=this;if(n.data){var r=void 0,o=void 0;try{r=(o=JSON.parse(n.data)).data}catch(e){return void L.Logger.warning(B.logType,"dynamic ppt receive iframe message data can't be converted to JSON , iframe data:",n.data)}if(o&&"ys_dynamicPPT"===o.source){L.Logger.debug(B.logType,"[dynamicPpt]receive remote iframe data form "+n.origin+":",n);switch(r.action){case"initEvent":this._handleIframeMessage_initEvent(t,r);break;case"slideChangeEvent":case"stepChangeEvent":this._handleIframeMessage_slideOrStepChangeEvent(t,r,r.action);break;case"autoPlayVideoInNewPpt":this._handleIframeMessage_autoPlayVideoInNewPpt(t,r);break;case"clinetAudioPlayer":this._handleIframeMessage_autoPlayAudioInNative(t,r);break;case"clickNewpptTriggerEvent":this._handleIframeMessage_clickNewpptTriggerEvent(e,t,r);break;case"allVideoAndAudio":case"clickLink":break;case"againReconnect":if(L.Logger.warning(B.logType,"[dynamic ppt]again reconnect info from dynamic ppt inner, again reconnect number is "+t.againreconnectNum),t.againreconnectNum++,t.againreconnectNum<=1)t.handler&&t.handler.receiveActionCommandCallback&&t.handler.receiveActionCommandCallback("reloadCurrentDocument",{id:t.id,iframeSrc:t.iframeSrc,fileid:t.fileid,forceReloadNumber:t.forceReloadNumber,isAgainreconnect:!0});else{if(t.againreconnectElement&&t.againreconnectElement.parentNode&&t.againreconnectElement.parentNode.removeChild(t.againreconnectElement),t.playback)return;t.againreconnectElement=document.createElement("div"),t.againreconnectElement.className="againreconnect-container";var a=document.createElement("div");a.className="againreconnect-box";var s=document.createElement("span");s.className="top-box title";var l=document.createElement("span");l.className="middle-box point-icon";var c=document.createElement("span");c.className="bottom-box ok-container";var d=document.createElement("button");d.className="ok-btn",d.onclick=function(){i._postMessage(t,{action:"userTriggerAudio"}),t.againreconnectElement&&t.againreconnectElement.parentNode&&t.againreconnectElement.parentNode.removeChild(t.againreconnectElement),t.againreconnectElement=void 0},d.ontouchend=function(){i._postMessage(t,{action:"userTriggerAudio"}),t.againreconnectElement&&t.againreconnectElement.parentNode&&t.againreconnectElement.parentNode.removeChild(t.againreconnectElement),t.againreconnectElement=void 0},c.appendChild(d),a.appendChild(s),a.appendChild(l),a.appendChild(c),t.againreconnectElement.appendChild(a),(t.againreconnectElementParentNode||t.dynamicPptInstanceElement).appendChild(t.againreconnectElement),this._setAgainreconnectInfo(t)}}}}}},{key:"_handleIframeMessage_initEvent",value:function(e,t){if(clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.remoteData.pptview=t.view,e.remoteData.pptslidesCount=t.slidesCount,e.remoteData.pptslide=t.slide+1,e.remoteData.pptstep=t.step,e.remoteData.pptstepTotal=t.stepTotal,e.handler&&e.handler.receiveActionCommandCallback&&(e.handler.receiveActionCommandCallback("dynamicPptSlideChange",{id:e.id,updateFileData:{pptslide:e.remoteData.pptslide,pptstep:e.remoteData.pptstep,currpage:e.remoteData.pptslide,steptotal:e.remoteData.pptstepTotal,fileid:e.fileid,pagenum:e.remoteData.pptslidesCount}}),e.handler.receiveActionCommandCallback("updateWhiteboardWatermarkImageScale",{id:e.id,scale:e.remoteData.pptview.width/e.remoteData.pptview.height}),e.handler.receiveActionCommandCallback("dynamicPptLoadEnd",{id:e.id,scale:e.remoteData.pptview.width/e.remoteData.pptview.height,reloadNumber:e.forceReloadNumber,success:!0})),e.isLoadFinished||(e.isLoadFinished=!0,void 0!==e.awitJumpToAnimPptslide&&(this._jumpToAnimation(e,e.awitJumpToAnimPptslide,e.awitJumpToAnimPptstep),e.awitJumpToAnimPptslide=void 0,e.awitJumpToAnimPptstep=void 0,delete e.awitJumpToAnimPptslide,delete e.awitJumpToAnimPptstep)),e.awitExecutePostMessageArray&&e.awitExecutePostMessageArray.length>0){var n=!0,i=!1,r=void 0;try{for(var o,a=W()(e.awitExecutePostMessageArray);!(n=(o=a.next()).done);n=!0){var s=o.value;this._postMessage(e,s)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}e.awitExecutePostMessageArray.length=0,this._hideLoading(e)}},{key:"_handleIframeMessage_slideOrStepChangeEvent",value:function(e,t,n){if(e.remoteData.pptslide=t.slide+1,e.remoteData.pptstep=t.step,e.remoteData.pptstepTotal=t.stepTotal,e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("slideChangeEvent"===n?"dynamicPptSlideChange":"dynamicPptStepChange",{id:e.id,updateFileData:{pptslide:e.remoteData.pptslide,pptstep:e.remoteData.pptstep,currpage:e.remoteData.pptslide,steptotal:e.remoteData.pptstepTotal,fileid:e.fileid,pagenum:e.remoteData.pptslidesCount}}),e.fileid===this.slideLoadFile.fileid&&e.remoteData.pptslide===this.slideLoadFile.pptslide&&clearTimeout(this.slideLoadFile.timer),f()(e.dynamicPptActionJson).length>0&&e.dynamicPptActionJson[e.remoteData.pptslide]&&0!==e.dynamicPptActionJson[e.remoteData.pptslide].length){var i=!0,r=!1,o=void 0;try{for(var a,s=W()(e.dynamicPptActionJson[e.remoteData.pptslide]);!(i=(a=s.next()).done);i=!0){var l=a.value;this._postMessage(e,l)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}e.dynamicPptActionJson[e.remoteData.pptslide].length=0,delete e.dynamicPptActionJson[e.remoteData.pptslide]}t.externalData&&t.externalData.initiative&&(this._sendSignalling_ShowPage(e,{data:{action:"slideChangeEvent"===n?"slide":"step"}}),e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("closeAllSelectBox",{id:e.id}))}},{key:"_handleIframeMessage_autoPlayVideoInNewPpt",value:function(e,t){if(e.handler&&e.handler.receiveActionCommandCallback){var n=t.isvideo,i=t.url,r=t.fileid,o={id:e.id,url:i,video:n,audio:!0,attributes:{source:"dynamicPPT",filename:"",fileid:r}};e.handler.receiveActionCommandCallback("publishDymanicPptNetworkMedia",o)}}},{key:"_handleIframeMessage_autoPlayAudioInNative",value:function(e,t){if(e.handler&&e.handler.receiveActionCommandCallback){var n=t.isPlay,i=t.url,r=t.fileid,o=ve()(t,["isPlay","url","fileid"]),a={id:e.id,url:i,isPlay:n,audio:!0,attributes:{source:"dynamicPPT",filename:"",fileid:r,type:"audio",other:o,currentPage:e.remoteData.pptslide}};e.handler.receiveActionCommandCallback("publishDymanicPptNetworkAudio",a)}}},{key:"_handleIframeMessage_clickNewpptTriggerEvent",value:function(e,t,n){n.externalData&&n.externalData.initiative&&(n.fileid=t.fileid,n.sourceInstanceId=e,this._sendSignallingToServer(t,{name:"default"===e?"NewPptTriggerActionClick":"ExtendNewPptTriggerActionClick",id:"default"===e?"NewPptTriggerActionClick":"NewPptTriggerActionClick_".concat(e),toID:"__allExceptSender",data:n}),t.handler&&t.handler.receiveActionCommandCallback&&t.handler.receiveActionCommandCallback("closeAllSelectBox",{id:t.id}))}},{key:"_sendSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.name,i=t.id,r=t.toID,o=void 0===r?"__all":r,a=t.data,s=t.do_not_save,l=t.expiresabs,c=t.associatedMsgID,d=t.associatedUserID;e.handler&&e.handler.sendSignallingToServer&&(c=c||e.associatedMsgID,d=d||e.associatedUserID,e.handler.sendSignallingToServer(n,i,o,a,s,l,c,d))}},{key:"_iframeReloadMonitor",value:function(e,t){var n=this;clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.iframeSrc&&!e.isLoadFinished&&(e.forceReloadNumber<e.maxForceReloadNumber?e.forceReloadNumberTimer=setTimeout(function(){e.iframeSrc&&!e.isLoadFinished&&e.forceReloadNumber<e.maxForceReloadNumber&&(e.forceReloadNumber++,n._isShowReloadFileShowReloadNumber(e),e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("reloadDynamicPptIframeSrc",{id:e.id,iframeSrc:e.iframeSrc,source:t,fileid:e.fileid,forceReloadNumber:e.forceReloadNumber}))},e.forceReloadInterval):e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("reloadDynamicPptFail",{id:e.id,forceReloadNumber:e.maxForceReloadNumber,success:!1}))}},{key:"_sendSignalling_ShowPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("sendSignalling_ShowPage",{id:e.id,updatePubmsgData:t})}},{key:"_isShowReloadFileShowReloadNumber",value:function(e){e.dynamicPptReloadNumberElement.style.display=e.isShowReloadFileTip&&e.forceReloadNumber?"inline-table":"none";var t="当前网络不稳定，正在尝试重新打开课件……第"+e.forceReloadNumber+"次";if(e.isMeeting)switch(t="当前网络不稳定，正在尝试重新打开素材……第"+e.forceReloadNumber+"次",e.languageType){case"tw":t="當前網絡不穩定，正在嘗試重新打開素材……第"+e.forceReloadNumber+"次";break;case"en":t="The network is unstable , Trying to reopen the courseware ..."+e.forceReloadNumber;break;case"ja":t="ネットが不安定です、素材を開きなおしています"+e.forceReloadNumber+"次"}else switch(e.languageType){case"tw":t="當前網絡不穩定，正在嘗試重新打開課件……第"+e.forceReloadNumber+"次";break;case"en":t="The network is unstable , Trying to reopen the courseware ..."+e.forceReloadNumber;break;case"ja":t="ネットが不安定です、教材を開きなおしています"+e.forceReloadNumber+"次"}e.dynamicPptReloadNumberElement.innerHTML=t||""}},{key:"_setAgainreconnectInfo",value:function(e){if(e.againreconnectElement){var t=e.againreconnectElement.getElementsByClassName("top-box")[0],n=e.againreconnectElement.getElementsByClassName("ok-btn")[0];if(t||n){var i="加载有点慢......",r="点此继续";switch(e.languageType){case"tw":i="加載有點慢......",r="點此繼續";break;case"en":i="Loading a bit slow...",r="Click to continue";break;case"ja":i="インストールに時間がかかっています。...",r="続行する"}t&&(t.innerHTML=i),n&&(n.innerHTML=r)}}}}]),e}()),be=new(function(){function e(){g()(this,e),this.defaultProductionOptions={synchronizationH5Document:!0,h5DocumentActionClick:!0,maxForceReloadNumber:10,forceReloadInterval:6e4,languageType:"ch"},this.h5DocumentInstanceIDPrefix="h5Document_",this.h5DocumentInstanceDefaultID="h5Document_default",this.h5DocumentInstanceStore={},this.uniqueH5Document=!1,this.specialH5DocumentInstanceIDPrefix="specialH5DocumentInstanceIDPrefix_"}return y()(e,[{key:"productionH5Document",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.h5DocumentElementId,i=t.productionOptions,r=void 0===i?{}:i,o=t.handler,a=void 0===o?{}:o,s=t.id;if(n){var l=this._getH5DocumentInstanceID(s),c=this.getH5DocumentInstanceByID(l);if(c)return L.Logger.error(B.logType,"The production h5Document(h5DocumentInstanceID:"+l+") fails, the h5Document already exists!"),c;c={},r=Object.deepAssign({},this.defaultProductionOptions,r);var d=document.getElementById(n);if(!d)return L.Logger.error(B.logType,"H5Document elements do not exist , element id is:"+n+"!"),c;var u=document.createElement("div"),h=n+"_h5DocumentInstance";u.className="h5Document-instance-element",u.id=h,u.style.width="100%",u.style.height="100%";var p=document.createElement("iframe"),f=n+"_h5DocumentIframe";p.className="h5Document-iframe-element",p.id=f,p.name=n+"_h5DocumentIframeName",p.allowFullScreen=!0,p.allow="autoplay",p.frameborder=0,p.scrolling="no",p.width="1px",p.height="100%",p.style.width="1px",p.style.minWidth="100%",p.style.height="100%",p.style.border="none",p.style.padding="0",p.style.margin="0",u.appendChild(p);var m=document.createElement("div"),g=n+"_h5DocumentLoading";m.className="h5Document-loading-element roadofcloud-loading",m.id=g;var v=document.createElement("span");v.className="ys-loading-reload-number",v.style.display="none",m.appendChild(v),u.appendChild(m);var y=document.createElement("div"),b=n+"_h5DocumentAction";return y.className="h5Document-action-element roadofcloud-action",y.style.width="100%",y.style.height="100%",y.style.zIndex=98,y.style.display=r.h5DocumentActionClick?"none":"block",y.style.position="absolute",y.style.top="0",y.style.left="0",y.id=b,u.appendChild(y),u.appendChild(y),d.appendChild(u),this.h5DocumentInstanceStore[l]=c,c.h5DocumentInstanceID=l,c.handler={},c.handler.sendSignallingToServer=a.sendSignallingToServer,c.handler.delSignallingToServer=a.delSignallingToServer,c.handler.receiveActionCommandCallback=a.receiveActionCommandCallback,c.h5DocumentElementId=n,c.h5DocumentElement=d,c.h5DocumentInstanceElementId=h,c.h5DocumentInstanceElement=u,c.h5DocumentIframeElementId=f,c.h5DocumentIframeElement=p,c.h5DocumentLoadingElementId=g,c.h5DocumentLoadingElement=m,c.h5DocumentReloadNumberElement=v,c.h5DocumentActionElementId=b,c.h5DocumentActionElement=y,c.id=s,c.awitExecutePostMessageArray=[],c.h5DocumentActionJson={},c.associatedMsgID=r.associatedMsgID,c.associatedUserID=r.associatedUserID,c.synchronizationH5Document=r.synchronizationH5Document,c.h5DocumentActionClick=r.h5DocumentActionClick,c.forceReloadNumber=0,c.maxForceReloadNumber=r.maxForceReloadNumber,c.forceReloadInterval=r.forceReloadInterval,c.isShowReloadFileTip=r.isShowReloadFileTip,c.languageType=r.languageType,c.isMeeting=r.isMeeting,c.h5DocumentIframeElement.onload=function(){clearTimeout(c.forceReloadNumberTimer),c.forceReloadNumberTimer=null,c.forceReloadNumber<c.maxForceReloadNumber&&e._iframeReloadMonitor(c,"h5DocumentLoaded")},c}L.Logger.error(B.logType,"h5DocumentElementId is required!")}},{key:"destroyH5DocumentInstance",value:function(e){var t=this.getH5DocumentInstanceByID(e);t?this._destroyH5DocumentInstance(t):L.Logger.error(B.logType,"[destroy]There are no h5 document Numbers that belong to id "+e)}},{key:"receiveWindowMessageEvent",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);n?t.source===n.h5DocumentIframeElement.contentWindow&&this._receiveWindowMessageEvent(e,n,t):L.Logger.error(B.logType,"[receiveWindowMessageEvent]There are no h5 document Numbers that belong to id "+e)}},{key:"hasH5DocumentById",value:function(e){var t=this.getH5DocumentInstanceByID(e);return null!=t}},{key:"setH5DocumentIframeSrc",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=this.getH5DocumentInstanceByID(e);if(o){var a="";o.isLoadFinished=!1,o.isReceivePagenum=!1,clearTimeout(o.h5DocumentActionTimer),clearTimeout(o.forceReloadNumberTimer),o.forceReloadNumberTimer=null,o.forceReloadNumber=r.forceReloadNumber||0;var s=i.fileid;if(o.fileid=s,t){a=t;for(var l=!1,c=0,u=h()(n);c<u.length;c++){var p=d()(u[c],2),f=p[0],m=p[1];l?a+="&"+f+"="+m:(l=!0,a+=(/\?/g.test(a)?"&":"?")+f+"="+m)}o.iframeSrc=a,this._showLoading(o),this._iframeReloadMonitor(o,"setH5DocumentIframeSrc")}else o.iframeSrc=a,this._hideLoading(o);o.h5DocumentIframeElement.src=a,L.Logger.debug(B.logType,"set h5 document src:",a)}else L.Logger.error(B.logType,"[setH5DocumentIframeSrc]There are no h5 document Numbers that belong to id "+e)}},{key:"getIframeSrc",value:function(e){var t=this.getH5DocumentInstanceByID(e);if(t)return t.iframeSrc;L.Logger.error(B.logType,"[getIframeSrc]There are no h5 document Numbers that belong to id "+e)}},{key:"jumpToPage",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);n?this._jumpToPage(n,t):L.Logger.error(B.logType,"[jumpToPage]There are no h5 document Numbers that belong to id "+e)}},{key:"nextPage",value:function(e){var t=this.getH5DocumentInstanceByID(e);if(t)if(t.isLoadFinished){var n=this._getWhiteboardFiledata(t);if(n&&n.currpage>=n.pagenum)L.Logger.warning(B.logType,"[nextPage]h5 document is on the last page , cannot execute nextPage method.");else{var i={currpage:n.currpage+1};this._postMessage(t,{method:"onJumpPage",toPage:i.currpage}),this._saveFiledataAndLoadCurrpageWhiteboardData(t,i),this._sendSignalling_ShowPage(t)}}else L.Logger.info(B.logType,"[nextPage]h5 document is not load finished  , cannot execute nextPage method");else L.Logger.error(B.logType,"[nextPage]There are no h5 document Numbers that belong to id "+e)}},{key:"prevPage",value:function(e){var t=this.getH5DocumentInstanceByID(e);if(t)if(t.isLoadFinished){var n=this._getWhiteboardFiledata(t);if(n&&n.currpage<=1)L.Logger.warning(B.logType,"[nextPage]h5 document is on page 1, cannot execute prevPage method.");else{var i={currpage:n.currpage-1};this._postMessage(t,{method:"onJumpPage",toPage:i.currpage}),this._saveFiledataAndLoadCurrpageWhiteboardData(t,i),this._sendSignalling_ShowPage(t)}}else L.Logger.info(B.logType,"[prevPage]h5 document is not load finished  , cannot execute prevPage method");else L.Logger.error(B.logType,"[nextPage]There are no h5 document Numbers that belong to id "+e)}},{key:"skipPage",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);if(n)if(n.isLoadFinished){var i=this._getWhiteboardFiledata(n);i&&t>i.pagenum&&(L.Logger.info(B.logType,"[skipPage]h5 document skip to page exceeds the maximum number of pages , change skip page  to 5(max page number)."),t=i.pagenum),t<1&&(L.Logger.info(B.logType,"[skipPage]h5 document skip to page less than the minimum page , change skip page  to 1(min page number)."),t=1),this._saveFiledataAndLoadCurrpageWhiteboardData(n,{currpage:t}),this._jumpToPage(n,t),this._sendSignalling_ShowPage(n)}else L.Logger.info(B.logType,"[skipPage]h5 document is not load finished  , cannot execute skipPage method");else L.Logger.error(B.logType,"[skipPage]There are no h5 document Numbers that belong to id "+e)}},{key:"updateH5DocumentProperty",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);n?(void 0!==t.associatedMsgID&&(n.associatedMsgID=t.associatedMsgID),void 0!==t.associatedUserID&&(n.associatedUserID=t.associatedUserID),void 0!==t.synchronizationH5Document&&(n.synchronizationH5Document=t.synchronizationH5Document),void 0!==t.h5DocumentActionClick&&(n.h5DocumentActionClick=t.h5DocumentActionClick,n.h5DocumentActionElement.style.display=n.h5DocumentActionClick?"none":"block"),void 0!==t.isShowReloadFileTip&&(n.isShowReloadFileTip=t.isShowReloadFileTip),void 0!==t.languageType&&(n.languageType=t.languageType,this._isShowReloadFileShowReloadNumber(n))):L.Logger.error(B.logType,"[updateH5DocumentProperty]There are no h5 document Numbers that belong to id "+e)}},{key:"postMessageH5DocumentTriggerAction",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);if(n){var i=this._getWhiteboardFiledata(n);t&&i.fileid&&i.currpage&&!n.isLoadFinished?(n.h5DocumentActionJson[i.currpage]=n.h5DocumentActionJson[i.currpage]||[],n.h5DocumentActionJson[i.currpage].push(t)):this._postMessage(n,t)}else L.Logger.error(B.logType,"[postMessageH5DocumentTriggerAction]There are no h5 document Numbers that belong to id "+e)}},{key:"postMessage",value:function(e,t){var n=this.getH5DocumentInstanceByID(e);n?this._postMessage(n,t):L.Logger.error(B.logType,"[postMessage]There are no h5 document Numbers that belong to id "+e)}},{key:"isLoadFinished",value:function(e){var t=this.getH5DocumentInstanceByID(e);if(t)return t.isLoadFinished;L.Logger.error(B.logType,"[isLoadFinished]There are no h5 document Numbers that belong to id "+e)}},{key:"getH5DocumentInstanceByID",value:function(e){var t=this._getH5DocumentInstanceID(e);return this.h5DocumentInstanceStore[t]}},{key:"_jumpToPage",value:function(e,t){if(e.isLoadFinished){var n=this._getWhiteboardFiledata(e),i=!1,r=t;if(n&&(n.currpage>n.pagenum&&(n.currpage=n.pagenum,i=!0,t=n.currpage),n.currpage<1&&(n.currpage=1,i=!0,t=n.currpage),r=n.currpage),i){var o={};i&&(o.currpage=r),this._saveFiledataAndLoadCurrpageWhiteboardData(e,o)}if(null!=t&&!isNaN(t)){var a={method:"onJumpPage",toPage:t};this._postMessage(e,a)}}}},{key:"_postMessage",value:function(e,t){if(e.isLoadFinished)try{if(e.h5DocumentIframeElement&&e.h5DocumentIframeElement.src){var n=t;n=l()(n),e.h5DocumentIframeElement&&e.h5DocumentIframeElement.contentWindow&&e.h5DocumentIframeElement.contentWindow.postMessage&&(L.Logger.debug(B.logType,"[_postMessage iframeInfo]h5 document postMessage instanceId is "+e.id+",sendData:"+n),e.h5DocumentIframeElement.contentWindow.postMessage(n,"*"))}}catch(e){L.Logger.error(B.logType,"[_postMessage] h5 document postMessage error:",e)}else e.awitExecutePostMessageArray.push(t)}},{key:"_showLoading",value:function(e){e.h5DocumentLoadingElement.style.display="block",this._isShowReloadFileShowReloadNumber(e)}},{key:"_hideLoading",value:function(e){e.h5DocumentLoadingElement.style.display="none",this._isShowReloadFileShowReloadNumber(e)}},{key:"_getH5DocumentInstanceID",value:function(e){var t=this.uniqueH5Document||null==e?this.h5DocumentInstanceDefaultID:this.h5DocumentInstanceIDPrefix+e;e&&"string"==typeof e&&(new RegExp(this.specialH5DocumentInstanceIDPrefix,"g").test(e)&&(t=e));return t}},{key:"_destroyH5DocumentInstance",value:function(e){var t=e.h5DocumentInstanceID,n=e.h5DocumentElement;n?n.innerHTML="":L.Logger.warning(B.logType,"[destroy] h5Document elements do not exist , element id is:"+e.h5DocumentElementId+"!");for(var i=0,r=f()(e);i<r.length;i++){var o=r[i];e[o]=null,delete e[o]}this.h5DocumentInstanceStore[t]=null,delete this.h5DocumentInstanceStore[t]}},{key:"_receiveWindowMessageEvent",value:function(e,t,n){if(n.data){var i=void 0;try{i=JSON.parse(n.data)}catch(e){return void L.Logger.warning(B.logType,"h5 document receive iframe message data can't be converted to JSON , iframe data:",n.data)}if(i.method||"ys_h5Document"===i.source){L.Logger.debug(B.logType,"[h5Document iframeInfo]receive remote iframe data form "+n.origin+":",n);switch(i.method){case"onLoadComplete":this._handleIframeMessage_onLoadComplete(t,i);break;case"onPagenum":this._handleIframeMessage_onPagenum(t,i);break;case"onFileMessage":this._handleIframeMessage_onFileMessage(e,t,i);break;case"onJumpPage":if(!i.toPage||"number"!=typeof i.toPage)return void L.Logger.warning(B.logType,"h5 document toPage is not a number , toPage:",i.toPage);t.handler.receiveActionCommandCallback("h5DocumentOnJumpPage",{id:t.id,toPage:i.toPage});break;case"clinetAudioPlayer":this._handleIframeMessage_autoPlayAudioInNative(t,i.data)}}}}},{key:"_handleIframeMessage_autoPlayAudioInNative",value:function(e,t){if(e.handler&&e.handler.receiveActionCommandCallback){var n=this._getWhiteboardFiledata(e),i=t.isPlay,r=t.url,o=t.fileid,a=ve()(t,["isPlay","url","fileid"]),s={id:e.id,url:r,isPlay:i,audio:!0,attributes:{source:"h5Document",filename:"",fileid:o,type:"audio",other:a,currentPage:n.currpage}};e.handler.receiveActionCommandCallback("publishH5DocumentNetworkAudio",s)}}},{key:"_handleIframeMessage_onLoadComplete",value:function(e,t){if(clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.handler&&e.handler.receiveActionCommandCallback&&(e.handler.receiveActionCommandCallback("updateWhiteboardWatermarkImageScale",{id:e.id,scale:t.coursewareRatio||16/9}),e.handler.receiveActionCommandCallback("h5DocumentLoadEnd",{id:e.id,scale:t.coursewareRatio||16/9,reloadNumber:e.forceReloadNumber,success:!0})),!e.isLoadFinished&&(e.isLoadFinished=!0,e.isReceivePagenum)){var n=this._getWhiteboardFiledata(e);if(n&&(this._jumpToPage(e,n.currpage),clearTimeout(e.h5DocumentActionTimer),e.isLoadFinished&&(n=this._getWhiteboardFiledata(e),f()(e.h5DocumentActionJson).length>0&&e.h5DocumentActionJson[n.currpage]&&0!==e.h5DocumentActionJson[n.currpage].length))){var i=!0,r=!1,o=void 0;try{for(var a,s=W()(e.h5DocumentActionJson[n.currpage]);!(i=(a=s.next()).done);i=!0){var l=a.value;this._postMessage(e,l)}}catch(e){r=!0,o=e}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}e.h5DocumentActionJson[n.currpage].length=0,delete e.h5DocumentActionJson[n.currpage]}}if(e.awitExecutePostMessageArray&&e.awitExecutePostMessageArray.length>0){var c=!0,d=!1,u=void 0;try{for(var h,p=W()(e.awitExecutePostMessageArray);!(c=(h=p.next()).done);c=!0){var m=h.value;this._postMessage(e,m)}}catch(e){d=!0,u=e}finally{try{c||null==p.return||p.return()}finally{if(d)throw u}}}e.awitExecutePostMessageArray.length=0,this._hideLoading(e)}},{key:"_handleIframeMessage_onPagenum",value:function(e,t){var n=t.totalPages,i=!1,r=1,o=this._getWhiteboardFiledata(e);o&&(o.pagenum=n,o.currpage>o.pagenum&&(o.currpage=o.pagenum,i=!0),o.currpage<1&&(o.currpage=1,i=!0),r=o.currpage);var a={pagenum:n};if(i&&(a.currpage=r),i?this._saveFiledataAndLoadCurrpageWhiteboardData(e,a):this._updateWhiteboardFiledata(e,a),e.isLoadFinished&&!e.isReceivePagenum&&(o=this._getWhiteboardFiledata(e))&&(this._jumpToPage(e,o.currpage),clearTimeout(e.h5DocumentActionTimer),e.isLoadFinished&&(o=this._getWhiteboardFiledata(e),f()(e.h5DocumentActionJson).length>0&&e.h5DocumentActionJson[o.currpage]&&0!==e.h5DocumentActionJson[o.currpage].length))){var s=!0,l=!1,c=void 0;try{for(var d,u=W()(e.h5DocumentActionJson[o.currpage]);!(s=(d=u.next()).done);s=!0){var h=d.value;this._postMessage(e,h)}}catch(e){l=!0,c=e}finally{try{s||null==u.return||u.return()}finally{if(l)throw c}}e.h5DocumentActionJson[o.currpage].length=0,delete e.h5DocumentActionJson[o.currpage]}e.isReceivePagenum=!0}},{key:"_handleIframeMessage_onFileMessage",value:function(e,t,n){n.sourceInstanceId=e,this._sendSignallingToServer(t,{name:"default"===e?"H5DocumentAction":"ExtendH5DocumentAction",id:"default"===e?"H5DocumentAction":"H5DocumentAction_".concat(e),toID:"__allExceptSender",data:n}),t.handler&&t.handler.receiveActionCommandCallback&&t.handler.receiveActionCommandCallback("closeAllSelectBox",{id:t.id})}},{key:"_sendSignallingToServer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.name,i=t.id,r=t.toID,o=void 0===r?"__all":r,a=t.data,s=t.do_not_save,l=t.expiresabs,c=t.associatedMsgID,d=t.associatedUserID;e.handler&&e.handler.sendSignallingToServer&&(c=c||e.associatedMsgID,d=d||e.associatedUserID,e.handler.sendSignallingToServer(n,i,o,a,s,l,c,d))}},{key:"_getWhiteboardFiledata",value:function(e){var t=void 0;return e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("getWhiteboardFiledata",{id:e.id,callback:function(e){t=e}}),t}},{key:"_saveFiledataAndLoadCurrpageWhiteboardData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("saveFiledataAndLoadCurrpageWhiteboardData",{id:e.id,updateFileData:t})}},{key:"_updateWhiteboardFiledata",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("updateWhiteboardFiledata",{id:e.id,updateFileData:t})}},{key:"_iframeReloadMonitor",value:function(e,t){var n=this;clearTimeout(e.forceReloadNumberTimer),e.forceReloadNumberTimer=null,e.iframeSrc&&!e.isLoadFinished&&(e.forceReloadNumber<e.maxForceReloadNumber?e.forceReloadNumberTimer=setTimeout(function(){e.iframeSrc&&!e.isLoadFinished&&e.forceReloadNumber<e.maxForceReloadNumber&&(e.forceReloadNumber++,n._isShowReloadFileShowReloadNumber(e),e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("reloadH5DocumentIframeSrc",{id:e.id,iframeSrc:e.iframeSrc,source:t,fileid:e.fileid,forceReloadNumber:e.forceReloadNumber}))},e.forceReloadInterval):e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("h5DocumentReloadFail",{id:e.id,reloadNumber:e.forceReloadNumber,success:!1}))}},{key:"_sendSignalling_ShowPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.handler&&e.handler.receiveActionCommandCallback&&e.handler.receiveActionCommandCallback("sendSignalling_ShowPage",{id:e.id,updatePubmsgData:t})}},{key:"_isShowReloadFileShowReloadNumber",value:function(e){e.h5DocumentReloadNumberElement.style.display=e.isShowReloadFileTip&&e.forceReloadNumber?"inline-table":"none";var t="当前网络不稳定，正在尝试重新打开课件……第"+e.forceReloadNumber+"次";if(e.isMeeting)switch(t="当前网络不稳定，正在尝试重新打开素材……第"+e.forceReloadNumber+"次",e.languageType){case"tw":t="當前網絡不穩定，正在嘗試重新打開素材……第"+e.forceReloadNumber+"次";break;case"en":t="The network is unstable , Trying to reopen the courseware ..."+e.forceReloadNumber;break;case"ja":t="ネットが不安定です、素材を開きなおしています"+e.forceReloadNumber+"次"}else switch(e.languageType){case"tw":t="當前網絡不穩定，正在嘗試重新打開課件……第"+e.forceReloadNumber+"次";break;case"en":t="The network is unstable , Trying to reopen the courseware ..."+e.forceReloadNumber;break;case"ja":t="ネットが不安定です、教材を開きなおしています"+e.forceReloadNumber+"次"}e.h5DocumentReloadNumberElement.innerHTML=t||""}}]),e}()),we=(navigator.userAgent.match(/AppleWebKit.*Mobile.*/),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.deepAssign({},z.defaultWhiteboard,z.commonWhiteboard),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;g()(this,e),this.parentNode=t,this.instanceId=n,this.configration=i,this.receiveActionCommand=r,this.whiteBoardManagerInstance=o,this.elements={},this.fileid=0,this.fullScreen=!1,this.remark=!1,this.scale=this.configration.defaultWhiteboardScale,this.loadDocumentFail=void 0,this.remarkText="",this.fileTypeMark="generalDocument",this.cacheMaxPageNum=1,this.cacheMinPageNum=1,this.filePreLoadCurrPage=1,this.filePreLoadStep=2,this.dynamicPptVolume=100,this.maxGeneralFileForceReloadNumber=10,this.generalDocumentFileForceReloadNumber=0,this.volume=100,this.pptAudio={},this.whiteboardViewState={tool:{},action:{},zoom:{},page:{},documentType:this.fileTypeMark,fileid:this.fileid,dynamicPptVolume:this.dynamicPptVolume,fullScreen:this.fullScreen,remark:this.remark,scale:this.scale,remarkText:this.remarkText,other:{primaryColor:this.configration.primaryColor,secondaryColor:this.configration.secondaryColor,backgroundColor:this.configration.backgroundColor,pencilWidth:this.configration.pencilWidth,shapeWidth:this.configration.shapeWidth,eraserWidth:this.configration.eraserWidth,fontSize:this.configration.fontSize,fontFamily:this.configration.fontFamily}},this._createElements(),this._connectElements()}return y()(e,[{key:"getConfigration",value:function(){return this.configration}},{key:"saveFiledataAndLoadCurrpageWhiteboardData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._saveFiledataAndLoadCurrpageWhiteboardData(e)}},{key:"noticeWhiteboardActionCommand",value:function(e,t){if("default"===this.instanceId)switch(e){case"playOrPauseDynamicPpt":"dynamicPPT"===this.fileTypeMark&&ye.postMessage(this.instanceId,{action:t.pause?"stopDynamicPpt":"playDynamicPpt"});break;case"updateMute":"dynamicPPT"===this.fileTypeMark&&ye.postMessage(this.instanceId,{action:"ExtendedNotice",extendedData:{type:"updateMute",data:{mute:t.isMute}}});break;case"ExtendedNotice":"dynamicPPT"===this.fileTypeMark&&ye.postMessage(this.instanceId,{action:"ExtendedNotice",extendedData:t.extendedData});break;case"closeDynamicPptAutoVideo":"dynamicPPT"===this.fileTypeMark&&ye.postMessage(this.instanceId,{action:"closeDynamicPptAutoVideo"})}}},{key:"reloadCurrentDocument",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("default"===this.instanceId||this.configration.hasExtendDocument)switch(this.fileTypeMark){case"generalDocument":var t=he.getWhiteboardFiledata(this.instanceId),n=t.cospdfpath,i=t.swfpath,r=t.isContentDocument,o=t.fileid,a=t.filetype,s=t.currpage,l=!!n;if(i&&"whiteboard"!==a&&0!=o){var c;if(Number(r))i&&(c=i);else{var d=(n||i).replace(/(\.[a-zA-Z]+)$/,"-"+s+"$1");c=B.nowUseDocAddress+d}he.setWhiteboardWatermarkImage(this.instanceId,c,{resetDedaultWhiteboardMagnification:!1,isPDF:l,fileid:o})}break;case"dynamicPPT":e.isAgainreconnect||(this.forceReloadTimestampFromPpt=(new Date).getTime()),this._loadCurrentDynamicPpt({},{isAgainreconnect:e.isAgainreconnect});break;case"h5Document":this._loadCurrentH5Document({forceReloadTimestamp:(new Date).getTime()})}}},{key:"changeDocumentRemarkState",value:function(e){this.remark=e&&this.configration.canRemark,this._viewStateUpdate()}},{key:"changeFullScreenState",value:function(e){this.fullScreen=e,this._viewStateUpdate(),this.resizeWhiteboardHandler()}},{key:"destroyWhiteboardView",value:function(){for(var e in he.hasWhiteboardById(this.instanceId)&&he.destroyWhiteboardInstance(this.instanceId),ye.hasDynamicPptById(this.instanceId)&&ye.destroyDynamicPptInstance(this.instanceId),be.hasH5DocumentById(this.instanceId)&&be.destroyH5DocumentInstance(this.instanceId),me.removeChild(this.elements.whiteboardViewRootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"changeWhiteBoardConfigration",value:function(e){Object.deepAssign(this.configration,e);for(var t={},n={},i={},r=0,o=h()(e);r<o.length;r++){var a=d()(o[r],2),s=a[0],l=a[1];"canDraw"===s?t.deawPermission=this.configration.canDraw&&this.configration.synchronization&&this.configration.isConnectedRoom:"myUserId"===s?t.myselfId=l:"myName"===s?t.nickname=l:"primaryColor"===s||"secondaryColor"===s||"primaryColor"===s?t[s.replace(/Color/g,"")]=l:"synchronization"===s?t.synchronizationWhiteboard=this.configration.synchronization&&this.configration.isConnectedRoom:t[s]=l,"synchronization"===s?n.synchronizationDynamicPpt=this.configration.synchronization&&this.configration.isConnectedRoom:"actionClick"===s?n.dynamicPptActionClick=this.configration.actionClick&&this.configration.isConnectedRoom:n[s]=l,"synchronization"===s?i.synchronizationH5Document=this.configration.synchronization&&this.configration.isConnectedRoom:"actionClick"===s?i.h5DocumentActionClick=this.configration.actionClick&&this.configration.isConnectedRoom:i[s]=l}void 0!==e.isConnectedRoom&&(t.synchronizationWhiteboard=this.configration.synchronization&&this.configration.isConnectedRoom,n.synchronizationDynamicPpt=this.configration.synchronization&&this.configration.isConnectedRoom,i.synchronizationH5Document=this.configration.synchronization&&this.configration.isConnectedRoom,n.dynamicPptActionClick=this.configration.actionClick&&this.configration.isConnectedRoom,i.h5DocumentActionClick=this.configration.actionClick&&this.configration.isConnectedRoom,t.deawPermission=this.configration.canDraw&&this.configration.synchronization&&this.configration.isConnectedRoom),void 0!==e.synchronization&&(t.deawPermission=this.configration.canDraw&&this.configration.synchronization&&this.configration.isConnectedRoom),he.updateWhiteboardProperty(this.instanceId,t),(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.updateDynamicPptProperty(this.instanceId,n),(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.updateH5DocumentProperty(this.instanceId,i),void 0!==e.loadDynamicPptView&&this.elements.dynamicPptViewElement&&(e.loadDynamicPptView&&!document.getElementById(this.elements.dynamicPptViewElement.getAttribute("id"))?(me.appendChild(this.elements.documentViewElement,this.elements.dynamicPptViewElement),this._productionDynamicPpt()):!e.loadDynamicPptView&&document.getElementById(this.elements.dynamicPptViewElement.getAttribute("id"))&&(ye.hasDynamicPptById(this.instanceId)&&ye.destroyDynamicPptInstance(this.instanceId),me.removeChild(this.elements.dynamicPptViewElement,this.elements.documentViewElement))),void 0!==e.loadH5DocumentView&&this.elements.h5DocumentViewElement&&(e.loadH5DocumentView&&!document.getElementById(this.elements.h5DocumentViewElement.getAttribute("id"))?(me.appendChild(this.elements.documentViewElement,this.elements.h5DocumentViewElement),this._productionH5Document()):!e.loadH5DocumentView&&document.getElementById(this.elements.h5DocumentViewElement.getAttribute("id"))&&(be.hasH5DocumentById(this.instanceId)&&be.destroyH5DocumentInstance(this.instanceId),me.removeChild(this.elements.h5DocumentViewElement,this.elements.documentViewElement))),void 0!==e.rootBackgroundColor&&me.updateStyle(this.elements.whiteboardViewRootElement,{backgroundColor:e.rootBackgroundColor}),void 0!==e.isMobile&&(e.isMobile?me.addClass(this.elements.whiteboardViewRootElement,"app-mobile"):me.removeClass(this.elements.whiteboardViewRootElement,"app-mobile")),void 0===e.canPage&&void 0===e.addPage&&void 0===e.isConnectedRoom||this._viewStateUpdate()}},{key:"receiveEventRoomPubmsg",value:function(e){e&&"string"==typeof e&&(e=JSON.parse(e)),"object"===a()(e)&&e.message&&"string"==typeof e.message&&(e.message=JSON.parse(e.message)),"object"===a()(e.message)&&e.message.data&&"string"==typeof e.message.data&&(e.message.data=JSON.parse(e.message.data));var t=e.message;switch(t.name){case"ShowPage":case"ExtendShowPage":t.source="room-pubmsg",this._handleShowPageSignalling(t,e.local);break;case"whiteboardMarkTool":case"ExtendWhiteboardMarkTool":t.data&&t.data.selectMouse?he.activeWhiteboardTool("tool_mouse",this.instanceId):he.useHistoryPenTool(this.instanceId);break;case"NewPptTriggerActionClick":case"ExtendNewPptTriggerActionClick":(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.postMessageDynamicPptTriggerAction(this.instanceId,t.data);break;case"H5DocumentAction":case"ExtendH5DocumentAction":(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.postMessageH5DocumentTriggerAction(this.instanceId,t.data);break;case"PptVolumeControl":case"ExtendPptVolumeControl":this.volume=100*t.data.volume,this._updatedynamicPptVolume(100*t.data.volume)}}},{key:"receiveEventRoomDelmsg",value:function(e){}},{key:"receiveEventRoomMsglist",value:function(e,t){switch(e){case"ShowPage":case"ExtendShowPage":t.source="room-msglist",this._handleShowPageSignalling(t);break;case"whiteboardMarkTool":case"ExtendWhiteboardMarkTool":t.data&&t.data.selectMouse?he.activeWhiteboardTool("tool_mouse",this.instanceId):he.useHistoryPenTool(this.instanceId);break;case"NewPptTriggerActionClick":case"ExtendNewPptTriggerActionClick":(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.postMessageDynamicPptTriggerAction(this.instanceId,t.data);break;case"H5DocumentAction":case"ExtendH5DocumentAction":(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.postMessageH5DocumentTriggerAction(this.instanceId,t.data);break;case"PptVolumeControl":case"ExtendPptVolumeControl":this._updatedynamicPptVolume(100*t.data.volume)}}},{key:"reveiveEventRoomReceiveActionCommand",value:function(e,t){switch(e){case"fullScreenChangeCallback":this.changeFullScreenState(t.isFullScreen);break;case"changeDynamicPptSize":this.configration.isMobile&&"dynamicPPT"===this.fileTypeMark&&ye.changeDynamicPptSize(this.instanceId);break;case"closeDynamicPptWebPlay":if("dynamicPPT"===this.fileTypeMark){ye.postMessage(this.instanceId,{action:"closeDynamicPptAutoVideo"})}}}},{key:"sendActionCommand",value:function(e,t){this.receiveActionCommand&&"function"==typeof this.receiveActionCommand&&("object"!==a()(t)||w()(t)||(t=Object.deepAssign({},t)),this.receiveActionCommand(e,t,this.instanceId))}},{key:"pubMsg",value:function(e){if("ShowPage"===e.name){var t=!1;"string"==typeof e.data?(e.data=JSON.parse(e.data),t=!0):e.data=e.data,e.data&&e.data.filedata&&e.data.filedata.baseurl&&delete e.data.filedata.baseurl,t&&(e.data=l()(e.data))}this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.pubMsg&&this.whiteBoardManagerInstance.pubMsg(e)}},{key:"delMsg",value:function(e){this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.delMsg&&this.whiteBoardManagerInstance.delMsg(e)}},{key:"getWhiteboardViewState",value:function(){return this.whiteboardViewState}},{key:"forceViewStateUpdate",value:function(){this._viewStateUpdate()}},{key:"useWhiteboardTool",value:function(e){if(this.whiteboardViewState.tool[e]&&this.whiteboardViewState.tool[e].disabled)L.Logger.warning(B.logType,"whiteboard tool("+e+") state is disabled , cannot use "+e+" tool!");else{if(("default"===this.instanceId||this.configration.hasExtendDocument)&&this.configration.synchronization&&this.configration.isConnectedRoom&&e!==he.getActiveTool(this.instanceId)&&("tool_mouse"!==e&&"tool_mouse"===he.getActiveTool(this.instanceId)||"tool_mouse"===e&&"tool_mouse"!==he.getActiveTool(this.instanceId))&&this.configration.isSyncMouseSwitch){var t={name:"default"===this.instanceId?"whiteboardMarkTool":"ExtendWhiteboardMarkTool",id:"default"===this.instanceId?"whiteboardMarkTool":"ExtendWhiteboardMarkTool_".concat(this.instanceId),toID:"__allExceptSender",data:{sourceInstanceId:this.instanceId,selectMouse:"tool_mouse"===e},save:!0};this.pubMsg(t)}he.activeWhiteboardTool(e,this.instanceId)}}},{key:"executeWhiteboardAction",value:function(e){this.whiteboardViewState.action[e]&&this.whiteboardViewState.action[e].disabled?L.Logger.warning(B.logType,"whiteboard action("+e+") state is disabled , cannot execute "+e+" action!"):he.activeWhiteboardTool(e,this.instanceId)}},{key:"executeZoomWhiteaord",value:function(e){this.whiteboardViewState.zoom[e]&&this.whiteboardViewState.zoom[e].disabled?L.Logger.warning(B.logType,"whiteboard zoom("+e+") state is disabled , cannot execute "+e+" zoom!"):he.activeWhiteboardTool(e,this.instanceId)}},{key:"addPage",value:function(){var e=he.getWhiteboardFiledata(this.instanceId),t=e.fileid,n=e.pagenum;if("generalDocument"===this.fileTypeMark||0!==Number(t)){if(n++,he.updateWhiteboardFiledata(this.instanceId,{pagenum:n}),this.configration.synchronization&&this.configration.isConnectedRoom){var i={name:"default"===this.instanceId?"WBPageCount":"ExtendWBPageCount",id:"default"===this.instanceId?"WBPageCount":"WBPageCount_".concat(this.instanceId),toID:"__allExceptSender",data:{sourceInstanceId:this.instanceId,totalPage:n,fileid:t},save:!0};this.pubMsg(i)}this.nextPage()}else L.Logger.warning(B.logType,"whiteboard addPage method can only be used in pure whiteboard.")}},{key:"nextPage",value:function(){var e=this;if(this.whiteboardViewState.page.nextPage&&this.whiteboardViewState.page.nextPage.disabled)L.Logger.warning(B.logType,"whiteboard nexPage state is disabled , cannot execute nextPage method!");else switch(this.fileTypeMark){case"generalDocument":var t=he.getWhiteboardFiledata(this.instanceId),n=t.currpage,i=t.pagenum;++n>i&&(n=i);var r={data:{filedata:{currpage:n}}};this._sendSignalling_ShowPage(r,function(t){e.receiveEventRoomPubmsg({type:"room-pubmsg",message:t,local:!0})});break;case"h5Document":be.nextPage(this.instanceId);break;case"dynamicPPT":ye.nextSlide(this.instanceId)}}},{key:"prevPage",value:function(){var e=this;if(this.whiteboardViewState.page.prevPage&&this.whiteboardViewState.page.prevPage.disabled)L.Logger.warning(B.logType,"whiteboard prevPage state is disabled , cannot execute prevPage method!");else switch(this.fileTypeMark){case"generalDocument":var t=he.getWhiteboardFiledata(this.instanceId).currpage;--t<1&&(t=1);var n={data:{filedata:{currpage:t}}};this._sendSignalling_ShowPage(n,function(t){e.receiveEventRoomPubmsg({type:"room-pubmsg",message:t,local:!0})});break;case"h5Document":be.prevPage(this.instanceId);break;case"dynamicPPT":ye.prevSlide(this.instanceId)}}},{key:"skipPage",value:function(e){var t=this;switch(this.fileTypeMark){case"generalDocument":var n=he.getWhiteboardFiledata(this.instanceId).pagenum;e>n&&(e=n),e<1&&(e=1);var i={data:{filedata:{currpage:e}}};this._sendSignalling_ShowPage(i,function(e){t.receiveEventRoomPubmsg({type:"room-pubmsg",message:e,local:!0})});break;case"h5Document":be.skipPage(this.instanceId,e);break;case"dynamicPPT":var r=e;ye.jumpToAnimation(this.instanceId,r,0,!0)}}},{key:"nextStep",value:function(){if("dynamicPPT"===this.fileTypeMark)if(this.whiteboardViewState.page.nextStep&&this.whiteboardViewState.page.nextStep.disabled)L.Logger.warning(B.logType,"whiteboard nextStep state is disabled , cannot execute nextStep method!");else switch(this.fileTypeMark){case"dynamicPPT":ye.nextStep(this.instanceId)}else L.Logger.warning(B.logType,"whiteboard nextStep method can only be used in dynamic PPT files.")}},{key:"prevStep",value:function(){if("dynamicPPT"===this.fileTypeMark)if(this.whiteboardViewState.page.prevStep&&this.whiteboardViewState.page.prevStep.disabled)L.Logger.warning(B.logType,"whiteboard prevStep state is disabled , cannot execute prevStep method!");else switch(this.fileTypeMark){case"dynamicPPT":ye.prevStep(this.instanceId)}else L.Logger.warning(B.logType,"whiteboard prevStep method can only be used in dynamic PPT files.")}},{key:"resizeWhiteboardSizeCallback",value:function(e){e.loadScrollBar?me.addClass(this.elements.totalDocumentViewElement,"custom-scroll-bar"):me.removeClass(this.elements.totalDocumentViewElement,"custom-scroll-bar"),me.updateStyle(this.elements.documentViewElement,{width:e.style.width,height:e.style.height}),me.updateStyle(this.elements.totalDocumentViewElement,{width:e.style.width,height:e.style.height}),me.updateStyle(this.elements.totalDocumentViewElement,{marginLeft:"-"+this.elements.totalDocumentViewElement.offsetWidth/2+"px",marginTop:"-"+this.elements.totalDocumentViewElement.offsetHeight/2+"px"})}},{key:"noticeUpdateToolDescCallback",value:function(){this._viewStateUpdate()}},{key:"noticeUpdateWhiteboardFiledataCallback",value:function(){this._viewStateUpdate()}},{key:"receiveActionCommandCallback",value:function(e,t){if(t.id===this.instanceId)switch(e){case"closeAllSelectBox":this.sendActionCommand("closeAllSelectBox");break;case"changeWhiteboardActiveTool":this._updateViewShowAndHide();break;case"updateWhiteboardWatermarkImageScale":he.updateWhiteboardWatermarkImageScale(this.instanceId,t.scale);break;case"dynamicPptLoadEnd":case"h5DocumentLoadEnd":case"generalDocumentLoadEnd":me.removeClass(this.elements.disableClickViewElement,"loading"),this.scale=t.scale,this._viewStateUpdate();var n=he.getWhiteboardFiledata(this.instanceId);n.success=t.success,n.reloadNumber=t.reloadNumber;var i={loadSuccessData:n};this.sendActionCommand("documentLoadSuccess",i);break;case"h5DocumentReloadFail":case"dynamicPptReloadFail":case"generalDocumentReloadFail":var r=he.getWhiteboardFiledata(this.instanceId);r.success=t.success,r.reloadNumber=t.reloadNumber;var o={loadFailData:r};this.sendActionCommand("documentLoadFail",o);break;case"sendSignalling_ShowPage":this._sendSignalling_ShowPage(t.updatePubmsgData);break;case"saveFiledataAndLoadCurrpageWhiteboardData":case"dynamicPptSlideChange":this._saveFiledataAndLoadCurrpageWhiteboardData(t.updateFileData);break;case"dynamicPptStepChange":he.updateWhiteboardFiledata(this.instanceId,t.updateFileData);break;case"publishDymanicPptNetworkMedia":if("default"===this.instanceId){ye.postMessage(this.instanceId,{action:"closeDynamicPptAutoVideo"});var a,s=he.getWhiteboardFiledata(this.instanceId),l=s.swfpath,c=s.isContentDocument;Number(c)?l&&(a=l.replace(/\/newppt.html/g,"")):a=B.nowUseDocAddress+l,t.url=a+"/"+t.url,this.whiteBoardManagerInstance&&(this.configration.clientMediaShare&&this.whiteBoardManagerInstance.getRoomDelegate()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().startShareMediaFile?this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().startShareMediaFile(t.url,void 0,void 0,{IgnoreElementId:!0,toID:this.configration.mediaShareToID,attrs:t.attributes}):this.whiteBoardManagerInstance.startShareMedia(t.url,t.video,this.configration.mediaShareToID,t.attributes))}break;case"publishDymanicPptNetworkAudio":if(this.configration.isNativePlayAudio){var d,u=he.getWhiteboardFiledata(this.instanceId),h=u.swfpath,p=u.isContentDocument;Number(p)?h&&(d=h.replace(/\/newppt.html/g,"")):d=B.nowUseDocAddress+h,d=(d=d.replace(/^https/,"http")).replace(/443/g,"80"),t.url=d+"/"+t.url,this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio&&(this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio(t.url,t.isPlay,t.attributes),this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume&&this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume(this.volume))}else{var f=t.attributes,m=f.fileid,g=f.currentPage,v=f.other,y=t.id,b=t.isPlay,w=t.url,_="".concat(y,"_").concat(w,"_").concat(g),S=document.getElementById(_)||document.createElement("audio");if(b){this.pptAudio[_]&&this.pptAudio[_].isPlay&&S.remove();var k=he.getWhiteboardFiledata(this.instanceId),P=k.swfpath,C=k.isContentDocument,T="";"/"!==(T=Number(C)?(P||T).replace(/\/newppt.html/g,""):B.nowUseDocAddress+P)[T.length-1]?"/"!==w[0]&&(T+="/"):"/"===w[0]&&(w=w.substr(1)),S.setAttribute("id",_),S.setAttribute("src",T+w),S.volume=this.volume/100,S.style.display="none",this.pptAudio[_]={isPlay:b,fileid:m,currentPage:g,url:w},document.querySelector("body").appendChild(S),YS.DeviceMgr.associateElementsToSpeaker([S]),this.pptAudio[_].isPlay=!0,S.play()}else if(!1===b&&this.pptAudio[_]){var I=v||{},E=I.currentTime,x=I.duration;this.pptAudio[_].isPlay=!1,S.pause(),E&&Y()(E)===Y()(x)&&(S.remove(),this.pptAudio[_]=null)}}break;case"publishH5DocumentNetworkAudio":if(this.configration.isNativePlayAudio){var R=t.url;R=(R=R.replace(/^https/,"http")).replace(/443/g,"80"),this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio&&(this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio(R,t.isPlay,t.attributes),this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume&&this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume(100))}else{var M=t.attributes,W=M.fileid,N=M.currentPage,O=M.other,F=t.id,j=t.isPlay,V=t.url,U="".concat(F,"_").concat(V,"_").concat(N),z=document.getElementById(U)||document.createElement("audio");if(j)this.pptAudio[U]||(z.setAttribute("id",U),z.setAttribute("src",V),z.volume=this.volume/100,z.style.display="none",this.pptAudio[U]={isPlay:j,fileid:W,currentPage:N,url:V},document.querySelector("body").appendChild(z),YS.DeviceMgr.associateElementsToSpeaker([z])),this.pptAudio[U].isPlay=!0,z.play();else if(!1===j&&this.pptAudio[U]){var q=O||{},H=q.currentTime,G=q.duration;this.pptAudio[U].isPlay=!1,z.pause(),H&&Y()(H)===Y()(G)&&(z.remove(),this.pptAudio[U]=null)}}break;case"updateWhiteboardFiledata":he.updateWhiteboardFiledata(this.instanceId,t.updateFileData);break;case"getWhiteboardFiledata":t&&t.callback&&"function"==typeof t.callback&&t.callback(he.getWhiteboardFiledata(this.instanceId));break;case"reloadCurrentDocument":this.reloadCurrentDocument({isAgainreconnect:t.isAgainreconnect});break;case"reloadDynamicPptIframeSrc":if(t.iframeSrc&&"dynamicPPT"===this.fileTypeMark&&new RegExp(he.getWhiteboardFiledata(this.instanceId).swfpath+"/newppt.html","g").test(t.iframeSrc)){var J=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress;B.docAddressKey=A.getItem(B.docAddressList,B.docAddressKey,!0),this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.setLocalStorageItem)&&(this.whiteBoardManagerInstance.setLocalStorageItem("ysDocAddressKey",B.docAddressKey),this.sendActionCommand("docAddressUpdate",{docAddressList:D()(B.docAddressList),docAddressIndex:B.docAddressKey,oldDocAddress:J,nowDocAddress:A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress})),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress,L.Logger.info(B.logType,"[reload dynamic ppt]change doc address , old address is "+J+" , now address is "+B.nowUseDocAddress),void 0!==t.forceReloadNumber&&(this.forceReloadNumberFromPpt=t.forceReloadNumber),this._loadCurrentDynamicPpt(),L.Logger.info(B.logType,"["+t.source+"]load dynamic ppt failure , reload file , old url is "+t.iframeSrc+" , now url is "+ye.getIframeSrc(this.instanceId)+" , reload number is "+t.forceReloadNumber)}break;case"reloadH5DocumentIframeSrc":if(t.iframeSrc&&"h5Document"===this.fileTypeMark&&new RegExp(he.getWhiteboardFiledata(this.instanceId).swfpath,"g").test(t.iframeSrc)){var X=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress;B.docAddressKey=A.getItem(B.docAddressList,B.docAddressKey,!0),this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.setLocalStorageItem)&&(this.whiteBoardManagerInstance.setLocalStorageItem("ysDocAddressKey",B.docAddressKey),this.sendActionCommand("docAddressUpdate",{docAddressList:D()(B.docAddressList),docAddressIndex:B.docAddressKey,oldDocAddress:X,nowDocAddress:A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress})),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress,L.Logger.info(B.logType,"[reload h5 document]change doc address , old address is "+X+" , now address is "+B.nowUseDocAddress);var K={};t.forceReloadNumber&&(K.forceReloadNumber=t.forceReloadNumber),this._loadCurrentH5Document(K,{forceReloadNumber:t.forceReloadNumber}),L.Logger.info(B.logType,"["+t.source+"]load h5 document failure , reload file , old url is "+t.iframeSrc+" , now url is "+ye.getIframeSrc(this.instanceId)+" , reload number is "+t.forceReloadNumber)}break;case"updateWhiteboardToolsInfo":this._viewStateUpdate();break;case"h5DocumentOnJumpPage":this.whiteBoardManagerInstance.skipPage(t.toPage,this.instanceId);break;case"currentWhiteboardId":this.sendActionCommand("currentWhiteboardId",t);break;case"slideLoadTimeout":this.sendActionCommand("slideLoadTimeout",t)}}},{key:"whiteboardWatermarkImageOnFailureCallback",value:function(e){var t=he.getWhiteboardFiledata(this.instanceId),n=t.cospdfpath,i=t.swfpath,r=t.currpage,o=t.fileid,a=t.filetype,s=t.isContentDocument,l=!!n;if("generalDocument"===this.fileTypeMark&&i&&e&&"whiteboard"!==a&&this.generalDocumentFileForceReloadNumber<this.maxGeneralFileForceReloadNumber){var c=void 0;if(c=Number(s)?i:(n||i).replace(/(\.[a-zA-Z]+)$/,"-"+r+"$1"),new RegExp(c,"g").test(e)){if(Number(s))this.generalDocumentFileForceReloadNumber++,L.Logger.info(B.logType,"[general document]load general document failure , reload file ,  url is "+c+" , reload number is "+this.generalDocumentFileForceReloadNumber);else{var d=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress;B.docAddressKey=A.getItem(B.docAddressList,B.docAddressKey,!0),this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.setLocalStorageItem)&&(this.whiteBoardManagerInstance.setLocalStorageItem("ysDocAddressKey",B.docAddressKey),this.sendActionCommand("docAddressUpdate",{docAddressList:D()(B.docAddressList),docAddressIndex:B.docAddressKey,oldDocAddress:d,nowDocAddress:A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress})),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||this.configration.docAddress,L.Logger.info(B.logType,"[reload general document]change doc address , old address is "+d+" , now address is "+B.nowUseDocAddress),this.generalDocumentFileForceReloadNumber++,L.Logger.info(B.logType,"[general document]load general document failure , reload file , old url is "+(d+c)+" , now url is "+(B.nowUseDocAddress+c)+" , reload number is "+this.generalDocumentFileForceReloadNumber)}var u;Number(s)?c&&(u=c):u=B.nowUseDocAddress+c,he.setWhiteboardWatermarkImage(this.instanceId,u,{resetDedaultWhiteboardMagnification:!1,isPDF:l,fileid:o})}else this.generalDocumentFileForceReloadNumber=0;this.generalDocumentFileForceReloadNumber>=this.maxGeneralFileForceReloadNumber&&this.receiveActionCommandCallback("generalDocumentReloadFail",{reloadNumber:this.generalDocumentFileForceReloadNumber,success:!1,id:this.instanceId})}}},{key:"whiteboardWatermarkImageOnloadCallback",value:function(e){var t=e.width,n=e.height;this.scale=t/n,this.receiveActionCommandCallback("generalDocumentLoadEnd",{reloadNumber:this.generalDocumentFileForceReloadNumber,success:!0,id:this.instanceId,scale:this.scale||16/9})}},{key:"resizeWhiteboardHandler",value:function(){he.resizeWhiteboardHandler(this.instanceId),"dynamicPPT"===this.fileTypeMark&&"ios"===this.configration.clientType&&ye.changeDynamicPptSize(this.instanceId)}},{key:"isWhiteboardTextEditing",value:function(){return he.isWhiteboardTextEditing(this.instanceId)}},{key:"resetWhiteboardData",value:function(){he.clearWhiteboardAllDataById(this.instanceId)}},{key:"receiveWindowMessageEvent",value:function(e){(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.receiveWindowMessageEvent(this.instanceId,e),(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.receiveWindowMessageEvent(this.instanceId,e)}},{key:"getWhiteboardRootElement",value:function(){return this.elements.whiteboardViewRootElement}},{key:"resetPureWhiteboardTotalPage",value:function(e){if(e>1)for(var t=2;t<=e;t++)he.clearWhiteboardDataByFileidAndCurrpage(this.instanceId,0,t);var n=he.getWhiteboardFiledata(this.instanceId);if(0==n.fileid){n.currpage=1,n.pagenum=1,this._saveFiledataAndLoadCurrpageWhiteboardData(n),this._generalDocumentFileShowPage(!1)}}},{key:"getDynamicPptInstanceByID",value:function(){return ye.getDynamicPptInstanceByID(this.instanceId)}},{key:"getH5DocumentInstanceByID",value:function(){return be.getH5DocumentInstanceByID(this.instanceId)}},{key:"_createElements",value:function(){this.elements.whiteboardViewRootElement=me.createElement("section",this.instanceId+"RoadofcloudSdkWhiteboardRoot",(this.configration.isMobile?"app-mobile ":" ")+"roadofcloud-sdk-whiteboard "+this.instanceId+" sdkwhiteboard-root",{width:"100%",height:"100%",position:"relative",left:0,top:0,backgroundColor:this.configration.rootBackgroundColor}),this.elements.totalDocumentViewElement=me.createElement("section",this.instanceId+"RoadofcloudTotalDocument","roadofcloud-sdk-whiteboard "+this.instanceId+" total-document-container",{width:"100%",height:"100%",position:"absolute",top:"50%",left:"50%",maxWidth:"100%",maxHeight:"100%"}),this.elements.documentViewElement=me.createElement("section",this.instanceId+"RoadofcloudDocument","roadofcloud-sdk-whiteboard "+this.instanceId+" document-container",{width:"100%",height:"100%",position:"absolute",left:0,top:0}),this.elements.whiteboardViewElement=me.createElement("article",this.instanceId+"RoadofcloudWhiteboard","roadofcloud-sdk-whiteboard "+this.instanceId+" whiteboard-container",{width:"100%",height:"100%",position:"absolute",left:0,top:0,zIndex:2}),this.elements.dynamicPptViewElement=me.createElement("article",this.instanceId+"RoadofcloudDynamicPpt","roadofcloud-sdk-whiteboard "+this.instanceId+" dynamic-ppt-container",{width:"100%",height:"100%",position:"absolute",left:0,top:0,display:"none",zIndex:1}),this.elements.h5DocumentViewElement=me.createElement("article",this.instanceId+"RoadofcloudH5Document","roadofcloud-sdk-whiteboard "+this.instanceId+" h5-document-container",{width:"100%",height:"100%",position:"absolute",left:0,top:0,display:"none",zIndex:1}),this.elements.disableClickViewElement=me.createElement("div",void 0,"roadofcloud-sdk-whiteboard "+this.instanceId+" disable-clock-container",{width:"100%",height:"100%",position:"absolute",left:0,top:0,display:"none",zIndex:4})}},{key:"_connectElements",value:function(){(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&me.appendChild(this.elements.documentViewElement,this.elements.dynamicPptViewElement),(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&me.appendChild(this.elements.documentViewElement,this.elements.h5DocumentViewElement),me.appendChild(this.elements.documentViewElement,this.elements.whiteboardViewElement),me.appendChild(this.elements.documentViewElement,this.elements.disableClickViewElement),me.appendChild(this.elements.totalDocumentViewElement,this.elements.documentViewElement),me.appendChild(this.elements.whiteboardViewRootElement,this.elements.totalDocumentViewElement),me.appendChild(this.parentNode,this.elements.whiteboardViewRootElement),this._productionWhiteboard(),this._productionDynamicPpt(),this._productionH5Document()}},{key:"_productionWhiteboard",value:function(){var e=this;he.hasWhiteboardById(this.instanceId)&&he.destroyWhiteboardInstance(this.instanceId);var t={whiteboardElementId:this.elements.whiteboardViewElement.getAttribute("id"),id:this.instanceId,handler:{sendSignallingToServer:function(t,n,i,r,o,a,s,l){e.configration.synchronization&&e.configration.isConnectedRoom&&e.pubMsg({name:t,id:n,toID:i,data:r,save:!o,expiresabs:a,associatedMsgID:s,associatedUserID:l})},delSignallingToServer:function(t,n,i,r){e.configration.synchronization&&e.configration.isConnectedRoom&&e.delMsg({name:t,id:n,toID:i,data:r})},resizeWhiteboardSizeCallback:this.resizeWhiteboardSizeCallback.bind(this),noticeUpdateToolDescCallback:this.noticeUpdateToolDescCallback.bind(this),noticeUpdateWhiteboardFiledataCallback:this.noticeUpdateWhiteboardFiledataCallback.bind(this),receiveActionCommandCallback:this.receiveActionCommandCallback.bind(this),whiteboardWatermarkImageOnFailureCallback:this.whiteboardWatermarkImageOnFailureCallback.bind(this),whiteboardWatermarkImageOnloadCallback:this.whiteboardWatermarkImageOnloadCallback.bind(this)},productionOptions:Object.deepAssign({deawPermission:this.configration.canDraw&&this.configration.synchronization&&this.configration.isConnectedRoom,showShapeAuthor:this.configration.showShapeAuthor,myselfId:this.configration.myUserId,nickname:this.configration.myName,synchronizationWhiteboard:this.configration.synchronization&&this.configration.isConnectedRoom,primaryColor:this.configration.primaryColor,secondaryColor:this.configration.secondaryColor,backgroundColor:this.configration.backgroundColor,pencilWidth:this.configration.pencilWidth,shapeWidth:this.configration.shapeWidth,eraserWidth:this.configration.eraserWidth,fontSize:this.configration.fontSize,fontFamily:this.configration.fontFamily,parcelAncestorElementId:this.elements.whiteboardViewRootElement.getAttribute("id"),defaultWhiteboardScale:this.configration.defaultWhiteboardScale,associatedMsgID:this.configration.associatedMsgID,associatedUserID:this.configration.associatedUserID,isOnlyUndoRedoClearMyselfShape:this.configration.isOnlyUndoRedoClearMyselfShape,insertPictureRule:this.configration.insertPictureRule,canWBPinch:this.configration.canWBPinch},this.configration.initWhiteboardProductionOptions||{})};he.productionWhiteboard(t),he.registerWhiteboardTools(this.instanceId,{tool_pencil:{},tool_highlighter:{},tool_line:{},tool_arrow:{},tool_eraser:{},tool_text:{},tool_rectangle:{},tool_rectangle_empty:{},tool_ellipse:{},tool_ellipse_empty:{},tool_mouse:{},tool_laser:{},action_undo:{},action_redo:{},action_clear:{},zoom_big:{},zoom_small:{}}),he.clearRedoAndUndoStack(this.instanceId),he.loadCurrpageWhiteboard(this.instanceId),("default"===this.instanceId||this.configration.hasExtendDocument)&&he.activeWhiteboardTool("tool_mouse",this.instanceId)}},{key:"_productionDynamicPpt",value:function(){var e=this;if(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument){ye.hasDynamicPptById(this.instanceId)&&ye.destroyDynamicPptInstance(this.instanceId);var t={dynamicPptElementId:this.elements.dynamicPptViewElement.getAttribute("id"),id:this.instanceId,handler:{sendSignallingToServer:function(t,n,i,r,o,a,s,l){e.configration.synchronization&&e.configration.isConnectedRoom&&e.pubMsg({name:t,id:n,toID:i,data:r,save:!o,expiresabs:a,associatedMsgID:s,associatedUserID:l})},receiveActionCommandCallback:this.receiveActionCommandCallback.bind(this)},productionOptions:{synchronizationDynamicPpt:this.configration.synchronization&&this.configration.isConnectedRoom,associatedMsgID:this.configration.associatedMsgID,associatedUserID:this.configration.associatedUserID,isShowReloadFileTip:this.configration.isShowReloadFileTip,languageType:this.configration.languageType,againreconnectElementParentNode:this.elements.documentViewElement,dynamicPptActionClick:this.configration.actionClick,isMeeting:this.configration.isMeeting}};ye.productionDynamicPpt(t)}}},{key:"_productionH5Document",value:function(){var e=this;if(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument){be.hasH5DocumentById(this.instanceId)&&be.destroyH5DocumentInstance(this.instanceId);var t={h5DocumentElementId:this.elements.h5DocumentViewElement.getAttribute("id"),id:this.instanceId,handler:{sendSignallingToServer:function(t,n,i,r,o,a,s,l){e.configration.synchronization&&e.configration.isConnectedRoom&&e.pubMsg({name:t,id:n,toID:i,data:r,save:!o,expiresabs:a,associatedMsgID:s,associatedUserID:l})},receiveActionCommandCallback:this.receiveActionCommandCallback.bind(this)},productionOptions:{synchronizationH5Document:this.configration.synchronization&&this.configration.isConnectedRoom,associatedMsgID:this.configration.associatedMsgID,associatedUserID:this.configration.associatedUserID,isShowReloadFileTip:this.configration.isShowReloadFileTip,languageType:this.configration.languageType,h5DocumentActionClick:this.configration.actionClick,isMeeting:this.configration.isMeeting}};be.productionH5Document(t)}}},{key:"_handleShowPageSignalling",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.source,r=e.data,o=this.fileid!=r.filedata.fileid;if(this.fileid!=r.filedata.fileid&&h()(this.pptAudio).forEach(function(e){var n=d()(e,2),i=n[0],o=n[1];o&&o.fileid!==r.filedata.fileid&&(t.pptAudio[i]=void 0,document.getElementById(i).remove())}),this.fileid=r.filedata.fileid,!this.configration.isPlayback)if(n)"ShowPage"===e.name?B.showPageFromId=this.configration.myUserId:"ExtendShowPage"===e.name&&(B.extendShowPageFromId=this.configration.myUserId);else{var a=!0;if("ShowPage"===e.name?((o||!e.fromID||B.showPageFromId!==this.configration.myUserId&&e.fromID===this.configration.myUserId||e.fromID!==this.configration.myUserId)&&(a=!1),B.showPageFromId=e.fromID):"ExtendShowPage"===e.name&&((o||!e.fromID||B.extendShowPageFromId!==this.configration.myUserId&&e.fromID===this.configration.myUserId||e.fromID!==this.configration.myUserId)&&(a=!1),B.extendShowPageFromId=e.fromID),a)return}if(this.fileTypeMark=r.isDynamicPPT?"dynamicPPT":r.isH5Document?"h5Document":"generalDocument",this.configration.isNativePlayAudio&&!r.isDynamicPPT){this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio&&this.whiteBoardManagerInstance.getRoomDelegate().isPlayAudio("",!1,{currentPage:-1})}if((r.isDynamicPPT||r.isH5Document)&&(r.filedata.pagenum=he.getWhiteboardFiledata(this.instanceId).pagenum),r.isGeneralFile||!o&&r.isDynamicPPT&&(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.isLoadFinished(this.instanceId)||!o&&r.isH5Document&&(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.isLoadFinished(this.instanceId)){var s=r.filedata;s.currpage>s.pagenum&&(s.currpage=s.pagenum),s.currpage<1&&(s.currpage=1),r.isDynamicPPT&&(s.pptslide=s.currpage)}if(this._updateViewShowAndHide(),this._viewStateUpdate(),r.isGeneralFile){if("room-pubmsg"===i&&!o&&Number(r.filedata.currpage)===he.getWhiteboardFiledata(this.instanceId).currpage)return;this._saveFiledataAndLoadCurrpageWhiteboardData(r.filedata),this._generalDocumentFileShowPage(o)}else if(r.isDynamicPPT)he.setWhiteboardWatermarkImage(this.instanceId,""),this._dynamicPPTFileShowPage(o,e);else if(r.isH5Document){if("room-pubmsg"===i&&!o&&Number(r.filedata.currpage)===he.getWhiteboardFiledata(this.instanceId).currpage)return;he.setWhiteboardWatermarkImage(this.instanceId,""),this._saveFiledataAndLoadCurrpageWhiteboardData(r.filedata),this._h5DocumentFileShowPage(o)}}},{key:"_generalDocumentFileShowPage",value:function(e){var t=this;this.generalDocumentFileForceReloadNumber=0,(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.setDynamicPptIframeSrc(this.instanceId,""),(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&be.setH5DocumentIframeSrc(this.instanceId,"");var n=he.getWhiteboardFiledata(this.instanceId),i=n.cospdfpath,r=n.swfpath,o=n.currpage,a=n.pagenum,s=n.filetype,l=n.isContentDocument,c=n.fileid,d=!!i;if(he.resetDedaultWhiteboardMagnification(this.instanceId),me.removeClass(this.elements.disableClickViewElement,"loading"),"whiteboard"===s)this.scale=this.configration.defaultWhiteboardScale,this._viewStateUpdate(),he.updateWhiteboardWatermarkImageScale(this.instanceId,this.configration.defaultWhiteboardScale),he.setWhiteboardWatermarkImage(this.instanceId,"",{resetDedaultWhiteboardMagnification:!1});else{var u;if(Number(l))r&&(u=r);else{var h=(i||r).replace(/(\.[a-zA-Z]+)$/,"-"+o+"$1");u=B.nowUseDocAddress+h}if(he.setWhiteboardWatermarkImage(this.instanceId,u,{resetDedaultWhiteboardMagnification:!1,timeoutCallback:function(){t.receiveActionCommandCallback("slideLoadTimeout",{id:dynamicPptInstance.id,loadTimeoutFile:{currpage:o,fileid:c,pagenum:a,cdn:B.nowUseDocAddress},fileType:"general"})},isPDF:d,fileid:c}),!Number(l)){var p=1,f=1;e?(this.cacheMaxPageNum=o,this.cacheMinPageNum=o,this.filePreLoadCurrPage=o,this.cacheMaxPageNum+this.filePreLoadStep<=a?this.cacheMaxPageNum+=this.filePreLoadStep:this.cacheMaxPageNum<a&&(this.cacheMaxPageNum+=a-this.cacheMaxPageNum),this.cacheMinPageNum-this.filePreLoadStep>=1?this.cacheMinPageNum-=this.filePreLoadStep:this.cacheMinPageNum=1,f=this.cacheMaxPageNum,p=this.cacheMinPageNum):(this.filePreLoadCurrPage<o?(p=this.cacheMaxPageNum+1,o>this.cacheMaxPageNum&&(this.cacheMaxPageNum=o),this.cacheMaxPageNum+this.filePreLoadStep<=a?this.cacheMaxPageNum+=this.filePreLoadStep:this.cacheMaxPageNum<a&&(this.cacheMaxPageNum+=a-this.cacheMaxPageNum),f=this.cacheMaxPageNum):this.filePreLoadCurrPage>o&&(f=this.cacheMinPageNum-1,o<this.cacheMinPageNum&&(this.cacheMinPageNum=o),this.cacheMinPageNum-this.filePreLoadStep>=1?this.cacheMinPageNum-=this.filePreLoadStep:this.cacheMinPageNum=1,p=this.cacheMinPageNum),this.filePreLoadCurrPage=o);for(var m=p;m<=f;m++)if(m!==o){var g=(d&&i||r).replace(/(\.[a-zA-Z]+)$/,"-"+m+"$1"),v=B.nowUseDocAddress+g;he.preloadWhiteboardImg(v,d,c,m)}}}}},{key:"_dynamicPPTFileShowPage",value:function(e,t){if(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)if(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument,e)he.updateWhiteboardWatermarkImageScale(this.instanceId,this.configration.defaultWhiteboardScale),this._saveFiledataAndLoadCurrpageWhiteboardData(t.data.filedata),this.forceReloadNumberFromPpt=void 0,this.forceReloadTimestampFromPpt=void 0,this._loadCurrentDynamicPpt();else{var n=t.data.filedata,i=n.currpage,r=n.pptstep;ye.jumpToAnimation(this.instanceId,i,r)}}},{key:"_h5DocumentFileShowPage",value:function(e){if(this.configration.loadH5DocumentView&&"default"===this.instanceId||this.configration.hasExtendDocument){this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument;var t=he.getWhiteboardFiledata(this.instanceId),n=(t.swfpath,t.currpage);e?(he.updateWhiteboardWatermarkImageScale(this.instanceId,this.configration.defaultWhiteboardScale),this._loadCurrentH5Document()):be.jumpToPage(this.instanceId,n)}}},{key:"_saveFiledataAndLoadCurrpageWhiteboardData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};he.saveWhiteboardStackToStorage(this.instanceId),he.updateWhiteboardFiledata(this.instanceId,e),he.loadCurrpageWhiteboard(this.instanceId)}},{key:"_updateViewShowAndHide",value:function(){var e=this.configration.clickCapture;switch(this.fileTypeMark){case"generalDocument":me.show(this.elements.whiteboardViewElement),me.hide([this.elements.h5DocumentViewElement,this.elements.dynamicPptViewElement]),this.elements.whiteboardViewElement.style.pointerEvents="";break;case"h5Document":this.elements.whiteboardViewElement.querySelectorAll("canvas")&&me.show(fe()(this.elements.whiteboardViewElement.querySelectorAll("canvas"))),me.show(this.elements.h5DocumentViewElement),me.hide(this.elements.dynamicPptViewElement),e?"tool_mouse"===he.getActiveTool(this.instanceId)&&this.configration.canDraw?this.elements.whiteboardViewElement.style.pointerEvents="none":this.elements.whiteboardViewElement.style.pointerEvents="":"tool_mouse"!==he.getActiveTool(this.instanceId)?me.show(this.elements.whiteboardViewElement):me.hide(this.elements.whiteboardViewElement);break;case"dynamicPPT":this.elements.whiteboardViewElement.querySelectorAll("canvas")&&me.show(fe()(this.elements.whiteboardViewElement.querySelectorAll("canvas"))),me.show(this.elements.dynamicPptViewElement),me.hide(this.elements.h5DocumentViewElement),e?"tool_mouse"===he.getActiveTool(this.instanceId)&&this.configration.canDraw?this.elements.whiteboardViewElement.style.pointerEvents="none":this.elements.whiteboardViewElement.style.pointerEvents="":"tool_mouse"!==he.getActiveTool(this.instanceId)?me.show(this.elements.whiteboardViewElement):me.hide(this.elements.whiteboardViewElement)}me.removeClass(this.elements.documentViewElement,["roadofcloud-filetype-generalDocument","roadofcloud-filetype-h5Document","roadofcloud-filetype-dynamicPPT"]),me.addClass(this.elements.documentViewElement,"roadofcloud-filetype-"+this.fileTypeMark),this.resizeWhiteboardHandler()}},{key:"_updatedynamicPptVolume",value:function(e){e<0?e=0:e>100&&(e=100),this.dynamicPptVolume=e,(this.configration.loadDynamicPptView&&"default"===this.instanceId||this.configration.hasExtendDocument)&&ye.postMessage(this.instanceId,{action:"PptVolumeControl",volumeValue:this.dynamicPptVolume/100}),f()(this.pptAudio).forEach(function(t){t&&document.getElementById(t)&&(document.getElementById(t).volume=e/100)}),this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume&&this.whiteBoardManagerInstance.getRoomDelegate().setPptAudioVolume(e),this._viewStateUpdate()}},{key:"_viewStateUpdate",value:function(){if(he.hasWhiteboardById(this.instanceId)){for(var e={},t=he.getWhiteboardFiledata(this.instanceId),n=t.currpage,i=t.pagenum,r=t.pptslide,o=t.pptstep,s=t.steptotal,l=t.fileid,c=he.getRegisterWhiteboardToolsList(this.instanceId),u={nextPage:{disabled:B.isPlayVideoing&&"default"===this.instanceId||!(this.configration.canPage&&this.configration.isConnectedRoom&&n<i)},prevPage:{disabled:B.isPlayVideoing&&"default"===this.instanceId||!(this.configration.canPage&&this.configration.isConnectedRoom&&n>1)},skipPage:{disabled:B.isPlayVideoing&&"default"===this.instanceId||!(this.configration.canPage&&this.configration.isConnectedRoom)},addPage:{disabled:!(!(B.isPlayVideoing&&"default"===this.instanceId||"generalDocument"!==this.fileTypeMark)&&this.configration.canPage&&this.configration.addPage&&this.configration.isConnectedRoom)||!(n>=i&&0===Number(l))},nextStep:{disabled:!(!(B.isPlayVideoing&&"default"===this.instanceId||"dynamicPPT"!==this.fileTypeMark)&&this.configration.canPage&&this.configration.isConnectedRoom)||r>=i&&o>=s-1},prevStep:{disabled:!(!(B.isPlayVideoing&&"default"===this.instanceId||"dynamicPPT"!==this.fileTypeMark)&&this.configration.canPage&&this.configration.isConnectedRoom)||r<=1&&o<=0},currentPage:n<1?1:n,totalPage:i<1?1:i},p=0,m=h()(c);p<m.length;p++){var g=d()(m[p],2),v=g[0],y=g[1];if(/tool_/g.test(v)){if(this.whiteboardViewState.tool[v]!==y)if("object"!==a()(y)||w()(y))e.tool=e.tool||{},e.tool[v]=y;else for(var b=0,_=h()(y);b<_.length;b++){var S=d()(_[b],2),k=S[0],P=S[1];this.whiteboardViewState.tool[v]=this.whiteboardViewState.tool[v]||{},P!==this.whiteboardViewState.tool[v][k]&&(e.tool=e.tool||{},e.tool[v]=e.tool[v]||{},e.tool[v][k]=P)}}else if(/action_/g.test(v)){if(this.whiteboardViewState.action[v]!==y)if("object"!==a()(y)||w()(y))e.action=e.action||{},e.action[v]=y;else for(var C=0,T=h()(y);C<T.length;C++){var A=d()(T[C],2),I=A[0],E=A[1];this.whiteboardViewState.action[v]=this.whiteboardViewState.action[v]||{},E!==this.whiteboardViewState.action[v][I]&&(e.action=e.action||{},e.action[v]=e.action[v]||{},e.action[v][I]=E)}}else if(/zoom_/g.test(v)&&this.whiteboardViewState.zoom[v]!==y)if("object"!==a()(y)||w()(y))e.zoom=e.zoom||{},e.zoom[v]=y;else for(var x=0,R=h()(y);x<R.length;x++){var D=d()(R[x],2),L=D[0],M=D[1];this.whiteboardViewState.zoom[v]=this.whiteboardViewState.zoom[v]||{},M!==this.whiteboardViewState.zoom[v][L]&&(e.zoom=e.zoom||{},e.zoom[v]=e.zoom[v]||{},e.zoom[v][L]=M)}}for(var W=0,N=h()(u);W<N.length;W++){var O=d()(N[W],2),F=O[0],j=O[1];if(this.whiteboardViewState.page[F]=this.whiteboardViewState.page[F]||{},"object"===a()(j))for(var V=0,U=h()(j);V<U.length;V++){var z=d()(U[V],2),q=z[0],H=z[1];this.whiteboardViewState.page[F][q]!==H&&(e.page=e.page||{},e.page[F]=e.page[F]||{},e.page[F][q]=H)}else this.whiteboardViewState.page[F]!==j&&(e.page=e.page||{},e.page[F]=j)}this.fileTypeMark!==this.whiteboardViewState.documentType&&(e.documentType=this.fileTypeMark),this.fileid!=this.whiteboardViewState.fileid&&(e.fileid=this.fileid),this.dynamicPptVolume!==this.whiteboardViewState.dynamicPptVolume&&(e.dynamicPptVolume=this.dynamicPptVolume),this.fullScreen!==this.whiteboardViewState.fullScreen&&(e.fullScreen=this.fullScreen),this.remark!==this.whiteboardViewState.remark&&(e.remark=this.remark),this.scale!==this.whiteboardViewState.scale&&(e.scale=this.scale);var G=B.allDocumentRemarkInfoMap.get("documentRemark_"+this.fileid);this.remarkText=0!=this.fileid&&G&&G[this.fileid+"_"+u.currentPage]?G[l+"_"+u.currentPage]:"",this.remarkText!==this.whiteboardViewState.remarkText&&(e.remarkText=this.remarkText);var Y=he.getWhiteboardToolsInfo(this.instanceId);if(Y&&"object"===a()(Y))for(var J=0,X=h()(Y);J<X.length;J++){var K=d()(X[J],2),Q=K[0],Z=K[1];void 0!==this.whiteboardViewState.other[Q]&&this.whiteboardViewState.other[Q]!==Z&&(e.other=e.other||{},e.other[Q]=Z)}if(f()(e).length&&(void 0!==e.tool&&this._updateViewShowAndHide(),Object.deepAssign(this.whiteboardViewState,e),f()(this.whiteboardViewState.tool).length&&f()(this.whiteboardViewState.action).length&&f()(this.whiteboardViewState.zoom).length&&f()(this.whiteboardViewState.page).length)){var $={viewState:this.whiteboardViewState,updateViewState:e};this.sendActionCommand("viewStateUpdate",$)}}}},{key:"_sendSignalling_ShowPage",value:function(e,t){if("default"===this.instanceId||this.configration.hasExtendDocument){var n=he.getWhiteboardFiledata(this.instanceId),i={associatedMsgID:this.configration.associatedMsgID,name:"default"===this.instanceId?"ShowPage":"ExtendShowPage",id:"default"===this.instanceId?"DocumentFilePage_ShowPage":"DocumentFilePage_ExtendShowPage_".concat(this.instanceId),toID:"__all",data:{sourceInstanceId:this.instanceId,isGeneralFile:"generalDocument"===this.fileTypeMark,isMedia:!1,isDynamicPPT:"dynamicPPT"===this.fileTypeMark,isH5Document:"h5Document"===this.fileTypeMark,action:"",mediaType:"",filedata:n},save:!0};e&&Object.deepAssign(i,e),this.configration.synchronization&&this.configration.isConnectedRoom&&this.pubMsg(i),t&&"function"==typeof t&&t(i)}}},{key:"_loadCurrentDynamicPpt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("dynamicPPT"===this.fileTypeMark){var n=he.getWhiteboardFiledata(this.instanceId),i=n.fileid,r=n.swfpath,o=n.isContentDocument,a=this.getRealBaseurl(n),s=Number(o)?r:a||B.nowUseDocAddress+r+"/newppt.html",l={versions:V.dynamicPptVersions,fileid:i,playback:this.configration.isPlayback,classbegin:!0,publishDynamicPptMediaPermission_video:this.configration.synchronization&&this.configration.isConnectedRoom,remoteNewpptUpdateTime:V.remoteDynamicPptUpdateTime,role:this.configration.myRole,dynamicPptActionClick:this.configration.actionClick&&this.configration.isConnectedRoom,newpptPagingPage:this.configration.canPage&&this.configration.isConnectedRoom,dynamicPptDebug:V.dynamicPptDebugLog,PptVolumeValue:this.dynamicPptVolume/100,deviceType:"phone"===this.configration.deviceType?0:void 0,isBackEvent:this.configration.isBackEvent,isClientPlayAudio:this.configration.isNativePlayAudio};if(this.setPreloadParams(l,a),void 0!==this.forceReloadTimestampFromPpt&&(l.forceReloadTimestamp=this.forceReloadTimestampFromPpt),void 0!==this.forceReloadNumberFromPpt&&(l.forceReloadNumber=this.forceReloadNumberFromPpt,t.forceReloadNumber=this.forceReloadNumberFromPpt),e&&A.isJson(e))for(var c=0,u=h()(e);c<u.length;c++){var p=d()(u[c],2),f=p[0],m=p[1];l[f]=m}t.playback=this.configration.isPlayback,ye.setDynamicPptIframeSrc(this.instanceId,s,l,S()({baseurl:a},n),t)}}},{key:"_loadCurrentH5Document",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("h5Document"===this.fileTypeMark){var n,i=he.getWhiteboardFiledata(this.instanceId),r=i.fileid,o=i.swfpath,a=i.isContentDocument,s=this.getRealBaseurl(i);L.Logger.info(B.logType,"Document swfpath：",o,"isContentDocument:",a),Number(a)?o&&(n=o):n=s||B.nowUseDocAddress+o;var l=this.configration.sendH5DocumentRoomInfo;if(l.isClientPlayAudio=!0,l.fileid=r,this.setPreloadParams(l,s),l.role=this.configration.myRole,e&&A.isJson(e))for(var c=0,u=h()(e);c<u.length;c++){var p=d()(u[c],2),f=p[0],m=p[1];l[f]=m}be.setH5DocumentIframeSrc(this.instanceId,n,l,S()({baseurl:s},i),t)}}},{key:"setPreloadParams",value:function(e,t){if(t){var n=B.nowUseDocAddress.split(":");e.playProtocol="http",e.playHostname=n[1].replace(/\//g,""),e.playPort="80"}}},{key:"getRealBaseurl",value:function(e){var t="";if(!YS.isYsNative&&!YS.isYsMacNative)return t;if(!B.preloadFile){var n=localStorage.getItem("preloadFile");try{n=JSON.parse(n)}catch(t){n=e.baseurl?e:n}B.preloadFile=n||B.preloadFile}return B.preloadFile&&this.isPreloadFile(e)&&(t=B.preloadFile.baseurl),t}},{key:"isPreloadFile",value:function(e){return!!B.preloadFile&&!!e&&String(B.preloadFile.fileid)===String(e.fileid)}}]),e}()),_e=n(12),Se=n.n(_e),ke=n(13),Pe=n.n(ke),Ce=n(14),Te=n.n(Ce),Ae=function(){function e(t){g()(this,e),"object"!==a()(t)||w()(t)?this.props={}:this.props=Object.shallowAssign({},t),this.state="object"!==a()(this.state)||w()(this.state)?{}:this.state}return y()(e,[{key:"setState",value:function(e){var t=Object.deepAssign({},this.state);Object.shallowAssign(this.state,e);var n=!1;this.shouldComponentUpdateState&&"function"==typeof this.shouldComponentUpdateState&&(n=this.shouldComponentUpdateState(t)),!n&&this.render&&"function"==typeof this.render&&this.render(),this.componentDidUpdateState&&"function"==typeof this.componentDidUpdateState&&this.componentDidUpdateState(t)}},{key:"setProps",value:function(e){var t=Object.deepAssign({},this.props);Object.shallowAssign(this.props,e);var n=!1;this.shouldComponentUpdateProps&&"function"==typeof this.shouldComponentUpdateProps&&(n=this.shouldComponentUpdateProps(t)),!n&&this.render&&"function"==typeof this.render&&this.render(),this.componentDidUpdateProps&&"function"==typeof this.componentDidUpdateProps&&this.componentDidUpdateProps(t)}}]),e}(),Ie=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.elements={},e.userid=e.props.streamInfo?e.props.streamInfo.userid:void 0,e.streamType=e.props.streamInfo?e.props.streamInfo.streamType:void 0,e._createElements(),e._connectElements(),e._playAV(),e}return Te()(t,e),y()(t,[{key:"componentDidUpdateProps",value:function(e){this.props.volume===e.volume&&this.props.muteVolume===e.muteVolume||this._changeVolume(this.props.muteVolume?0:this.props.volume)}},{key:"destroyView",value:function(){for(var e in this._unplayAV(),me.removeChild(this.elements.rootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"getElementId",value:function(){return this.elements.rootElement.id}},{key:"_changeVolume",value:function(e){if(void 0!==e&&"number"==typeof e&&this.props.streamInfo&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()){var t=this.props.streamInfo||{},n=t.userid,i=t.streamType;this.whiteBoardManagerInstance.getRoomDelegate().setVolume&&this.whiteBoardManagerInstance.getRoomDelegate().setVolume(n,i,e)}}},{key:"_createElements",value:function(){var e=(this.props.streamInfo||{}).userid;this.elements.rootElement=me.createElement("div",this.props.videoDumbElementIdPrefix+e,"ys-audio-or-video-player  ys-audio-player-video-dumb")}},{key:"_connectElements",value:function(){me.appendChild(this.parentNode,this.elements.rootElement)}},{key:"_playAV",value:function(){if(this.props.streamInfo&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()&&this.elements.rootElement&&this.elements.rootElement.id){var e=this.props.streamInfo||{},t=e.userid;e.video,e.audio;switch(e.streamType){case"media":if(this.whiteBoardManagerInstance.getRoomDelegate().playRemoteMedia){var n=this.elements.rootElement.id;this.whiteBoardManagerInstance.getRoomDelegate().playRemoteMedia(t,n)}break;case"file":if(this.whiteBoardManagerInstance.getRoomDelegate().playRemoteMediaFile){var i=this.elements.rootElement.id;this.whiteBoardManagerInstance.getRoomDelegate().playRemoteMediaFile(t,i)}}}this._changeVolume(this.props.muteVolume?0:this.props.volume)}},{key:"_unplayAV",value:function(){if(this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate())switch(this.streamType){case"media":this.whiteBoardManagerInstance.getRoomDelegate().unplayRemoteMedia&&this.whiteBoardManagerInstance.getRoomDelegate().unplayRemoteMedia(this.userid);break;case"file":this.whiteBoardManagerInstance.getRoomDelegate().unplayRemoteMediaFile&&this.whiteBoardManagerInstance.getRoomDelegate().unplayRemoteMediaFile(this.userid)}}},{key:"render",value:function(){}}]),t}(Ae),Ee=(n(205),function(e){var t={},n="",i="",r="",o="",a="",s="",l=!1,c=100,d=100,u=document.getElementById(e.sliderContainer.id);u.classList.add("custom-ys-volume-slider-container"),e.sliderContainer&&"vertikal"===e.sliderContainer.direction&&u.classList.add("vertikal"),(i=document.createElement("div")).classList.add("custom-ys-rc-slider","custom-ys-slider","custom-ys-detection-device"),"vertikal"===e.sliderContainer.direction&&i.classList.add("vertikal"),(s=document.createElement("div")).classList.add("custom-ys-rc-slider-rail"),"vertikal"===e.sliderContainer.direction&&s.classList.add("vertikal"),(r=document.createElement("div")).classList.add("custom-ys-rc-slider-track"),"vertikal"===e.sliderContainer.direction&&r.classList.add("vertikal"),(o=document.createElement("div")).classList.add("custom-ys-rc-slider-step"),"vertikal"===e.sliderContainer.direction&&o.classList.add("vertikal"),(n=document.createElement("div")).classList.add("custom-ys-rc-slider-handle"),"vertikal"===e.sliderContainer.direction&&n.classList.add("vertikal"),(a=document.createElement("div")).classList.add("custom-ys-rc-slider-mark"),"vertikal"===e.sliderContainer.direction&&a.classList.add("vertikal"),i.appendChild(s),i.appendChild(r),i.appendChild(o),i.appendChild(n),i.appendChild(a),u.appendChild(i);var h=document,p=window,f=Math;return i.onmousedown=function(t){if(l=!0,"vertikal"===e.sliderContainer.direction){e.onBeforeChange&&e.onBeforeChange(d);var o=(t||p.event).clientY,a=i.offsetHeight;(d=f.round((i.getBoundingClientRect().bottom-o)/a*100))>100?d=100:d<0&&(d=0),n.style.bottom=d+"%",r.style.height=d+"%",i.onmouseup=function(t){return l&&e.onAfterChange&&e.onAfterChange(d),t&&(t.preventDefault(),t.stopPropagation()),!1}}else{e.onBeforeChange&&e.onBeforeChange(d);var s=(t||p.event).clientX,c=i.offsetWidth;(d=f.round((s-i.getBoundingClientRect().left)/c*100))>100?d=100:d<0&&(d=0),n.style.left=d+"%",r.style.width=d+"%",i.onmouseup=function(){l&&e.onAfterChange&&e.onAfterChange(d)}}t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0},n.onclick=function(e){e&&e.stopPropagation?e.stopPropagation():window.event.cancelBubble=!0},n.onmousedown=function(t){var o=!1;if("vertikal"===e.sliderContainer.direction){e.onBeforeChange&&e.onBeforeChange(c);var a=(t||p.event).clientY,s=n.offsetTop,l=i.offsetHeight,d=n.offsetHeight,u=l-(y=l-d);document.onmousemove=function(t){var i=(t||p.event).clientY,m=f.min(y,f.max(-d,s+(i-a)));(c=100-f.round((m+u)/l*100))>100?c=100:c<0&&(c=0),n.style.bottom="calc(("+c+"%) - 3px)",r.style.height=c+"%",e.onChange&&e.onChange(c),p.getSelection?p.getSelection().removeAllRanges():h.selection.empty(),o=!0},document.onmouseup=function(){document.onmousemove=null,e.onAfterChange&&e.onAfterChange(c),document.onmouseup=null}}else{e.onBeforeChange&&o&&e.onBeforeChange(c);var m=(t||p.event).clientX,g=(s=n.offsetLeft,i.offsetWidth),v=n.offsetWidth,y=i.offsetWidth-this.offsetWidth;u=g-y,document.onmousemove=function(t){var i=(t||p.event).clientX,a=f.min(y,f.max(-v,s+(i-m)));(c=f.round((a+u)/g*100))>100?c=100:c<0&&(c=0),n.style.left=c+"%",r.style.width=c+"%",e.onChange&&e.onChange(c),p.getSelection?p.getSelection().removeAllRanges():h.selection.empty(),o=!0},document.onmouseup=function(){document.onmousemove=null,o&&e.onAfterChange&&e.onAfterChange(c),document.onmouseup=null}}t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0},n.ontouchstart=function(t){if(l=!1,"vertikal"===e.sliderContainer.direction){e.onBeforeChange&&e.onBeforeChange(c);var o=(t||p.event).touches[0].clientY,a=n.offsetTop,s=i.offsetHeight,d=n.offsetHeight,u=s-(y=s-d);document.ontouchmove=function(t){var i=(t||p.event).touches[0].clientY,l=f.min(y,f.max(-d,a+(i-o)));(c=100-f.round((l+u)/s*100))>100?c=100:c<0&&(c=0),n.style.bottom="calc(("+c+"%) - 3px)",r.style.height=c+"%",e.onChange&&e.onChange(c),p.getSelection?p.getSelection().removeAllRanges():h.selection.empty()},document.ontouchend=function(){document.ontouchmove=null,e.onAfterChange&&e.onAfterChange(c),document.ontouchend=null}}else{e.onBeforeChange&&e.onBeforeChange(c);var m=(t||p.event).touches[0].clientX,g=(a=n.offsetLeft,i.offsetWidth),v=n.offsetWidth,y=i.offsetWidth-this.offsetWidth;u=g-y,n.ontouchmove=function(t){var i=(t||p.event).touches[0].clientX,o=f.min(y,f.max(-v,a+(i-m)));(c=f.round((o+u)/g*100))>100?c=100:c<0&&(c=0),n.style.left=c+"%",r.style.width=c+"%",e.onChange&&e.onChange(c),p.getSelection?p.getSelection().removeAllRanges():h.selection.empty()},document.ontouchend=function(){document.ontouchmove=null,e.onAfterChange&&e.onAfterChange(c),document.ontouchend=null}}t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0},t.setProgress=function(t){void 0!==t&&("vertikal"===e.sliderContainer.direction?(n.style.bottom=t+"%",r.style.height=t+"%"):(n.style.left=t+"%",r.style.width=t+"%"))},t}),xe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.elements={},e.videoDumb=void 0,e._createElements(),e._connectElements(),e.render(),e}return Te()(t,e),y()(t,[{key:"shouldComponentUpdateProps",value:function(e){if(e.streamInfo!==this.props.streamInfo&&e.streamInfo&&this.props.streamInfo&&e.streamInfo.attributes&&this.props.streamInfo.attributes){for(var t=!1,n=0,i=h()(this.props.streamInfo.attributes);n<i.length;n++){var r=d()(i[n],2),o=r[0],a=r[1];if("position"!==o&&a!==e.streamInfo.attributes[o]){t=!0;break}}if(e.streamInfo.attributes.position!==this.props.streamInfo.attributes.position&&!t)return!0}return!1}},{key:"componentDidUpdateProps",value:function(e){var t=this;if(e.streamInfo!==this.props.streamInfo){var n=void 0===e.streamInfo&&this.props.streamInfo,i=!this.props.streamInfo,r=e.streamInfo&&this.props.streamInfo&&e.streamInfo.attributes&&this.props.streamInfo.attributes&&e.streamInfo.attributes.position!==this.props.streamInfo.attributes.position;if(n||i||r){var o=(new Date).getTime();!this.updateTime||o-this.updateTime>500?(this.updateTime=o,clearTimeout(this._updateProgressTimer),this._updateProgress()):(clearTimeout(this._updateProgressTimer),this._updateProgressTimer=setTimeout(function(){o=(new Date).getTime(),t.updateTime=o,t._updateProgress()},750))}}e.volume!==this.props.volume&&this.volumeSlider&&"function"==typeof this.volumeSlider.setProgress&&a()(this.volumeSlider.setProgress(this.props.volume)),e.muteVolume!==this.props.muteVolume&&this.volumeSlider&&"function"==typeof this.volumeSlider.setProgress&&a()(this.volumeSlider.setProgress(this.props.muteVolume?0:this.props.volume)),e.isPlayback!==this.props.isPlayback&&(this.props.isPlayback?me.addClass(this.elements.mediaTotalControlElement,"ys-playback"):me.removeClass(this.elements.mediaTotalControlElement,"ys-playback")),(e.myUserId!==this.props.myUserId||e.streamInfo!==this.props.streamInfo&&!e.streamInfo&&this.props.streamInfo)&&this._updateControlByPermissions(),A.deepCompareJson(e.controlPermissions,this.props.controlPermissions)&&this._updateControlByPermissions()}},{key:"destroyView",value:function(){for(var e in me.removeChild(this.elements.mediaTotalControlElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"playOrPauseClick",value:function(){"function"==typeof this.props.onPlayOrPauseClick&&this.props.onPlayOrPauseClick()}},{key:"closeClick",value:function(){"function"==typeof this.props.onCloseClick&&this.props.onCloseClick()}},{key:"fullScreenClick",value:function(){"function"==typeof this.props.onFullScreenClick&&this.props.onFullScreenClick()}},{key:"volumeMuteClick",value:function(){"function"==typeof this.props.onVolumeMuteClick&&this.props.onVolumeMuteClick()}},{key:"_formatTime",value:function(e){var t=Y()(e/60),n=Math.round(e%60);return 60===n&&(t+=1,n=0),0===Y()(t/10)&&(t="0"+t),0===Y()(n/10)&&(n="0"+n),t+":"+n}},{key:"_createElements",value:function(){this.elements.mediaTotalControlElement=me.createElement("article",this.instanceId+(this.props.isVideoPlayer?"VideoPlayer":"MediaPlayer")+"RoadofMediaPlayerTotalControl","roadofcloud-sdk-whiteboard ys-media-player  ys-media-player-total-control "+(this.props.isVideoPlayer?"video-player-control-container ":"audio-player-control-container ")+(this.props.isPlayback?"ys-playback ":" "))}},{key:"_connectElements",value:function(){var e=this;me.appendChild(this.parentNode,this.elements.mediaTotalControlElement);var t=(this.props.streamInfo||{}).attributes,n=void 0===t?{}:t,i=n.filename,r=void 0===i?"":i,o=n.position,a=void 0===o?0:o,s=n.duration,l=void 0===s?0:s,c=n.pause;this.elements.mediaTotalControlElement&&(this.elements.mediaTotalControlElement.innerHTML=' \n                <article class="media-player-box clear-float " >\n                    <span class="media-player-icon add-fl '.concat(c?"play":"pause",'" ></span>\n                    <div class="media-player-control-container add-fl clear-float"> \n                        <button  class="play-pause-btn add-cursor-pointer add-fl ').concat(c?"play":"pause",'"  ></button>\n                        <div class="media-player-info-container add-fl"> \n                            <div class="media-player-name-time-container clear-float"> \n                                <span class="media-player-name add-fl add-nowrap" >').concat(r,'</span>\n                                <span class="media-player-time-container add-fr" > \n                                    <em class="curr-time" >').concat(this._formatTime(a/1e3),'</em> / <em class="total-time" >').concat(this._formatTime(l/1e3),'</em>\n                                </span>\n                            </div>\n                            <div class="media-player-progress-container" id="').concat(this.instanceId+(this.props.isVideoPlayer?"VideoPlayer":"MediaPlayer"),'MediaPlayerProgressBar" >                              \n                            </div>\n                        </div>\n                        <div class="volume-info-container add-fl clear-float" > \n                            <button  class="volume-icon add-cursor-pointer add-fl" ></button>\n                            <div class="volume-bar-container add-fl"  id="').concat(this.instanceId+(this.props.isVideoPlayer?"VideoPlayer":"MediaPlayer"),'MediaPlayerVolumeBar" ></div>\n                        </div>\n                        <button  class="close-btn add-cursor-pointer add-fl" ></button>\n                        <button  class="full-screen-btn add-cursor-pointer add-fl" ></button>\n                    </div>\n                </article> \n            '),this.elements.playPauseBtnElement=this.elements.mediaTotalControlElement.getElementsByClassName("play-pause-btn")[0],this.elements.playPauseIconElement=this.elements.mediaTotalControlElement.getElementsByClassName("media-player-icon")[0],this.elements.volumeMuteBtnElement=this.elements.mediaTotalControlElement.getElementsByClassName("volume-icon")[0],this.elements.closeBtnElement=this.elements.mediaTotalControlElement.getElementsByClassName("close-btn")[0],this.elements.fullScreenBtnElement=this.elements.mediaTotalControlElement.getElementsByClassName("full-screen-btn")[0],this.elements.filenameElement=this.elements.mediaTotalControlElement.getElementsByClassName("media-player-name")[0],this.elements.currTimeElement=this.elements.mediaTotalControlElement.getElementsByClassName("curr-time")[0],this.elements.totalTimeElement=this.elements.mediaTotalControlElement.getElementsByClassName("total-time")[0],this.elements.mediaPlayerProgressElement=this.elements.mediaTotalControlElement.getElementsByClassName("media-player-progress-container")[0],this.elements.playPauseBtnElement.onclick=this.playOrPauseClick.bind(this),this.elements.volumeMuteBtnElement.onclick=this.volumeMuteClick.bind(this),this.elements.closeBtnElement.onclick=this.closeClick.bind(this),this.elements.fullScreenBtnElement.onclick=this.fullScreenClick.bind(this),Ee&&(this.progressSlider=new Ee({sliderContainer:{id:e.instanceId+(e.props.isVideoPlayer?"VideoPlayer":"MediaPlayer")+"MediaPlayerProgressBar",direction:"horizontal"},onBeforeChange:function(t){e.mediaPlayerProgressSlidering=!0},onAfterChange:function(t){e.mediaPlayerProgressSlidering=!1,"function"==typeof e.props.onChangeProgress&&e.props.onChangeProgress(t),e._updateProgress(),e.tempStopUpdatePosition=!0,setTimeout(function(){e.tempStopUpdatePosition=!1},500)}}),this.volumeSlider=new Ee({sliderContainer:{id:e.instanceId+(e.props.isVideoPlayer?"VideoPlayer":"MediaPlayer")+"MediaPlayerVolumeBar",direction:"horizontal"},onAfterChange:function(t){"function"==typeof e.props.onChangeVolume&&e.props.onChangeVolume(t)}})),this._updateControlByPermissions())}},{key:"_updateControlByPermissions",value:function(){var e=!1,t=this.props.streamInfo||{},n=t.streamType,i=t.userid;"file"===n&&i!=this.props.myUserId&&(e=!0),me.updateStyle(this.elements.playPauseBtnElement,{display:!this.props.controlPermissions.hasPlayOrPause||e?"none":""}),this.elements.playPauseBtnElement.disabled=!this.props.controlPermissions.hasPlayOrPause||e,me.updateStyle(this.elements.closeBtnElement,{display:this.props.controlPermissions.hasClose?"":"none"}),this.elements.closeBtnElement.disabled=!this.props.controlPermissions.hasClose,this.progressSlider&&A.isFunction(this.progressSlider.updateDisabled)&&this.progressSlider.updateDisabled(!this.props.controlPermissions.hasChangeProgress||e),!this.props.controlPermissions.hasChangeProgress||e?me.addClass(this.elements.mediaPlayerProgressElement,"disabled"):me.removeClass(this.elements.mediaPlayerProgressElement,"disabled")}},{key:"_updateProgress",value:function(){if(this.props.streamInfo&&!this.mediaPlayerProgressSlidering&&!this.tempStopUpdatePosition&&this.progressSlider&&"function"==typeof this.progressSlider.setProgress){var e=0,t=this.props.streamInfo&&this.props.streamInfo.attributes?this.props.streamInfo.attributes:{},n=t.position,i=void 0===n?0:n,r=t.duration,o=void 0===r?0:r;0!==o&&(e=i/o*100,isNaN(e)&&(e=0)),e<0?e=0:e>100&&(e=100),this.elements.currTimeElement.innerHTML=this._formatTime(i/1e3),this.progressSlider.setProgress(e)}}},{key:"render",value:function(){var e=this.props,t=e.streamInfo,n=void 0===t?{}:t,i=e.muteVolume,r=e.isFullScreen,o=n.attributes,a=void 0===o?{}:o,s=a.filename,l=void 0===s?"":s,c=a.position,d=void 0===c?0:c,u=a.duration,h=void 0===u?0:u,p=a.pause;this.elements.filenameElement.innerHTML=l,this.elements.currTimeElement.innerHTML=this._formatTime(d/1e3),this.elements.totalTimeElement.innerHTML=this._formatTime(h/1e3),p?(me.removeClass(this.elements.playPauseBtnElement,"pause"),me.addClass(this.elements.playPauseBtnElement,"play"),me.removeClass(this.elements.playPauseIconElement,"pause"),me.addClass(this.elements.playPauseIconElement,"play")):(me.removeClass(this.elements.playPauseBtnElement,"play"),me.addClass(this.elements.playPauseBtnElement,"pause"),me.removeClass(this.elements.playPauseIconElement,"play"),me.addClass(this.elements.playPauseIconElement,"pause")),i?me.addClass(this.elements.volumeMuteBtnElement,"mute"):me.removeClass(this.elements.volumeMuteBtnElement,"mute"),r?me.addClass(this.elements.fullScreenBtnElement,"yes"):me.removeClass(this.elements.fullScreenBtnElement,"yes")}}]),t}(Ae),Re=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).isVideoPlayer=s,e.parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.configration=a,e.state={streamInfo:void 0,volume:100,muteVolume:!1,isFullScreen:!1},e.progressIntervalDuration=1e3,e.elements={},e.videoDumb=void 0,e._createElements(),e._connectElements(),e.render(),e}return Te()(t,e),y()(t,[{key:"shouldComponentUpdateState",value:function(e){if(e.streamInfo!==this.state.streamInfo&&e.streamInfo&&this.state.streamInfo&&e.streamInfo.attributes&&this.state.streamInfo.attributes){for(var t=!1,n=0,i=h()(this.state.streamInfo.attributes);n<i.length;n++){var r=d()(i[n],2),o=r[0],a=r[1];if("position"!==o&&a!==e.streamInfo.attributes[o]){t=!0;break}}if(e.streamInfo.attributes.position!==this.state.streamInfo.attributes.position&&!t)return!0}return!1}},{key:"componentDidUpdateState",value:function(e){if(e.streamInfo&&!this.state.streamInfo){var t=this.elements.rootElement;A.getFullscreenElement()&&A.getFullscreenElement().id===t.id&&A.exitFullscreen()}if(this.elements.closeVideoPlayerElement&&this.state.streamInfo){var n=!1,i=this.state.streamInfo||{},r=i.streamType,o=i.userid;"file"===r&&o!=this.props.myUserId&&(n=!0),me.updateStyle(this.elements.closeVideoPlayerElement,{display:!this.props.controlPermissions.hasClose||n?"none":""}),this.elements.closeVideoPlayerElement.disabled=!this.props.controlPermissions.hasClose||n}this.state.streamInfo&&this.state.streamInfo.attributes?!this.progressTimer||"media"!==this.state.streamInfo.streamType||this.state.streamInfo.userid!=this.props.myUserId&&0!=this.props.myRole&&1!=this.props.myRole?this.progressTimer&&this.state.streamInfo.attributes.pause?this._stopProgressTimer():this.progressTimer||this.state.streamInfo.attributes.pause||this._startProgressTimer():this._stopProgressTimer():this.progressTimer&&this._stopProgressTimer(),this.videoDumb&&(e.volume!==this.state.volume&&this.videoDumb.setProps({volume:this.state.volume}),e.muteVolume!==this.state.muteVolume&&this.videoDumb.setProps({muteVolume:this.state.muteVolume}),e.streamInfo!==this.state.streamInfo&&this.videoDumb.setProps({streamInfo:this.state.streamInfo})),this.mediaPlayerControllerDumb&&(e.streamInfo!==this.state.streamInfo&&this.mediaPlayerControllerDumb.setProps({streamInfo:this.state.streamInfo}),e.volume!==this.state.volume&&this.mediaPlayerControllerDumb.setProps({volume:this.state.volume}),e.muteVolume!==this.state.muteVolume&&this.mediaPlayerControllerDumb.setProps({muteVolume:this.state.muteVolume}),e.isFullScreen!==this.state.isFullScreen&&this.mediaPlayerControllerDumb.setProps({isFullScreen:this.state.isFullScreen}))}},{key:"componentDidUpdateProps",value:function(e){if(e.isLoadControl!==this.props.isLoadControl&&(!this.mediaPlayerControllerDumb&&this.props.isLoadControl?this._loadMediaPlayerController():this.mediaPlayerControllerDumb&&!this.props.isLoadControl&&(this.mediaPlayerControllerDumb.destroyView(),this.mediaPlayerControllerDumb=void 0)),this.elements.closeVideoPlayerElement&&e.controlPermissions.hasClose!==this.props.controlPermissions.hasClose){var t=!1,n=this.state.streamInfo||{},i=n.streamType,r=n.userid;"file"===i&&r!=this.props.myUserId&&(t=!0),me.updateStyle(this.elements.closeVideoPlayerElement,{display:!this.props.controlPermissions.hasClose||t?"none":""}),this.elements.closeVideoPlayerElement.disabled=!this.props.controlPermissions.hasClose||t}this.mediaPlayerControllerDumb&&(e.myUserId!==this.props.myUserId&&this.mediaPlayerControllerDumb.setProps({myUserId:this.props.myUserId}),e.isPlayback!==this.props.isPlayback&&(this.props.isPlayback?me.addClass(this.elements.rootElement,"ys-playback"):me.removeClass(this.elements.rootElement,"ys-playback"),this.mediaPlayerControllerDumb.setProps({isPlayback:this.props.isPlayback})),e.controlPermissions!==this.props.controlPermissions&&this.mediaPlayerControllerDumb.setProps({controlPermissions:this.props.controlPermissions})),this.videoDumb&&e.myUserId!==this.props.myUserId&&this.videoDumb.setProps({myUserId:this.props.myUserId})}},{key:"destroyView",value:function(){for(var e in me.removeChild(this.elements.rootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"receiveEventFullScreenChange",value:function(e){if(A.isFullScreenStatus()){var t=this.elements.rootElement;A.getFullscreenElement()&&A.getFullscreenElement().id===t.id?this._changeFullScreenState(!0):this._changeFullScreenState(!1)}else this._changeFullScreenState(!1)}},{key:"onPlayOrPauseClick",value:function(){var e=this;if("pc"===YS.SDKTYPE&&this.state.streamInfo&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()){var t=this.whiteBoardManagerInstance.getRoomDelegate();switch(this.state.streamInfo.streamType){case"media":if(this.state.streamInfo.attributes.pause){var n=this.state.streamInfo.attributes,i=n.position,r=void 0===i?0:i,o=n.duration;r>=(void 0===o?0:o)&&t.seekMedia(0),t.pauseShareMedia(!1),me.updateStyle(this.elements.closeVideoPlayerElement,{display:""}),this.props.controlCallback&&this.props.controlCallback.play&&A.isFunction(this.props.controlCallback.play)&&this.props.controlCallback.play()}else t.pauseShareMedia(!0),me.updateStyle(this.elements.closeVideoPlayerElement,{display:"none"}),this.props.controlCallback&&this.props.controlCallback.pause&&A.isFunction(this.props.controlCallback.pause)&&this.props.controlCallback.pause();break;case"file":if(this.state.streamInfo.userid===this.props.myUserId&&t.getNativeInterface()){var a=t.getNativeInterface();if(this.state.streamInfo.attributes.pause){var s=this.state.streamInfo.attributes,l=s.position,c=void 0===l?0:l,d=s.duration,u=void 0===d?0:d;this._updateLocalFileStreamInfoPlayerPosition(function(){c+1e3>=u&&a.seekMediaFile(0),a.pauseShareMediaFile(!1),e.props.controlCallback&&e.props.controlCallback.play&&A.isFunction(e.props.controlCallback.play)&&(e.props.controlCallback.play(),me.updateStyle(e.elements.closeVideoPlayerElement,{display:""}))})}else a.pauseShareMediaFile(!0),this.props.controlCallback&&this.props.controlCallback.pause&&A.isFunction(this.props.controlCallback.pause)&&(this.props.controlCallback.pause(),me.updateStyle(this.elements.closeVideoPlayerElement,{display:"none"}))}}}}},{key:"onChangeVolume",value:function(e){var t={volume:e};0!==e||this.state.muteVolume?0!==e&&this.state.muteVolume&&(t.muteVolume=!1):t.muteVolume=!0,this.setState(t)}},{key:"onChangeProgress",value:function(e){if("mobile"!==YS.SDKTYPE&&this.state.streamInfo&&this.state.streamInfo.attributes&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate())switch(this.state.streamInfo.streamType){case"media":var t=e/100;t<0&&(t=0),t>1&&(t=1);var n=this.state.streamInfo.attributes.duration*t;this._updateStreamInfoAttributes("position",n),this.whiteBoardManagerInstance.getRoomDelegate().seekMedia(t);break;case"file":if(this.state.streamInfo.userid===this.props.myUserId&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface()){var i=e/100;i<0&&(i=0),i>1&&(i=1);var r=this.state.streamInfo.attributes.duration*i;this._updateStreamInfoAttributes("position",r),this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().seekMediaFile(i)}}}},{key:"onVolumeMuteClick",value:function(){var e={muteVolume:!this.state.muteVolume};!e.muteVolume&&this.state.volume<=0&&(e.volume=100),this.setState(e)}},{key:"onCloseClick",value:function(){if(this.state.streamInfo&&this.whiteBoardManagerInstance)switch(this.state.streamInfo.streamType){case"media":this.whiteBoardManagerInstance.stopShareMedia();break;case"file":this.whiteBoardManagerInstance.stopShareLocalMedia()}}},{key:"onFullScreenClick",value:function(){if(this.state.isFullScreen)A.exitFullscreen();else{A.isFullScreenStatus()&&A.exitFullscreen();var e=this.elements.rootElement;A.launchFullscreen(e)}}},{key:"_createElements",value:function(){this.elements.rootElement=me.createElement("section",this.instanceId+(this.isVideoPlayer?"VideoPlayer":"AudioPlayer")+"RoadofMediaPlayerBox","roadofcloud-sdk-whiteboard ys-media-player  ys-media-player-container "+(this.isVideoPlayer?"ys-video-player-container ":"ys-audio-player-container ")+(this.props.isPlayback?"ys-playback ":" "),{display:this.state.streamInfo?"":"none"}),this.elements.mediaSourceElement=me.createElement("article",this.instanceId+(this.isVideoPlayer?"VideoPlayer":"AudioPlayer")+"RoadofMediaPlayerSourceBox","roadofcloud-sdk-whiteboard ys-media-player  ys-media-player-source",{display:this.isVideoPlayer?"":"none"});var e=!1,t=this.state.streamInfo||{},n=t.streamType,i=t.userid;"file"===n&&i!=this.props.myUserId&&(e=!0),this.isVideoPlayer&&(this.elements.closeVideoPlayerElement=me.createElement("button",void 0,"roadofcloud-sdk-whiteboard add-cursor-pointer ys-video-player-close-btn ",{display:!this.props.controlPermissions.hasClose||e?"none":""})),this.elements.mediaTotalControlElement=me.createElement("article",this.instanceId+(this.isVideoPlayer?"VideoPlayer":"AudioPlayer")+"RoadofMediaPlayerTotalControlBox","roadofcloud-sdk-whiteboard ys-media-player  ys-media-player-total-control-box",{}),this.isVideoPlayer&&(this.elements.rootElement.onmouseover=this._videoMouseover.bind(this),this.elements.rootElement.onmouseout=this._videoMouseout.bind(this),this.elements.rootElement.onclick=this._videoClick.bind(this),this.elements.mediaTotalControlElement.onmouseover=this._videoControlMouseover.bind(this),this.elements.mediaTotalControlElement.onclick=this._videoControlClick.bind(this))}},{key:"_videoMouseover",value:function(){var e=this;me.addClass(this.elements.rootElement,"show-controller"),clearTimeout(this.showControllerTimer),this.showControllerTimer=setTimeout(function(){me.removeClass(e.elements.rootElement,"show-controller")},2e3)}},{key:"_videoMouseout",value:function(){me.removeClass(this.elements.rootElement,"show-controller")}},{key:"_videoClick",value:function(e){var t=this;this.elements.rootElement.classList.toggle("show-controller")&&(clearTimeout(this.showControllerTimer),this.showControllerTimer=setTimeout(function(){me.removeClass(t.elements.rootElement,"show-controller")},2e3))}},{key:"_videoControlMouseover",value:function(e){clearTimeout(this.showControllerTimer),me.addClass(this.elements.rootElement,"show-controller"),e.stopPropagation()}},{key:"_videoControlClick",value:function(e){e.stopPropagation()}},{key:"_connectElements",value:function(){me.appendChild(this.elements.rootElement,this.elements.mediaSourceElement),me.appendChild(this.elements.rootElement,this.elements.mediaTotalControlElement),this.elements.closeVideoPlayerElement&&me.appendChild(this.elements.rootElement,this.elements.closeVideoPlayerElement),me.appendChild(this.parentNode,this.elements.rootElement),this.props.isLoadControl&&this._loadMediaPlayerController(),this.elements.closeVideoPlayerElement&&(this.elements.closeVideoPlayerElement.onclick=this.onCloseClick.bind(this))}},{key:"_loadMediaPlayerController",value:function(){this.props.isLoadControl?(this.mediaPlayerControllerDumb&&this.mediaPlayerControllerDumb.destroyView(),this.mediaPlayerControllerDumb=new xe(this.elements.mediaTotalControlElement,this.instanceId,this.whiteBoardManagerInstance,{streamInfo:this.state.streamInfo,volume:this.state.volume,muteVolume:this.state.muteVolume,isFullScreen:this.state.isFullScreen,isPlayback:this.props.isPlayback,myUserId:this.props.myUserId,controlPermissions:this.props.controlPermissions,isVideoPlayer:this.isVideoPlayer,onCloseClick:this.onCloseClick.bind(this),onPlayOrPauseClick:this.onPlayOrPauseClick.bind(this),onChangeVolume:this.onChangeVolume.bind(this),onVolumeMuteClick:this.onVolumeMuteClick.bind(this),onChangeProgress:this.onChangeProgress.bind(this),onFullScreenClick:this.onFullScreenClick.bind(this)})):this.mediaPlayerControllerDumb&&this.mediaPlayerControllerDumb.destroyView()}},{key:"_formatTime",value:function(e){var t=Y()(e/60),n=Math.round(e%60);return 60===n&&(t+=1,n=0),0===Y()(t/10)&&(t="0"+t),0===Y()(n/10)&&(n="0"+n),t+":"+n}},{key:"_startProgressTimer",value:function(){var e=this;if(this.props.isPlayback)this._stopProgressTimer();else if(this._stopProgressTimer(),this.state.streamInfo){if("media"===this.state.streamInfo.streamType&&(this.state.streamInfo.userid==this.props.myUserId||0==this.props.myRole||1==this.props.myRole))return void this._stopProgressTimer();this.progressTimer=setInterval(function(){if(e.state.streamInfo){var t=e.state.streamInfo,n=t.userid,i=t.streamType,r=t.attributes,o=void 0===r?{}:r;switch(i){case"media":if("media"===e.state.streamInfo.streamType&&(e.state.streamInfo.userid==e.props.myUserId||0==e.props.myRole||1==e.props.myRole))return void e._stopProgressTimer();var a=o.position,s=void 0===a?0:a,l=o.duration,c=void 0===l?0:l;(s+=e.progressIntervalDuration)>c&&(s=c,e._stopProgressTimer()),e._updateStreamInfoAttributes("position",s);break;case"file":if(n!==e.props.myUserId){var d=o.position,u=void 0===d?0:d,h=o.duration,p=void 0===h?0:h;(u+=e.progressIntervalDuration)>p&&(u=p,e._stopProgressTimer()),e._updateStreamInfoAttributes("position",u)}else e._updateLocalFileStreamInfoPlayerPosition()}}else e._stopProgressTimer()},this.progressIntervalDuration)}}},{key:"_stopProgressTimer",value:function(){clearInterval(this.progressTimer),this.progressTimer=null}},{key:"_updateStreamInfoAttributes",value:function(e,t){if(this.state.streamInfo){var n={};n[e]=t,this.setState({streamInfo:Object.deepAssign({},this.state.streamInfo,{attributes:n})})}}},{key:"_updateLocalFileStreamInfoPlayerPosition",value:function(e){var t=this;this.state.streamInfo&&"file"===this.state.streamInfo.streamType&&this.state.streamInfo.userid===this.props.myUserId&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().getMediaFileProgress(function(n){if("object"===a()(n)){var i=n.position,r=void 0===i?0:i,o=n.duration,s=void 0===o?0:o;r>s&&(r=s,t._stopProgressTimer()),t._updateStreamInfoAttributes("position",r),A.isFunction(e)&&e(n)}})}},{key:"_changeFullScreenState",value:function(e){this.setState({isFullScreen:e})}},{key:"getVideoDumbElementId",value:function(){if(this.videoDumb)return this.videoDumb.getElementId()}},{key:"render",value:function(){this.state.streamInfo&&!this.videoDumb?this.videoDumb=new Ie(this.elements.mediaSourceElement,this.instanceId,this.whiteBoardManagerInstance,{videoDumbElementIdPrefix:this.instanceId,streamInfo:this.state.streamInfo,volume:this.state.volume,muteVolume:this.state.muteVolume,myUserId:this.props.myUserId}):!this.state.streamInfo&&this.videoDumb&&(this.videoDumb.destroyView(),this.videoDumb=void 0),me.updateStyle(this.elements.rootElement,{display:this.state.streamInfo?"":"none"})}}]),t}(Ae),De=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};g()(this,t);return Se()(this,Pe()(t).call(this,e,n,i,r,o,!1))}return Te()(t,e),y()(t,[{key:"reveiveEventRoomUsermediaorfilestateChanged",value:function(e){var t=e.message,n=t.type,i=t.userId,r=t.attributes,o=void 0===r?{}:r,a=t.published;if(("media"===n||"file"===n)&&o.audio&&!o.video)if(a){this.setState({streamInfo:void 0}),this.setState({streamInfo:{userid:i,streamType:n,audio:o.audio,video:o.video,attributes:o}}),i===this.props.myUserId&&"file"===n&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface()&&(this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().pauseShareMediaFile(!1),this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().seekMediaFile(0));var s=o.pause;this.sendMediaPlayerNoticeActionCommand("start",e),this.sendMediaPlayerNoticeActionCommand(s?"pause":"play",e)}else this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("end",e)}},{key:"reveiveEventRoomUsermediaorfileattributesUpdate",value:function(e){var t=e.message,n=t.type,i=t.attributes,r=void 0===i?{}:i,o=t.updateAttributes,a=void 0===o?{}:o;"media"!==n&&"file"!==n||!r.audio||r.video||this.state.streamInfo&&(this.setState({streamInfo:Object.deepAssign({},this.state.streamInfo,{attributes:a})}),void 0!==a.pause&&this.sendMediaPlayerNoticeActionCommand(a.pause?"pause":"play",e))}},{key:"receiveEventRoomErrorNotice",value:function(e){switch(e.errorCode){case YS.ERROR_NOTICE.SHARE_MEDIA_FAILURE:case YS.ERROR_NOTICE.SHARE_FILE_FAILURE:this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("startShareMediaFail",e);break;case YS.ERROR_NOTICE.STOP_MEDIA_FAILURE:case YS.ERROR_NOTICE.STOP_FILE_FAILURE:this.sendMediaPlayerNoticeActionCommand("stopShareMediaFail",e);break;case YS.ERROR_NOTICE.SUBSCRIBE_MEDIA_FAILURE:case YS.ERROR_NOTICE.SUBSCRIBE_FILE_FAILURE:this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("subscribeShareMediaFail",e);break;case YS.ERROR_NOTICE.UNSUBSCRIBE_MEDIA_FAILURE:case YS.ERROR_NOTICE.UNSUBSCRIBE_FILE_FAILURE:this.sendMediaPlayerNoticeActionCommand("unsubscribeShareMediaFail",e)}}},{key:"sendMediaPlayerNoticeActionCommand",value:function(e,t){var n=t.message,i=n.type,r=n.userId,o=n.attributes,a=void 0===o?{}:o;if(("media"===i||"file"===i)&&a.audio&&!a.video&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.whiteboardViewMap&&this.whiteBoardManagerInstance.whiteboardViewMap.has("default")){var s=this.whiteBoardManagerInstance.whiteboardViewMap.get("default");if(s&&s.sendActionCommand){var l,c={playerType:"audioPlayer",userid:r,streamType:i,audio:a.audio,video:a.video,attributes:a,isDynamicPptVideo:!1};l=Object.deepAssign({type:e,fileid:c.attributes.fileid},c),s.sendActionCommand("mediaPlayerNotice",l)}}}}]),t}(Re),Le=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};g()(this,t);return(e=Se()(this,Pe()(t).call(this,n,i,r,o,a,!0))).configration=a,e}return Te()(t,e),y()(t,[{key:"reveiveEventRoomUsermediaorfilestateChanged",value:function(e){var t=e.message,n=t.type,i=t.userId,r=t.attributes,o=void 0===r?{}:r,a=t.published;if(("media"===n||"file"===n)&&o.audio&&o.video)if(a){B.isPlayVideoing=!0,this.setState({streamInfo:void 0}),this.setState({streamInfo:{userid:i,streamType:n,audio:o.audio,video:o.video,attributes:o}}),i===this.props.myUserId&&"file"===n&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.getRoomDelegate()&&this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface()&&(this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().pauseShareMediaFile(!1),this.whiteBoardManagerInstance.getRoomDelegate().getNativeInterface().seekMediaFile(0));var s=o.pause;this.sendMediaPlayerNoticeActionCommand("start",e),this.sendMediaPlayerNoticeActionCommand(s?"pause":"play",e),this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.reveiveEventRoomReceiveActionCommand&&this.whiteBoardManagerInstance.reveiveEventRoomReceiveActionCommand({type:"room-receiveActionCommand",message:{action:"closeDynamicPptWebPlay"}})}else B.isPlayVideoing=!1,this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("end",e)}},{key:"reveiveEventRoomUsermediaorfileattributesUpdate",value:function(e){var t=e.message,n=t.type,i=t.attributes,r=void 0===i?{}:i,o=t.updateAttributes,a=void 0===o?{}:o;("media"===n||"file"===n)&&r.audio&&r.video&&this.state.streamInfo&&(this.setState({streamInfo:Object.deepAssign({},this.state.streamInfo,{attributes:a})}),void 0!==a.pause&&this.sendMediaPlayerNoticeActionCommand(a.pause?"pause":"play",e))}},{key:"receiveEventRoomErrorNotice",value:function(e){switch(e.errorCode){case YS.ERROR_NOTICE.SHARE_MEDIA_FAILURE:case YS.ERROR_NOTICE.SHARE_FILE_FAILURE:B.isPlayVideoing=!1,this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("startShareMediaFail",e);break;case YS.ERROR_NOTICE.STOP_MEDIA_FAILURE:case YS.ERROR_NOTICE.STOP_FILE_FAILURE:this.sendMediaPlayerNoticeActionCommand("stopShareMediaFail",e);break;case YS.ERROR_NOTICE.SUBSCRIBE_MEDIA_FAILURE:case YS.ERROR_NOTICE.SUBSCRIBE_FILE_FAILURE:B.isPlayVideoing=!1,this.setState({streamInfo:void 0}),this.sendMediaPlayerNoticeActionCommand("subscribeShareMediaFail",e);break;case YS.ERROR_NOTICE.UNSUBSCRIBE_MEDIA_FAILURE:case YS.ERROR_NOTICE.UNSUBSCRIBE_FILE_FAILURE:this.sendMediaPlayerNoticeActionCommand("unsubscribeShareMediaFail",e)}}},{key:"sendMediaPlayerNoticeActionCommand",value:function(e,t){var n=t.message,i=n.type,r=n.userId,o=n.attributes,a=void 0===o?{}:o;if(("media"===i||"file"===i)&&a.audio&&a.video&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.whiteboardViewMap&&this.whiteBoardManagerInstance.whiteboardViewMap.has("default")){var s=this.whiteBoardManagerInstance.whiteboardViewMap.get("default");if(s&&s.sendActionCommand){var l,c={playerType:"videoPlayer",userid:r,streamType:i,audio:a.audio,video:a.video,attributes:a};c.isDynamicPptVideo="dynamicPPT"===c.attributes.source||"videoPlayer"===c.playerType&&""===c.attributes.filename,l=Object.deepAssign({type:e,fileid:c.attributes.fileid},c),s.sendActionCommand("mediaPlayerNotice",l),A.isFunction(s.forceViewStateUpdate)&&s.forceViewStateUpdate()}}}}]),t}(Re),Me=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g()(this,t),(n=Se()(this,Pe()(t).call(this,i))).parentNode=e,n.elements={},n.state={extendShow:!1},n.listDirection="down",n._createConnectElements(),n.render(),n}return Te()(t,e),y()(t,[{key:"componentDidUpdateState",value:function(e){e.extendShow!==this.state.extendShow&&this._noticeSelectExtendListShowOrHide(this.state.extendShow)}},{key:"componentDidUpdateProps",value:function(e){if(e.selectOptions!==this.state.selectOptions){var t=this.props,n=t.optionClassName,i=t.selectOptions,r=void 0===i?[]:i,o=t.disabled,a=t.currentValue;me.removeAllChild(this.elements.selectListViewElement);for(var s=0;s<r.length;s++){var l=me.createElement("li",void 0,"select-option "+(n||" ")+(a===r[s].value?" selected":" "));l.innerHTML=r[s].value,l.onclick=o?void 0:this.optionOnClick.bind(this,r[s].value,s),me.appendChild(this.elements.selectListViewElement,l)}}}},{key:"destroyView",value:function(){for(var e in me.removeChild(this.elements.selectViewRootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"forceHideSelectExtendList",value:function(){this.setState({extendShow:!1})}},{key:"currentTextOnClick",value:function(e){return!this.props.disabled&&(this.setState({extendShow:!this.state.extendShow}),e&&(e.preventDefault(),e.stopPropagation()),!1)}},{key:"optionOnClick",value:function(e,t,n){return!this.props.disabled&&(e!==this.props.currentValue&&this.props.onChange&&"function"==typeof this.props.onChange&&this.props.onChange(e,t),this.setState({extendShow:!1}),n&&(n.preventDefault(),n.stopPropagation()),!1)}},{key:"selectContainerOnMouseLeave",value:function(e){return this.setState({extendShow:!1}),e&&(e.preventDefault(),e.stopPropagation()),!1}},{key:"_noticeSelectExtendListShowOrHide",value:function(e){this.props.noticeSelectExtendListShowOrHide&&"function"==typeof this.props.noticeSelectExtendListShowOrHide&&this.props.noticeSelectExtendListShowOrHide(e)}},{key:"_getRect",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement.clientTop,i=document.documentElement.clientLeft;return{top:t.top-n,bottom:t.bottom-n,left:t.left-i,right:t.right-i,width:t.width,height:t.height}}},{key:"_createConnectElements",value:function(){this.elements.selectViewRootElement=me.createElement("article",this.props.id,void 0,{}),this.elements.currentSelectTextElement=me.createElement("button",void 0,void 0,{}),this.elements.arrowElement=me.createElement("span"),this.elements.arrowElement.innerHTML='<em class="arrow "></em>',this.elements.selectListViewElement=me.createElement("ol"),me.appendChild(this.elements.selectViewRootElement,this.elements.currentSelectTextElement),me.appendChild(this.elements.selectViewRootElement,this.elements.arrowElement),me.appendChild(this.elements.selectViewRootElement,this.elements.selectListViewElement),me.appendChild(this.parentNode,this.elements.selectViewRootElement),this.elements.currentSelectTextElement.onclick=this.currentTextOnClick.bind(this),this.elements.selectViewRootElement.onmouseleave=this.selectContainerOnMouseLeave.bind(this)}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.disabled,i=e.currentValue,r=void 0===i?"":i;if(me.updateStyle(this.elements.selectListViewElement,{display:n?"none":this.state.extendShow?"block":"none"}),this.listDirection=this.props.listDirection||this.listDirection,me.resetClass(this.elements.selectViewRootElement,"roadofcloud-sdk-whiteboard  select-root ys-select-container clear-float "+(n?" disabled ":"  ")+(t||"")+(n?" hideExtendList":this.state.extendShow?" showExtendList":" hideExtendList")),me.resetClass(this.elements.currentSelectTextElement,"roadofcloud-sdk-whiteboard  select-btn current-select-text-btn current-select-text "+(n?"disabled ":" ")),me.resetClass(this.elements.arrowElement,"arrow-container "+(n?"disabled ":" ")),me.resetClass(this.elements.selectListViewElement,"select-extend-list-container "+(this.props.isMobile?" ":"custom-scroll-bar")+(n?" disabled ":"  ")+(n?" hide":this.state.extendShow?" show":" hide")),n?this.elements.currentSelectTextElement.setAttribute("disabled","true"):this.elements.currentSelectTextElement.removeAttribute("disabled"),this.elements.currentSelectTextElement.value=r,this.elements.currentSelectTextElement.innerText=r,this.props.parentNode&&this.state.extendShow&&!this.props.disabled&&!this.props.listDirection){var o=this._getRect(this.props.parentNode),a=this._getRect(this.elements.selectListViewElement);a.top-o.top>o.height-a.height+5?this.listDirection="up":this.listDirection="down",me.removeClass(this.elements.selectViewRootElement,["down","up"]),me.removeClass(this.elements.selectListViewElement,["down","up"]),me.addClass(this.elements.selectViewRootElement,this.listDirection),me.addClass(this.elements.selectListViewElement,this.listDirection)}else me.removeClass(this.elements.selectViewRootElement,["down","up"]),me.removeClass(this.elements.selectListViewElement,["down","up"]),me.addClass(this.elements.selectViewRootElement,this.listDirection),me.addClass(this.elements.selectListViewElement,this.listDirection)}}]),t}(Ae),We=new O.a;We.set("ch",{documentToolbar:{prevPage:"上一页",nextPage:"下一页",prevStep:"上一页",nextStep:"下一页",addPage:"加页",enlargeWhiteboard:"放大",narrowWhiteboard:"缩小",pptVolume:"音量",onRemark:"打开备注",offRemark:"关闭备注",onGeneralDocumentFullScreen:"绘制区域全屏",offGeneralDocumentFullScreen:"绘制区域取消全屏",onDynamicPPTFullScreen:"PPT全屏",offDynamicPPTFullScreen:"PPT取消全屏",onH5DocumentFullScreen:"H5课件全屏",offH5DocumentFullScreen:"H5课件取消全屏"},whiteboardToolbar:{fontFamily:{title:"文字样式",options:{Msyh:"微软雅黑",Ming:"宋体",Arial:"Arial"}},fontSizeText:"号",pencilWidthTitle:"线条宽度",eraserWidthTitle:"橡皮擦大小",toolTextList:{tool_mouse:"鼠标",tool_laser:"激光笔",penList:"笔",tool_pencil:"铅笔",tool_highlighter:"荧光笔",tool_line:"线条",tool_arrow:"箭头",tool_text:"文字",shapeList:"形状",tool_rectangle_empty:"空心矩形",tool_rectangle:"矩形",tool_ellipse_empty:"空心椭圆",tool_ellipse:"椭圆",tool_eraser:"橡皮檫",action_undo:"撤销",action_redo:"恢复",action_clear:"清屏",settingList:"更多设置"}},documentRemark:{name:"备注",closeTitle:"关闭备注"}}),We.set("tw",{documentToolbar:{prevPage:"上壹頁",nextPage:"下壹頁",prevStep:"上壹頁",nextStep:"下壹頁",addPage:"加頁",enlargeWhiteboard:"放大",narrowWhiteboard:"縮小",pptVolume:"音量",onRemark:"打開備註",offRemark:"關閉備註",onGeneralDocumentFullScreen:"繪制區域全屏",offGeneralDocumentFullScreen:"繪制區域取消全屏",onDynamicPPTFullScreen:"PPT全屏",offDynamicPPTFullScreen:"PPT取消全屏",onH5DocumentFullScreen:"H5課件全屏",offH5DocumentFullScreen:"H5課件取消全屏"},whiteboardToolbar:{fontFamily:{title:"文字樣式",options:{Msyh:"微軟雅黑",Ming:"宋體",Arial:"Arial"}},fontSizeText:"號",pencilWidthTitle:"線條寬度",eraserWidthTitle:"橡皮擦大小",toolTextList:{tool_mouse:"鼠標",tool_laser:"激光筆",penList:"筆",tool_pencil:"鉛筆",tool_highlighter:"熒光筆",tool_line:"線條",tool_arrow:"箭頭",tool_text:"文字",shapeList:"形狀",tool_rectangle_empty:"空心矩形",tool_rectangle:"矩形",tool_ellipse_empty:"空心橢圓",tool_ellipse:"橢圓",tool_eraser:"橡皮檫",action_undo:"撤銷",action_redo:"恢復",action_clear:"清屏",settingList:"更多設置"}},documentRemark:{name:"備註",closeTitle:"關閉備註"}}),We.set("en",{documentToolbar:{prevPage:"Previous Page",nextPage:"Next Page",prevStep:"Previous Page",nextStep:"Next Page",addPage:"Add Page",enlargeWhiteboard:"Zoom In",narrowWhiteboard:"Zoom Out",pptVolume:"Volume",onRemark:"Open Courseware Remarks",offRemark:"Close Courseware Remarks",onGeneralDocumentFullScreen:"Full Screen of Drawing Area",offGeneralDocumentFullScreen:"Cancel Full Screen of Drawing Area",onDynamicPPTFullScreen:"Full Screen  of PPT",offDynamicPPTFullScreen:"Cancel Full Screen  of PPT",onH5DocumentFullScreen:"Full Screen  of Courseware",offH5DocumentFullScreen:"Cancel Full Screen  of Courseware"},whiteboardToolbar:{fontFamily:{title:"Font Format",options:{Msyh:"Microsoft YaHei",Ming:"SimSun",Arial:"Arial"}},fontSizeText:"Font",pencilWidthTitle:"Line Width",eraserWidthTitle:"Eraser Size",toolTextList:{tool_mouse:"Mouse",tool_laser:"Laser Pen",penList:"Pen",tool_pencil:"Pencil",tool_highlighter:"Highlighter",tool_line:"Line",tool_arrow:"Arrow",tool_text:"Text Input",shapeList:"Shape",tool_rectangle_empty:"Square",tool_rectangle:"Solid Square",tool_ellipse_empty:"Circle",tool_ellipse:"Solid Circle",tool_eraser:"Eraser",action_undo:"Undo",action_redo:"Recover",action_clear:"Clear Screen",settingList:"More"}},documentRemark:{name:"Courseware Remarks",closeTitle:"Close Courseware Remarks"}}),We.set("ja",{documentToolbar:{prevPage:"前のページ",nextPage:"次のページ",prevStep:"前のページ",nextStep:"次のページ",addPage:"ページを追加する",enlargeWhiteboard:"拡大",narrowWhiteboard:"縮小",pptVolume:"ボリューム",onRemark:"備考を開く",offRemark:"備考を閉じる",onGeneralDocumentFullScreen:"描画領域全画面",offGeneralDocumentFullScreen:"手書き部分全画面表示の終了",onDynamicPPTFullScreen:"PPT全画面",offDynamicPPTFullScreen:"PPT全画面表示の終了",onH5DocumentFullScreen:"h5教材全画面",offH5DocumentFullScreen:"H5教材全画面の終了"},whiteboardToolbar:{fontFamily:{title:"フォント様式",options:{Msyh:"Microsoft　Yahei",Ming:"宋体",Arial:"Arial"}},fontSizeText:"番号",pencilWidthTitle:"線の太さ",eraserWidthTitle:"消しゴムの大きさ",toolTextList:{tool_mouse:"マウス",tool_laser:"レーザーペン",penList:"鉛筆",tool_pencil:"鉛筆",tool_highlighter:"蛍光ペン",tool_line:"線",tool_arrow:"矢印",tool_text:"文字",shapeList:"形状",tool_rectangle_empty:"長方形（塗りつぶしなし）",tool_rectangle:"長方形",tool_ellipse_empty:"楕円（塗りつぶしなし）",tool_ellipse:"楕円",tool_eraser:"消しゴム",action_undo:"キャンセル",action_redo:"元に戻す",action_clear:"クリア",settingList:"詳細設定"}},documentRemark:{name:"備考",closeTitle:"关闭备注"}});var Ne=We,Oe=function(e,t){var n=this;if((t=t||{}).containerData=t.containerData||{},n.flag=!1,n.element=e,n.leftPercent=void 0!==t.containerData.left?t.containerData.left/100:0,n.topPercent=void 0!==t.containerData.top?t.containerData.top/100:0,n.disabled=void 0!==t.disabled&&t.disabled,"string"==typeof e&&(n.element=document.getElementById(e)),n.element)return void 0!==t.containerData.parentNodeID?(n.containerElement=t.containerData.parentNodeID,"string"==typeof t.containerData.parentNodeID&&(n.containerElement=document.getElementById(t.containerData.parentNodeID))):n.containerElement=n.element.parentNode,n.containerElement&&(n.containerElement.className=n.containerElement.className.replace("roadofcloud-drag-parent-container","")+" roadofcloud-drag-parent-container "),n.cur={x:0,y:0},n.updateDisabled=function(e){n.disabled=e},n.destroy=function(){window.removeEventListener("resize",n.resizeCallback,!1),n.element.removeEventListener("mousedown",n.mousedownOrTouchstartCallback,!1),n.element.removeEventListener("touchstart",n.mousedownOrTouchstartCallback,!1),n.element.removeEventListener("touchmove",n.mousemoveOrTouchmoveEventCallback,!1),n.element.removeEventListener("touchend",n.mouseupOrTouchendEventCallback,!1),document.documentElement.removeEventListener("mousemove",n.mousemoveOrTouchmoveEventCallback,!1),document.documentElement.removeEventListener("mouseup",n.mouseupOrTouchendEventCallback,!1)},n.resize=function(){n.element.style.left=(n.containerElement.offsetWidth-n.element.offsetWidth)*n.leftPercent+"px",n.element.style.top=(n.containerElement.offsetHeight-n.element.offsetHeight)*n.topPercent+"px"},n.setPosition=function(e,t){n.leftPercent=e/100,n.topPercent=t/100,n.element.style.left=(n.containerElement.offsetWidth-n.element.offsetWidth)*n.leftPercent+"px",n.element.style.top=(n.containerElement.offsetHeight-n.element.offsetHeight)*n.topPercent+"px"},n.down=function(e){var i;"mousedown"===e.type&&(document.documentElement.addEventListener("mousemove",n.mousemoveOrTouchmoveEventCallback,!1),document.documentElement.addEventListener("mouseup",n.mouseupOrTouchendEventCallback,!1)),n.element.setAttribute("roadofDragState","onBeforeDrag"),n.containerElement&&n.containerElement.setAttribute("roadofDragParentState","onBeforeDrag"),n.flag=!0,i=e.touches?e.touches[0]:e,n.cur.x=i.clientX,n.cur.y=i.clientY,n.dx=n.element.offsetLeft,n.dy=n.element.offsetTop,"mousedown"===e.type?t.onBeforeDrag&&t.onBeforeDrag(100*n.leftPercent,100*n.topPercent):"touchstart"===e.type&&(n.flag=!1,clearTimeout(n.downTimer),n.downTimer=setTimeout(function(){n.flag=!0,n.element.style.pointerEvents="none",n.element.style.boxShadow="0 0 0.2rem 0.05rem #222",n.element.style.transform="scale(1.05)",t.onBeforeDrag&&t.onBeforeDrag(100*n.leftPercent,100*n.topPercent)},500))},n.move=function(e){if("touchmove"===e.type){var i=Math.abs(e.touches[0].clientX-n.cur.x),r=Math.abs(e.touches[0].clientY-n.cur.y);Math.hypot(i,r)>=40&&(clearTimeout(n.downTimer),n.downTimer=void 0)}if(n.flag){var o;n.element.setAttribute("roadofDragState","onDrag"),n.containerElement&&n.containerElement.setAttribute("roadofDragParentState","onDrag"),o=e.touches?e.touches[0]:e,t.onDrag&&t.onDrag(100*n.leftPercent,100*n.topPercent);var a=n.containerElement.offsetWidth-n.element.offsetWidth,s=n.containerElement.offsetHeight-n.element.offsetHeight;n.nx=o.clientX-n.cur.x,n.ny=o.clientY-n.cur.y;var l=n.dx+n.nx,c=n.dy+n.ny;l=Math.min(Math.max(0,l),a),c=Math.min(Math.max(0,c),s),n.element.style.left=l+"px",n.element.style.top=c+"px",n.leftPercent=l/(n.containerElement.offsetWidth-n.element.offsetWidth),n.topPercent=c/(n.containerElement.offsetHeight-n.element.offsetHeight)}},n.end=function(e){"mouseup"===e.type&&(document.documentElement.removeEventListener("mousemove",n.mousemoveOrTouchmoveEventCallback,!1),document.documentElement.removeEventListener("mouseup",n.mouseupOrTouchendEventCallback,!1)),"touchend"===e.type&&(clearTimeout(n.downTimer),n.downTimer=void 0,n.flag=!0,n.element.style.pointerEvents="auto",n.element.style.boxShadow="0 0 0 0 #222",n.element.style.transform="scale(1)"),n.flag&&(n.element.setAttribute("roadofDragState","onAfterDrag"),n.containerElement&&n.containerElement.setAttribute("roadofDragParentState","onAfterDrag"),n.flag=!1,t.onAfterDrag&&t.onAfterDrag(100*n.leftPercent,100*n.topPercent))},n.resizeCallback=function(e){n.resize()},n.mousedownOrTouchstartCallback=function(e){if(n.flag||!n.disabled){try{n.down(e)}catch(e){console.error(e)}return!1}},n.mousemoveOrTouchmoveEventCallback=function(e){if(n.flag||!n.disabled){try{n.move(e)}catch(e){console.error(e)}return!1}},n.mouseupOrTouchendEventCallback=function(e){if(n.flag||!n.disabled){try{n.end(e)}catch(e){console.error(e)}return!1}},window.addEventListener("resize",n.resizeCallback,!1),n.element.addEventListener("mousedown",n.mousedownOrTouchstartCallback,!1),n.element.addEventListener("touchstart",n.mousedownOrTouchstartCallback,!1),n.element.addEventListener("touchmove",n.mousemoveOrTouchmoveEventCallback,!1),n.element.addEventListener("touchend",n.mouseupOrTouchendEventCallback,!1),n.element.setAttribute("roadofDrag","true"),n.resize(),n;console.error("parameter elementId cannot find a node!")},Fe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.configration=a,e.elements={},e.elementsViewClass={},e.documentToolbarRoadofDrag=void 0,e.state={updateState:!1,dynamicPptAVSize:0,tempDisabledDrag:!1,viewState:{tool:{},action:{},zoom:{},page:{},documentType:"generalDocument",fileid:0,dynamicPptVolume:100,fullScreen:!1,remark:!1,remarkText:"",other:{primaryColor:e.configration.primaryColor,secondaryColor:e.configration.secondaryColor,backgroundColor:e.configration.backgroundColor,pencilWidth:e.configration.pencilWidth,shapeWidth:e.configration.shapeWidth,eraserWidth:e.configration.eraserWidth,fontSize:e.configration.fontSize,fontFamily:e.configration.fontFamily}}},e._createConnectElements(),e._updateSelectInfo(),e._updateLanguage(),e.render(),e}return Te()(t,e),y()(t,[{key:"componentDidUpdateState",value:function(e){if(e.viewState!==this.state.viewState){var t=e.viewState.page.currentPage===this.state.viewState.page.currentPage,n=e.viewState.page.totalPage===this.state.viewState.page.totalPage,i=e.viewState.page.skipPage&&this.state.viewState.page.skipPage?A.deepCompareJson(e.viewState.page.skipPage,this.state.viewState.page.skipPage):e.viewState.page.skipPage===this.state.viewState.page.skipPage;t&&n&&i||(this._isShowRemarkBtn(),this._updateSelectInfo()),e.viewState.fileid==this.state.viewState.fileid&&e.viewState.remarkText===this.state.viewState.remarkText||this._isShowRemarkBtn(),e.viewState.dynamicPptVolume!==this.state.viewState.dynamicPptVolume&&!this.pageVolumeSlidering&&this.pageVolumeSlider&&"function"==typeof this.pageVolumeSlider.setProgress&&this.pageVolumeSlider.setProgress(this.state.viewState.dynamicPptVolume)}e.tempDisabledDrag!==this.state.tempDisabledDrag&&this.documentToolbarRoadofDrag&&a()(this.documentToolbarRoadofDrag.updateDisabled)&&this.documentToolbarRoadofDrag.updateDisabled(this.state.tempDisabledDrag),e.viewState.documentType===this.state.viewState.documentType&&e.viewState.fullScreen===this.state.viewState.fullScreen&&e.viewState.remark===this.state.viewState.remark||this._updateLanguage(),e.updateState!==this.state.updateState&&this._isShowRemarkBtn()}},{key:"componentDidUpdateProps",value:function(e){if(e.languageType!==this.props.languageType&&this._updateLanguage(),e.isMobile!==this.props.isMobile&&(this.elements.skipPageCurrpageElement.setAttribute("contenteditable",!this.props.isMobile),this.props.isMobile?me.addClass(this.elements.documentToolbarViewRootElement,"app-mobile"):me.removeClass(this.elements.documentToolbarViewRootElement,"app-mobile"),this.elementsViewClass.selectPageView&&this.elementsViewClass.selectPageView.setProps({isMobile:this.props.isMobile})),e.isDrag!==this.props.isDrag&&(this.props.isDrag?this._addRoadofDrag():this.documentToolbarRoadofDrag&&"function"==typeof this.documentToolbarRoadofDrag.destroy&&(this.documentToolbarRoadofDrag.destroy(),this.documentToolbarRoadofDrag=void 0)),!A.deepCompareJson(e.initDragPosition,this.props.initDragPosition)&&this.documentToolbarRoadofDrag&&"function"==typeof this.documentToolbarRoadofDrag.setPosition){var t=this.props.initDragPosition||{},n=t.left,i=void 0===n?50:n,r=t.top,o=void 0===r?100:r;this.documentToolbarRoadofDrag.setPosition(i,o)}e.isLoadRemark===this.props.isLoadRemark&&e.canRemark===this.props.canRemark||!this.elements.remarkElement||this._isShowRemarkBtn(),e.isLoadFullScreen!==this.props.isLoadFullScreen&&this.elements.fullScreenElement&&me.updateStyle(this.elements.fullScreenElement,{display:this.props.isLoadFullScreen?"":"none"})}},{key:"resize",value:function(){this.documentToolbarRoadofDrag&&A.isFunction(this.documentToolbarRoadofDrag.resizeCallback)&&this.documentToolbarRoadofDrag.resizeCallback()}},{key:"forceRender",value:function(){this.setState({updateState:!this.state.updateState})}},{key:"changeParentNode",value:function(e){e&&(me.removeChild(this.elements.documentToolbarViewRootElement,this.parentNode),this.parentNode=e,me.appendChild(this.parentNode,this.elements.documentToolbarViewRootElement))}},{key:"destroyView",value:function(){for(var e=0,t=x()(this.elementsViewClass);e<t.length;e++){var n=t[e];n&&n.destroyView&&n.destroyView()}for(var i in this.elementsViewClass={},me.removeChild(this.elements.documentToolbarViewRootElement,this.parentNode),this.elements)this.elements[i]=void 0,delete this.elements[i]}},{key:"receiveActionCommand",value:function(e,t){switch("object"!==a()(t)||w()(t)||(t=Object.deepAssign({},t)),L.Logger.debug(B.logType,"[DocumentToolbar]receive whiteboard view action command（action,cmd）:",e,t),e){case"closeAllSelectBox":me.removeClass(this.elements.volumeElement,"open");break;case"viewStateUpdate":this.setState({viewState:t.viewState})}}},{key:"changeSelectPageOnChange",value:function(e){this.skipPage(e)}},{key:"changeSelectPageNoticeSelectExtendListShowOrHide",value:function(e){this.setState({tempDisabledDrag:e})}},{key:"prevPage",value:function(){switch(this.state.viewState.documentType){case"dynamicPPT":this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.prevStep(this.instanceId);break;default:this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.prevPage(this.instanceId)}return!1}},{key:"nextPage",value:function(){switch(this.state.viewState.documentType){case"dynamicPPT":this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.nextStep(this.instanceId);break;default:this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.nextPage(this.instanceId)}return!1}},{key:"addPage",value:function(){return this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.addPage(this.instanceId),!1}},{key:"fullScreen",value:function(){return this.whiteBoardManagerInstance&&(this.state.viewState.fullScreen?this.whiteBoardManagerInstance.exitFullScreen(this.instanceId):this.whiteBoardManagerInstance.fullScreen(this.instanceId)),!1}},{key:"openDynamicPptVolumeOnClick",value:function(){return me.hasClass(this.elements.volumeElement,"open")?me.removeClass(this.elements.volumeElement,"open"):me.addClass(this.elements.volumeElement,"open"),!1}},{key:"closeDynamicPptVolumeOnMouseLeave",value:function(){return me.removeClass(this.elements.volumeElement,"open"),!1}},{key:"openOrCloseRemarkOnClick",value:function(){var e=this.state.viewState.remark;this.whiteBoardManagerInstance&&(e?this.whiteBoardManagerInstance.closeDocumentRemark(this.instanceId):this.whiteBoardManagerInstance.openDocumentRemark(this.instanceId))}},{key:"changeDynamicPptVolume",value:function(e){this.whiteBoardManagerInstance&&"function"==typeof this.whiteBoardManagerInstance.changeDynamicPptVolume&&this.whiteBoardManagerInstance.changeDynamicPptVolume(e,this.instanceId)}},{key:"skipPage",value:function(e){return"number"==typeof(e=Number(e))&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.skipPage(e,this.instanceId),!1}},{key:"sendActionCommand",value:function(e,t){if(this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.whiteboardViewMap&&this.whiteBoardManagerInstance.whiteboardViewMap.has(this.instanceId)){var n=this.whiteBoardManagerInstance.whiteboardViewMap.get(this.instanceId);n&&n.sendActionCommand&&n.sendActionCommand(e,t)}}},{key:"changePageOnFocus",value:function(e){return B.isSkipPageing=!0,e&&(e.preventDefault(),e.stopPropagation()),!1}},{key:"changePageOnClick",value:function(){return this.elements.skipPageCurrpageElement.setAttribute("contenteditable",!this.props.isMobile),this.elements.skipPageCurrpageElement.focus(),event&&(event.preventDefault(),event.stopPropagation()),!1}},{key:"changePageOnBlur",value:function(e){return B.isSkipPageing=!1,this._changePage(),e&&(e.preventDefault(),e.stopPropagation()),!1}},{key:"changePageOnKeyDown",value:function(e){switch(e.keyCode){case 13:return this.elements.skipPageCurrpageElement&&"function"==typeof this.elements.skipPageCurrpageElement.blur?(this.elements.skipPageCurrpageElement.setAttribute("contenteditable",!1),this.elements.skipPageCurrpageElement.blur()):this._changePage(),e&&(e.preventDefault(),e.stopPropagation()),!1}}},{key:"enlargeWhiteboard",value:function(){return this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.enlargeWhiteboard(this.instanceId),!1}},{key:"narrowWhiteboard",value:function(){return this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.narrowWhiteboard(this.instanceId),!1}},{key:"receiveWindowMessageEvent",value:function(e){var t={};if(this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.whiteboardViewMap.has(this.instanceId)&&(t=this.whiteBoardManagerInstance.whiteboardViewMap.get(this.instanceId)),e.data){var n=void 0,i=void 0;try{n=(i=JSON.parse(e.data)).data}catch(t){return void L.Logger.warning(B.logType,"document tool bar receive iframe message data can't be converted to JSON , iframe data:",e.data)}if("ys_dynamicPPT"===i.source&&t.getDynamicPptInstanceByID&&"function"==typeof t.getDynamicPptInstanceByID&&t.getDynamicPptInstanceByID().dynamicPptIframeElement&&e.source===t.getDynamicPptInstanceByID().dynamicPptIframeElement.contentWindow){L.Logger.debug(B.logType,"[document tool bar]receive remote iframe data form "+e.origin+":",e);switch(n.action){case"allVideoAndAudio":this.setState({dynamicPptAVSize:void 0!==n.allVideoAndAudioLength?n.allVideoAndAudioLength:0})}}}}},{key:"stopEvent",value:function(e){return e&&(e.preventDefault(),e.stopPropagation()),!1}},{key:"_changePage",value:function(){var e=Number(this.elements.skipPageCurrpageElement.innerHTML),t=this.state.viewState.page,n=void 0===t?{}:t,i=n.totalPage,r=void 0===i?1:i,o=n.currentPage,a=void 0===o?1:o;if("number"!=typeof e||isNaN(e)){var s={type:"pageTypeNotNumber",currentPage:a,totalPage:r,toPage:this.elements.skipPageCurrpageElement.innerHTML};this.sendActionCommand("skipPageFailureBouncedNotice",s),this.elements.skipPageCurrpageElement.innerHTML=a}else{if(e===a)return;if(e<1||e>r){var l={type:"overPageRange",currentPage:a,totalPage:r,toPage:e};this.sendActionCommand("skipPageFailureBouncedNotice",l),this.elements.skipPageCurrpageElement.innerHTML=a}else this.skipPage(e)}}},{key:"_createConnectElements",value:function(){var e=this;this.elements.documentToolbarViewRootElement=me.createElement("article",this.instanceId+"DocumentToolViewRoot","roadofcloud-sdk-whiteboard "+this.instanceId+" document-toolbar-root "+(this.props.isMobile?"app-mobile ":" "),{zIndex:5}),this.elements.previousPageElement=me.createElement("button",this.instanceId+"RoadofcloudPreviousPage","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn previous-page-btn",{}),this.elements.skipPageElement=me.createElement("div",this.instanceId+"RoadofcloudSkipPage","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-select skip-page-select",{}),this.elements.nextPageElement=me.createElement("button",this.instanceId+"RoadofcloudNextPage","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn next-page-btn",{}),this.elements.addPageElement=me.createElement("button",this.instanceId+"RoadofcloudAddPage","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn add-page-btn",{display:"none"}),this.elements.fullScreenElement=me.createElement("button",this.instanceId+"RoadofcloudFullScreen","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn full-screen-btn",{display:this.props.isLoadFullScreen?"":"none"}),this.elements.volumeElement=me.createElement("button",this.instanceId+"RoadofcloudVolume","roadofcloud-sdk-whiteboard "+this.instanceId+" document-toolbar-btn volume-btn",{display:this.props.isLoadVolume?"":"none"}),this.elements.remarkElement=me.createElement("button",this.instanceId+"RoadofcloudRemark","roadofcloud-sdk-whiteboard "+this.instanceId+" document-toolbar-btn remark-btn",{display:this.props.isLoadRemark&&this.props.canRemark?"":"none"}),this.elements.enlargeWhiteboardElement=me.createElement("button",this.instanceId+"RoadofcloudZoomBig","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn zoom-big-btn",{}),this.elements.narrowWhiteboardElement=me.createElement("button",this.instanceId+"RoadofcloudZoomSmall","roadofcloud-sdk-whiteboard  "+this.instanceId+" document-toolbar-btn zoom-small-btn",{}),this.elements.volumeElement.innerHTML='\n            <span class="volume-slider-container" onclick="return false;" id="'.concat(this.instanceId,'PageVolumeSlider" ></span>\n        '),this.elements.skipPageElement.innerHTML='\n            <div class="page-info-container" > \n                <span contenteditable="'.concat(!this.props.isMobile,'" class="curr-page">1</span><em>/</em><span class="total-page">1</span>\n            </div>\n        '),this.elements.skipPageCurrpageElement=this.elements.skipPageElement.getElementsByClassName("curr-page")[0],this.elements.skipPageTotalpageElement=this.elements.skipPageElement.getElementsByClassName("total-page")[0],this.elements.skipPageCurrpageElement.oninput=function(e){var t=e.target.innerHTML;(!Number(t)||t.length>5)&&(e.target.innerHTML=t.substr(0,5))},this.elements.skipPageCurrpageElement.onclick=this.changePageOnClick.bind(this),this.elements.skipPageCurrpageElement.onfocus=this.changePageOnFocus.bind(this),this.elements.skipPageCurrpageElement.onblur=this.changePageOnBlur.bind(this),this.elements.skipPageCurrpageElement.onkeydown=this.changePageOnKeyDown.bind(this),this.elements.previousPageElement.onclick=this.prevPage.bind(this),this.elements.nextPageElement.onclick=this.nextPage.bind(this),this.elements.addPageElement.onclick=this.addPage.bind(this),this.elements.fullScreenElement.onclick=this.fullScreen.bind(this),this.elements.volumeElement.onclick=this.openDynamicPptVolumeOnClick.bind(this),this.elements.volumeElement.getElementsByClassName("volume-slider-container")[0].onclick=this.stopEvent.bind(this),this.elements.volumeElement.onmouseleave=this.closeDynamicPptVolumeOnMouseLeave.bind(this),this.elements.remarkElement.onclick=this.openOrCloseRemarkOnClick.bind(this),this.elements.enlargeWhiteboardElement.onclick=this.enlargeWhiteboard.bind(this),this.elements.narrowWhiteboardElement.onclick=this.narrowWhiteboard.bind(this),this.elementsViewClass.selectPageView=new Me(this.elements.skipPageElement,{parentNode:this.parentNode,isMobile:this.props.isMobile,onChange:this.changeSelectPageOnChange.bind(this),noticeSelectExtendListShowOrHide:this.changeSelectPageNoticeSelectExtendListShowOrHide.bind(this)}),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.previousPageElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.skipPageElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.nextPageElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.addPageElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.enlargeWhiteboardElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.narrowWhiteboardElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.fullScreenElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.volumeElement),me.appendChild(this.elements.documentToolbarViewRootElement,this.elements.remarkElement),me.appendChild(this.parentNode,this.elements.documentToolbarViewRootElement),Ee&&(this.pageVolumeSlider=new Ee({sliderContainer:{id:e.instanceId+"PageVolumeSlider",direction:"vertikal"},onBeforeChange:function(t){e.pageVolumeSlidering=!0},onAfterChange:function(t){e.pageVolumeSlidering=!1,e.changeDynamicPptVolume(t)}})),this._addRoadofDrag()}},{key:"_addRoadofDrag",value:function(){if(this.props.isDrag&&Oe&&this.elements.documentToolbarViewRootElement){this.documentToolbarRoadofDrag&&"function"==typeof this.documentToolbarRoadofDrag.destroy&&(this.documentToolbarRoadofDrag.destroy(),this.documentToolbarRoadofDrag=void 0);var e=this.props.initDragPosition||{},t=e.left,n=void 0===t?50:t,i=e.top,r=void 0===i?100:i;this.documentToolbarRoadofDrag=new Oe(this.elements.documentToolbarViewRootElement,{containerData:{left:n,top:r}})}}},{key:"_updateLanguage",value:function(){var e=this.props.languageType,t=void 0===e?"ch":e,n=this.state.viewState,i=n.remark,r=n.fullScreen,o=n.documentType;"ch"!==t&&"tw"!==t&&"en"!==t&&"ja"!==t&&(t="ch");var a=Ne.get(t).documentToolbar,s=a.prevPage,l=a.nextPage,c=a.prevStep,d=a.nextStep,u=a.addPage,h=a.enlargeWhiteboard,p=a.narrowWhiteboard,f=a.pptVolume,m=a.onRemark,g=a.offRemark,v=a.onGeneralDocumentFullScreen,y=a.offGeneralDocumentFullScreen,b=a.onDynamicPPTFullScreen,w=a.offDynamicPPTFullScreen,_=a.onH5DocumentFullScreen,S=a.offH5DocumentFullScreen,k=r?y:v;"dynamicPPT"===o?k=r?w:b:"h5Document"===o&&(k=r?S:_),this.elements.previousPageElement.title="dynamicPPT"===o?c:s,this.elements.nextPageElement.title="dynamicPPT"===o?d:l,this.elements.addPageElement.title=u,this.elements.fullScreenElement.title=k,this.elements.volumeElement.title=f,this.elements.remarkElement.title=i?g:m,this.elements.enlargeWhiteboardElement.title=h,this.elements.narrowWhiteboardElement.title=p}},{key:"_updateSelectInfo",value:function(){if(this.elementsViewClass.selectPageView){var e=this.state.viewState.page,t=void 0===e?{}:e,n=t.totalPage,i=void 0===n?1:n,r=t.currentPage,o=void 0===r?1:r,a=t.skipPage,s=void 0===a?{}:a,l=[];i<1&&(i=1),o<1&&(o=1);for(var c=1;c<=i;c++)l.push({label:c,value:c});this.elementsViewClass.selectPageView.setProps({selectOptions:l,currentValue:o,disabled:s.disabled,isMobile:this.props.isMobile}),this.elements.skipPageCurrpageElement.innerHTML=o,this.elements.skipPageTotalpageElement.innerHTML=i}}},{key:"_isShowRemarkBtn",value:function(){if(this.elements.remarkElement){var e=this.props.isLoadRemark&&this.props.canRemark&&this.state.viewState.remarkText;me.updateStyle(this.elements.remarkElement,{display:e?"":"none"})}}},{key:"render",value:function(){var e=this.state.viewState,t=e.page,n=void 0===t?{}:t,i=e.zoom,r=void 0===i?{}:i,o=e.documentType,a=e.fullScreen,s=e.remark,l=(e.fileid,n.prevPage),c=void 0===l?{}:l,d=n.nextPage,u=void 0===d?{}:d,h=n.prevStep,p=void 0===h?{}:h,f=n.nextStep,m=void 0===f?{}:f,g=n.addPage,v=void 0===g?{}:g,y=n.skipPage,b=void 0===y?{}:y,w=(n.currentPage,r.zoom_big),_=void 0===w?{}:w,S=r.zoom_small,k=void 0===S?{}:S;this.elements.previousPageElement.disabled="dynamicPPT"===o?p.disabled:c.disabled,this.elements.nextPageElement.disabled="dynamicPPT"===o?m.disabled:u.disabled,this.elements.addPageElement.disabled=v.disabled,this.elements.enlargeWhiteboardElement.disabled=_.disabled,this.elements.narrowWhiteboardElement.disabled=k.disabled,b.disabled?me.addClass(this.elements.skipPageElement,"disabled"):me.removeClass(this.elements.skipPageElement,"disabled"),me.updateStyle(this.elements.nextPageElement,{display:v.disabled?"":"none"}),me.updateStyle(this.elements.addPageElement,{display:v.disabled?"none":""}),a?me.addClass(this.elements.fullScreenElement,"yes"):me.removeClass(this.elements.fullScreenElement,"yes"),me.updateStyle(this.elements.volumeElement,{display:this.props.isLoadVolume&&"dynamicPPT"===o&&this.state.dynamicPptAVSize>0?"":"none"}),s?me.addClass(this.elements.remarkElement,"yes"):me.removeClass(this.elements.remarkElement,"yes")}}]),t}(Ae),Be=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.configration=a,e.elements={},e.whiteboardToolbarRoadofDrag=void 0,e.state={tempDisabledDrag:!1,viewState:{tool:{},action:{},zoom:{},page:{},documentType:"generalDocument",fileid:0,dynamicPptVolume:100,fullScreen:!1,remark:!1,other:{primaryColor:e.configration.primaryColor,secondaryColor:e.configration.secondaryColor,backgroundColor:e.configration.backgroundColor,pencilWidth:e.configration.pencilWidth,shapeWidth:e.configration.shapeWidth,eraserWidth:e.configration.eraserWidth,fontSize:e.configration.fontSize,fontFamily:e.configration.fontFamily}},useColor:""},e.fileTypeMark="general",e._createConnectElements(),e._addEvent(),e._updateLanguage(),e.render(),e}return Te()(t,e),y()(t,[{key:"componentDidUpdateState",value:function(e){e.tempDisabledDrag!==this.state.tempDisabledDrag&&this.whiteboardToolbarRoadofDrag&&a()(this.whiteboardToolbarRoadofDrag.updateDisabled)&&this.whiteboardToolbarRoadofDrag.updateDisabled(this.state.tempDisabledDrag),e.viewState.other.pencilWidth!==this.state.viewState.other.pencilWidth&&this._setPencilWidthToSlider(),e.viewState.other.eraserWidth!==this.state.viewState.other.eraserWidth&&this._setEraserWidthToSlider()}},{key:"componentDidUpdateProps",value:function(e){if(e.languageType!==this.props.languageType&&this._updateLanguage(),e.isDrag!==this.props.isDrag&&(this.props.isDrag?this._addRoadofDrag():this.whiteboardToolbarRoadofDrag&&"function"==typeof this.whiteboardToolbarRoadofDrag.destroy&&(this.whiteboardToolbarRoadofDrag.destroy(),this.whiteboardToolbarRoadofDrag=void 0)),!A.deepCompareJson(e.initDragPosition,this.props.initDragPosition)&&this.whiteboardToolbarRoadofDrag&&"function"==typeof this.whiteboardToolbarRoadofDrag.setPosition){var t=this.props.initDragPosition||{},n=t.left,i=void 0===n?0:n,r=t.top,o=void 0===r?0:r;this.whiteboardToolbarRoadofDrag.setPosition(i,o)}if(this.elements&&(!A.deepCompareJson(e.loadWhiteboardTools,this.props.loadWhiteboardTools)||e.isMobile!==this.props.isMobile)){var a=this.props.loadWhiteboardTools||{},s=a.mouse,l=a.laser,c=a.pen,d=a.text,u=a.shape,h=a.eraser,p=a.clear,f=a.undo,m=a.redo,g=a.setting;me.updateStyle(this.elements.tool_mouse,{display:s?"":"none"}),me.updateStyle(this.elements.tool_laser,{display:!l||this.props.isMobile?"none":""}),me.updateStyle(this.elements.penList,{display:c?"":"none"}),me.updateStyle(this.elements.tool_text,{display:d?"":"none"}),me.updateStyle(this.elements.shapeList,{display:u?"":"none"}),me.updateStyle(this.elements.tool_eraser,{display:h?"":"none"}),me.updateStyle(this.elements.action_clear,{display:p?"":"none"}),me.updateStyle(this.elements.action_undo,{display:f?"":"none"}),me.updateStyle(this.elements.action_redo,{display:m?"":"none"}),me.updateStyle(this.elements.settingList,{display:g?"":"none"})}e.pencilWidthScale!==this.props.pencilWidthScale&&this._setPencilWidthToSlider(),e.eraserWidthScale!==this.props.eraserWidthScale&&this._setEraserWidthToSlider()}},{key:"changeParentNode",value:function(e){e&&(me.removeChild(this.elements.whiteboardToolbarViewRootElement,this.parentNode),this.parentNode=e,me.appendChild(this.parentNode,this.elements.whiteboardToolbarViewRootElement))}},{key:"destroyView",value:function(){for(var e in me.removeChild(this.elements.whiteboardToolbarViewRootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"receiveActionCommand",value:function(e,t){switch("object"!==a()(t)||w()(t)||(t=Object.deepAssign({},t)),L.Logger.debug(B.logType,"[WhiteboardToolbar]receive whiteboard view action command（action,cmd）:",e,t),e){case"closeAllSelectBox":this._closeList();break;case"viewStateUpdate":this.setState({viewState:t.viewState})}}},{key:"whiteboardToolbarViewRootMouseLeave",value:function(e){return this._closeList(),e&&(e.preventDefault(),e.stopPropagation()),!1}},{key:"listOpenOrCloseOnClick",value:function(e,t){if(this.elements[e])if(this._closeList(e),me.hasClass(this.elements[e],"open"))me.removeClass(this.elements[e],"open"),me.removeClass(this.elements[e],"left-show-list");else{me.addClass(this.elements[e],"open");var n=void 0,i=void 0;switch(e){case"penList":(n=this.elements.penList.getAttribute("data-current-pen"))&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.useWhiteboardTool(n,this.instanceId),i=this._getRect(this.elements.penListExtend);break;case"shapeList":(n=this.elements.shapeList.getAttribute("data-current-shape"))&&this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.useWhiteboardTool(n,this.instanceId),i=this._getRect(this.elements.shapeListExtend);break;case"settingList":i=this._getRect(this.elements.settingListExtend)}if(i){var r=this._getRect(this.elements.whiteboardToolbarViewRootElement),o=this._getRect(this.parentNode);r.left-o.left>o.width-(r.width+i.width+5)?me.addClass(this.elements[e],"left-show-list"):me.removeClass(this.elements[e],"left-show-list")}}return t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"listOpenOrCloseOnMouseLeave",value:function(e,t){return this.elements[e]&&me.removeClass(this.elements[e],"open"),t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"useWhiteboardToolOnClick",value:function(e,t){return this.whiteBoardManagerInstance&&e&&this.whiteBoardManagerInstance.useWhiteboardTool(e,this.instanceId),t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"executeWhiteboardAction",value:function(e,t){return this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.executeWhiteboardAction(e,this.instanceId),t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"changeColorOnClick",value:function(e,t){return this._changeWhiteBoardConfigration("primaryColor",e),t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"changeFontFamilyOnClick",value:function(e,t,n){return this._changeWhiteBoardConfigration("fontFamily",e),n&&(n.preventDefault(),n.stopPropagation()),!1}},{key:"changeFontSizeOnClick",value:function(e,t){return this._changeWhiteBoardConfigration("fontSize",e),t&&(t.preventDefault(),t.stopPropagation()),!1}},{key:"sendActionCommand",value:function(e,t){if(this.whiteBoardManagerInstance&&this.whiteBoardManagerInstance.whiteboardViewMap&&this.whiteBoardManagerInstance.whiteboardViewMap.has(this.instanceId)){var n=this.whiteBoardManagerInstance.whiteboardViewMap.get(this.instanceId);n&&n.sendActionCommand&&n.sendActionCommand(e,t)}}},{key:"resize",value:function(){this.whiteboardToolbarRoadofDrag&&A.isFunction(this.whiteboardToolbarRoadofDrag.resizeCallback)&&this.whiteboardToolbarRoadofDrag.resizeCallback()}},{key:"_getRect",value:function(e){var t=e.getBoundingClientRect(),n=document.documentElement.clientTop,i=document.documentElement.clientLeft;return{top:t.top-n,bottom:t.bottom-n,left:t.left-i,right:t.right-i,width:t.width,height:t.height}}},{key:"_createConnectElements",value:function(){var e=this,t=this.props.loadWhiteboardTools||{},n=t.mouse,i=t.laser,r=t.pen,o=t.text,a=t.shape,s=t.eraser,l=t.clear,c=t.undo,d=t.redo,u=t.setting;this.elements.whiteboardToolbarViewRootElement=me.createElement("article",this.instanceId+"WhiteboardToolViewRoot","roadofcloud-sdk-whiteboard "+this.instanceId+" whiteboard-toolbar-root",{zIndex:6}),me.appendChild(this.parentNode,this.elements.whiteboardToolbarViewRootElement),this.elements.whiteboardToolbarViewRootElement.innerHTML='\n            <ul class="whiteboard-tool-list-container" > \n                <li class="tool-option tool_mouse"  style="display:'.concat(n?"":"none",'" >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option tool_laser" style="display:').concat(!i||this.props.isMobile?"none":"",'" >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option pen-list"  data-current-pen=\'tool_pencil\' style="display:').concat(r?"":"none",'" > \n                    <em class="icon"></em>\n                    <div class="tool-pen-list-extend" >\n                         <ol class="tool-pen-container" > \n                             <em class="arrow" ></em>\n                            <li class="pen-option tool_pencil" >\n                                <em class="pen-icon "></em>\n                            </li>\n                            <li class="pen-option tool_highlighter" >\n                                <em class="pen-icon"></em>\n                            </li>\n                            <li class="pen-option tool_line" >\n                                 <em class="pen-icon"></em>\n                            </li>\n                            <li class="pen-option tool_arrow" >\n                                 <em class="pen-icon"></em>\n                            </li>\n                        </ol>\n                    </div>                \n                </li>\n                <li class="tool-option tool_text" style="display:').concat(o?"":"none",'" >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option shape-list" data-current-shape=\'tool_rectangle_empty\'  style="display:').concat(a?"":"none",'"  > \n                    <em class="icon"></em>\n                     <div class="tool-shape-list-extend" >\n                         <ol class="tool-shape-container" > \n                            <em class="arrow" ></em>\n                            <li class="shape-option tool_rectangle_empty" >\n                                <em class="shape-icon"></em>\n                            </li>\n                            <li class="shape-option tool_rectangle" >\n                                <em class="shape-icon"></em>\n                            </li>\n                            <li class="shape-option tool_ellipse_empty" >\n                                <em class="shape-icon"></em>\n                            </li>\n                            <li class="shape-option tool_ellipse" >\n                                <em class="shape-icon"></em>\n                            </li>\n                        </ol>\n                     </div>\n                </li>\n                <li class="tool-option tool_eraser"  style="display:').concat(s?"":"none",'" >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option tool_undo" style="display:').concat(c?"":"none",'"  >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option tool_redo" style="display:').concat(d?"":"none",'" >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option tool_clear" style="display:').concat(l?"":"none",'"  >\n                    <em class="icon"></em>\n                </li>\n                <li class="tool-option setting-list" style="display:').concat(u?"":"none",'" > \n                    <em class="icon"></em>\n                    <div class="setting-list-extend" title=""  >\n                        <div class="setting-container" > \n                            <em class="arrow" ></em>\n                            <div class="colors-container" >                         \n                            </div>\n                            <div class="font-container">\n                                <span class="font-title title"></span>\n                                <div class="font-content-container" > \n                                    <div class="font-family-container"> \n                                    </div>\n                                    <div class="font-size-container" >\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="pencil-width-container" >\n                                <span class="pencil-width-title title"  ></span>\n                                <div class="slider-container pencil-slider-container" id="').concat(this.instanceId,'PencilWidthSlider" ></div>\n                            </div> \n                            <div class="eraser-width-container" >\n                                <span class="eraser-width-title title"></span>\n                                <div class="slider-container eraser-slider-container"  id="').concat(this.instanceId,'EraserWidthSlider" ></div>\n                            </div> \n                        </div>\n                    </div>\n                  \n                </li>\n            </ul>\n        '),this.elements.tool_mouse=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_mouse")[0],this.elements.tool_laser=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_laser")[0],this.elements.tool_text=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_text")[0],this.elements.tool_eraser=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_eraser")[0],this.elements.tool_pencil=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_pencil")[0],this.elements.tool_highlighter=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_highlighter")[0],this.elements.tool_line=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_line")[0],this.elements.tool_arrow=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_arrow")[0],this.elements.tool_ellipse=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_ellipse")[0],this.elements.tool_ellipse_empty=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_ellipse_empty")[0],this.elements.tool_rectangle=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_rectangle")[0],this.elements.tool_rectangle_empty=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_rectangle_empty")[0],this.elements.action_undo=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_undo")[0],this.elements.action_redo=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_redo")[0],this.elements.action_clear=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool_clear")[0],this.elements.penList=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("pen-list")[0],this.elements.shapeList=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("shape-list")[0],this.elements.settingList=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("setting-list")[0],this.elements.penListExtend=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool-pen-list-extend")[0],this.elements.shapeListExtend=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("tool-shape-list-extend")[0],this.elements.settingListExtend=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("setting-list-extend")[0],this.elements.colorsContainer=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("colors-container")[0],this.elements.fontTitle=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("font-title")[0],this.elements.fontFamilyContainer=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("font-family-container")[0],this.elements.fontSizeContainer=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("font-size-container")[0],this.elements.pencilWidthTitle=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("pencil-width-title")[0],this.elements.eraserWidthTitle=document.getElementById(this.instanceId+"WhiteboardToolViewRoot").getElementsByClassName("eraser-width-title")[0],Ee&&(this.pencilWidthSlider=new Ee({sliderContainer:{id:e.instanceId+"PencilWidthSlider",direction:"horizontal"},onChange:function(t){var n=e.props.pencilWidthScale,i=void 0===n?1:n;e.sendActionCommand("pencilWidthChange",{pencilWidthPercentage:t,pencilWidth:t*i})},onAfterChange:function(t){t=t<1?1:t;var n=e.props.pencilWidthScale,i=void 0===n?1:n;e._changeWhiteBoardConfigration("pencilWidth",t*i),e._changeWhiteBoardConfigration("shapeWidth",t*i),e.sendActionCommand("pencilWidthChange",{pencilWidthPercentage:t,pencilWidth:t*i})}}),this.eraserWidthSlider=new Ee({sliderContainer:{id:e.instanceId+"EraserWidthSlider",direction:"horizontal"},onChange:function(t){var n=e.props.eraserWidthScale,i=void 0===n?1:n;e.sendActionCommand("eraserWidthChange",{eraserWidth:t*i,eraserWidthPercentage:t/100})},onAfterChange:function(t){t=t<1?1:t;var n=e.props.eraserWidthScale,i=void 0===n?1:n;e._changeWhiteBoardConfigration("eraserWidth",t*i),e.sendActionCommand("eraserWidthChange",{eraserWidth:t*i,eraserWidthPercentage:t/100})}}),this._setPencilWidthToSlider(),this._setEraserWidthToSlider()),this._addRoadofDrag()}},{key:"_addRoadofDrag",value:function(){if(this.props.isDrag&&Oe&&this.elements.whiteboardToolbarViewRootElement){this.whiteboardToolbarRoadofDrag&&"function"==typeof this.whiteboardToolbarRoadofDrag.destroy&&(this.whiteboardToolbarRoadofDrag.destroy(),this.whiteboardToolbarRoadofDrag=void 0);var e=this.props.initDragPosition||{},t=e.left,n=void 0===t?0:t,i=e.top,r=void 0===i?0:i;this.whiteboardToolbarRoadofDrag=new Oe(this.elements.whiteboardToolbarViewRootElement,{containerData:{left:n,top:r}})}}},{key:"_updateLanguage",value:function(){var e=this.props.languageType,t=void 0===e?"ch":e;"ch"!==t&&"tw"!==t&&"en"!==t&&"ja"!==t&&(t="ch");var n=Ne.get(t).whiteboardToolbar,i=n.fontSizeText,r=n.fontFamily,o=void 0===r?{}:r,a=n.pencilWidthTitle,s=n.eraserWidthTitle,l=n.toolTextList,c=void 0===l?{}:l,u=o.title,p=o.options,f=void 0===p?{}:p;this.elements.fontTitle.innerHTML=u,this.elements.pencilWidthTitle.innerHTML=a,this.elements.eraserWidthTitle.innerHTML=s,me.removeAllChild(this.elements.fontFamilyContainer);for(var m=0,g=h()(f);m<g.length;m++){var v=d()(g[m],2),y=v[0],b=v[1],w=me.createElement("button",void 0,"font-family-option "+y);w.innerHTML=b,w.setAttribute("data-font-family-key",y),w.setAttribute("data-font-family-value",b),w.onclick=this.changeFontFamilyOnClick.bind(this,b,y),me.appendChild(this.elements.fontFamilyContainer,w)}me.removeAllChild(this.elements.fontSizeContainer);for(var _=0,S=void 0,k=0,P=[12,14,18,24,26,36,48,72];k<P.length;k++){var C=P[k],T=me.createElement("button",void 0,"font-size-option font-size-"+C);T.innerHTML=C+i,T.setAttribute("data-font-size",C),T.onclick=this.changeFontSizeOnClick.bind(this,C),_>2&&(_=0),0===_&&(S=me.createElement("span",void 0,"font-size-list"),me.appendChild(this.elements.fontSizeContainer,S)),S&&me.appendChild(S,T),++_}for(var A=0,I=h()(c);A<I.length;A++){var E=d()(I[A],2),x=E[0],R=E[1];this.elements[x]&&(this.elements[x].title=R)}this.render()}},{key:"_changeWhiteBoardConfigration",value:function(e,t){if(this.whiteBoardManagerInstance){var n={};n[e]=t,this.whiteBoardManagerInstance.changeWhiteBoardConfigration(n,this.instanceId)}}},{key:"_closeList",value:function(e){"penList"!==e&&me.removeClass(this.elements.penList,"open"),"shapeList"!==e&&me.removeClass(this.elements.shapeList,"open"),"settingList"!==e&&me.removeClass(this.elements.settingList,"open")}},{key:"_addEvent",value:function(){me.removeAllChild(this.elements.colorsContainer);for(var e=0,t=["#5AC9FA","#FFCC00","#ED3E3A","#4740D2","#007BFF","#09C62B","#000000","#EDEDED"];e<t.length;e++){var n=t[e],i=me.createElement("button",void 0,"color-option color-"+n.replace(/#/g,""),{backgroundColor:n});i.innerHTML='<span style="border-color: '.concat(n,'"></span>'),i.setAttribute("data-color",n),i.onclick=this.changeColorOnClick.bind(this,n),me.appendChild(this.elements.colorsContainer,i)}this.elements.whiteboardToolbarViewRootElement.onmouseleave=this.whiteboardToolbarViewRootMouseLeave.bind(this),this.elements.settingListExtend.onclick=function(e){return e&&(e.preventDefault(),e.stopPropagation()),!1};for(var r=0,o=["penList","shapeList","settingList"];r<o.length;r++){var a=o[r];this.elements[a]&&(this.elements[a].onclick=this.listOpenOrCloseOnClick.bind(this,a),this.elements[a].onmouseleave=this.listOpenOrCloseOnMouseLeave.bind(this,a))}for(var s=0,l=["tool_mouse","tool_laser","tool_text","tool_eraser","tool_pencil","tool_highlighter","tool_line","tool_arrow","tool_ellipse","tool_ellipse_empty","tool_rectangle","tool_rectangle_empty"];s<l.length;s++){var c=l[s];this.elements[c]&&(this.elements[c].onclick=this.useWhiteboardToolOnClick.bind(this,c))}for(var d=0,u=["action_clear","action_redo","action_undo"];d<u.length;d++){var h=u[d];this.elements[h]&&(this.elements[h].onclick=this.executeWhiteboardAction.bind(this,h))}}},{key:"_setPencilWidthToSlider",value:function(){if(this.pencilWidthSlider&&this.pencilWidthSlider.setProgress){var e=this.props.pencilWidthScale,t=void 0===e?1:e;this.pencilWidthSlider.setProgress(this.state.viewState.other.pencilWidth/t),this.sendActionCommand("pencilWidthChange",{pencilWidth:this.state.viewState.other.pencilWidth,pencilWidthPercentage:this.state.viewState.other.pencilWidth/t/100})}}},{key:"_setEraserWidthToSlider",value:function(){if(this.eraserWidthSlider&&this.eraserWidthSlider.setProgress){var e=this.props.eraserWidthScale,t=void 0===e?1:e;this.eraserWidthSlider.setProgress(this.state.viewState.other.eraserWidth/t),this.sendActionCommand("eraserWidthChange",{eraserWidth:this.state.viewState.other.eraserWidth,eraserWidthPercentage:this.state.viewState.other.eraserWidth/t/100})}}},{key:"render",value:function(){for(var e=this.state.viewState,t=e.tool,n=void 0===t?{}:t,i=e.action,r=void 0===i?{}:i,o=e.other,a=void 0===o?{}:o,s=a.primaryColor,l=a.fontFamily,c=a.fontSize,u={},p={},m=0,g=h()(n);m<g.length;m++){var v=d()(g[m],2),y=v[0],b=v[1];if(this.elements[y]){switch(y){case"tool_pencil":case"tool_highlighter":case"tool_line":case"tool_arrow":b.isUse&&(u[y]=b);break;case"tool_rectangle":case"tool_rectangle_empty":case"tool_ellipse_empty":case"tool_ellipse":b.isUse&&(p[y]=b)}b.isUse?me.addClass(this.elements[y],"active"):me.removeClass(this.elements[y],"active"),b.disabled?me.addClass(this.elements[y],"disabled"):me.removeClass(this.elements[y],"disabled"),this.elements[y].disabled=b.disabled}}if(f()(u).length)for(var w=0,_=f()(u);w<_.length;w++){var S=_[w];this.elements.penList.setAttribute("data-current-pen",S),me.addClass(this.elements.penList,"active")}else me.removeClass(this.elements.penList,"active");if(f()(p).length)for(var k=0,P=f()(p);k<P.length;k++){var C=P[k];this.elements.shapeList.setAttribute("data-current-shape",C),me.addClass(this.elements.shapeList,"active")}else me.removeClass(this.elements.shapeList,"active");for(var T=0,A=h()(r);T<A.length;T++){var I=d()(A[T],2),E=I[0],x=I[1];this.elements[E]&&(x.disabled?me.addClass(this.elements[E],"disabled"):me.removeClass(this.elements[E],"disabled"),this.elements[E].disabled=x.disabled)}var R=this.elements.colorsContainer.getElementsByClassName("color-option"),D=!0,L=!1,M=void 0;try{for(var N,O=W()(R);!(D=(N=O.next()).done);D=!0){var F=N.value;F.getAttribute("data-color")===s?me.addClass(F,"active"):me.removeClass(F,"active")}}catch(e){L=!0,M=e}finally{try{D||null==O.return||O.return()}finally{if(L)throw M}}var B=this.elements.fontFamilyContainer.getElementsByClassName("font-family-option"),j=!0,V=!1,U=void 0;try{for(var z,q=W()(B);!(j=(z=q.next()).done);j=!0){for(var H=z.value,G=void 0,Y=0,J=["ch","tw","en"];Y<J.length;Y++){for(var X=J[Y],K=Ne.get(X).whiteboardToolbar.fontFamily.options,Q=void 0===K?{}:K,Z=0,$=h()(Q);Z<$.length;Z++){var ee=d()($[Z],2),te=ee[0];if(ee[1]===l){G=te;break}}if(G)break}H.getAttribute("data-font-family-key")===G?me.addClass(H,"active"):me.removeClass(H,"active")}}catch(e){V=!0,U=e}finally{try{j||null==q.return||q.return()}finally{if(V)throw U}}var ne=this.elements.fontSizeContainer.getElementsByClassName("font-size-option"),ie=!0,re=!1,oe=void 0;try{for(var ae,se=W()(ne);!(ie=(ae=se.next()).done);ie=!0){var le=ae.value;le.getAttribute("data-font-size")===""+c?me.addClass(le,"active"):me.removeClass(le,"active")}}catch(e){re=!0,oe=e}finally{try{ie||null==se.return||se.return()}finally{if(re)throw oe}}}}]),t}(Ae);function je(e){return e||null}function Ve(e,t,n,i){var r=["then","catch","always"].reduce(function(e,t){return e[t]=function(n){return e[t]=n,e},e},{}),o=new XMLHttpRequest,a=function(e,t,n){if("get"!==n.toLowerCase()||!t)return e;var i=ze(t),r=e.indexOf("?")>-1?"&":"?";return e+r+i}(t,n,e);return o.open(e,a,!0),o.withCredentials=i.hasOwnProperty("withCredentials"),function(e,t){(function(e){return f()(e).some(function(e){return"content-type"===e.toLowerCase()})})(t=t||{})||(t["Content-Type"]="application/x-www-form-urlencoded");f()(t).forEach(function(n){t[n]&&e.setRequestHeader(n,t[n])})}(o,i.headers),o.addEventListener("readystatechange",function(e,t){return function n(){t.readyState===t.DONE&&(t.removeEventListener("readystatechange",n,!1),e.always.apply(e,Ue(t)),t.status>=200&&t.status<300?e.then.apply(e,Ue(t)):e.catch.apply(e,Ue(t)))}}(r,o),!1),o.send(ze(n)),r.abort=function(){return o.abort()},r}function Ue(e){var t;try{t=JSON.parse(e.responseText)}catch(n){t=e.responseText}return[t,e]}function ze(e){return function(e){return"[object Object]"===Object.prototype.toString.call(e)}(e)?(t=e,f()(t).reduce(function(e,n){var i=e?e+"&":"";return i+qe(n)+"="+qe(t[n])},"")):e;var t}function qe(e){return encodeURIComponent(e)}var He=function(e){return(e=e||{}).baseUrl=e.baseUrl||"",e.method&&e.url?Ve(e.method,e.baseUrl+e.url,je(e.data),e):["get","post","put","delete"].reduce(function(t,n){return t[n]=function(t,i){return Ve(n,e.baseUrl+t,je(i),e)},t},{})},Ge=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return g()(this,t),(e=Se()(this,Pe()(t).call(this,o))).parentNode=n,e.instanceId=i,e.whiteBoardManagerInstance=r,e.configration=a,e.elements={},e.documentRemarkRoadofDrag=void 0,e.ajaxRequestingList={},e.state={autoOpenRemark:!0,updateState:!1,viewState:{tool:{},action:{},zoom:{},page:{},documentType:"generalDocument",fileid:0,dynamicPptVolume:100,fullScreen:!1,remark:!1,other:{primaryColor:e.configration.primaryColor,secondaryColor:e.configration.secondaryColor,backgroundColor:e.configration.backgroundColor,pencilWidth:e.configration.pencilWidth,shapeWidth:e.configration.shapeWidth,eraserWidth:e.configration.eraserWidth,fontSize:e.configration.fontSize,fontFamily:e.configration.fontFamily}}},e._createConnectElements(),e._updateLanguage(),e.render(),e}return Te()(t,e),y()(t,[{key:"componentDidUpdateState",value:function(e){this.state.autoOpenRemark&&e.viewState.fileid==this.state.viewState.fileid&&0!=this.state.viewState.fileid&&e.viewState.page.currentPage!==this.state.viewState.page.currentPage&&this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.openDocumentRemark)&&this.whiteBoardManagerInstance.openDocumentRemark(this.instanceId),e.viewState.fileid!=this.state.viewState.fileid&&(this.state.autoOpenRemark&&0!=this.state.viewState.fileid&&this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.openDocumentRemark)&&this.whiteBoardManagerInstance.openDocumentRemark(this.instanceId),this._ajaxDocumentRemark()),e.viewState.remark!==this.state.viewState.remark&&this._ajaxDocumentRemark()}},{key:"componentDidUpdateProps",value:function(e){if(e.languageType!==this.props.languageType&&this._updateLanguage(),e.isDrag!==this.props.isDrag&&(this.props.isDrag?this._addRoadofDrag():this.documentRemarkRoadofDrag&&"function"==typeof this.documentRemarkRoadofDrag.destroy&&(this.documentRemarkRoadofDrag.destroy(),this.documentRemarkRoadofDrag=void 0)),!A.deepCompareJson(e.initDragPosition,this.props.initDragPosition)&&this.documentRemarkRoadofDrag&&"function"==typeof this.documentRemarkRoadofDrag.setPosition){var t=this.props.initDragPosition||{},n=t.left,i=void 0===n?50:n,r=t.top,o=void 0===r?100:r;this.documentRemarkRoadofDrag.setPosition(i,o)}}},{key:"changeParentNode",value:function(e){e&&(me.removeChild(this.elements.remarkViewRootElement,this.parentNode),this.parentNode=e,me.appendChild(this.parentNode,this.elements.remarkViewRootElement))}},{key:"destroyView",value:function(){for(var e in me.removeChild(this.elements.remarkViewRootElement,this.parentNode),this.elements)this.elements[e]=void 0,delete this.elements[e]}},{key:"resize",value:function(){this.documentRemarkRoadofDrag&&A.isFunction(this.documentRemarkRoadofDrag.resizeCallback)&&this.documentRemarkRoadofDrag.resizeCallback()}},{key:"receiveActionCommand",value:function(e,t){switch("object"!==a()(t)||w()(t)||(t=Object.deepAssign({},t)),L.Logger.debug(B.logType,"[DocumentRemark]receive whiteboard view action command（action,cmd）:",e,t),e){case"viewStateUpdate":this.setState({viewState:t.viewState})}}},{key:"closeDocumentRemarkOnClick",value:function(){this.whiteBoardManagerInstance&&A.isFunction(this.whiteBoardManagerInstance.closeDocumentRemark)&&this.whiteBoardManagerInstance.closeDocumentRemark(this.instanceId)}},{key:"_createConnectElements",value:function(){this.elements.remarkViewRootElement=me.createElement("div",this.instanceId+"RoadofcloudRemark","roadofcloud-sdk-whiteboard "+this.instanceId+" roadofcloud-remark-container remark-container",{position:"absolute",left:0,top:0,display:"none",zIndex:3}),this.elements.remarkViewRootElement.innerHTML='\n            <div class="remark-head"> \n                <span class="name"></span>\n                <button class="close"></button>\n            </div>\n            <div class="content-container"> \n                <span class="content-text  custom-scroll-bar" >  </span>\n            </div>\n        ',me.appendChild(this.parentNode,this.elements.remarkViewRootElement),this.elements.remarkNameElement=this.elements.remarkViewRootElement.getElementsByClassName("name")[0],this.elements.remarkCloseElement=this.elements.remarkViewRootElement.getElementsByClassName("close")[0],this.elements.remarkContentElement=this.elements.remarkViewRootElement.getElementsByClassName("content-text")[0],this.elements.remarkCloseElement.onclick=this.closeDocumentRemarkOnClick.bind(this),this._addRoadofDrag()}},{key:"_updateLanguage",value:function(){var e=this.props.languageType,t=void 0===e?"ch":e;"ch"!==t&&"tw"!==t&&"en"!==t&&"ja"!==t&&(t="ch");var n=Ne.get(t).documentRemark,i=n.name,r=n.closeTitle;this.elements.remarkNameElement.innerHTML=i,this.elements.remarkCloseElement.setAttribute("title",r)}},{key:"_addRoadofDrag",value:function(){Oe&&this.elements.remarkViewRootElement&&(this.documentRemarkRoadofDrag&&"function"==typeof this.documentRemarkRoadofDrag.destroy&&(this.documentRemarkRoadofDrag.destroy(),this.documentRemarkRoadofDrag=void 0),this.documentRemarkRoadofDrag=new Oe(this.elements.remarkViewRootElement,{containerData:{left:50,top:90}}))}},{key:"_ajaxDocumentRemark",value:function(){var e=this,t=this.state.viewState,n=t.remark,i=t.fileid,r=this,o=!1;this.ajaxRequestingList["documentRemark_"+i]&&(new Date).getTime()-this.ajaxRequestingList["documentRemark_"+i].requestTime<5e3&&(o=!0),this.props.isConnectedRoom&&!o&&this.props.canRemark&&n&&0!=i&&!B.allDocumentRemarkInfoMap.has("documentRemark_"+i)&&(this.ajaxRequestingList["documentRemark_"+i]&&this.ajaxRequestingList["documentRemark_"+i].ajaxXhr&&A.isFunction(this.ajaxRequestingList["documentRemark_"+i].ajaxXhr.abort)&&this.ajaxRequestingList["documentRemark_"+i].ajaxXhr.abort(),this.ajaxRequestingList["documentRemark_"+i]={requestTime:(new Date).getTime(),ajaxXhr:void 0},this.ajaxRequestingList["documentRemark_"+i].ajaxXhr=He().post(this.props.webAddress+"/ClientAPI/getfileremark?ts="+(new Date).getTime(),{fileid:i}).then(function(t){if(e.ajaxRequestingList["documentRemark_"+i]=void 0,delete e.ajaxRequestingList["documentRemark_"+i],t&&0===t.result)for(var n in t){var o=t[n];if("result"!==n&&o&&A.isJson(o)){B.allDocumentRemarkInfoMap.has("documentRemark_"+o.fileid)||B.allDocumentRemarkInfoMap.set("documentRemark_"+o.fileid,{});var a=B.allDocumentRemarkInfoMap.get("documentRemark_"+o.fileid);a&&(a[o.fileid+"_"+o.pageid]=o.remark),e.whiteBoardManagerInstance&&e.whiteBoardManagerInstance.whiteboardViewMap&&e.whiteBoardManagerInstance.whiteboardViewMap.get(r.instanceId)&&A.isFunction(e.whiteBoardManagerInstance.whiteboardViewMap.get(r.instanceId).forceViewStateUpdate)&&e.whiteBoardManagerInstance.whiteboardViewMap.get(r.instanceId).forceViewStateUpdate()}}e.setState({updateState:!e.state.updateState})}).catch(function(t,n){L.Logger.error(B.logType,"ajax request fail  error info( response, xhr ):",t,n),e.ajaxRequestingList["documentRemark_"+i]=void 0,delete e.ajaxRequestingList["documentRemark_"+i],e.setState({updateState:!e.state.updateState})}))}},{key:"render",value:function(){var e=this.state.viewState,t=e.remark,n=e.fileid,i=e.page,r=(void 0===i?{}:i).currentPage,o=void 0===r?1:r,a=B.allDocumentRemarkInfoMap.get("documentRemark_"+n),s=this.props.canRemark&&t&&0!=n&&a&&a[n+"_"+o],l=!this.isShow&&s;this.isShow=s,me.updateStyle(this.elements.remarkViewRootElement,{display:s?"block":"none"}),s&&a&&a[n+"_"+o]&&(this.elements.remarkContentElement.innerHTML=a[n+"_"+o]),l&&this.documentRemarkRoadofDrag&&A.isFunction(this.documentRemarkRoadofDrag.resizeCallback)&&this.documentRemarkRoadofDrag.resizeCallback()}}]),t}(Ae),Ye=function(){function e(t,n,i){g()(this,e),this.className="YSWhiteBoardManagerInner",this.isInner=i,this.room=t,this.sdkReceiveActionCommand=n,this.whiteboardViewMap=new O.a,this.awitWhiteboardConfigrationMap=new O.a,this.randomCreateExtendWhiteboardNumber=0,this.audioPlayerView=void 0,this.videoPlayerView=void 0,this.documentRemarkViewList={},this.documentToolbarViewList={},this.whiteboardToolbarViewList={},this.listernerBackupid=(new Date).getTime()+"_"+Math.random(),this.pureWhiteboardFileinfoList={},this.saveMsglistData={},this.savePubmsgData={},this._registerEvent(),this._addRoomEvent()}return y()(e,[{key:"getVersion",value:function(){return V.WHITEBOARD_SDK_VERSION}},{key:"createMainWhiteboard",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;if("string"==typeof t){var r=t;if(!(t=document.getElementById(r)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createMainWhiteboard method cannot be performed , element id is "+r+".")}L.Logger.debug(B.logType,"[whiteboarrd-sdk]createMainWhiteboard  parentNode and configration and receiveActionCommand:",t&&t.id||t,n,i),this._createWhiteboard(t,"default",n,function(){var t,n;e.documentToolbarViewList.default&&e.documentToolbarViewList.default.receiveActionCommand&&(t=e.documentToolbarViewList.default).receiveActionCommand.apply(t,arguments);e.documentRemarkViewList.default&&e.documentRemarkViewList.default.receiveActionCommand&&(n=e.documentRemarkViewList.default).receiveActionCommand.apply(n,arguments);if("function"==typeof i)if(e.isInner)i.apply(void 0,arguments);else{var r=arguments.length<=0?void 0:arguments[0];"viewStateUpdate"!==r&&"mediaPlayerNotice"!==r||i.apply(void 0,arguments)}});var o=this.whiteboardViewMap.get("default");if(o&&o.getConfigration().isLoadDocumentToolBar){var a=o.getConfigration().documentToolBarConfig.parentNode||o.getWhiteboardRootElement();this.createDocumentToolBar(a,o.getConfigration().documentToolBarConfig,"default")}if(o&&o.getConfigration().isLoadDocumentRemark){var s=o.getConfigration().documentRemarkConfig.parentNode||o.getWhiteboardRootElement();this.createDocumentRemark(s,o.getConfigration().documentRemarkConfig,"default")}if(o&&o.getConfigration().isLoadAudioPlayer){var l=o.getConfigration().audioPlayerConfig.parentNode||o.getWhiteboardRootElement();this.createAudioPlayer(l,o.getConfigration().audioPlayerConfig)}if(o&&o.getConfigration().isLoadVideoPlayer){var c=o.getConfigration().videoPlayerConfig.parentNode||o.getWhiteboardRootElement();this.createVideoPlayer(c,o.getConfigration().videoPlayerConfig)}this._executeSaveMsglistData("default"),this._executeSavePubmsgData("default")}},{key:"createExtendWhiteboard",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createExtendWhiteboard  parentNode  instanceId  configration and receiveActionCommand:",t&&t.id||t,n,i,r),null!=n){if("string"==typeof t){var o=t;if(!(t=document.getElementById(o)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createExtendWhiteboard method cannot be performed , element id is "+o+".")}n||(this.randomCreateExtendWhiteboardNumber++,n="randomWhiteboard"+this.randomCreateExtendWhiteboardNumber),this._createWhiteboard(t,n,i,function(){var t,i;e.documentToolbarViewList[n]&&e.documentToolbarViewList[n].receiveActionCommand&&(t=e.documentToolbarViewList[n]).receiveActionCommand.apply(t,arguments);e.documentRemarkViewList[n]&&e.documentRemarkViewList[n].receiveActionCommand&&(i=e.documentRemarkViewList[n]).receiveActionCommand.apply(i,arguments);if("function"==typeof r)if(e.isInner)r.apply(void 0,arguments);else{var o=arguments.length<=0?void 0:arguments[0];"viewStateUpdate"!==o&&"mediaPlayerNotice"!==o||r.apply(void 0,arguments)}});var a=this.whiteboardViewMap.get(n);if(a&&a.getConfigration().isLoadDocumentToolBar&&a.getConfigration().hasExtendDocument){var s=a.getConfigration().documentToolBarConfig.parentNode||a.getWhiteboardRootElement();this.createDocumentToolBar(s,a.getConfigration().documentToolBarConfig,n)}if(a&&a.getConfigration().isLoadDocumentRemark&&a.getConfigration().hasExtendDocument){var l=a.getConfigration().documentRemarkConfig.parentNode||a.getWhiteboardRootElement();this.createDocumentRemark(l,a.getConfigration().documentRemarkConfig,n)}this._executeSaveMsglistData(n),this._executeSavePubmsgData(n)}}},{key:"destroyMainWhiteboard",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]destroyMainWhiteboard");this._destroyWhiteboard("default")}},{key:"destroyExtendWhiteboard",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]destroyExtendWhiteboard  instanceId:",e),null!=e&&this._destroyWhiteboard(e)}},{key:"changeDocument",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";if("mobile"!==YS.SDKTYPE)if(null!=e&&null!=e){if(this.room&&this.whiteboardViewMap.has(n)){var i=this.whiteboardViewMap.get(n),r=void 0;if(0==e)r=this.pureWhiteboardFileinfoList[n];else{var o=this.room.getFileList(),a=!0,s=!1,l=void 0;try{for(var c,d=W()(o);!(a=(c=d.next()).done);a=!0){var u=c.value;if(u.fileid==e){r=u;break}}}catch(e){s=!0,l=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw l}}}if(r)if(/(mp3|mp4|webm)/g.test(r.filetype)){var h=r.swfpath,p=h.lastIndexOf("."),f=h.substring(p),m=h.replace(f,"-1"+f),g=B.nowUseDocAddress+m,v=/(mp4|webm)/g.test(r.filetype),y=i.getConfigration().mediaShareToID,b={source:"mediaFileList",filename:r.filename,fileid:r.fileid,pauseWhenOver:v&&i.getConfigration().mediaSharePauseWhenOver};this.startShareMedia(g,v,y,b)}else{var w=Number(r.fileprop),_=1===w||2===w,S=3===w,k=!_&&!S;if(_||S||k){k&&t>r.pagenum&&(t=r.pagenum),t<1&&(t=1);var P={associatedMsgID:i.getConfigration()?i.getConfigration().associatedMsgID:void 0,name:"default"===n?"ShowPage":"ExtendShowPage",id:"default"===n?"DocumentFilePage_ShowPage":"DocumentFilePage_ExtendShowPage_".concat(n),toID:"__all",data:{sourceInstanceId:n,isGeneralFile:k,isMedia:!1,isDynamicPPT:_,isH5Document:S,action:"show",mediaType:"",filedata:{currpage:t,pptslide:_?t:1,pptstep:0,steptotal:0,fileid:r.fileid,pagenum:r.pagenum,filename:r.filename,filetype:r.filetype,isContentDocument:r.isContentDocument,cospdfpath:r.cospdfpath,swfpath:_||S?r.downloadpath:r.swfpath}},save:!0};this.receiveEventRoomPubmsg({type:"room-pubmsg",message:Object.deepAssign({},P)},n),i.getConfigration().synchronization&&i.getConfigration().isConnectedRoom&&this.pubMsg(P)}else L.Logger.info(B.logType,"[whiteboarrd-sdk]changeDocument:you open file type is not support , filetype is "+r.filetype+" , fileid is "+e+" , toPage is "+t+".")}else L.Logger.info(B.logType,"[whiteboarrd-sdk]changeDocument:you can't find the file by fileid , fileid is "+e+" , toPage is "+t+".")}}else L.Logger.error(B.logType,"changeDocument method parameter error: fileid can't be empty! ");else L.Logger.error(B.logType,"changeDocument method is not allowed in the mobile environment!")}},{key:"openRemoteDocument",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(!function(){return function(e,t,n,i){return function(e){var t=e;return 1==new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)?/).test(t)}(e)?-1==["generalDocument","dynamicPPT","h5Document","mediaFile"].indexOf(t)?(L.Logger.error(B.logType,"[whiteboarrd-sdk]openRemoteDocument: type invalid"),"function"==typeof i&&i("type invalid"),!1):!!function(e){return!!e}(n)||(L.Logger.error(B.logType,"[whiteboarrd-sdk]openRemoteDocument: id is empty"),"function"==typeof i&&i("id is empty"),!1):(L.Logger.error(B.logType,"[whiteboarrd-sdk]openRemoteDocument: url invalid"),"function"==typeof i&&i("url invalid"),!1)}}()(e,n,t,i)||!this.room)return!1;if(this.whiteboardViewMap.has("default")){var o=this.whiteboardViewMap.get("default"),a="unknown",s="unknown";try{var l=e.split(/(\/|\\)/g);if(l&&l.length>1){var c=l[l.length-1];if(c&&"string"==typeof c){var d=c.split(".");d&&2==d.length&&(a=d[0],s=d[1])}}}catch(e){L.Logger.error(B.logType,"[whiteboarrd-sdk]openRemoteDocument err:",e)}if("mediaFile"===n){var u=o.getConfigration().mediaShareToID,h="unknown"===s?/(.mp4|.webm)/g.test(e):/(mp4|webm)/g.test(s),p={source:"mediaFileList",filename:a,fileid:t,pauseWhenOver:h&&o.getConfigration().mediaSharePauseWhenOver};this.startShareMedia(e,h,u,p)}else{var f={name:"ShowPage",id:"DocumentFilePage_ShowPage",toID:"__all",data:{isGeneralFile:"generalDocument"==n,isMedia:!1,isDynamicPPT:"dynamicPPT"==n,isH5Document:"h5Document"==n,action:"show",mediaType:"",filedata:{currpage:void 0!==r.toPage&&"number"==typeof r.toPage?r.toPage:1,pptslide:void 0!==r.toPage&&"number"==typeof r.toPage?r.toPage:1,pptstep:0,steptotal:0,fileid:t,pagenum:1,filename:a,filetype:s,isContentDocument:1,swfpath:e}},save:!0};this.receiveEventRoomPubmsg({type:"room-pubmsg",message:Object.deepAssign({},f)}),o.getConfigration().synchronization&&o.getConfigration().isConnectedRoom&&this.pubMsg(f)}}}},{key:"changeWhiteBoardConfigration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n={};for(var i in e)z.commonWhiteboard.hasOwnProperty(i)&&(n[i]=e[i],delete e[i]);if(f()(n).length&&this.changeCommonWhiteBoardConfigration(n),f()(e).length){if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]changeWhiteBoardConfigration  configration and instanceId:",e,t),this.whiteboardViewMap.has(t)?(this.awitWhiteboardConfigrationMap.has(t)&&this.awitWhiteboardConfigrationMap.delete(t),this.whiteboardViewMap.get(t).changeWhiteBoardConfigration(e)):this.awitWhiteboardConfigrationMap.has(t)?Object.deepAssign(this.awitWhiteboardConfigrationMap.get(t),e):this.awitWhiteboardConfigrationMap.set(t,Object.deepAssign({},z.defaultWhiteboard,z.commonWhiteboard,e)),void 0!==e.isLoadDocumentToolBar&&"default"===t||e.hasExtendDocument){var r=this.whiteboardViewMap.get(t);if(e.isLoadDocumentToolBar&&!this.documentToolbarViewList[t]){if(r){var o=r.getConfigration().documentToolBarConfig.parentNode||r.getWhiteboardRootElement();this.createDocumentToolBar(o,r.getConfigration().documentToolBarConfig,t)}}else!e.isLoadDocumentToolBar&&this.documentToolbarViewList[t]&&this.documentToolbarViewList[t].destroyView&&(this.documentToolbarViewList[t].destroyView(),this.documentToolbarViewList[t]=void 0)}if(void 0!==e.isLoadDocumentRemark&&"default"===t||e.hasExtendDocument){var s=this.whiteboardViewMap.get(t);if(e.isLoadDocumentRemark&&!this.documentRemarkViewList[t]){if(s){var l=s.getConfigration().documentRemarkConfig.parentNode||s.getWhiteboardRootElement();this.createDocumentRemark(l,s.getConfigration().documentRemarkConfig,t)}}else!e.isLoadDocumentRemark&&this.documentRemarkViewList[t]&&this.documentRemarkViewList[t].destroyView&&(this.documentRemarkViewList[t].destroyView(),this.documentRemarkViewList[t]=void 0)}if(void 0!==e.isLoadWhiteboardToolBar){var c=this.whiteboardViewMap.get(t);if(e.isLoadWhiteboardToolBar&&!this.whiteboardToolbarViewList[t]){if(c){var d=c.getConfigration().whiteboardToolBarConfig.parentNode||c.getWhiteboardRootElement();this.createWhiteboardToolBar(d,c.getConfigration().whiteboardToolBarConfig,t)}}else!e.isLoadWhiteboardToolBar&&this.whiteboardToolbarViewList[t]&&this.whiteboardToolbarViewList[t].destroyView&&(this.whiteboardToolbarViewList[t].destroyView(),this.whiteboardToolbarViewList[t]=void 0,delete this.whiteboardToolbarViewList[t])}if(void 0!==e.isLoadAudioPlayer&&"default"===t){var u=this.whiteboardViewMap.get(t);if(e.isLoadAudioPlayer&&!this.audioPlayerView){if(u){var h=u.getConfigration().audioPlayerConfig.parentNode||u.getWhiteboardRootElement();this.createAudioPlayer(h,u.getConfigration().audioPlayerConfig)}}else!e.isLoadAudioPlayer&&this.audioPlayerView&&this.audioPlayerView.destroyView&&(this.audioPlayerView.destroyView(),this.audioPlayerView=void 0)}if(void 0!==e.isLoadVideoPlayer&&"default"===t){var p=this.whiteboardViewMap.get(t);if(e.isLoadVideoPlayer&&!this.videoPlayerView){if(p){var m=p.getConfigration().videoPlayerConfig.parentNode||p.getWhiteboardRootElement();this.createVideoPlayer(m,p.getConfigration().videoPlayerConfig)}}else!e.isLoadVideoPlayer&&this.videoPlayerView&&this.videoPlayerView.destroyView&&(this.videoPlayerView.destroyView(),this.videoPlayerView=void 0)}if(void 0!==e.languageType&&(("default"===t||e.hasExtendDocument)&&(this.documentToolbarViewList[t]&&this.documentToolbarViewList[t].setProps({languageType:e.languageType}),this.documentRemarkViewList[t]&&this.documentRemarkViewList[t].setProps({languageType:e.languageType})),this.whiteboardToolbarViewList[t]&&this.whiteboardToolbarViewList[t].setProps({languageType:e.languageType})),void 0!==e.isMobile&&(("default"===t||e.hasExtendDocument)&&(this.documentToolbarViewList[t]&&this.documentToolbarViewList[t].setProps({isMobile:e.isMobile}),this.documentRemarkViewList[t]&&this.documentRemarkViewList[t].setProps({isMobile:e.isMobile})),this.whiteboardToolbarViewList[t]&&this.whiteboardToolbarViewList[t].setProps({isMobile:e.isMobile})),void 0!==e.canRemark&&("default"===t||e.hasExtendDocument)&&(this.documentToolbarViewList[t]&&this.documentToolbarViewList[t].setProps({canRemark:e.canRemark}),this.documentRemarkViewList[t]&&this.documentRemarkViewList[t].setProps({canRemark:e.canRemark})),void 0!==e.whiteboardToolBarConfig&&this.whiteboardToolbarViewList[t]){if(e.whiteboardToolBarConfig.hasOwnProperty("parentNode")&&"function"==typeof this.whiteboardToolbarViewList[t].changeParentNode){var g=this.whiteboardViewMap.get(t),v=e.whiteboardToolBarConfig.parentNode||(g?g.getWhiteboardRootElement():void 0);if("string"==typeof v){var y=v;if(!(v=document.getElementById(y)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and  whiteboardToolBarConfig.parentNode cannot update config, element id is "+y+".")}this.whiteboardToolbarViewList[t].changeParentNode(v)}for(var b in e.whiteboardToolBarConfig){var w=e.whiteboardToolBarConfig[b];"object"===a()(w)&&(e.whiteboardToolBarConfig[b]=Object.deepAssign({},this.whiteboardToolbarViewList[t].props[b],w))}this.whiteboardToolbarViewList[t].setProps(Object.deepAssign({},e.whiteboardToolBarConfig))}if(void 0!==e.documentToolBarConfig&&("default"===t||e.hasExtendDocument)&&this.documentToolbarViewList[t]){if(e.documentToolBarConfig.hasOwnProperty("parentNode")&&"function"==typeof this.documentToolbarViewList[t].changeParentNode){var _=this.whiteboardViewMap.get(t),S=e.documentToolBarConfig.parentNode||(_?_.getWhiteboardRootElement():void 0);if("string"==typeof S){var k=S;if(!(S=document.getElementById(k)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and  documentToolBarConfig.parentNode cannot update config, element id is "+k+".")}this.documentToolbarViewList[t].changeParentNode(S)}for(var P in e.documentToolBarConfig){var C=e.documentToolBarConfig[P];"object"===a()(C)&&(e.documentToolBarConfig[P]=Object.deepAssign({},this.documentToolbarViewList[t].props[P],C))}this.documentToolbarViewList[t].setProps(Object.deepAssign({},e.documentToolBarConfig))}if(void 0!==e.documentRemarkConfig&&("default"===t||e.hasExtendDocument)&&this.documentRemarkViewList[t]){if(e.documentRemarkConfig.hasOwnProperty("parentNode")&&"function"==typeof this.documentRemarkViewList[t].changeParentNode){var T=this.whiteboardViewMap.get(t),A=e.documentRemarkConfig.parentNode||(T?T.getWhiteboardRootElement():void 0);if("string"==typeof A){var I=A;if(!(A=document.getElementById(I)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and  documentRemarkConfig.parentNode cannot update config, element id is "+I+".")}this.documentRemarkViewList[t].changeParentNode(A)}for(var E in e.documentRemarkConfig){var x=e.documentRemarkConfig[E];"object"===a()(x)&&(e.documentRemarkConfig[E]=Object.deepAssign({},this.documentRemarkViewList[t].props[E],x))}this.documentRemarkViewList[t].setProps(Object.deepAssign({},e.documentRemarkConfig))}if(void 0!==e.audioPlayerConfig&&this.audioPlayerView){for(var R in e.audioPlayerConfig){var D=e.audioPlayerConfig[R];"object"===a()(D)&&(e.audioPlayerConfig[R]=Object.deepAssign({},this.audioPlayerView.props[R],D))}this.audioPlayerView.setProps(Object.deepAssign({},e.audioPlayerConfig))}if(void 0!==e.videoPlayerConfig&&this.videoPlayerView){for(var M in e.videoPlayerConfig){var W=e.videoPlayerConfig[M];"object"===a()(W)&&(e.videoPlayerConfig[M]=Object.deepAssign({},this.videoPlayerView.props[M],W))}this.videoPlayerView.setProps(Object.deepAssign({},e.videoPlayerConfig))}}}},{key:"noticeWhiteboardActionCommand",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";(L.Logger.debug(B.logType,"[whiteboarrd-sdk]noticeWhiteboardActionCommand "),this.whiteboardViewMap.has(n))&&this.whiteboardViewMap.get(n).noticeWhiteboardActionCommand(e,t)}},{key:"changeCommonWhiteBoardConfigration",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]changeCommonWhiteBoardConfigration common configration:",e);var t=Object.deepAssign({},e);"object"===a()(t.docAddress)&&(B.docAddress=e.docAddress,""===B.docAddressKey&&(B.docAddressKey=e.docAddress.hostname),B.protocol=t.docAddress.protocol,B.port=t.docAddress.port,t.docAddress=e.docAddress.protocol+"://"+e.docAddress.hostname+":"+e.docAddress.port),"object"===a()(t.webAddress)&&(t.webAddress=e.webAddress.protocol+"://"+e.webAddress.hostname+":"+e.webAddress.port),t.backupDocAddressList&&w()(t.backupDocAddressList)&&(B.backupDocAddressList=e.backupDocAddressList,z.commonWhiteboard.backupDocAddressList=[]),Object.deepAssign(z.commonWhiteboard,t);var n=!0,i=!1,r=void 0;try{for(var o,s=W()(this.awitWhiteboardConfigrationMap.values());!(n=(o=s.next()).done);n=!0){var l=o.value;Object.deepAssign(l,t)}}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}void 0===e.docAddress&&void 0===e.backupDocAddressList||(B.docAddressList=[B.docAddress].concat(D()(B.backupDocAddressList),D()(B.laterAddressList)),B.hasGetDocAddressIndexByLocalStorage?(B.localStorageDocAddressKey&&""===A.getItem(B.docAddressList,B.localStorageDocAddressKey)&&""===A.getItem(B.laterAddressList,B.localStorageDocAddressKey)&&(B.protocol&&B.port&&(B.laterAddressList=[{protocol:B.protocol,hostname:B.localStorageDocAddressKey,port:B.port}]),B.docAddressList=[B.docAddress].concat(D()(B.backupDocAddressList),D()(B.laterAddressList))),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||z.commonWhiteboard.docAddress):(B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||z.commonWhiteboard.docAddress,this.getLocalStorageItem("ysDocAddressKey",function(e){e&&void 0!==e&&"string"==typeof e&&"undefined"!==e?(B.docAddressKey=e,B.localStorageDocAddressKey=e,B.localStorageDocAddressKey&&""===A.getItem(B.docAddressList,B.localStorageDocAddressKey)&&""===A.getItem(B.laterAddressList,B.localStorageDocAddressKey)&&(B.protocol&&B.port&&(B.laterAddressList=[{protocol:B.protocol,hostname:B.localStorageDocAddressKey,port:B.port}]),B.docAddressList=[B.docAddress].concat(D()(B.backupDocAddressList),D()(B.laterAddressList))),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||z.commonWhiteboard.docAddress,B.hasGetDocAddressIndexByLocalStorage=!0):(B.localStorageDocAddressKey&&""===A.getItem(B.docAddressList,B.localStorageDocAddressKey)&&""===A.getItem(B.laterAddressList,B.localStorageDocAddressKey)&&(B.protocol&&B.port&&(B.laterAddressList=[{protocol:B.protocol,hostname:B.localStorageDocAddressKey,port:B.port}]),B.docAddressList=[B.docAddress].concat(D()(B.backupDocAddressList),D()(B.laterAddressList))),B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||z.commonWhiteboard.docAddress,B.hasGetDocAddressIndexByLocalStorage=!0)})));var c=!0,u=!1,h=void 0;try{for(var p,f=W()(this.whiteboardViewMap);!(c=(p=f.next()).done);c=!0){var m=d()(p.value,2),g=m[0],v=m[1];this.awitWhiteboardConfigrationMap.has(g)&&this.awitWhiteboardConfigrationMap.delete(g),v.changeWhiteBoardConfigration(t)}}catch(e){u=!0,h=e}finally{try{c||null==f.return||f.return()}finally{if(u)throw h}}for(var y=0,b=x()(this.whiteboardToolbarViewList);y<b.length;y++){var _=b[y];_&&_.setProps(Object.deepAssign({},t))}for(var S=0,k=x()(this.documentToolbarViewList);S<k.length;S++){var P=k[S];P&&P.setProps(Object.deepAssign({},t))}for(var C=0,T=x()(this.documentRemarkViewList);C<T.length;C++){var I=T[C];I&&I.setProps(Object.deepAssign({},t))}this.audioPlayerView&&this.audioPlayerView.setProps(Object.deepAssign({},t)),this.videoPlayerView&&this.videoPlayerView.setProps(Object.deepAssign({},t))}},{key:"useWhiteboardTool",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]useWhiteboardTool toolKey and instanceId:",e,t),e&&this.whiteboardViewMap.has(t)&&this.whiteboardViewMap.get(t).useWhiteboardTool(e)}},{key:"addPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]addPage "),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).addPage()}},{key:"nextPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]nextPage "),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).nextPage()}},{key:"prevPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]prevPage "),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).prevPage()}},{key:"skipPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]skipPage  page :",e),"number"==typeof e?this.whiteboardViewMap.has(t)&&this.whiteboardViewMap.get(t).skipPage(e):L.Logger.warning(B.logType,"skipPage page must is number!")}},{key:"nextStep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]nextStep "),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).nextStep()}},{key:"prevStep",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]prevStep "),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).prevStep()}},{key:"enlargeWhiteboard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]enlargeWhiteboard  instanceId:",e);this.executeZoomWhiteaord("zoom_big",e)}},{key:"narrowWhiteboard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]narrowWhiteboard  instanceId:",e);this.executeZoomWhiteaord("zoom_small",e)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]clear  instanceId:",e);this.executeWhiteboardAction("action_clear",e)}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]undo  instanceId:",e);this.executeWhiteboardAction("action_undo",e)}},{key:"redo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]redo  instanceId:",e);this.executeWhiteboardAction("action_redo",e)}},{key:"fullScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]fullScreen "),this.whiteboardViewMap.has(e)&&this.room){var t=this.whiteboardViewMap.get(e);if(t.getConfigration().isMobile)this.room.changeWebPageFullScreen&&this.room.changeWebPageFullScreen(!0);else{A.isFullScreenStatus()&&A.exitFullscreen();var n=t.getWhiteboardRootElement(),i=t.getConfigration().documentToolBarConfig.fullScreenElementId;i&&("string"==typeof i?document.getElementById(i)&&(n=document.getElementById(i)):n=i),A.launchFullscreen(n)}}}},{key:"exitFullScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";(L.Logger.debug(B.logType,"[whiteboarrd-sdk]exitFullScreen "),this.whiteboardViewMap.has(e)&&this.room)&&(this.whiteboardViewMap.get(e).getConfigration().isMobile?this.room.changeWebPageFullScreen&&this.room.changeWebPageFullScreen(!1):A.exitFullscreen())}},{key:"updateWhiteboardSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]updateWhiteboardSize  instanceId:",e);var t={};if(this.whiteboardViewMap.has(e)){var n=this.whiteboardViewMap.get(e);n.resizeWhiteboardHandler(),t=n.getConfigration()}("default"===e||t.hasExtendDocument)&&this.documentRemarkViewList[e]&&A.isFunction(this.documentRemarkViewList[e].resize)&&this.documentRemarkViewList[e].resize(),("default"===e||t.hasExtendDocument)&&this.documentToolbarViewList[e]&&A.isFunction(this.documentToolbarViewList[e].resize)&&this.documentToolbarViewList[e].resize(),this.whiteboardToolbarViewList[e]&&A.isFunction(this.whiteboardToolbarViewList[e].resize)&&this.whiteboardToolbarViewList[e].resize()}},{key:"updateAllWhiteboardSize",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]updateAllWhiteboardSize ");var e=!0,t=!1,n=void 0;try{for(var i,r=W()(this.whiteboardViewMap.keys());!(e=(i=r.next()).done);e=!0){var o=i.value;this.updateWhiteboardSize(o)}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"resetWhiteboardData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]resetWhiteboardData  instanceId:",e),this.whiteboardViewMap.has(e)&&this.whiteboardViewMap.get(e).resetWhiteboardData()}},{key:"resetAllWhiteboardData",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]resetAllWhiteboardData ");var e=!0,t=!1,n=void 0;try{for(var i,r=W()(this.whiteboardViewMap.values());!(e=(i=r.next()).done);e=!0){i.value.resetWhiteboardData()}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"resetPureWhiteboardTotalPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]resetPureWhiteboardTotalPage ");var t=this.pureWhiteboardFileinfoList[e]?this.pureWhiteboardFileinfoList[e].pagenum:1;this.pureWhiteboardFileinfoList[e]&&(this.pureWhiteboardFileinfoList[e].pagenum=1);var n=this.whiteboardViewMap.get(e);n&&A.isFunction(n.resetPureWhiteboardTotalPage)&&n.resetPureWhiteboardTotalPage(t)}},{key:"changeDynamicPptVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]changeDynamicPptVolume volume:",e),"number"==typeof e&&this.whiteboardViewMap.has(t)){var n=this.whiteboardViewMap.get(t);e<0?e=0:e>100&&(e=100);var i={name:"default"===t?"PptVolumeControl":"ExtendPptVolumeControl",id:"default"===t?"PptVolumeControl":"PptVolumeControl_".concat(t),toID:"__allExceptSender",data:{sourceInstanceId:t,volume:e/100},save:!0};this.receiveEventRoomPubmsg({type:"room-pubmsg",message:i}),this.room.setPptAudioVolume&&this.room.setPptAudioVolume(e),n.getConfigration().pptVolumeSynchronization&&n.getConfigration().isConnectedRoom&&this.pubMsg(i)}}},{key:"openDocumentRemark",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";(L.Logger.debug(B.logType,"[whiteboarrd-sdk]openDocumentRemark "),this.whiteboardViewMap.has(e))&&this.whiteboardViewMap.get(e).changeDocumentRemarkState(!0)}},{key:"closeDocumentRemark",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";(L.Logger.debug(B.logType,"[whiteboarrd-sdk]closeDocumentRemark "),this.whiteboardViewMap.has(e))&&this.whiteboardViewMap.get(e).changeDocumentRemarkState(!1)}},{key:"executeWhiteboardAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]executeWhiteboardAction actionKey and\tinstanceId:",e,t),this.whiteboardViewMap.has(t)&&this.whiteboardViewMap.get(t).executeWhiteboardAction(e)}},{key:"executeZoomWhiteaord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]executeZoomWhiteaord \tzoomKey and\tinstanceId:",e,t),this.whiteboardViewMap.has(t)&&this.whiteboardViewMap.get(t).executeZoomWhiteaord(e)}},{key:"receiveEventRoomPubmsg",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomPubmsg \trecvEventData:",e),"string"==typeof e&&(e=JSON.parse(e));var t=e.message;if(this._isWhiteboardCorrelationSignalling(t.name))if("SharpsChange"===t.name)t.data&&t.data.nickname?t.remindContent=t.data.nickname:this.room&&A.isFunction(this.room.getUser)&&this.room.getUser(t.fromID)&&"object"===a()(this.room.getUser(t.fromID))&&this.room.getUser(t.fromID).nickname&&(t.remindContent=this.room.getUser(t.fromID).nickname),he.handlerPubmsg_SharpsChange(t);else if("WBPageCount"===t.name)this.pureWhiteboardFileinfoList.default&&(this.pureWhiteboardFileinfoList.default.pagenum=t.data.totalPage);else if("ExtendWBPageCount"===t.name)t.data&&this.pureWhiteboardFileinfoList[t.data.sourceInstanceId]&&(this.pureWhiteboardFileinfoList[t.data.sourceInstanceId].pagenum=t.data.totalPage);else if(["ShowPage","whiteboardMarkTool","NewPptTriggerActionClick","PptVolumeControl","H5DocumentAction","ExtendShowPage","ExtendWhiteboardMarkTool","ExtendH5DocumentAction","ExtendPptVolumeControl","ExtendNewPptTriggerActionClick"].includes(t.name))["ShowPage","ExtendShowPage"].includes(t.name)&&("string"==typeof t.data&&(t.data=A.toJsonParse(t.data)),t.data.isGeneralFile&&t.data.filedata&&0==t.data.filedata.fileid&&("ShowPage"===t.name&&this.pureWhiteboardFileinfoList.default?t.data.filedata.pagenum=this.pureWhiteboardFileinfoList.default.pagenum:"ExtendShowPage"===t.name&&this.pureWhiteboardFileinfoList[t.data.sourceInstanceId]&&(t.data.filedata.pagenum=this.pureWhiteboardFileinfoList[t.data.sourceInstanceId].pagenum))),["ShowPage","whiteboardMarkTool","NewPptTriggerActionClick","PptVolumeControl","H5DocumentAction"].includes(t.name)?this.whiteboardViewMap.has("default")?this.whiteboardViewMap.get("default").receiveEventRoomPubmsg(e):this.savePubmsgData.default&&w()(this.savePubmsgData.default)?this.savePubmsgData.default.push(e):this.savePubmsgData.default=[e]:["ExtendShowPage","ExtendWhiteboardMarkTool","ExtendPptVolumeControl","ExtendH5DocumentAction","ExtendNewPptTriggerActionClick"].includes(t.name)&&t.data&&(this.whiteboardViewMap.has(t.data.sourceInstanceId)?this.whiteboardViewMap.get(t.data.sourceInstanceId).receiveEventRoomPubmsg(e):this.savePubmsgData[t.data.sourceInstanceId]&&w()(this.savePubmsgData[t.data.sourceInstanceId])?this.savePubmsgData[t.data.sourceInstanceId].push(e):this.savePubmsgData[t.data.sourceInstanceId]=[e]);else{var n=!0,i=!1,r=void 0;try{for(var o,s=W()(this.whiteboardViewMap.values());!(n=(o=s.next()).done);n=!0){o.value.receiveEventRoomPubmsg(e)}}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}}},{key:"receiveEventRoomConnected",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomConnected \trecvEventData:",e),this.saveMsglistData={},this.savePubmsgData={},this.resetAllWhiteboardData(),this.resetPureWhiteboardTotalPage();var t=e.message;this.receiveEventRoomMsglist(l()({type:"room-msglist",message:t}))}},{key:"receiveEventRoomDisconnected",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomDisconnected "),B.laterAddressList=[],B.hasGetDocAddressIndexByLocalStorage=!1;var e=!0,t=!1,n=void 0;try{for(var i,r=W()(this.whiteboardViewMap.values());!(e=(i=r.next()).done);e=!0){var o=i.value;o&&o.getConfigration()&&o.getConfigration().isDisconnectedClearWhiteboardData&&A.isFunction(o.resetWhiteboardData)&&o.resetWhiteboardData()}}catch(e){t=!0,n=e}finally{try{e||null==r.return||r.return()}finally{if(t)throw n}}}},{key:"receiveEventRoomDelmsg",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomDelmsg \trecvEventData:",e),"string"==typeof e&&(e=JSON.parse(e));var t=e.message;if(this._isWhiteboardCorrelationSignalling(t.name))if("SharpsChange"===t.name)he.handlerDelmsg_SharpsChange(t);else{var n=!0,i=!1,r=void 0;try{for(var o,a=W()(this.whiteboardViewMap.values());!(n=(o=a.next()).done);n=!0){o.value.receiveEventRoomDelmsg(e)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}}}},{key:"receiveEventRoomMsglist",value:function(e){var t=this;L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomMsglist \trecvEventData:",e),"string"==typeof e&&(e=JSON.parse(e));var n={},i=e.message;for(var r in i)this._isWhiteboardCorrelationSignalling(i[r].name)&&(i[r].data&&"string"==typeof i[r].data&&(i[r].data=JSON.parse(i[r].data)),null===n[i[r].name]||void 0===n[i[r].name]?(n[i[r].name]=[],n[i[r].name].push(i[r])):n[i[r].name].push(i[r]));var o=n.WBPageCount;null!=o&&o.length>0&&this.pureWhiteboardFileinfoList.default&&(this.pureWhiteboardFileinfoList.default.pagenum=o[o.length-1].data.totalPage),n.WBPageCount=null,delete n.WBPageCount;var a=n.ExtendWBPageCount;null!=a&&a.length>0&&a.forEach(function(e,n){e.data&&t.pureWhiteboardFileinfoList[e.data.sourceInstanceId]&&(t.pureWhiteboardFileinfoList[e.data.sourceInstanceId].pagenum=e.data.totalPage)}),n.ExtendWBPageCount=null,delete n.ExtendWBPageCount;for(var s=0,l=["ShowPage","whiteboardMarkTool","NewPptTriggerActionClick","PptVolumeControl","H5DocumentAction","ExtendShowPage","ExtendWhiteboardMarkTool","ExtendPptVolumeControl","ExtendH5DocumentAction","ExtendNewPptTriggerActionClick"];s<l.length;s++){var c=l[s],d=n[c];if(("ShowPage"===c||"ExtendShowPage"===c)&&d&&d.length){var u=!0,h=!1,p=void 0;try{for(var f,m=W()(d);!(u=(f=m.next()).done);u=!0){var g=f.value;["ShowPage","ExtendShowPage"].includes(g.name)&&("string"==typeof g.data&&(g.data=A.toJsonParse(g.data)),g.data.isGeneralFile&&g.data.filedata&&0==g.data.filedata.fileid&&("ShowPage"===g.name&&this.pureWhiteboardFileinfoList.default?g.data.filedata.pagenum=this.pureWhiteboardFileinfoList.default.pagenum:"ExtendShowPage"===g.name&&this.pureWhiteboardFileinfoList[g.data.sourceInstanceId]&&(g.data.filedata.pagenum=this.pureWhiteboardFileinfoList[g.data.sourceInstanceId].pagenum)))}}catch(e){h=!0,p=e}finally{try{u||null==m.return||m.return()}finally{if(h)throw p}}}if(null!=d&&d.length>0)if("ShowPage"===c||"whiteboardMarkTool"===c||"NewPptTriggerActionClick"===c||"PptVolumeControl"===c||"H5DocumentAction"===c)this.whiteboardViewMap.has("default")?this.whiteboardViewMap.get("default").receiveEventRoomMsglist(c,d[d.length-1]):this.saveMsglistData.default&&w()(this.saveMsglistData.default)?this.saveMsglistData.default.push(d[d.length-1]):this.saveMsglistData.default=[d[d.length-1]];else if("ExtendShowPage"===c||"ExtendWhiteboardMarkTool"===c||"ExtendPptVolumeControl"===c||"ExtendH5DocumentAction"===c||"ExtendNewPptTriggerActionClick"===c){var v=!0,y=!1,b=void 0;try{for(var _,S=W()(d);!(v=(_=S.next()).done);v=!0){var k=_.value;k.data&&(this.whiteboardViewMap.has(k.data.sourceInstanceId)?this.whiteboardViewMap.get(k.data.sourceInstanceId).receiveEventRoomMsglist(c,k):this.saveMsglistData[k.data.sourceInstanceId]&&w()(this.saveMsglistData[k.data.sourceInstanceId])?this.saveMsglistData[k.data.sourceInstanceId].push(k):this.saveMsglistData[k.data.sourceInstanceId]=[k])}}catch(e){y=!0,b=e}finally{try{v||null==S.return||S.return()}finally{if(y)throw b}}}n[c]=null,delete n[c]}var P=n.SharpsChange;null!=P&&P.length>0&&he.handlerMsglist_SharpsChange(P),n.SharpsChange=null,delete n.SharpsChange,n=null}},{key:"reveiveEventRoomUsermediaorfilestateChanged",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]reveiveEventRoomUsermediaorfilestateChanged recvEventData:",e),this._forwardingStreamEvents("reveiveEventRoomUsermediaorfilestateChanged",e)}},{key:"reveiveEventRoomUsermediaorfileattributesUpdate",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]reveiveEventRoomUsermediaorfileattributesUpdate recvEventData:",e),this._forwardingStreamEvents("reveiveEventRoomUsermediaorfileattributesUpdate",e)}},{key:"receiveEventRoomErrorNotice",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]receiveEventRoomErrorNotice recvEventData:",e),this._forwardingStreamEvents("receiveEventRoomErrorNotice",e)}},{key:"reveiveEventRoomReceiveActionCommand",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]reveiveEventRoomReceiveActionCommand \trecvEventData:",e);var t=e.message,n=t.action,i=t.cmd;switch(n){case"transmitWindowSize":this._windowResizeCallback()}var r=!0,o=!1,a=void 0;try{for(var s,l=W()(this.whiteboardViewMap.values());!(r=(s=l.next()).done);r=!0){s.value.reveiveEventRoomReceiveActionCommand(n,i)}}catch(e){o=!0,a=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw a}}}},{key:"registerRoomDelegate",value:function(e,t){L.Logger.debug(B.logType,"[whiteboarrd-sdk]registerRoomDelegate \troom and  sdkReceiveActionCommand:",e,t),this.room=e,this.sdkReceiveActionCommand=t,this._addRoomEvent()}},{key:"getRoomDelegate",value:function(){return L.Logger.debug(B.logType,"[whiteboarrd-sdk]getRoomDelegate "),this.room}},{key:"hasRoomDelegate",value:function(){return L.Logger.debug(B.logType,"[whiteboarrd-sdk]hasRoomDelegate "),!!this.room}},{key:"sendActionCommandToSdk",value:function(e,t){L.Logger.debug(B.logType,"[whiteboarrd-sdk]sendActionCommandToSdk \taction and\tcmd:",e,t),this.sdkReceiveActionCommand&&"function"==typeof this.sdkReceiveActionCommand&&(a()(t)&&!w()(t)&&(t=JSON.parse(l()(t))),this.sdkReceiveActionCommand(e,t))}},{key:"pubMsg",value:function(e){if("ShowPage"===e.name){var t=!1;"string"==typeof e.data?(e.data=JSON.parse(e.data),t=!0):e.data=e.data,e.data&&e.data.filedata&&e.data.filedata.baseurl&&delete e.data.filedata.baseurl,t&&(e.data=l()(e.data))}L.Logger.debug(B.logType,"[whiteboarrd-sdk]pubMsg \tparams :",e),this.room&&this.room.pubMsg&&("string"==typeof e&&(e=JSON.parse(e)),"WBPageCount"===e.name&&this.pureWhiteboardFileinfoList.default&&(this.pureWhiteboardFileinfoList.default.pagenum=e.data.totalPage),"ExtendWBPageCount"===e.name&&this.pureWhiteboardFileinfoList[e.data.sourceInstanceId]&&(this.pureWhiteboardFileinfoList[e.data.sourceInstanceId].pagenum=e.data.totalPage),e.data&&"object"===a()(e.data)&&!w()(e.data)&&(e.data=l()(e.data)),this.room.pubMsg(e))}},{key:"delMsg",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]delMsg params :",e),this.room&&this.room.delMsg&&(e.data&&"object"===a()(e.data)&&!w()(e.data)&&(e.data=l()(e.data)),this.room.delMsg(e))}},{key:"startShareMedia",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]startShareMedia url  isVideo  toID  and  attrs:",e,t,n,i),this.stopShareMedia(),this.stopShareLocalMedia(),this.room&&this.room.startShareMedia){var r=this.whiteboardViewMap.get("default");t&&r&&r.getConfigration()&&r.getConfigration().mediaSharePauseWhenOver&&(i.pauseWhenOver=r.getConfigration().mediaSharePauseWhenOver),r&&r.getConfigration()&&void 0!==r.getConfigration().myUserId&&!r.getConfigration().synchronization&&(n=r.getConfigration().myUserId),"mobile"!==YS.SDKTYPE?this.room.startShareMedia(e,t,function(e){L.Logger.warning(B.logType,"[whiteboard-sdk]startShareMedia fail , fail info:"+e)},{toID:n,attrs:i}):this.room.startShareMedia(e,t,n,i)}}},{key:"stopShareMedia",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]stopShareMedia "),this.room&&this.room.stopShareMedia&&this.room.stopShareMedia()}},{key:"stopShareLocalMedia",value:function(){"mobile"!==YS.SDKTYPE&&this.room&&this.room.stopShareLocalMedia&&(L.Logger.debug(B.logType,"[whiteboarrd-sdk]stopShareLocalMedia "),this.room.stopShareLocalMedia())}},{key:"createAudioPlayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createAudioPlayer parentNode and config :",e&&e.id||e,t),De){if("string"==typeof e){var n=e;if(!(e=document.getElementById(n)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createAudioPlayer method cannot be performed , element id is "+n+".")}var i=this.whiteboardViewMap.get("default"),r=e||(i?i.getWhiteboardRootElement():document.body);this.audioPlayerView&&this.audioPlayerView.destroyView&&(this.audioPlayerView.destroyView(),this.audioPlayerView=void 0),this.audioPlayerView=new De(r,"default",this,Object.deepAssign({},t,{languageType:i?i.getConfigration().languageType:"ch",isMobile:!!i&&i.getConfigration().isMobile},z.commonWhiteboard),i?i.getConfigration():void 0)}else L.Logger.error(B.logType,"The resource file for the audio player is not loaded and can't be executed with createAudioPlayer methods.")}},{key:"createVideoPlayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createVideoPlayer parentNode and config :",e&&e.id||e,t),Le){if("string"==typeof e){var n=e;if(!(e=document.getElementById(n)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createVideoPlayer method cannot be performed , element id is "+n+".")}var i=this.whiteboardViewMap.get("default"),r=e||(i?i.getWhiteboardRootElement():document.body);this.videoPlayerView&&this.videoPlayerView.destroyView&&(this.videoPlayerView.destroyView(),this.videoPlayerView=void 0),this.videoPlayerView=new Le(r,"default",this,Object.deepAssign({},t,{languageType:i?i.getConfigration().languageType:"ch",isMobile:!!i&&i.getConfigration().isMobile},z.commonWhiteboard),i?i.getConfigration():void 0)}else L.Logger.error(B.logType,"The resource file for the audio player is not loaded and can't be executed with createVideoPlayer methods.")}},{key:"createDocumentRemark",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createDocumentRemark parentNode and config :",e&&e.id||e,t),Ge){if("string"==typeof e){var i=e;if(!(e=document.getElementById(i)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createDocumentRemark method cannot be performed , element id is "+i+".")}var r=this.whiteboardViewMap.get(n),o=e||(r?r.getWhiteboardRootElement():document.body);if(this.documentRemarkViewList[n]&&this.documentRemarkViewList[n].destroyView&&(this.documentRemarkViewList[n].destroyView(),delete this.documentRemarkViewList[n]),this.documentRemarkViewList[n]=new Ge(o,n,this,Object.deepAssign({},t,{languageType:r?r.getConfigration().languageType:"ch",isMobile:!!r&&r.getConfigration().isMobile,canRemark:!!r&&r.getConfigration().canRemark},z.commonWhiteboard),r?r.getConfigration():void 0),r){var a=this.getWhiteboardViewState(n);if(this.documentRemarkViewList[n]&&this.documentRemarkViewList[n].receiveActionCommand&&a&&f()(a.page).length&&f()(a.zoom).length){var s={viewState:a,updateViewState:{}};this.documentRemarkViewList[n].receiveActionCommand("viewStateUpdate",s)}}}else L.Logger.error(B.logType,"The resource file for the document tool bar is not loaded and can't be executed with createDocumentRemark methods.")}},{key:"createDocumentToolBar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createDocumentToolBar parentNode and config :",e&&e.id||e,t),Fe){if("string"==typeof e){var i=e;if(!(e=document.getElementById(i)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createDocumentToolBar method cannot be performed , element id is "+i+".")}var r=this.whiteboardViewMap.get(n),o=e||(r?r.getWhiteboardRootElement():document.body);if(this.documentToolbarViewList[n]&&this.documentToolbarViewList[n].destroyView&&(this.documentToolbarViewList[n].destroyView(),delete this.documentToolbarViewList[n]),this.documentToolbarViewList[n]=new Fe(o,n,this,Object.deepAssign({},t,{languageType:r?r.getConfigration().languageType:"ch",isMobile:!!r&&r.getConfigration().isMobile,canRemark:!!r&&r.getConfigration().canRemark},z.commonWhiteboard),r?r.getConfigration():void 0),r){var a=this.getWhiteboardViewState(n);if(this.documentToolbarViewList[n]&&this.documentToolbarViewList[n].receiveActionCommand&&a&&f()(a.page).length&&f()(a.zoom).length){var s={viewState:a,updateViewState:{}};this.documentToolbarViewList[n].receiveActionCommand("viewStateUpdate",s)}}}else L.Logger.error(B.logType,"The resource file for the document tool bar is not loaded and can't be executed with createDocumentToolBar methods.")}},{key:"createWhiteboardToolBar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]createWhiteboardToolBar parentNode  config  and instanceId :",e&&e.id||e,t,n),Be){if("string"==typeof e){var i=e;if(!(e=document.getElementById(i)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and RoadofWhiteboardToolbar method cannot be performed , element id is "+i+".")}var r=this.whiteboardViewMap.get(n),o=e||(r?r.getWhiteboardRootElement():document.body);if(this.whiteboardToolbarViewList[n]&&this.whiteboardToolbarViewList[n].destroyView&&(this.whiteboardToolbarViewList[n].destroyView(),delete this.whiteboardToolbarViewList[n]),this.whiteboardToolbarViewList[n]=new Be(o,n,this,Object.deepAssign({},t,{languageType:r?r.getConfigration().languageType:"ch",isMobile:!!r&&r.getConfigration().isMobile},z.commonWhiteboard),r?r.getConfigration():void 0),r){var a=this.getWhiteboardViewState(n);if(this.whiteboardToolbarViewList[n]&&this.whiteboardToolbarViewList[n].receiveActionCommand&&a&&f()(a.page).length&&f()(a.zoom).length){var s={viewState:a,updateViewState:{}};this.whiteboardToolbarViewList[n].receiveActionCommand("viewStateUpdate",s)}}}else L.Logger.error(B.logType,"The resource file for the document tool bar is not loaded and can't be executed with RoadofWhiteboardToolbar methods.")}},{key:"getWhiteboardViewState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]getWhiteboardViewState ");var t=this.whiteboardViewMap.get(e);return t?t.getWhiteboardViewState():void 0}},{key:"getWhiteboardIntermediateLayerInstance",value:function(){return L.Logger.debug(B.logType,"[whiteboarrd-sdk]getWhiteboardIntermediateLayerInstance "),he}},{key:"switchDocAddress",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"default";if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]call switchDocAddress method , docAddressKey is "+e),e&&"string"==typeof e){if(B.localStorageDocAddressKey=e,B.localStorageDocAddressKey&&""===A.getItem(B.docAddressList,B.localStorageDocAddressKey)&&""===A.getItem(B.laterAddressList,B.localStorageDocAddressKey)&&(B.protocol&&B.port&&(B.laterAddressList=[{protocol:B.protocol,hostname:B.localStorageDocAddressKey,port:B.port}]),B.docAddressList=[B.docAddress].concat(D()(B.backupDocAddressList),D()(B.laterAddressList))),B.docAddressKey!==e){var r=A.getItem(B.docAddressList,B.docAddressKey);B.docAddressKey=e,B.nowUseDocAddress=A.getItem(B.docAddressList,B.docAddressKey)||z.commonWhiteboard.docAddress,t&&this.setLocalStorageItem("ysDocAddressKey",B.docAddressKey);var o=this.whiteboardViewMap.get(i);o&&(o.reloadCurrentDocument(),o.sendActionCommand("docAddressUpdate",{docAddressList:D()(B.docAddressList),docAddressKey:B.docAddressKey,oldDocAddress:r,nowDocAddress:B.docAddressList[B.docAddressKey]||z.commonWhiteboard.docAddress}))}else if(n){var a=this.whiteboardViewMap.get(i);a&&a.reloadCurrentDocument()}}else if(n){var s=this.whiteboardViewMap.get(i);s&&s.reloadCurrentDocument()}}},{key:"setLocalStorageItem",value:function(e,t){"mobile"===YS.SDKTYPE?this.room&&A.isFunction(this.room.setLocalStorageItem)&&this.room.setLocalStorageItem(e,t):A.setLocalStorageItem(e,t)}},{key:"getLocalStorageItem",value:function(e,t){if(A.isFunction(t))if("mobile"===YS.SDKTYPE){if(this.room&&A.isFunction(this.room.getLocalStorageItem))try{this.room.getLocalStorageItem(e,function(e){t(e)})}catch(e){L.Logger.error(B.logType,"[whiteboard-sdk]getLocalStorageItem error:",e)}}else t(A.getLocalStorageItem("ysDocAddressKey"))}},{key:"_executeSaveMsglistData",value:function(e){var t=this;this.saveMsglistData[e]&&this.whiteboardViewMap.get(e)&&(this.saveMsglistData[e].forEach(function(n,i){t.whiteboardViewMap.get(e).receiveEventRoomMsglist(n.name,n)}),delete this.saveMsglistData[e])}},{key:"_executeSavePubmsgData",value:function(e){var t=this;this.savePubmsgData[e]&&this.whiteboardViewMap.get(e)&&(this.savePubmsgData[e].forEach(function(n,i){t.whiteboardViewMap.get(e).receiveEventRoomPubmsg(n)}),delete this.savePubmsgData[e])}},{key:"_createWhiteboard",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(L.Logger.debug(B.logType,"[whiteboarrd-sdk]_createWhiteboard  parentNode  instanceId  configration  and\treceiveActionCommand:",t&&t.id||t,n,i,r),"string"==typeof t){var o=t;if(!(t=document.getElementById(o)))return void L.Logger.warning(B.logType,"The node id cannot be found by node id, and createWhiteboard method cannot be performed , element id is "+o+".")}this.pureWhiteboardFileinfoList[n]={fileid:0,companyid:"",filename:"whiteboard",uploaduserid:"",uploadusername:"",downloadpath:"",swfpath:"",filetype:"whiteboard",pagenum:1,dynamicppt:0,filecategory:0,fileprop:0};var a=void 0;this.awitWhiteboardConfigrationMap.has(n)?(a=this.awitWhiteboardConfigrationMap.get(n),this.awitWhiteboardConfigrationMap.delete(n)):a=Object.deepAssign({},z.defaultWhiteboard,z.commonWhiteboard);var s=Object.deepAssign({},a,i);this.whiteboardViewMap.has(n)&&this._destroyWhiteboard(n),this.whiteboardViewMap.set(n,new we(t,n,s,function(){var t;e.whiteboardToolbarViewList[n]&&e.whiteboardToolbarViewList[n].receiveActionCommand&&(t=e.whiteboardToolbarViewList[n]).receiveActionCommand.apply(t,arguments);"function"==typeof r&&r.apply(void 0,arguments)},this)),A.onElementResize(t,function(){e.updateWhiteboardSize(n)});var l=this.whiteboardViewMap.get(n);if(l&&l.getConfigration().isLoadWhiteboardToolBar){var c=l.getConfigration().whiteboardToolBarConfig.parentNode||l.getWhiteboardRootElement();this.createWhiteboardToolBar(c,l.getConfigration().whiteboardToolBarConfig,n)}}},{key:"_destroyWhiteboard",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";L.Logger.debug(B.logType,"[whiteboarrd-sdk]_destroyWhiteboard    instanceId  :",e),this.whiteboardViewMap.has(e)&&(this.whiteboardViewMap.get(e).destroyWhiteboardView(),this.whiteboardViewMap.delete(e)),this.awitWhiteboardConfigrationMap.has(e)&&this.awitWhiteboardConfigrationMap.delete(e)}},{key:"_isWhiteboardCorrelationSignalling",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]_isWhiteboardCorrelationSignalling    name  :",e);var t=!1;switch(e){case"SharpsChange":case"ShowPage":case"ExtendShowPage":case"WBPageCount":case"ExtendWBPageCount":case"NewPptTriggerActionClick":case"ExtendNewPptTriggerActionClick":case"PptVolumeControl":case"ExtendPptVolumeControl":case"H5DocumentAction":case"ExtendH5DocumentAction":case"whiteboardMarkTool":case"ExtendWhiteboardMarkTool":t=!0}return t}},{key:"_windowResizeCallback",value:function(){var e=this;return L.Logger.debug(B.logType,"[whiteboarrd-sdk]_windowResizeCallback "),this.updateAllWhiteboardSize(),setTimeout(function(){e.updateAllWhiteboardSize(),setTimeout(function(){e.updateAllWhiteboardSize()},250)},50),!1}},{key:"_windowMessageCallback",value:function(e){L.Logger.debug(B.logType,"[whiteboarrd-sdk]_windowMessageCallback"),e=e||window.event;var t=!0,n=!1,i=void 0;try{for(var r,o=W()(this.whiteboardViewMap.values());!(t=(r=o.next()).done);t=!0){r.value.receiveWindowMessageEvent(e)}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}for(var a=0,s=x()(this.documentToolbarViewList);a<s.length;a++){var l=s[a];l&&l.receiveWindowMessageEvent(e)}return!1}},{key:"_documentKeydownCallback",value:function(e){var t=this;switch(L.Logger.debug(B.logType,"[whiteboarrd-sdk]_documentKeydownCallback"),(e=e||window.event).keyCode){case 27:A.isFullScreenStatus()&&A.exitFullscreen()}var n=function(){if(!B.isSkipPageing&&t.whiteboardViewMap.has("default")&&t.whiteboardViewMap.get("default").getConfigration().isUseKeyboardPage&&!t.whiteboardViewMap.get("default").isWhiteboardTextEditing())switch(e.keyCode){case 37:t.whiteboardViewMap.get("default").prevPage();break;case 38:t.whiteboardViewMap.get("default").prevStep();break;case 39:t.whiteboardViewMap.get("default").nextPage();break;case 40:t.whiteboardViewMap.get("default").nextStep()}};return clearTimeout(this.documentKeydownTimer),this.documentKeydownDateTime&&(new Date).getTime()-this.documentKeydownDateTime>500?n():this.documentKeydownTimer=setTimeout(function(){n()},300),this.documentKeydownDateTime=(new Date).getTime(),!1}},{key:"_documentFullscreenchangeCallback",value:function(e){var t=this;L.Logger.debug(B.logType,"[whiteboarrd-sdk]_documentFullscreenchangeCallback");var n=!0,i=!1,r=void 0;try{for(var o,a=W()(this.whiteboardViewMap.values());!(n=(o=a.next()).done);n=!0){var s=o.value;if(A.isFullScreenStatus()){var l=s.getWhiteboardRootElement(),c=s.getConfigration().documentToolBarConfig.fullScreenElementId;c&&("string"==typeof c?document.getElementById(c)&&(l=document.getElementById(c)):l=c),A.getFullscreenElement()&&A.getFullscreenElement().id===l.id?s.changeFullScreenState(!0):s.changeFullScreenState(!1)}else s.changeFullScreenState(!1)}}catch(e){i=!0,r=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw r}}return this.videoPlayerView&&this.videoPlayerView.receiveEventFullScreenChange&&this.videoPlayerView.receiveEventFullScreenChange(e),this.updateAllWhiteboardSize(),setTimeout(function(){t.updateAllWhiteboardSize(),setTimeout(function(){t.updateAllWhiteboardSize()},250)},50),!1}},{key:"_registerEvent",value:function(){var e=this;L.Logger.debug(B.logType,"[whiteboarrd-sdk]_registerEvent");A.addEvent(window,"resize",this._windowResizeCallback.bind(this)),A.addEvent(window,"message",this._windowMessageCallback.bind(this)),A.addEvent(document,"keyup",this._documentKeydownCallback.bind(this)),A.addFullscreenchange(this._documentFullscreenchangeCallback.bind(this));var t=function(){var e,t,n;return void 0!==document.hidden?(e="hidden",n="visibilitychange",t="visibilityState"):void 0!==document.mozHidden?(e="mozHidden",n="mozvisibilitychange",t="mozVisibilityState"):void 0!==document.msHidden?(e="msHidden",n="msvisibilitychange",t="msVisibilityState"):void 0!==document.webkitHidden&&(e="webkitHidden",n="webkitvisibilitychange",t="webkitVisibilityState"),{hidden:e,state:t,visibilityChange:n}}(),n=t.state,i=t.visibilityChange;A.addEvent(document,i,function(){if("visible"===document[n])return e.updateAllWhiteboardSize(),setTimeout(function(){e.updateAllWhiteboardSize(),setTimeout(function(){e.updateAllWhiteboardSize()},250)},50),!1},!1)}},{key:"_addRoomEvent",value:function(){L.Logger.debug(B.logType,"[whiteboarrd-sdk]_addRoomEvent"),this.room&&(this.room.removeBackupListerner&&this.room.removeBackupListerner(this.listernerBackupid),this.room.addEventListener("room-receiveActionCommand",this.reveiveEventRoomReceiveActionCommand.bind(this),this.listernerBackupid),this.room.addEventListener("room-pubmsg",this.receiveEventRoomPubmsg.bind(this),this.listernerBackupid),this.room.addEventListener("room-delmsg",this.receiveEventRoomDelmsg.bind(this),this.listernerBackupid),this.room.addEventListener("room-connected",this.receiveEventRoomConnected.bind(this),this.listernerBackupid),this.room.addEventListener("room-disconnected",this.receiveEventRoomDisconnected.bind(this),this.listernerBackupid),this.room.addEventListener("room-msglist",this.receiveEventRoomMsglist.bind(this),this.listernerBackupid),this.room.addEventListener("room-usermediastate-changed",this.reveiveEventRoomUsermediaorfilestateChanged.bind(this),this.listernerBackupid),this.room.addEventListener("room-userfilestate-changed",this.reveiveEventRoomUsermediaorfilestateChanged.bind(this),this.listernerBackupid),this.room.addEventListener("room-usermediaattributes-update",this.reveiveEventRoomUsermediaorfileattributesUpdate.bind(this),this.listernerBackupid),this.room.addEventListener("room-userfileattributes-update",this.reveiveEventRoomUsermediaorfileattributesUpdate.bind(this),this.listernerBackupid),this.room.addEventListener("room-error-notice",this.receiveEventRoomErrorNotice.bind(this),this.listernerBackupid))}},{key:"_forwardingStreamEvents",value:function(e,t){L.Logger.debug(B.logType,"[whiteboarrd-sdk]_forwardingStreamEvents handlerName and recvEventData:",e,t),this.audioPlayerView&&this.audioPlayerView[e]&&A.isFunction(this.audioPlayerView[e])&&this.audioPlayerView[e](t),this.videoPlayerView&&this.videoPlayerView[e]&&A.isFunction(this.videoPlayerView[e])&&this.videoPlayerView[e](t)}}]),e}(),Je=["createMainWhiteboard","destroyMainWhiteboard","createExtendWhiteboard","destroyExtendWhiteboard","changeWhiteBoardConfigration","useWhiteboardTool","addPage","nextPage","prevPage","skipPage","nextStep","prevStep","enlargeWhiteboard","narrowWhiteboard","clear","undo","redo","fullScreen","exitFullScreen","resetWhiteboardData","updateWhiteboardSize","updateAllWhiteboardSize","resetAllWhiteboardData","resetPureWhiteboardTotalPage","changeDynamicPptVolume","openDocumentRemark","closeDocumentRemark","getWhiteboardIntermediateLayerInstance","changeCommonWhiteBoardConfigration","registerRoomDelegate","changeDocument","stopShareLocalMedia","switchDocAddress","getVersion","openRemoteDocument","noticeWhiteboardActionCommand"],Xe=["createMainWhiteboard","destroyMainWhiteboard","changeDocument","changeWhiteBoardConfigration","useWhiteboardTool","addPage","nextPage","prevPage","skipPage","nextStep","prevStep","enlargeWhiteboard","narrowWhiteboard","clear","undo","redo","fullScreen","exitFullScreen","resetWhiteboardData","registerRoomDelegate","changeCommonWhiteBoardConfigration","getVersion","openRemoteDocument","noticeWhiteboardActionCommand"];function Ke(e,t,n){for(var i={className:"YSWhiteBoardManager"},r=new Ye(e,t,n),o=function(){var e=s[a];i[e]=function(){return r[e].apply(r,arguments)}},a=0,s=n?Je:Xe;a<s.length;a++)o();return i}window.YSWhiteBoardManager=Ke;var Qe=Ke;n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214);try{var Ze=window.URL||webkitURL;if(Ze&&window&&window.MediaStream){var $e=new window.MediaStream;try{Ze.createObjectURL($e)}catch(e){window._URLCreateObjectURL=Ze.createObjectURL,window.HTMLMediaElement.prototype._setAttribute=window.HTMLMediaElement.prototype.setAttribute,window.HTMLMediaElement.prototype._removeAttribute=window.HTMLMediaElement.prototype.removeAttribute,Ze.createObjectURL=function(e){try{return window._URLCreateObjectURL(e)}catch(t){return e&&window.MediaStream&&e instanceof window.MediaStream?e:(console.error("redefine createObjectURL err:",t),e)}},window.HTMLMediaElement&&"srcObject"in window.HTMLMediaElement.prototype&&(r()(window.HTMLMediaElement.prototype,"src",{set:function(e){e&&window.MediaStream&&e instanceof window.MediaStream?(this._srcObject=e,this.srcObject=this._srcObject):(this.srcObject=null,this._srcObject=void 0,this._setAttribute("src",e))}}),window.HTMLMediaElement.prototype.setAttribute=function(e,t){"src"===e?this.src=t:this._setAttribute(e,t)},window.HTMLMediaElement.prototype.removeAttribute=function(e){"src"===e?this.src="":this._removeAttribute(e)})}}}catch(e){console.error("compatibility createObjectURL err:",e)}t.default=Qe}]);